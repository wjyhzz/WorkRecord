# Chapter 1. 数据库简介

## Ⅰ 数据库分类

- 关系型数据库 `RDMS`
  - MySQL
  - Oracle
- 非关系型数据库 ``
  - Redis（键值型key-value）
  - MongoDB（文档型）



## Ⅱ 数据类型

- 整数：`int`
  - 有符号整数：-(2^31-1)~2^31-1
  - 无符号整数：0~2^32-1
- 小数：`decimal(5,2)`表示共存 5 位数，小数占 2 位，整数占 3 位
- 字符串：`varchar`：0~65535
- 日期时间：`datetime`



## Ⅲ 约束

- 主键(primary key)：能唯⼀一标识表中的每⼀一条记录的属性组
- 非空(not null)：此字段不不允许填写空值
- 唯一(unique)：此字段的值不不允许重复
- 默认值(default)：当不不填写此值时会使⽤用默认值，如果填写时以填写为准
- 外键(foreign key)：⼀一个表中的⼀一个字段引⽤用另⼀一个表的主键



## Ⅳ 表结构描述

表名称：dept

描述：部门信息表

| 英文字段名称 | 中文描述 | 类型        |
| ------------ | -------- | ----------- |
| DEPTNO       | 部门编号 | INT(2)      |
| DNAME        | 部门名称 | VARCHAR(14) |
| LOC          | 位置     | VARCHAR(13) |

 

表名称：emp

描述：员工信息表

| 英文字段名称 | 中文描述 | 类型         |
| ------------ | -------- | ------------ |
| EMPNO        | 员工编号 | INT (4)      |
| ENAME        | 员工姓名 | VARCHAR(10)  |
| JOB          | 工作岗位 | VARCHAR(9)   |
| MGR          | 上级领导 | INT (4)      |
| HIREDATE     | 入职日期 | DATE         |
| SAL          | 薪水     | DOUBLE(7,2)  |
| COMM         | 津贴     | DOUBLE (7,2) |
| DEPTNO       | 部门编号 | INT(2)       |

注：DEPTNO字段是外键，DEPTNO的值来源于dept表的主键，起到了约束的作用

表名称：salgrade

描述：薪水等级信息表

| 英文字段名称 | 中文描述 | 类型 |
| ------------ | -------- | ---- |
| GRADE        | 等级     | INT  |
| LOSAL        | 最低薪水 | INT  |
| HISAL        | 最高薪水 | INT  |



## Ⅴ大小写问题

MySQL在windows下是不区分大小写的，将script文件导入MySQL后表名也会自动转化为小写，结果再想要将数据库导出放到linux服务器中使用时就出错了。因为在linux下表名区分大小写而找不到表，查了很多都是说在linux下更改MySQL的设置使其也不区分大小写，但是有没有办法反过来让windows 下大小写敏感呢。其实方法是一样的，相应的更改windows中MySQL的设置就行了。

具体操作：

在MySQL的配置文件my.ini中增加一行：

```
lower_case_table_names = 0
```

其中 0：区分大小写，1：不区分大小写

MySQL 在 Linux 下数据库名、表名、列名、别名大小写规则是这样的：

1. 数据库名与表名是严格区分大小写的；
2. 表的别名是严格区分大小写的；
3. 列名与列的别名在所有的情况下均是忽略大小写的；
4. 变量名也是严格区分大小写的；  MySQL 在 Windows 下都不区分大小写



# Chapter 2. Navicat 图形页面化操作

## Ⅰ 整数无符号设置

<img src="./assets/image-20251128101032617.png" alt="image-20251128101032617" style="zoom: 50%;" />

## Ⅱ 约束

### 一、 主键&不为空

![image-20251128102009880](./assets/image-20251128102009880.png)





### 二、 唯一

![image-20251128102235613](./assets/image-20251128102235613.png)



### 三、 默认

![image-20251128102359899](./assets/image-20251128102359899.png)



## Ⅲ 打开命令行

![image-20251128102536468](./assets/image-20251128102536468.png)

## Ⅳ 数据库备份

![image-20251128105923718](./assets/image-20251128105923718.png)

![image-20251128110059121](./assets/image-20251128110059121.png)



# Chapter3. SQL语句

## Ⅰ 数据库操作

### 一、创建&切换数据库

```sql
-- 创建数据库
create database 数据库名称;
-- 切换数据库
use 数据库名称;
```



### 二、查询当前使用的数据库

```sql
select database();
```



### 三、修改数据库编码格式&排序规则

```sql
ALTER DATABASE zq_test
DEFAULT CHARACTER SET utf8mb4
DEFAULT COLLATE utf8mb4_general_ci;
```



### 四、删除数据库和查看所有数据库

```sql
-- 删除数据库
DROP DATABASE zq_test;
--查看所有库
SHOW DATABASES;
```



### 五、数据库备份

```sql
# 备份语法：mysqldump -u用户名 -p密码 -h主机 -P端口 数据库名 [选项] > 备份文件.sql
mysqldump -uroot -p123456 - test_db > x.sql
# 还原语法：mysql -u用户名 -p密码 -h主机 -P端口 目标数据库名 < 备份文件.sql
mysql -uroot -p123456 test_db < x.sql
```



## Ⅱ 数据表操作

### 一、创建表

```sql
CREATE TABLE students ( 
    id INT UNSIGNED PRIMARY KEY auto_increment, 
    NAME VARCHAR ( 20 ), 
    age INT UNSIGNED, 
    height DECIMAL ( 5, 2 ) );
```



### 二、查看表

```sql
SHOW CREATE TABLE students;
```



### 三、先判断表是否存在，再移除并创建

```sql
DROP TABLE
IF
	EXISTS students;
CREATE TABLE students ( id INT UNSIGNED PRIMARY KEY auto_increment, NAME VARCHAR ( 20 ), age INT UNSIGNED, height DECIMAL ( 5, 2 ) );
```



### 四、通过Navicat工具获取创表语句的方法

![image-20251128142110742](./assets/image-20251128142110742.png)



### 五、查看表结构和删除表

```sql
-- 查看表结构(字段)
-- desc 表名;
DESC auth_group;
-- 删除表
-- drop table 表名;
drop table students;
```



## Ⅲ 数据操作

### 一、增加数据

#### 1.1 增加一行数据

```sql
-- 增加⼀行数据
-- insert into 表名 values(...)
-- 注意: 
-- 1. 数据值需要和表的字段⼀一对应(数据个数及数据类型)
-- 2. 主键列列是自动增长，插入时需要占位，通常使⽤用 0 或者 default 或者
INSERT INTO students
VALUES
	( 0, 'zhangsan', 28, 1.78 );
	
-- 增加部分字段
INSERT INTO students ( NAME, height )
VALUES
	( 'lisi', 1.68 );
```



#### 1.2 增加多行数据

```sql
insert into students values(0, '王五1', 29, 1.78),(0, '王五2', 
30, 1.78);
```



#### 1.3 修改数据

更新students表中，id=9的数据。将其age设为48

```sql
update students set age=48 where id=9;
```



### 二、删除数据

#### 2.1 三种删除命令

- `delete from 表名` :  删除所有数据, 但是不重置主键字段的计数
- `truncate table 表名` : 删除所有数据, 并重置主键字段的计数
- `drop table 表名` : 删掉表(字段和数据均不再存在)

```sql
DELETE FROM students WHERE id = 2;
TRUNCATE TABLE students;
DROP TABLE students;
```



#### 2.2 图形化界面

![image-20251128144045233](./assets/image-20251128144045233.png)

#### 2.3 逻辑删除

对于重要的数据，不能轻易执行 delete 语句进行删除。因为⼀旦删除，数据⽆法恢复，这 时可以进⾏逻辑删除。 

1. 给表添加字段，代表数据是否删除，⼀般起名 `isdelete`，0代表未删除，1代 表删除，默认值为0
2. 当要删除某条数据时，只需要设置这条数据的 isdelete 字段为1 
3. 以后在查询数据时，只查询出 `isdelete` 为 0 的数据

![image-20251128143613888](./assets/image-20251128143613888.png)

```sql
-- 将id4的数据设为删除
UPDATE students 
SET isdelete = 1 
WHERE
	id = 4;

-- 查询所有未删除数据
SELECT
	* 
FROM
	students 
WHERE
	isdelete = 0;
```



# Chapter4. 简单查询

`select` 语句后面跟的是字段名称，`select` 是关键字，`select` 和字段名称之间采用空格隔开，`from` 表示将要查询的表，它和字段之间采用空格隔开,查询多个字段，`select` 中的字段采用**逗号**间隔即可，最后一个字段，也就是在 `from` 前面的字段不能使用逗号了。

```sql
-- 查询员工姓名
select ename from emp;
-- 查询员工的编号和姓名
SELECT empno,ename FROM emp;
```

```sql
SELECT * FROM emp;
```

>  采用 `select * from emp` ，虽然简单，但是 `*` 号不是很明确，建议查询全部字段将相关字段写到  `select` 语句的后面，写明字段，这样可读性强.

```sql
SELECT empno,ename,sal * 12 FROM emp;
```

在 `select` 语句中可以使用运算符，以上存在一些问题，年薪的字段名称不太明确

1. 字符串必须添加单引号或双引号
2. 关键字 `as` 可以省略

```sql
select empno as ‘员工编号’, ename as ‘员工姓名’, sal*12 as ‘年薪’ from emp;
select empno  "员工编号", ename  "员工姓名", sal*12  "年薪" from emp;
```



# Chapter5. 条件查询

条件查询需要用到 where 语句，where 必须放到 from 语句表的后面



```sql
-- 查询薪水为5000的员工
select empno, ename, sal from emp where sal=5000;
-- 查询job为MANAGER的员工
select empno, ename from emp where job="manager";
```

```sql
-- 查询薪水不等于5000的员工
select empno, ename, sal from emp where sal <> 5000;
-- 查询工作岗位不等于MANAGER的员工
select empno, ename from emp where job <> 'MANAGER';
```

```sql
-- 查询薪水为1600到3000的员工
-- 法1
select empno, ename, sal from emp where sal >= 1600 and sal <= 3000;
-- 法2
select empno, ename, sal from emp where sal between 1600 and 3000;
```

```sql
-- 查询津贴为空的员工
select * from emp where comm is null;
```

```sql
-- 工作岗位为MANAGER,薪水大于2500的员工
select * from emp where job='MANAGER' and sal > 2500;
```

```sql
-- 查询出job为manager或者job为salesman的员工
select * from emp where job='MANAGER' or job='SALESMAN';
```

```sql
-- 查询薪水大于1800，并且部门代码为20或30的员工
select * from emp where sal > 1800 and (deptno = 20 or deptno = 30);

```

```sql
-- 查询出job为manager或者job为salesman的员工
select * from emp where job in ('manager','salesman');
-- 查询出薪水包含1600和薪水包含3000的员工
select * from emp where sal in(1600, 3000);
```

```sql
-- 查询出薪水不包含1600和薪水不包含3000的员工
select * from emp where sal <> 1600 and sal <> 3000;
select * from emp where not (sal = 1600 or sal = 3000);
select * from emp where sal not in (1600, 3000);
-- 查询出津贴不为null的所有员工
select * from emp where comm is not  null;
```

```sql
-- 查询姓名以M开头所有的员工
select * from emp where ename like 'M%';
-- 查询姓名以N结尾的所有的员工
select * from emp where ename like '%N';
-- 查询姓名中包含O的所有的员工
select * from emp where ename like '%O%';
-- 查询姓名中第二个字符为A的所有员工
select * from emp where ename like '_A%';
```



# Chapter6. 排序顺序

排序采用order by子句，order by后面跟上排序字段，排序字段可以放多个，多个采用逗号间隔，order by默认采用升序，如果存在where子句那么order by必须放到where语句的后面

```sql
-- 按照薪水由小到大排序(系统默认由小到大)
select * from emp order by sal;
-- 取得job为MANAGER的员工，按照薪水由小到大排序(系统默认由小到大)
select * from emp where job='MANAGER' order by sal;
-- 按照多个字段排序，如：首先按照job排序，再按照sal排序
select * from emp order by job,sal;
```

```sql
-- 手动指定按照薪水由小到大排序
select * from emp order by sal asc;
-- 手动指定按照薪水由大到小排序
select * from emp order by sal desc;
```

```sql
-- 按照job和薪水倒序
select * from emp order by job desc, sal desc;
```

```sql
-- 按照薪水升序(不建议使用)
select * from emp order by 6;
```



# Chapter7. 分组/聚合/多行处理

| count | 取得记录数 |
| ----- | ---------- |
| sum   | 求和       |
| avg   | 取平均     |
| max   | 取最大的数 |
| min   | 取最小的数 |

**注意：分组函数自动忽略空值，不需要手动的加where*条件排除空值。**

**select count(\*) from emp where xxx;**            **符合条件的所有记录总数。**

**select count(comm) from emp;     comm这个字段中不为空的元素总数。**

```sql
-- 取得所有的员工数
select count(*) from emp;
-- 取得津贴不为null员工数
select count(comm) from emp;
-- 取得工作岗位的个数 distanct去重
select count(distinct job) from emp;
```

```sql
-- 取得薪水的合计
select sum(sal) from emp;
-- 取得津贴的合计
select sum(comm) from emp;
-- 取得薪水的合计
select sum(sal+IFNULL(comm, 0)) from emp;
```

```sql
-- 取得平均薪水
select avg(sal) from emp;
```

```sql
-- 取得最高薪水
select max(sal) from emp;
-- 取得最晚入职得员工
select max(str_to_date (hiredate, '%Y-%m-%d')) from emp;
```

```sql
-- 取得最低薪水
select min(sal) from emp;
-- 取得最早入职得员工（可以不使用str_to_date转换）
select min(str_to_date(hiredate, '%Y-%m-%d')) from emp;
```

```sql
-- 可以将这些聚合函数都放到select中一起使用
select count(*),sum(sal),avg(sal),max(sal),min(sal) from emp;
```



# Chapter8. 分组查询

```sql
-- 取得每个工作岗位的工资合计，要求显示岗位名称和工资合计
select job, sum(sal) from emp group by job;
select job,deptno,sum(sal) from emp group by job,deptno;
```

```sql
-- 取得每个岗位的平均工资大于2000
select job, avg(sal) from emp group by job having avg(sal) >2000;
```



## select语句总结

```sql
SELECT
	字段 
FROM
	表名 
WHERE
GROUP BY
HAVING
ORDER BY
```



# Chapter9. 连接查询(跨表查询)



# Chapter10. 子查询
