<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4. 在 Windows 上使用 Python" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/using/windows.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="本文档旨在概述在 Microsoft Windows 上使用 Python 时应了解的特定于 Windows 的行为。 与大多数Unix系统和服务不同，Windows不包括系统支持的Python安装。相反，Python可以从许多发行商获得，包括直接从CPython团队获得。每个Python发行版都有自己的优点和缺点，但是，与您正在使用的其他工具保持一致通常是值得的优点。在使用这里描述的过程之..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://docs.python.org/3.14/zh-cn/_images/social_previews/summary_using_windows_9be3738b.png" />
<meta property="og:image:alt" content="本文档旨在概述在 Microsoft Windows 上使用 Python 时应了解的特定于 Windows 的行为。 与大多数Unix系统和服务不同，Windows不包括系统支持的Python安装。相反，Python可以从许多发行商获得，包括直接从CPython团队获得。每个Python发行版都有自己的优点和缺点，但是，与您正在使用的其他工具保持一致通常是值得的优点。在使用这里描述的过程之..." />
<meta name="description" content="本文档旨在概述在 Microsoft Windows 上使用 Python 时应了解的特定于 Windows 的行为。 与大多数Unix系统和服务不同，Windows不包括系统支持的Python安装。相反，Python可以从许多发行商获得，包括直接从CPython团队获得。每个Python发行版都有自己的优点和缺点，但是，与您正在使用的其他工具保持一致通常是值得的优点。在使用这里描述的过程之..." />
<meta name="twitter:card" content="summary_large_image" />
<meta name="theme-color" content="#3776ab">

    <title>4. 在 Windows 上使用 Python &#8212; Python 3.14.0 文档</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=234b1a7c" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=8cd84f99" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=5349f25f" />
    
    <script src="../_static/documentation_options.js?v=a595ec0e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.14.0 文档 中搜索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="关于此文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="copyright" title="版权" href="../copyright.html" />
    <link rel="next" title="5. 在 macOS 上使用 Python" href="mac.html" />
    <link rel="prev" title="3. 配置 Python" href="configure.html" />
    
      
      <script defer file-types="bz2,epub,zip" data-domain="docs.python.org" src="https://analytics.python.org/js/script.file-downloads.outbound-links.js"></script>
      
      <link rel="canonical" href="https://docs.python.org/3/using/windows.html">
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg">
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="菜单">
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo">
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q">
                <input type="submit" value="转到">
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">4. 在 Windows 上使用 Python</a><ul>
<li><a class="reference internal" href="#python-install-manager">4.1. Python 安装管理器</a><ul>
<li><a class="reference internal" href="#installation">4.1.1. 安装</a></li>
<li><a class="reference internal" href="#basic-use">4.1.2. 基础使用</a></li>
<li><a class="reference internal" href="#command-help">4.1.3. 命令帮助</a></li>
<li><a class="reference internal" href="#listing-runtimes">4.1.4. 列出运行时</a></li>
<li><a class="reference internal" href="#installing-runtimes">4.1.5. 安装运行时</a></li>
<li><a class="reference internal" href="#offline-installs">4.1.6. 离线安装</a></li>
<li><a class="reference internal" href="#uninstalling-runtimes">4.1.7. 卸载运行时</a></li>
<li><a class="reference internal" href="#configuration">4.1.8. 配置</a></li>
<li><a class="reference internal" href="#shebang-lines">4.1.9. Shebang 行</a></li>
<li><a class="reference internal" href="#advanced-installation">4.1.10. 高级安装</a></li>
<li><a class="reference internal" href="#administrative-configuration">4.1.11. 管理配置</a></li>
<li><a class="reference internal" href="#installing-free-threaded-binaries">4.1.12. 安装自由线程二进制文件</a></li>
<li><a class="reference internal" href="#troubleshooting">4.1.13. 故障排除</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-embeddable-package">4.2. 可嵌入的包</a><ul>
<li><a class="reference internal" href="#python-application">4.2.1. Python 应用程序</a></li>
<li><a class="reference internal" href="#embedding-python">4.2.2. 嵌入Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-nuget-org-packages">4.3. nuget.org 安装包</a><ul>
<li><a class="reference internal" href="#free-threaded-packages">4.3.1. 自由线程版软件包</a></li>
</ul>
</li>
<li><a class="reference internal" href="#alternative-bundles">4.4. 替代捆绑包</a></li>
<li><a class="reference internal" href="#supported-windows-versions">4.5. 支持的 Windows 版本</a></li>
<li><a class="reference internal" href="#removing-the-max-path-limitation">4.6. 移除 MAX_PATH 限制</a></li>
<li><a class="reference internal" href="#utf-8-mode">4.7. UTF-8 模式</a></li>
<li><a class="reference internal" href="#finding-modules">4.8. 查找模块</a></li>
<li><a class="reference internal" href="#additional-modules">4.9. 附加模块</a><ul>
<li><a class="reference internal" href="#pywin32">4.9.1. PyWin32</a></li>
<li><a class="reference internal" href="#cx-freeze">4.9.2. cx_Freeze</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compiling-python-on-windows">4.10. 在Windows上编译Python</a></li>
<li><a class="reference internal" href="#the-full-installer-deprecated">4.11. 完整安装程序（已弃用）</a><ul>
<li><a class="reference internal" href="#installation-steps">4.11.1. 安装步骤</a></li>
<li><a class="reference internal" href="#id2">4.11.2. 移除 MAX_PATH 限制</a></li>
<li><a class="reference internal" href="#installing-without-ui">4.11.3. 无 UI 安装</a></li>
<li><a class="reference internal" href="#installing-without-downloading">4.11.4. 免下载安装</a></li>
<li><a class="reference internal" href="#modifying-an-install">4.11.5. 修改安装</a></li>
<li><a class="reference internal" href="#id3">4.11.6. 安装自由线程二进制文件</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python-launcher-for-windows-deprecated">4.12. Windows 版 Python 启动器（已弃用）</a><ul>
<li><a class="reference internal" href="#getting-started">4.12.1. 入门</a><ul>
<li><a class="reference internal" href="#from-the-command-line">4.12.1.1. 从命令行</a></li>
<li><a class="reference internal" href="#virtual-environments">4.12.1.2. 从虚拟环境</a></li>
<li><a class="reference internal" href="#from-a-script">4.12.1.3. 从脚本</a></li>
<li><a class="reference internal" href="#from-file-associations">4.12.1.4. 从文件关联</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">4.12.2. Shebang 行</a></li>
<li><a class="reference internal" href="#arguments-in-shebang-lines">4.12.3. shebang 行的参数</a></li>
<li><a class="reference internal" href="#customization">4.12.4. 自定义</a><ul>
<li><a class="reference internal" href="#customization-via-ini-files">4.12.4.1. 通过INI文件自定义</a></li>
<li><a class="reference internal" href="#customizing-default-python-versions">4.12.4.2. 自定义默认的Python版本</a></li>
</ul>
</li>
<li><a class="reference internal" href="#diagnostics">4.12.5. 诊断</a></li>
<li><a class="reference internal" href="#dry-run">4.12.6. 试运行</a></li>
<li><a class="reference internal" href="#install-on-demand">4.12.7. 按需安装</a></li>
<li><a class="reference internal" href="#return-codes">4.12.8. 返回码</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="configure.html"
                          title="上一章"><span class="section-number">3. </span>配置 Python</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="mac.html"
                          title="下一章"><span class="section-number">5. </span>在 macOS 上使用 Python</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告代码错误</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/using/windows.rst?plain=1"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="mac.html" title="5. 在 macOS 上使用 Python"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="configure.html" title="3. 配置 Python"
             accesskey="P">上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python安装和使用</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">4. </span>在 Windows 上使用 Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box">
          <input type="submit" value="转到">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="using-python-on-windows">
<span id="using-on-windows"></span><h1 class="translated"><span class="section-number">4. </span>在 Windows 上使用 Python<a class="headerlink" href="#using-python-on-windows" title="Link to this heading">¶</a></h1>
<p class="translated">本文档旨在概述在 Microsoft Windows 上使用 Python 时应了解的特定于 Windows 的行为。</p>
<p class="translated">与大多数Unix系统和服务不同，Windows不包括系统支持的Python安装。相反，Python可以从许多发行商获得，包括直接从CPython团队获得。每个Python发行版都有自己的优点和缺点，但是，与您正在使用的其他工具保持一致通常是值得的优点。在使用这里描述的过程之前，我们建议调查您现有的工具，看看它们是否可以直接提供Python。</p>
<p class="translated">要从 CPython 团队获取 Python，请使用 Python 安装管理器。 这是一个独立的工具，它使 Python 可以作为 Windows 机器上的全局命令使用，与系统集成，并支持随时间更新。 您可以从 <a class="reference external" href="https://www.python.org/downloads/">python.org/downloads</a> 或通过  <a class="reference external" href="https://apps.microsoft.com/detail/9NQ7512CXL7T">Microsoft Store app</a> 下载 Python 安装管理器。</p>
<p class="translated">一旦安装了Python安装管理器，就可以在任何终端上使用全局命令 <code class="docutils literal notranslate"><span class="pre">python</span></code> 启动当前最新版本的 Python。 当您添加或删除不同的版本时，该版本可能会随着时间的推移而变化，<code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">list</span></code> 命令将显示当前的版本。</p>
<p class="translated">总的来说，我们推荐你为每个项目创建一个 <a class="reference internal" href="../tutorial/venv.html#tut-venv"><span class="std std-ref">虚拟环境</span></a> 并在你的终端里运行 <code class="docutils literal notranslate"><span class="pre">&lt;env&gt;\Scripts\Activate</span></code> 来使用它。 这提供了项目之间的隔离，时间变化后的一致性，并确保由软件包添加的额外命令在你的会话中同样可用。 创建虚拟环境是使用 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">venv</span> <span class="pre">&lt;env</span> <span class="pre">path&gt;</span></code>。</p>
<p class="translated">如果 <code class="docutils literal notranslate"><span class="pre">python</span></code> 或 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令显示不可用，请查看下面的 <a class="reference internal" href="#pymanager-troubleshoot"><span class="std std-ref">故障排查</span></a> 一节。 有时还需要额外的手动操作步骤来配置你的 PC。</p>
<p class="translated">除了使用 Python 安装管理器，Python 也可以作为 NuGet 软件包来获取。 请参阅下面的 <a class="reference internal" href="#windows-nuget"><span class="std std-ref">nuget.org 安装包</span></a> 了解有关这些软件包的更多信息。</p>
<p class="translated">可嵌入分发版是适用于嵌入到更大的应用程序中的最小化的 Python 软件包。 它们可以使用 Python 安装管理器来安装。 请参阅下面的 <a class="reference internal" href="#windows-embeddable"><span class="std std-ref">可嵌入的包</span></a> 了解有关这些软件包的更多信息。</p>
<section id="python-install-manager">
<span id="launcher"></span><span id="windows-path-mod"></span><span id="setting-envvars"></span><span id="windows-store"></span><span id="pymanager"></span><h2 class="translated"><span class="section-number">4.1. </span>Python 安装管理器<a class="headerlink" href="#python-install-manager" title="Link to this heading">¶</a></h2>
<section id="installation">
<h3 class="translated"><span class="section-number">4.1.1. </span>安装<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h3>
<p class="translated">Python 安装管理器可从 <a class="reference external" href="https://apps.microsoft.com/detail/9NQ7512CXL7T">Microsoft Store app</a> 安装或是从 <a class="reference external" href="https://www.python.org/downloads/">python.org/downloads</a> 下载并安装。 这两个版本的内容是一致的。</p>
<p class="translated">要通过 Store 安装，只需点击 &quot;Install&quot;。 在安装完成之后，可打开一个终端并键入 <code class="docutils literal notranslate"><span class="pre">python</span></code> 以开始使用。</p>
<p class="translated">要安装从 python.org 下载的文件，只需双击并选择 &quot;Install&quot;，或是在 Windows Powershell 中运行 <code class="docutils literal notranslate"><span class="pre">Add-AppxPackage</span> <span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">MSIX&gt;</span></code>。</p>
<p class="translated">在安装完成之后，应当可以使用 <code class="docutils literal notranslate"><span class="pre">python</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code> 和 <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> 等命令。 如果你已经安装了其他版本的 Python，或者已经修改了你的 <span class="target" id="index-80"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 变量，你可能需要移除它们或撤销修改。 请参阅 <a class="reference internal" href="#pymanager-troubleshoot"><span class="std std-ref">故障排除</span></a> 了解有关修复不可用的命令的更多帮助信息。</p>
<p class="translated">当你第一次安装一个运行时，你可能会被提示添加一个目录到你的 <span class="target" id="index-81"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code>。 如果你更喜欢使用 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令，这是可选的，但对于那些希望使用全部别名 (例如``python3.14.exe``) 的人来说，这是可选的。 默认目录为 <code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Python\bin</span></code>，但可以由管理员自定义。 单击“开始”，在系统设置页面中搜索“编辑帐户的环境变量”，添加路径。</p>
<p class="translated">你安装的每个 Python 运行时都会拥有它自己的脚本目录。 如果你希望使用它们则也需要将其添加到 <span class="target" id="index-82"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code>。</p>
<p class="translated">Python 安装管理器将自动更新到最新发布版。 这不会影响任何已安装的 Python 运行时。 卸载 Python 安装管理器不会卸载任何 Python 运行时。</p>
<p class="translated">如果你无法在你的应用场景上下文中安装 MSIX，举例来说，当你使用不支持它的自动化布署软件，或者是使用 Windows Server 2019，请参阅下面的 <a class="reference internal" href="#pymanager-advancedinstall"><span class="std std-ref">高级安装</span></a> 了解更多信息。</p>
</section>
<section id="basic-use">
<h3 class="translated"><span class="section-number">4.1.2. </span>基础使用<a class="headerlink" href="#basic-use" title="Link to this heading">¶</a></h3>
<p class="translated">推荐的 Python 启动命令是 <code class="docutils literal notranslate"><span class="pre">python</span></code>，它将启动被运行脚本所请求的版本、激活的虚拟环境版本，或者默认的安装版本，默认的安装版本将是最新稳定发布版除非另有配置。 如果没有请求特定版本且没有安装任何运行时，则会自动安装当前的最新发布版。</p>
<p class="translated">对于所有涉及多个运行时版本场景，推荐的命令是 <code class="docutils literal notranslate"><span class="pre">py</span></code>。 此命令可在任何地方代替 <code class="docutils literal notranslate"><span class="pre">python</span></code> 或更老旧的 <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> 启动器使用。 在默认情况下，<code class="docutils literal notranslate"><span class="pre">py</span></code> 将匹配 <code class="docutils literal notranslate"><span class="pre">python</span></code> 的行为，但也允许通过命令行选项来选择特定版本以及用子命令来管理安装版本。 这将在下文中详细说明。</p>
<p class="translated">因为 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令可能已被之前的版本占用了，所以还有一个无歧义的 <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> 命令。 希望使用 Python 安装管理器的脚本安装程序应当考虑使用 <code class="docutils literal notranslate"><span class="pre">pymanager</span></code>，这样遇到与现有安装版发生冲突的几率较小。 这两个命令的唯一区别出现在不带任何参数运行的时候: <code class="docutils literal notranslate"><span class="pre">py</span></code> 将安装并启动你的默认解释器，而 <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> 将显示帮助信息 (<code class="docutils literal notranslate"><span class="pre">pymanager</span> <span class="pre">exec</span> <span class="pre">...</span></code> 提供了与 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">...</span></code> 等价的行为)。</p>
<p class="translated">这些命令还各自拥有一个避免创建控制台窗口的窗口模式版本。 其对应的命令为 <code class="docutils literal notranslate"><span class="pre">pyw</span></code>, <code class="docutils literal notranslate"><span class="pre">pythonw</span></code> 和 <code class="docutils literal notranslate"><span class="pre">pymanagerw</span></code>。 另外还包括一个相当于 <code class="docutils literal notranslate"><span class="pre">python</span></code> 命令的 <code class="docutils literal notranslate"><span class="pre">python3</span></code> 命令。 它的目的是在 Windows 上捕获意外使用典型 POSIX 命令的情况，但它不应当也不推荐被广泛使用。</p>
<p class="translated">要启动你的默认运行时，则运行 <code class="docutils literal notranslate"><span class="pre">python</span></code> 或 <code class="docutils literal notranslate"><span class="pre">py</span></code> 并附带你希望传给运行时的参数（如要运行的脚本文件或模块）：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py
...
$&gt; python my-script.py
...
$&gt; py -m this
...
</pre></div>
</div>
<p class="translated">默认运行时可通过 <span class="target" id="index-83"></span><a class="reference internal" href="#envvar-PYTHON_MANAGER_DEFAULT"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_MANAGER_DEFAULT</span></code></a> 环境变量，或配置文件来覆盖。 请参阅 <a class="reference internal" href="#pymanager-config"><span class="std std-ref">配置</span></a> 了解有关配置设置的信息。</p>
<p class="translated">为了启动特定的运行时，<code class="docutils literal notranslate"><span class="pre">py</span></code> 命令接受一个 <code class="docutils literal notranslate"><span class="pre">-V:&lt;TAG&gt;</span></code> 选项。 该选项必须在任何其他选项之前指定。 该标签包含针对运行时的部分或全部标识符；对于来自 CPython 团队的标识符，看上去类似于版本号，并可能带有平台名称。 为保持兼容性，在标签指代某一官方发布版并且以 <code class="docutils literal notranslate"><span class="pre">3</span></code> 开头的情况下 <code class="docutils literal notranslate"><span class="pre">V:</span></code> 可以被省略。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py -V:3.14 ...
$&gt; py -V:3-arm64 ...
</pre></div>
</div>
<p class="translated">来自其他发行方的运行时还可能包括 <em>公司名</em>。 这应当以一个斜杠隔开标签以及可能存在的前缀。 当公司名为 <code class="docutils literal notranslate"><span class="pre">PythonCore</span></code> 时它可以被省略，而当你想要来自特定公司的最新发布版时指定标签也是可选项（但斜杠是必须的）。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py -V:Distributor\1.0 ...
$&gt; py -V:distrib/ ...
</pre></div>
</div>
<p class="translated">如果没有指定版本，但是传入了一个脚本文件，则将检查该脚本是否有 <em>井号叹号行</em>。 这是一种针对文件首行的允许对命令进行覆盖的特殊格式。 请参阅 <a class="reference internal" href="#pymanager-shebang"><span class="std std-ref">Shebang 行</span></a> 了解详情。 当不存在井号咍行，或其无法被解析时，脚本将使用默认运行时来启动。</p>
<p class="translated">如果你在活动的虚拟环境中运行，没有请求特定的版本，并且没有 shebang 行，则默认运行时将是该虚拟环境。 在这种情况下，<code class="docutils literal notranslate"><span class="pre">python</span></code> 命令可能已经被覆盖，并且这些检查都没有发生。 然而，这种行为确保了 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令可以互换使用。</p>
<p class="translated">当你启动``python``或``py``但没有安装任何运行时，并且所请求的版本是默认的，它将自动安装然后启动。否则，如果配置了自动安装（很可能通过将``PYTHON_MANAGER_AUTOMATIC_INSTALL``设置为``true``），或者如果使用了命令的``py exec``或``pymanager exec``形式，则将安装所请求的版本。</p>
</section>
<section id="command-help">
<h3 class="translated"><span class="section-number">4.1.3. </span>命令帮助<a class="headerlink" href="#command-help" title="Link to this heading">¶</a></h3>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">help``命令将显示支持的命令的完整列表，以及它们的选项。任何命令都可以通过</span></code>-?``选项显示其帮助，或者将命令的名称传递给``py help``。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py help
$&gt; py help install
$&gt; py install /?
</pre></div>
</div>
<p class="translated">所有命令都支持一些常用选项，这些选项将通过 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">help</span></code> 显示。 这些选项必须在任何子命令之后指定。 指定 <code class="docutils literal notranslate"><span class="pre">-v</span></code> 或 <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> 将增加显示的输出信息量，<code class="docutils literal notranslate"><span class="pre">-vv</span></code> 将进一步增加信息量用于调试目的。 传递 <code class="docutils literal notranslate"><span class="pre">-q</span></code> 或 <code class="docutils literal notranslate"><span class="pre">--quiet</span></code> 将减少输出，<code class="docutils literal notranslate"><span class="pre">-qq</span></code> 将进一步减少输出。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">--config=&lt;PATH&gt;</span></code> 选项允许指定一个配置文件一次覆盖多个设置。 有关这些文件的更多信息，请参阅下面的 <a class="reference internal" href="#pymanager-config"><span class="std std-ref">配置</span></a>。</p>
</section>
<section id="listing-runtimes">
<h3 class="translated"><span class="section-number">4.1.4. </span>列出运行时<a class="headerlink" href="#listing-runtimes" title="Link to this heading">¶</a></h3>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py list [-f=|--format=&lt;FMT&gt;] [-1|--one] [--online|-s=|--source=&lt;URL&gt;] [&lt;TAG&gt;...]
</pre></div>
</div>
<p class="translated">可以使用``py list``查看已安装的运行时列表。可以以一个或多个标签的形式添加（带或不带公司说明符）过滤器，每个标签都可以包含``&lt;<code class="docutils literal notranslate"><span class="pre">、``&lt;=</span></code>、<code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>、或``&gt;``前缀，以限制一个范围。</p>
<p class="translated">支持一系列格式，可以作为 <code class="docutils literal notranslate"><span class="pre">--format=&lt;FMT&gt;</span></code> 或 <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">&lt;FMT&gt;</span></code> 选项传递。 格式包括 <code class="docutils literal notranslate"><span class="pre">table</span></code> (用户友好的表视图)、<code class="docutils literal notranslate"><span class="pre">csv</span></code> (逗号分隔的表)、<code class="docutils literal notranslate"><span class="pre">json</span></code> (单个 JSON 块)、<code class="docutils literal notranslate"><span class="pre">jsonl</span></code> (每个结果一个 JSON 块)、<code class="docutils literal notranslate"><span class="pre">exe</span></code> (只是可执行路径)、<code class="docutils literal notranslate"><span class="pre">prefix</span></code> (只是前缀路径)。</p>
<p class="translated">选项``--one``或``-1``只显示单个结果。如果包含默认运行时，它将是这一个。否则，将显示“最佳”结果（“最佳”是故意模糊定义的，但通常是最新版本）。由``py list --one &lt;TAG&gt;``显示的结果将匹配由``py -V:&lt;TAG&gt;``启动的运行时。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">--only-managed</span></code> 选项排除未由 Python 安装管理器安装的结果。 在确定可以通过 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令更新或卸载哪些运行时时，这很有用。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">--online</span></code> 选项是使用默认源传递 <code class="docutils literal notranslate"><span class="pre">--source=&lt;URL&gt;</span></code> 的简写。 传递这两个选项中的任何一个都将在在线索引中搜索可以安装的运行时。 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">list</span> <span class="pre">--online</span> <span class="pre">--one</span> <span class="pre">&lt;TAG&gt;</span></code> 显示的结果将与 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span> <span class="pre">&lt;TAG&gt;</span></code> 安装的运行时相匹配。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py list --online 3.14
</pre></div>
</div>
<p class="translated">为了与旧的启动器的兼容性，<code class="docutils literal notranslate"><span class="pre">--list</span></code>、<code class="docutils literal notranslate"><span class="pre">--list-paths</span></code>、<code class="docutils literal notranslate"><span class="pre">-0``和</span></code>-0p``命令(例如：<code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-0p</span></code>)被保留。它们不允许附加选项，并且会产生遗留格式的输出。</p>
</section>
<section id="installing-runtimes">
<h3 class="translated"><span class="section-number">4.1.5. </span>安装运行时<a class="headerlink" href="#installing-runtimes" title="Link to this heading">¶</a></h3>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py install [-s=|--source=&lt;URL&gt;] [-f|--force] [-u|--update] [--dry-run] [&lt;TAG&gt;...]
</pre></div>
</div>
<p class="translated">可以使用``py install``添加新的运行时版本。可以指定一个或多个标签，并且可以使用特殊标签``default``来选择默认值。不支持按范围的安装。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">--source=&lt;URL&gt;</span></code> 选项允许覆盖用于获取运行时的在线索引。 这可以与离线索引一起使用，如 <a class="reference internal" href="#pymanager-offline"><span class="std std-ref">离线安装</span></a> 所示。</p>
<p class="translated">传递``--force``将忽略所有缓存的文件，并删除所有现有的安装以替换为指定的文件。</p>
<p class="translated">如果新版本较新，传递``--update``将替换现有的安装。否则，他们将离开不安装。如果``--update``没有提供运行时标签，如果有新版本可用，则Python安装管理器管理的所有安装将被更新。更新将删除对安装所做的任何修改，包括全局安装的包，但虚拟环境将继续工作。</p>
<p class="translated">传递``--dry-run``将生成输出和日志，但不会修改任何安装。</p>
<p class="translated">除了上述选项之外，<code class="docutils literal notranslate"><span class="pre">--target</span></code> 选项将把运行时解压到指定的目录，而不是进行正常的安装。 这对于将运行时嵌入到较大的应用程序中非常有用。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py install ... [-t=|--target=&lt;PATH&gt;] &lt;TAG&gt;
</pre></div>
</div>
</section>
<section id="offline-installs">
<span id="pymanager-offline"></span><h3 class="translated"><span class="section-number">4.1.6. </span>离线安装<a class="headerlink" href="#offline-installs" title="Link to this heading">¶</a></h3>
<p class="translated">要执行Python的离线安装，你需要首先在具有网络访问权限的机器上创建离线索引。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py install --download=&lt;PATH&gt; ... &lt;TAG&gt;...
</pre></div>
</div>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">--download=&lt;PATH&gt;</span></code> 选项将下载列出的标签的包，并创建一个包含它们的目录和一个适合以后安装的 <code class="docutils literal notranslate"><span class="pre">index.json</span></code> 文件。 整个目录可以移动到离线主机，并用于安装一个或多个捆绑的运行时：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py install --source=&quot;&lt;PATH&gt;\index.json&quot; &lt;TAG&gt;...
</pre></div>
</div>
<p class="translated">Python安装管理器可以通过下载其安装程序并在安装前将其移动到另一台主机来安装。</p>
<p class="translated">或者，可以简单地将离线索引目录中的ZIP文件传输到另一台主机并解压缩。这不会以任何方式注册安装，因此它必须通过直接引用解压目录中的可执行文件来启动，但有时在不可能或不方便安装Python安装管理器的情况下，这是一种更可取的方法。</p>
<p class="translated">通过这种方式，Python运行时可以在不访问internet的主机上安装和管理。</p>
</section>
<section id="uninstalling-runtimes">
<h3 class="translated"><span class="section-number">4.1.7. </span>卸载运行时<a class="headerlink" href="#uninstalling-runtimes" title="Link to this heading">¶</a></h3>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py uninstall [-y|--yes] &lt;TAG&gt;...
</pre></div>
</div>
<p class="translated">运行时可以使用``py uninstall``命令删除。必须指定一个或多个标签。这里不支持范围。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">--yes</span></code> 选项绕过卸载前的确认提示。</p>
<p class="translated">可以指定``--purge``选项，而不是一个一个地传递标签。这将删除由Python安装管理器管理的所有运行时，包括清理开始菜单、注册表和任何下载缓存。未由Python安装管理器安装的运行时不会受到影响，手动创建的配置文件也不会受到影响。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py uninstall [-y|--yes] --purge
</pre></div>
</div>
<p class="translated">Python安装管理器可以通过Windows的“安装的应用”设置页面卸载。这不会删除任何运行时，并且它们仍然可用，尽管全局的``python``和``py``命令将被删除。重新安装Python安装管理器将允许您再次管理这些运行时。要完全清理所有Python运行时，请在卸载Python安装管理器之前使用``--purge``运行。</p>
</section>
<section id="configuration">
<span id="pymanager-config"></span><h3 class="translated"><span class="section-number">4.1.8. </span>配置<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h3>
<p class="translated">Python安装管理器由配置文件、环境变量、命令行选项和注册表设置组成。通常，配置文件能够配置所有内容，包括其他配置文件的位置，而注册表设置仅由管理员设置，并且将覆盖配置文件。命令行选项覆盖所有其他设置，但不是每个选项都可用。</p>
<p class="translated">本节将描述默认设置，但请注意，修改或覆盖的安装可能以不同的方式解析设置。</p>
<p class="translated">首先读取由管理员配置的全局配置文件，随后读取保存在:file:<cite>%AppData%\Python\pymanager.json</cite> (默认情况下) 的用户配置文件，覆盖以前文件中的任何设置。额外的配置文件可以指定为``PYTHON_MANAGER_CONFIG``环境变量或``--config``命令行选项（但不能同时指定两者）。</p>
<p class="translated">以下设置是在正常使用中可能被修改的设置。后面的部分列出了用于管理定制的选项。</p>
<p class="translated rubric">标准配置选项</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p class="translated">配置键</p></th>
<th class="head"><p class="translated">环境变量</p></th>
<th class="head"><p class="translated">描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">default_tag</span></code></p></td>
<td><dl class="std envvar">
<dt class="sig sig-object std" id="envvar-PYTHON_MANAGER_DEFAULT">
<span class="sig-name descname"><span class="pre">PYTHON_MANAGER_DEFAULT</span></span><a class="headerlink" href="#envvar-PYTHON_MANAGER_DEFAULT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</td>
<td><p class="translated">首选启动或安装的默认版本。 在默认情况下，这会被解读为来自 CPython 团队的最新非预发布版本。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">default_platform</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_DEFAULT_PLATFORM</span></code></p></td>
<td><p class="translated">启动或安装的首选默认平台。这被视为指定标签的后缀，因此``py -V:3.14``如果存在（并且``default_platform``为``-64``），则更倾向于安装``3.14-64``，但如果不存在添加后的标签的安装，则将使用``3.14``。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">logs_dir</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_LOGS</span></code></p></td>
<td><p class="translated">写入日志文件的位置。默认为:file:<cite>%TEMP%</cite>。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">automatic_install</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_AUTOMATIC_INSTALL</span></code></p></td>
<td><p class="translated">真值表示当指定了要启动的运行时的时候允许自动安装。 默认为真值。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">include_unmanaged</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_INCLUDE_UNMANAGED</span></code></p></td>
<td><p class="translated">真值表示允许列出和启动不是由 Python 安装管理器安装的运行时，假值表示排除它们。 默认为真值。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">shebang_can_run_anything</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_SHEBANG_CAN_RUN_ANYTHING</span></code></p></td>
<td><p class="translated">真值表示允许 <code class="docutils literal notranslate"><span class="pre">.py</span></code> 文件中的 shebang 启动 Python 运行时之外的应用程序，假值表示阻止它们。 默认为真值。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">log_level</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYMANAGER_VERBOSE</span></code>, <code class="docutils literal notranslate"><span class="pre">PYMANAGER_DEBUG</span></code></p></td>
<td><p class="translated">设置输出的默认级别 (0-50)。 默认值为 20。 更低的值将产生更多的输出。 该环境变量为布尔值，并可能在启动期间产生输出输出随后再被其他配置所抑制。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">confirm</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_CONFIRM</span></code></p></td>
<td><p class="translated">若为 True，则在执行某些操作（如卸载）前进行确认；若为 False，则跳过确认。默认值为 true。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">install.source</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_SOURCE_URL</span></code></p></td>
<td><p class="translated">覆盖用于获取新安装包的索引源。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">list.format</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">PYTHON_MANAGER_LIST_FORMAT</span></code></p></td>
<td><p class="translated">指定 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">list</span></code> 命令使用的默认格式。默认值为 <code class="docutils literal notranslate"><span class="pre">table</span></code>。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">install_dir</span></code></p></td>
<td><p class="translated">(none)</p></td>
<td><p class="translated">指明将要安装运行时的根目录位置。 如果你更改此设置，之前安装的运行时将不可用除非你将其移至新的位置。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">global_dir</span></code></p></td>
<td><p class="translated">(none)</p></td>
<td><p class="translated">指明存放全局命令 (如 <code class="docutils literal notranslate"><span class="pre">python3.14.exe</span></code>) 的目录。 此目录应被添加到你的 <span class="target" id="index-84"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 以使这些命令在你的终端中可用。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">download_dir</span></code></p></td>
<td><p class="translated">(none)</p></td>
<td><p class="translated">指明存放已下载文件的目录。 此目录是临时缓存区，可能被随时清空。</p></td>
</tr>
</tbody>
</table>
<p class="translated">点分名称应嵌套在 JSON 对象内部，例如，<code class="docutils literal notranslate"><span class="pre">list.format</span></code> 应指定为 <code class="docutils literal notranslate"><span class="pre">{&quot;list&quot;:</span> <span class="pre">{&quot;format&quot;:</span> <span class="pre">&quot;table&quot;}}</span></code>。</p>
</section>
<section id="shebang-lines">
<span id="pymanager-shebang"></span><h3 class="translated"><span class="section-number">4.1.9. </span>Shebang 行<a class="headerlink" href="#shebang-lines" title="Link to this heading">¶</a></h3>
<p class="translated">如果脚本文件的第一行以 <code class="docutils literal notranslate"><span class="pre">#!</span></code> 开头，则称为 &quot;shebang&quot; 行。Linux 和其他类 Unix 操作系统对这类行有原生支持，通常用于指示脚本的执行方式。<code class="docutils literal notranslate"><span class="pre">python</span></code> 和 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令允许在 Windows 上的 Python 脚本中使用相同的功能。</p>
<p class="translated">为了让 Python 脚本中的 shebang 行在 Unix 和 Windows 之间保持可移植性，支持使用一些“虚拟”命令来指定要使用的解释器。支持的虚拟命令包括：</p>
<ul class="simple">
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">&lt;ALIAS&gt;</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">-S</span> <span class="pre">&lt;ALIAS&gt;</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">/usr/bin/&lt;ALIAS&gt;</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">/usr/local/bin/&lt;ALIAS&gt;</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">&lt;ALIAS&gt;</span></code></p></li>
</ul>
<p class="translated">例如，如果脚本开始的第一行为</p>
<div class="translated highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/python</span>
</pre></div>
</div>
<p class="translated">将找到并使用默认的 Python 或激活的虚拟环境。 因为在 Unix 上编写的许多 Python 脚本都已经有了这一行，你应该会发现这些脚本可以由启动器使用而无需修改。 如果你在 Windows 上编写一个新脚本并希望其在 Unix 上可用，你应当使用某个以 <code class="docutils literal notranslate"><span class="pre">/usr</span></code> 开头的 shebang 行。</p>
<p class="translated">上述任何虚拟命令中的 <code class="docutils literal notranslate"><span class="pre">&lt;ALIAS&gt;</span></code> 都可以替换为已安装运行时的别名。也就是说，在全局别名目录中生成的任何命令（你可能已将其添加到 <span class="target" id="index-85"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 环境变量中）都可以在 shebang 中使用，即使它不在你的 <span class="target" id="index-86"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 中。这允许使用类似 <code class="docutils literal notranslate"><span class="pre">/usr/bin/python3.12</span></code> 的 shebang 来选择特定的运行时。</p>
<p class="translated">如果没有安装任何运行时，或者启用了自动安装功能，则会在必要时安装所请求的运行时。有关配置设置的信息，请参阅 <a class="reference internal" href="#pymanager-config"><span class="std std-ref">配置</span></a>。</p>
<p class="translated">使用 <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span></code> 形式的 shebang 行也会在 <span class="target" id="index-87"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 环境变量中搜索未识别的命令。这与 Unix 的 <code class="docutils literal notranslate"><span class="pre">env</span></code> 程序的行为相对应，该程序执行相同的搜索，但优先启动已知的 Python 命令。在搜索任意可执行文件时可能会显示警告，并且可以通过 <code class="docutils literal notranslate"><span class="pre">shebang_can_run_anything</span></code> 配置选项禁用此搜索。</p>
<p class="translated">不符合上述任何模式的 shebang 行将被视为相对于脚本文件所在目录的 <em>Windows</em> 可执行文件路径（绝对或相对路径）。这为仅限 Windows 的脚本（如安装程序生成的脚本）提供了便利，因为这种行为与 Unix 风格的 shell 不兼容。这些路径可以加引号，并且可以包含多个参数，之后会追加脚本路径和任何额外的参数。此功能可以通过 <code class="docutils literal notranslate"><span class="pre">shebang_can_run_anything</span></code> 配置选项禁用。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p class="translated">在 Python 安装管理器中 shebang 的行为与之前的 <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> 启动器存在细微差异，并且旧的配置选项已不再适用。 如果你特别依赖旧的行为或配置，我们建议安装 <a class="reference external" href="https://www.python.org/ftp/python/3.14.0/win32/launcher.msi">legacy launcher</a>。 旧式启动器的 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令默认将覆盖 PyManager 的对应命令，你需要使用 <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> 命令来进行安装和卸载。</p>
</div>
</section>
<section id="advanced-installation">
<span id="pymanager-advancedinstall"></span><h3 class="translated"><span class="section-number">4.1.10. </span>高级安装<a class="headerlink" href="#advanced-installation" title="Link to this heading">¶</a></h3>
<p class="translated">对于无法安装 MSIX 的情况（例如某些较旧的管理分发平台），可以从 python.org 下载页面获取 MSI 安装包。此 MSI 没有用户界面，只能在 Program Files 中的默认位置执行每台机器的安装。它会尝试修改系统的 <span class="target" id="index-88"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 环境变量以包含此安装位置，但请务必在你的配置中验证这一点。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p class="translated">Windows Server 2019 是 CPython 支持的唯一不支持 MSIX 的 Windows 版本。对于 Windows Server 2019，应使用 MSI 安装包。</p>
</div>
<p class="translated">请注意，MSI 安装包不捆绑任何运行时，因此如果不创建离线安装索引，就不适合在离线环境中进行安装。有关处理这些场景的信息，请参阅 <a class="reference internal" href="#pymanager-offline"><span class="std std-ref">离线安装</span></a> 和 <a class="reference internal" href="#pymanager-admin-config"><span class="std std-ref">管理配置</span></a>。</p>
<p class="translated">MSI 安装的运行时与 MSIX 安装的运行时共享，并且均为仅针对用户的安装。Python 安装管理器不支持按机器安装运行时。若要模拟按机器安装，可以以管理员身份使用 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span> <span class="pre">--target=&lt;共享位置&gt;</span></code> 命令，并自行对 <span class="target" id="index-89"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code>、注册表或开始菜单进行全系统范围的修改。</p>
<p class="translated">当 MSIX 已安装但命令在 <span class="target" id="index-90"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 环境变量中不可用时，可在以下位置找到它们： 从 python.org 安装：<code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Microsoft\WindowsApps\PythonSoftwareFoundation.PythonManager_3847v3x7pw1km</span></code> ；从 Windows 应用商店安装：<code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Microsoft\WindowsApps\PythonSoftwareFoundation.PythonManager_qbz5n2kfra8p0</span></code> 。不建议直接从 Program Files 目录运行可执行文件。</p>
<p class="translated">若要以编程方式安装 Python 安装管理器，最简单的方法是使用 WinGet，它包含在所有受支持的 Windows 版本中：</p>
<div class="translated highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">$&gt;</span> <span class="n">winget</span> <span class="n">install</span> <span class="n">9NQ7512CXL7T</span> <span class="n">-e</span> <span class="p">-</span><span class="n">-accept-package-agreements</span> <span class="p">-</span><span class="n">-disable-interactivity</span>

<span class="c"># 可选地运行配置检查器并接受所有更改</span>
<span class="p">$&gt;</span> <span class="n">py</span> <span class="n">install</span> <span class="p">-</span><span class="n">-configure</span> <span class="n">-y</span>
</pre></div>
</div>
<p class="translated">要下载 Python 安装管理器并在另一台计算机上安装，可使用以下 WinGet 命令从应用商店下载所需文件到您的下载目录（添加 <code class="docutils literal notranslate"><span class="pre">-d</span> <span class="pre">&lt;location&gt;</span></code> 可自定义输出位置）。此命令还会生成一个看似不必要的 YAML 文件，因为下载的 MSIX 可以通过启动或使用以下命令进行安装。</p>
<div class="translated highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">$&gt;</span> <span class="n">winget</span> <span class="n">download</span> <span class="n">9NQ7512CXL7T</span> <span class="n">-e</span> <span class="p">-</span><span class="n">-skip-license</span> <span class="p">-</span><span class="n">-accept-package-agreements</span> <span class="p">-</span><span class="n">-accept-source-agreements</span>
</pre></div>
</div>
<p class="translated">若要仅使用 PowerShell 以编程方式安装或卸载 MSIX，建议使用 PowerShell cmdlet <a class="reference external" href="https://learn.microsoft.com/powershell/module/appx/add-appxpackage">Add-AppxPackage</a> 和 <a class="reference external" href="https://learn.microsoft.com/powershell/module/appx/remove-appxpackage">Remove-AppxPackage</a>：</p>
<div class="translated highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">$&gt;</span> <span class="nb">Add-AppxPackage</span> <span class="n">C</span><span class="p">:\</span><span class="n">Downloads</span><span class="p">\</span><span class="n">python-manager</span><span class="p">-</span><span class="n">25</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">msix</span>
<span class="p">...</span>
<span class="p">$&gt;</span> <span class="nb">Get-AppxPackage</span> <span class="n">PythonSoftwareFoundation</span><span class="p">.</span><span class="n">PythonManager</span> <span class="p">|</span> <span class="nb">Remove-AppxPackage</span>
</pre></div>
</div>
<p class="translated">通过将 AppInstaller 文件传递给 Add-AppxPackage 命令，Windows 可以下载并安装最新版本。这会使用 python.org 上的 MSIX 进行安装，仅建议在无法通过应用商店（交互式或使用 WinGet）安装的情况下使用。</p>
<div class="translated highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">$&gt;</span> <span class="nb">Add-AppxPackage</span> <span class="n">-AppInstallerFile</span> <span class="n">https</span><span class="p">://</span><span class="n">www</span><span class="p">.</span><span class="n">python</span><span class="p">.</span><span class="n">org</span><span class="p">/</span><span class="n">ftp</span><span class="p">/</span><span class="n">python</span><span class="p">/</span><span class="n">pymanager</span><span class="p">/</span><span class="n">pymanager</span><span class="p">.</span><span class="n">appinstaller</span>
</pre></div>
</div>
<p class="translated">也可以使用其他工具和 API 为计算机上的所有用户预配 MSIX 包，但 Python 不认为这是受支持的场景。我们建议研究 PowerShell 的 <a class="reference external" href="https://learn.microsoft.com/powershell/module/dism/add-appxprovisionedpackage">Add-AppxProvisionedPackage</a> cmdlet、原生 Windows 的 <a class="reference external" href="https://learn.microsoft.com/uwp/api/windows.management.deployment.packagemanager">PackageManager</a> 类，或查阅您的部署工具的文档和支持资源。</p>
<p class="translated">无论采用何种安装方法，用户仍需自行安装 Python 本身，因为在未登录用户的情况下无法触发这些安装。使用 MSIX 时，最新版本的 Python 将可供所有用户在无网络访问的情况下安装。</p>
<p class="translated">请注意，从应用商店和 Python 网站下载的 MSIX 存在细微差异，不能同时安装。只要有可能，我们建议使用上述 WinGet 命令从应用商店下载软件包，以降低设置冲突安装的风险。Python 安装管理器没有许可证限制，可以以这种方式使用应用商店的软件包。</p>
</section>
<section id="administrative-configuration">
<span id="pymanager-admin-config"></span><h3 class="translated"><span class="section-number">4.1.11. </span>管理配置<a class="headerlink" href="#administrative-configuration" title="Link to this heading">¶</a></h3>
<p class="translated">管理员可以使用许多选项来覆盖 Python 安装管理器的配置。这些选项可用于提供本地缓存、禁用某些快捷方式类型、覆盖捆绑内容。除了上述配置选项外，还可以设置以下选项。</p>
<p class="translated">可以通过在注册表路径 <code class="file docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE\Software\Policies\Python\PyManager</span></code> 下设置值来覆盖配置选项，其中值名称与配置键匹配，值类型为 <code class="docutils literal notranslate"><span class="pre">REG_SZ</span></code>。请注意，此键本身可以自定义，但只能通过修改 Python 安装管理器分发的核心配置文件来实现。然而，我们建议仅使用注册表值将 <code class="docutils literal notranslate"><span class="pre">base_config</span></code> 设置为包含完整覆盖集的 JSON 文件。注册表键覆盖将替换任何其他已配置的设置，而 <code class="docutils literal notranslate"><span class="pre">base_config</span></code> 允许用户进一步修改他们可能需要的设置。</p>
<p class="translated">请注意，大多数支持环境变量的设置之所以支持这些变量，是因为它们的默认设置中指定了该变量。如果您覆盖了这些设置，环境变量将不再生效，除非您用另一个环境变量覆盖它。例如，<code class="docutils literal notranslate"><span class="pre">confirm</span></code> 的默认值实际上是 <code class="docutils literal notranslate"><span class="pre">%PYTHON_MANAGER_CONFIRM%</span></code>，它会在加载时解析该变量。如果您将该值覆盖为 <code class="docutils literal notranslate"><span class="pre">yes</span></code>，则环境变量将不再被使用。如果您将该值覆盖为 <code class="docutils literal notranslate"><span class="pre">%CONFIRM%</span></code>，则会使用该环境变量。</p>
<p class="translated">配置文件中指定的路径类配置设置将被解释为相对于包含该配置文件的目录的相对路径。</p>
<p class="translated rubric">管理配置选项</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p class="translated">配置键</p></th>
<th class="head"><p class="translated">描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">base_config</span></code></p></td>
<td><p class="translated">要读取的优先级最高的配置文件。请注意，只有内置配置文件和注册表可以修改此设置。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">user_config</span></code></p></td>
<td><p class="translated">要读取的第二个配置文件。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">additional_config</span></code></p></td>
<td><p class="translated">要读取的第三个配置文件。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">registry_override_key</span></code></p></td>
<td><p class="translated">检查覆盖设置的注册表位置。请注意，只有内置配置文件可以修改此设置。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">bundled_dir</span></code></p></td>
<td><p class="translated">包含本地缓存文件的只读目录。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">install.fallback_source</span></code></p></td>
<td><p class="translated">当无法访问主索引时要查阅的索引的路径或 URL。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">install.enable_shortcut_kinds</span></code></p></td>
<td><p class="translated">允许的快捷方式类型的逗号分隔列表（例如 <code class="docutils literal notranslate"><span class="pre">&quot;pep514,start&quot;</span></code>）。已启用的快捷方式仍可能被 <code class="docutils literal notranslate"><span class="pre">disable_shortcut_kinds</span></code> 禁用。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">install.disable_shortcut_kinds</span></code></p></td>
<td><p class="translated">要排除的快捷方式类型的逗号分隔列表（例如 <code class="docutils literal notranslate"><span class="pre">&quot;pep514,start&quot;</span></code>）。已禁用的快捷方式不会被 <code class="docutils literal notranslate"><span class="pre">enable_shortcut_kinds</span></code> 重新激活。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">pep514_root</span></code></p></td>
<td><p class="translated">用于读取和写入 PEP 514 条目的注册表位置。默认路径为：<code class="file docutils literal notranslate"><span class="pre">HKEY_CURRENT_USER\Software\Python</span></code>。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">start_folder</span></code></p></td>
<td><p class="translated">用于写入快捷方式的开始菜单文件夹。默认文件夹为 <code class="docutils literal notranslate"><span class="pre">Python</span></code>。此路径是相对于用户的“程序”文件夹的相对路径。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">virtual_env</span></code></p></td>
<td><p class="translated">活动虚拟环境的路径。默认值为 <code class="docutils literal notranslate"><span class="pre">%VIRTUAL_ENV%</span></code>，但可设置为空以禁用虚拟环境检测。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">shebang_can_run_anything_silently</span></code></p></td>
<td><p class="translated">当 shebang 启动的应用程序不是 Python 运行时，若要隐藏可见警告，可将此值设为 True。</p></td>
</tr>
</tbody>
</table>
</section>
<section id="installing-free-threaded-binaries">
<span id="install-freethreaded-windows"></span><h3 class="translated"><span class="section-number">4.1.12. </span>安装自由线程二进制文件<a class="headerlink" href="#installing-free-threaded-binaries" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.13.</span></p>
</div>
<p class="translated">自由线程构建的预编译发行版可通过安装带有 <code class="docutils literal notranslate"><span class="pre">t</span></code> 后缀的标签来获取。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py install 3.14t
$&gt; py install 3.14t-arm64
$&gt; py install 3.14t-32
</pre></div>
</div>
<p class="translated">这将按常规方式进行安装和注册。如果您没有安装其他运行时，那么 <code class="docutils literal notranslate"><span class="pre">python</span></code> 命令将启动此版本。否则，您需要使用 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-V:3.14t</span> <span class="pre">...</span></code> 命令，或者如果您已将全局别名目录添加到 <span class="target" id="index-91"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 环境变量中，也可以使用 <code class="docutils literal notranslate"><span class="pre">python3.14t.exe</span></code> 命令。</p>
</section>
<section id="troubleshooting">
<span id="pymanager-troubleshoot"></span><h3 class="translated"><span class="section-number">4.1.13. </span>故障排除<a class="headerlink" href="#troubleshooting" title="Link to this heading">¶</a></h3>
<p class="translated">如果您的 Python 安装管理器运行不正常，请尝试以下测试和修复方法，看看是否能解决问题。如果问题仍未解决，请前往我们的 <a class="reference external" href="https://github.com/python/cpython/issues">错误跟踪器</a> 报告问题，并附上所有相关的日志文件（默认情况下，日志文件会写入您的 <code class="file docutils literal notranslate"><span class="pre">%TEMP%</span></code> 目录）。</p>
<p class="translated rubric">故障排除</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p class="translated">症状</p></th>
<th class="head"><p class="translated">可以尝试的事情</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated">当我在终端中输入 <code class="docutils literal notranslate"><span class="pre">python</span></code> 时，出现“命令未找到”错误，或者打开了应用商店。</p></td>
<td><p class="translated">您是否 <a class="reference internal" href="#pymanager"><span class="std std-ref">已安装 Python 安装管理器</span></a>？</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p class="translated">点击开始菜单，打开&quot;管理应用执行别名&quot;，检查&quot;Python (默认)&quot;的别名是否已启用。如果已启用，可以尝试禁用后重新启用以刷新命令。&quot;Python (默认窗口化)&quot;和&quot;Python 安装管理器&quot;命令可能也需要刷新。</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p class="translated">检查 <code class="docutils literal notranslate"><span class="pre">py</span></code> 和 <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> 命令是否能正常使用。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">当我在终端中输入 <code class="docutils literal notranslate"><span class="pre">py</span></code> 时，出现“命令未找到”错误。</p></td>
<td><p class="translated">您是否 <a class="reference internal" href="#pymanager"><span class="std std-ref">已安装 Python 安装管理器</span></a>？</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p class="translated">点击开始菜单，打开&quot;管理应用执行别名&quot;，检查&quot;Python (默认)&quot;的别名是否已启用。如果已启用，可以尝试禁用后重新启用以刷新命令。&quot;Python (默认窗口化)&quot;和&quot;Python 安装管理器&quot;命令可能也需要刷新。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">当我在终端中输入 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令时，出现“无法打开文件”错误。</p></td>
<td><p class="translated">这通常意味着您安装了旧版启动器，并且它的优先级高于 Python 安装管理器。要解决此问题，请点击开始菜单，打开&quot;已安装的应用&quot;，搜索&quot;Python 启动器&quot;并卸载它。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">python</span></code> 和 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令启动的不是同一个 Python 运行时。</p></td>
<td><p class="translated">点击开始菜单，打开&quot;已安装的应用&quot;，查找任何已存在的 Python 运行时，然后删除它们，或者选择&quot;修改&quot;并禁用 <span class="target" id="index-92"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 选项。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p class="translated">点击开始菜单，打开&quot;管理应用执行别名&quot;，并确保您的 <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> 别名设置为&quot;Python (默认)&quot;。</p></td>
</tr>
<tr class="row-even"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">python</span></code> 和 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令没有启动我期望的 Python 运行时。</p></td>
<td><p class="translated">检查你的 <span class="target" id="index-93"></span><a class="reference internal" href="#envvar-PYTHON_MANAGER_DEFAULT"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_MANAGER_DEFAULT</span></code></a> 环境变量或 <code class="docutils literal notranslate"><span class="pre">default_tag</span></code> 配置。 使用 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">list</span></code> 命令可为你显示基于这些设置的默认选项。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p class="translated">由 Python 安装管理器管理的安装会优先于未管理的安装被选择。请使用 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span></code> 命令安装您期望的运行时，或配置您的默认标签。</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p class="translated">未由 Python 安装管理器管理的预发布版和实验版安装可能会优先于稳定版本被选择。请配置您的默认标签，或卸载预发布版运行时，然后使用 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span></code> 重新安装。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><code class="docutils literal notranslate"><span class="pre">pythonw</span></code> 或 <code class="docutils literal notranslate"><span class="pre">pyw</span></code> 启动的运行时与 <code class="docutils literal notranslate"><span class="pre">python</span></code> 或 <code class="docutils literal notranslate"><span class="pre">py</span></code> 不同。</p></td>
<td><p class="translated">点击开始菜单，打开&quot;管理应用执行别名&quot;，并确保您的 <code class="docutils literal notranslate"><span class="pre">pythonw.exe</span></code> 和 <code class="docutils literal notranslate"><span class="pre">pyw.exe</span></code> 别名与其他别名保持一致。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">当我在终端中输入 <code class="docutils literal notranslate"><span class="pre">pip</span></code> 时，出现“命令未找到”错误。</p></td>
<td><p class="translated">您是否已激活虚拟环境？请在终端中运行 <code class="docutils literal notranslate"><span class="pre">.venv\Scripts\activate</span></code> 脚本以激活它。</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p class="translated">该软件包可能已安装，但缺少生成的可执行文件。我们建议改用 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span></code> 命令，或者使用 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--force</span> <span class="pre">pip</span></code> 命令重新创建可执行文件，并显示需要添加到 <span class="target" id="index-94"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 的路径。这些脚本针对每个运行时是分开的，因此您可能需要添加多个路径。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">在终端中键入 <code class="docutils literal notranslate"><span class="pre">script-name.py</span></code> 将会在新窗口中打开。</p></td>
<td><p class="translated">这是一个已知的操作系统限制。 可以在脚本名称前添加 <code class="docutils literal notranslate"><span class="pre">py</span></code>，创建与脚本同名的包含 <code class="docutils literal notranslate"><span class="pre">&#64;py</span> <span class="pre">&quot;%~dpn0.py&quot;</span> <span class="pre">%*</span></code> 的批处理文件，或者安装 <a class="reference external" href="https://www.python.org/ftp/python/3.14.0/win32/launcher.msi">legacy launcher</a> 并选择它作为脚本的关联程序。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">将文件拖放到脚本上没有效果</p></td>
<td><p class="translated">这是一个已知的操作系统限制。 它在 <a class="reference external" href="https://www.python.org/ftp/python/3.14.0/win32/launcher.msi">legacy launcher</a> 中或当使用 MSI 安装时在 Python 安装管理器中是受支持的。</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-embeddable-package">
<span id="windows-embeddable"></span><h2 class="translated"><span class="section-number">4.2. </span>可嵌入的包<a class="headerlink" href="#the-embeddable-package" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.5.</span></p>
</div>
<p class="translated">嵌入式发行版是一个包含最小 Python 环境的 ZIP 文件。 它旨在作为另一个应用程序的一部分，而不是由最终用户直接访问。</p>
<p class="translated">要安装嵌入式发行版，我们建议使用带 <code class="docutils literal notranslate"><span class="pre">--target</span></code> 选项的 <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span></code> 命令：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>$&gt; py install 3.14-embed --target=runtime
</pre></div>
</div>
<p class="translated">提取后，嵌入式发行版（几乎）与用户系统完全隔离，包括环境变量、系统注册表设置和已安装的软件包。标准库以预编译和优化的 <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> 文件形式包含在 ZIP 中，并提供了 <code class="docutils literal notranslate"><span class="pre">python3.dll</span></code>、<code class="docutils literal notranslate"><span class="pre">python313.dll</span></code>、<code class="docutils literal notranslate"><span class="pre">python.exe</span></code> 和 <code class="docutils literal notranslate"><span class="pre">pythonw.exe</span></code>。Tcl/tk（包括所有依赖项，如 Idle）、pip 和 Python 文档不包含在内。</p>
<p class="translated">嵌入式发行版中包含一个默认的 <code class="docutils literal notranslate"><span class="pre">._pth</span></code> 文件，该文件进一步限制了默认搜索路径（如下面 <a class="reference internal" href="#windows-finding-modules"><span class="std std-ref">查找模块</span></a> 中所述）。此文件供嵌入者根据需要进行修改。</p>
<p class="translated">第三方软件包应该由应用程序与嵌入式发行版一起安装。这个发行版不支持像常规 Python 安装那样使用 pip 来管理依赖关系，不过可以小心地将 pip 包含进来并使用它进行自动更新。 通常，第三方包应该作为应用程序的一部分(“打包”)处理，以便开发人员在向用户提供更新之前能够确保与新版本兼容。</p>
<p class="translated">下面描述了这个发行版的两个推荐用例。</p>
<section id="python-application">
<h3 class="translated"><span class="section-number">4.2.1. </span>Python 应用程序<a class="headerlink" href="#python-application" title="Link to this heading">¶</a></h3>
<p class="translated">用 Python 编写的应用程序并不一定要求用户了解这一事实。 在这种情况下，可以使用嵌入式发行版在安装包中包含 Python 的私有版本。 根据它应该有多透明（或者相反，它应该看起来有多专业），有两个选项。</p>
<p class="translated">使用专门的可执行文件作为启动程序需要一些编码，但为用户提供了最透明的体验。使用定制的启动器，没有明显的迹象表明程序是在 Python 上运行的：图标可以定制，公司和版本信息可以指定，文件关联可以正常运行。在大多数情况下，自定义启动程序应该只需使用硬编码的命令行就能调用 <code class="docutils literal notranslate"><span class="pre">Py_Main</span></code>。</p>
<p class="translated">更简单的方法是提供批处理文件或生成的快捷方式，使用所需的命令行参数直接调用 <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> 或 <code class="docutils literal notranslate"><span class="pre">pythonw.exe</span></code>。在这种情况下，应用程序将显示为 Python 而不是其实际名称，并且用户可能无法将其与其他正在运行的 Python 进程或文件关联区分开来。</p>
<p class="translated">对于后一种方法，包应该与 Python 可执行文件一起作为目录安装，以确保它们在路径上可用。 使用专用的启动器，包可以位于其他位置，因为在启动应用程序之前有机会指定搜索路径。</p>
</section>
<section id="embedding-python">
<h3 class="translated"><span class="section-number">4.2.2. </span>嵌入Python<a class="headerlink" href="#embedding-python" title="Link to this heading">¶</a></h3>
<p class="translated">用本地代码编写的应用程序通常需要某种形式的脚本语言，嵌入式Python发行版可以用于此目的。通常，应用程序的大部分都是本机代码，某些部分将调用 <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> 或直接使用 <code class="docutils literal notranslate"><span class="pre">python3.dll</span></code> 。无论是哪种情况，将嵌入的发行版解压缩到应用程序安装的子目录中就足以提供可加载的Python解释器。</p>
<p class="translated">与应用程序使用一样，包可以安装到任何位置，因为在初始化解释器之前有机会指定搜索路径。否则，使用嵌入式发行版和常规安装之间没有根本区别。</p>
</section>
</section>
<section id="the-nuget-org-packages">
<span id="windows-nuget"></span><h2 class="translated"><span class="section-number">4.3. </span>nuget.org 安装包<a class="headerlink" href="#the-nuget-org-packages" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.5.2.</span></p>
</div>
<p class="translated">nuget.org 是一个精简的 Python 环境，用于在没有全局安装 Python 的系统的持续集成和构建。 虽然 nuget 是“.NET的包管理器”，但是对于包含构建时工具的包来说，它也可以很好地工作。</p>
<p class="translated">访问 <a class="reference external" href="https://www.nuget.org/">nuget.org</a>  获取有关使用 nuget 的最新信息。 下面的摘要对 Python 开发人员来说已经足够了。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">nuget.exe</span></code> 命令行工具可以直接从 <code class="docutils literal notranslate"><span class="pre">https://aka.ms/nugetclidl</span></code> 下载，例如，使用 curl 或 PowerShell。 使用该工具安装 64 位或 32 位最新版本的 Python:</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>nuget.exe install python -ExcludeVersion -OutputDirectory .
nuget.exe install pythonx86 -ExcludeVersion -OutputDirectory .
</pre></div>
</div>
<p class="translated">要选择特定版本，请添加 <code class="docutils literal notranslate"><span class="pre">-Version</span> <span class="pre">3.x.y</span></code> 。 输出目录可以从 <code class="docutils literal notranslate"><span class="pre">.</span></code> 更改，包将安装到子目录中。 默认情况下，子目录的名称与包的名称相同，如果没有 <code class="docutils literal notranslate"><span class="pre">-ExcludeVersion</span></code> 选项，则此名称将包含已安装的特定版本。 子目录里面是一个包含 Python 安装的 <code class="docutils literal notranslate"><span class="pre">tools</span></code> 目录：</p>
<div class="translated highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="go"># Without -ExcludeVersion</span>
<span class="gp">&gt;</span> .\python.3.5.2\tools\python.exe -V
<span class="go">Python 3.5.2</span>

<span class="go"># With -ExcludeVersion</span>
<span class="gp">&gt;</span> .\python\tools\python.exe -V
<span class="go">Python 3.5.2</span>
</pre></div>
</div>
<p class="translated">通常，nuget 包不可升级，应该平行安装较新版本并使用完整路径引用。 或者，手动删除程序包目录并再次安装。 如果在构建之间不保留文件，许多 CI 系统将自动执行此操作。</p>
<p class="translated">除了 <code class="docutils literal notranslate"><span class="pre">tools</span></code> 目录外，还有一个 <code class="docutils literal notranslate"><span class="pre">build\native</span></code> 目录。 它包含一个 MSBuild 属性文件 <code class="docutils literal notranslate"><span class="pre">python.props</span></code>，可以在 C++ 项目中使用该文件来引用 Python 安装。 包含这些设置将自动在生成中使用标头和导入库。</p>
<p class="translated">在 nuget.org 上的软件包信息页 <a class="reference external" href="https://www.nuget.org/packages/python">www.nuget.org/packages/python</a> 对应 64 位版本，<a class="reference external" href="https://www.nuget.org/packages/pythonx86">www.nuget.org/packages/pythonx86</a> 对应 32 位版本，<a class="reference external" href="https://www.nuget.org/packages/pythonarm64">www.nuget.org/packages/pythonarm64</a> 对应 ARM64 版本</p>
<section id="free-threaded-packages">
<h3 class="translated"><span class="section-number">4.3.1. </span>自由线程版软件包<a class="headerlink" href="#free-threaded-packages" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.13.</span></p>
</div>
<p class="translated">包含自由线程版二进制文件的包名称 <a class="reference external" href="https://www.nuget.org/packages/python-freethreaded">python-freethreaded</a> 对应 64 位版本，<a class="reference external" href="https://www.nuget.org/packages/pythonx86-freethreaded">pythonx86-freethreaded</a> 对应 32 位版本，<a class="reference external" href="https://www.nuget.org/packages/pythonarm64-freethreaded">pythonarm64-freethreaded</a> 对应 ARM64 版本。 这些包同时包含 <code class="docutils literal notranslate"><span class="pre">python3.13t.exe</span></code> 和 <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> 入口点，两者均在自由线程模式下运行。</p>
</section>
</section>
<section id="alternative-bundles">
<h2 class="translated"><span class="section-number">4.4. </span>替代捆绑包<a class="headerlink" href="#alternative-bundles" title="Link to this heading">¶</a></h2>
<p class="translated">除了标准的CPython发行版之外，还有一些包含附加功能的修改包。以下是热门版本及其主要功能的列表：</p>
<dl>
<dt class="translated"><a class="reference external" href="https://www.activestate.com/products/python/">ActivePython</a></dt><dd><p class="translated">具有多平台兼容性的安装程序，文档，PyWin32</p>
</dd>
<dt class="translated"><a class="reference external" href="https://www.anaconda.com/download/">Anaconda</a></dt><dd><p class="translated">流行的科学模块（如numpy，scipy和pandas）和 <code class="docutils literal notranslate"><span class="pre">conda</span></code> 包管理器。</p>
</dd>
<dt class="translated"><a class="reference external" href="https://assets.enthought.com/downloads/edm/">Enthought 部署管理器</a></dt><dd><p class="translated">“下一代的 Python 环境和包管理器”</p>
<p class="translated">之前 Enthought 提供了 Canopy，但已经 <a class="reference external" href="https://support.enthought.com/hc/en-us/articles/360038600051-Canopy-GUI-end-of-life-transition-to-the-Enthought-Deployment-Manager-EDM-and-Visual-Studio-Code">于 2016 年结束生命期</a>。</p>
</dd>
<dt class="translated"><a class="reference external" href="https://winpython.github.io/">WinPython</a></dt><dd><p class="translated">特定于Windows的发行版，包含用于构建包的预构建科学包和工具。</p>
</dd>
</dl>
<p class="translated">请注意，这些软件包可能不包含最新版本的Python或其他库，并且不由核心Python团队维护或支持。</p>
</section>
<section id="supported-windows-versions">
<h2 class="translated"><span class="section-number">4.5. </span>支持的 Windows 版本<a class="headerlink" href="#supported-windows-versions" title="Link to this heading">¶</a></h2>
<p class="translated">根据 <span class="target" id="index-95"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> 的规定，Python 发行版仅在 Microsoft 提供扩展支持的 Windows 平台上受支持。这意味着 Python 3.14 支持 Windows 10 及更高版本。如果您需要 Windows 7 支持，请安装 Python 3.8。如果您需要 Windows 8.1 支持，请安装 Python 3.12。</p>
</section>
<section id="removing-the-max-path-limitation">
<span id="max-path"></span><h2 class="translated"><span class="section-number">4.6. </span>移除 MAX_PATH 限制<a class="headerlink" href="#removing-the-max-path-limitation" title="Link to this heading">¶</a></h2>
<p class="translated">历史上Windows的路径长度限制为260个字符。这意味着长于此的路径将无法解决并导致错误。</p>
<p class="translated">在最新版本的 Windows 中，此限制可以扩展到超过 32,000 个字符。您的管理员需要启用“启用 Win32 长路径”组策略，或将注册表项 <code class="docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem</span></code> 中的 <code class="docutils literal notranslate"><span class="pre">LongPathsEnabled</span></code> 设置为 <code class="docutils literal notranslate"><span class="pre">1</span></code>。</p>
<p class="translated">这允许 <a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> 函数，<a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块和大多数其他路径功能接受并返回长度超过 260 个字符的路径。</p>
<p class="translated">更改上述选项并重启后，无需进一步配置。</p>
</section>
<section id="utf-8-mode">
<span id="win-utf8-mode"></span><h2 class="translated"><span class="section-number">4.7. </span>UTF-8 模式<a class="headerlink" href="#utf-8-mode" title="Link to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7.</span></p>
</div>
<p class="translated">Windows 仍然使用传统编码格式作为系统的编码格式 (ANSI 代码页)。 Python 使用它作为文本文件默认的编码格式 (即 <a class="reference internal" href="../library/locale.html#locale.getencoding" title="locale.getencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getencoding()</span></code></a>)。</p>
<p class="translated">这可能会造成问题，因为因特网和大多数 Unix 系统包括 WSL (Windows Subsystem for Linux) 广泛使用 UTF-8。</p>
<p class="translated">你可以使用 <a class="reference internal" href="../library/os.html#utf8-mode"><span class="std std-ref">Python UTF-8 模式</span></a> 将默认的文本编码格式改为 UTF-8。 要启用 <a class="reference internal" href="../library/os.html#utf8-mode"><span class="std std-ref">Python UTF-8 模式</span></a> 可以通过 <code class="docutils literal notranslate"><span class="pre">-X</span> <span class="pre">utf8</span></code> 命令行选项，或者 <code class="docutils literal notranslate"><span class="pre">PYTHONUTF8=1</span></code> 环境变量。 请参阅 <span class="target" id="index-96"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONUTF8"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONUTF8</span></code></a> 了解如何启用 UTF-8 模式，并参阅 <a class="reference internal" href="#setting-envvars"><span class="std std-ref">Python 安装管理器</span></a> 了解如何修改环境变量。</p>
<p class="translated">当 <a class="reference internal" href="../library/os.html#utf8-mode"><span class="std std-ref">Python UTF-8 模式</span></a> 启用时，你仍然可以通过 &quot;mbcs&quot; 编解码器使用系统编码格式（ANSI 代码页）。</p>
<p class="translated">请注意添加 <code class="docutils literal notranslate"><span class="pre">PYTHONUTF8=1</span></code> 到默认环境变量将会影响你的系统中的所有 Python 3.7+ 应用。 如果你有任何 Python 3.7+ 应用仍然依赖于传统的系统编码格式，则推荐设置临时环境变量或使用 <code class="docutils literal notranslate"><span class="pre">-X</span> <span class="pre">utf8</span></code> 命令行选项。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p class="translated">即使在不启用 UTF-8 模式时，Windows 版的 Python 也会在以下情况中默认使用 UTF-8：</p>
<ul class="simple">
<li><p class="translated">控制台 I/O 包括标准 I/O (详情见 <span class="target" id="index-97"></span><a class="pep reference external" href="https://peps.python.org/pep-0528/"><strong>PEP 528</strong></a>)。</p></li>
<li><p class="translated"><a class="reference internal" href="../glossary.html#term-filesystem-encoding-and-error-handler"><span class="xref std std-term">文件系统编码格式</span></a> (参见 <span class="target" id="index-98"></span><a class="pep reference external" href="https://peps.python.org/pep-0529/"><strong>PEP 529</strong></a> 了解详情)。</p></li>
</ul>
</div>
</section>
<section id="finding-modules">
<span id="windows-finding-modules"></span><h2 class="translated"><span class="section-number">4.8. </span>查找模块<a class="headerlink" href="#finding-modules" title="Link to this heading">¶</a></h2>
<p class="translated">这些注释以详细的 Windows 注释对 <a class="reference internal" href="../library/sys_path_init.html#sys-path-init"><span class="std std-ref">sys.path 模块搜索路径的初始化</span></a> 中的描述进行了补充。</p>
<p class="translated">当找不到 <code class="docutils literal notranslate"><span class="pre">._pth</span></code> 文件时， <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> 是如何在Windows上填充的：</p>
<ul class="simple">
<li><p class="translated">在开始时，添加一个空条目，该条目对应于当前目录。</p></li>
<li><p class="translated">如果环境变量 <span class="target" id="index-99"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> 存在，如 <a class="reference internal" href="cmdline.html#using-on-envvars"><span class="std std-ref">环境变量</span></a> 中所述，则接下来添加其条目。请注意，在Windows上，此变量中的路径必须用分号分隔，以区别于驱动器标识符中使用的冒号（ <code class="docutils literal notranslate"><span class="pre">C:\</span></code>  等）。</p></li>
<li><p class="translated">额外的 &quot;应用程序路径&quot; 可以作为子键被同时添加到注册表 <code class="docutils literal notranslate"><span class="pre">HKEY_CURRENT_USER</span></code> 和 <code class="docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE</span></code> 分支下的 <code class="samp docutils literal notranslate"><span class="pre">\SOFTWARE\Python\PythonCore{version}\PythonPath</span></code> 中。 以分号分隔的路径字符串作为默认值的子键将导致每个路径都被添加到 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> 中。 （请注意所有已知的安装程序都只使用 HKLM，因此 HKCU 通常为空。）</p></li>
<li><p class="translated">如果设置了环境变量 <span class="target" id="index-100"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a>  ，则将其假定为 “Python 主目录” 。否则，主Python可执行文件的路径用于定位 “landmark 文件” （ <code class="docutils literal notranslate"><span class="pre">Lib\os.py</span></code> 或 <code class="docutils literal notranslate"><span class="pre">pythonXY.zip</span></code> ）以推断 ”Python 主目录“ 。如果找到了Python主目录，则基于该文件夹将相关的子目录添加到 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> （<code class="docutils literal notranslate"><span class="pre">Lib</span></code> , <code class="docutils literal notranslate"><span class="pre">plat-win</span></code> 等）。否则，核心Python路径是从存储在注册表中的PythonPath构造的。</p></li>
<li><p class="translated">如果找不到Python Home，也没有指定 <span class="target" id="index-101"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> 环境变量，并且找不到注册表项，则使用具有相对条目的默认路径（例如 <code class="docutils literal notranslate"><span class="pre">.\Lib;</span> <span class="pre">.\plat-win</span></code> 等等）。</p></li>
</ul>
<p class="translated">如果在主可执行文件旁边或在可执行文件上一级的目录中找到 <code class="docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> 文件，则以下变体适用：</p>
<ul class="simple">
<li><p class="translated">如果 <code class="docutils literal notranslate"><span class="pre">home</span></code> 是一个绝对路径，并且 <span class="target" id="index-102"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> 未设置，则在推断起始位置时使用此路径而不是主可执行文件的路径。</p></li>
</ul>
<p class="translated">这一切的最终结果是：</p>
<ul class="simple">
<li><p class="translated">运行 <code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> ，或主Python目录中的任何其他.exe（安装版本，或直接来自PCbuild目录）时，推导出核心路径，并忽略注册表中的核心路径。始终读取注册表中的其他“应用程序路径”。</p></li>
<li><p class="translated">当Python托管在另一个.exe（不同的目录，通过COM嵌入等）时，将不会推断出“Python Home”，因此使用了来自注册表的核心路径。始终读取注册表中的其他“应用程序路径”。</p></li>
<li><p class="translated">如果Python找不到它的主目录并且没有注册表值（冻结的.exe，一些非常奇怪的安装设置），那么你会得到一条带有一些默认但相对的路径的路径。</p></li>
</ul>
<p class="translated">对于那些想要将Python捆绑到其应用程序或发行版中的人，以下建议将防止与其他安装冲突：</p>
<ul class="simple">
<li><p class="translated">在您的可执行文件中包含一个 <code class="docutils literal notranslate"><span class="pre">._pth</span></code> 文件，其中包含目录。这将忽略注册表和环境变量中列出的路径，并忽略 <a class="reference internal" href="../library/site.html#module-site" title="site: Module responsible for site-specific configuration."><code class="xref py py-mod docutils literal notranslate"><span class="pre">site</span></code></a> ，除非列出 <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">site</span></code> 。</p></li>
<li><p class="translated">如果你在自己的可执行文件中加载 <code class="file docutils literal notranslate"><span class="pre">python3.dll</span></code> 或 <code class="file docutils literal notranslate"><span class="pre">python37.dll</span></code>，请在 <a class="reference internal" href="../c-api/init.html#c.Py_InitializeFromConfig" title="Py_InitializeFromConfig"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_InitializeFromConfig()</span></code></a> 之前显式地设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths" title="PyConfig.module_search_paths"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths</span></code></a>。</p></li>
<li><p class="translated">清除 和/或 覆盖 <span class="target" id="index-103"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a> 并在启动来自应用程序的 <code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> 之前设置 <span class="target" id="index-104"></span><a class="reference internal" href="cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> 。</p></li>
<li><p class="translated">如果您不能使用前面的建议（例如，您是一个允许人们直接运行 <code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> 的分发版），请确保安装目录中存在 landmark 文件 (<code class="file docutils literal notranslate"><span class="pre">Lib\os.py</span></code>)。 （请注意，在 ZIP 文件中不会检测到该文件，但会检测到正确命名的 ZIP 文件。）</p></li>
</ul>
<p class="translated">这些将确保系统范围安装中的文件不会优先于与应用程序捆绑在一起的标准库的副本。否则，用户可能会在使用您的应用程序时遇到问题请注意，第一个建议是最好的，因为其他建议可能仍然容易受到注册表和用户站点包中的非标准路径的影响。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.6 版本发生变更: </span>添加 <code class="docutils literal notranslate"><span class="pre">._pth</span></code> 文件支持并从 <code class="docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> 中移除了 <code class="docutils literal notranslate"><span class="pre">applocal</span></code> 选项。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.6 版本发生变更: </span>当与可执行文件直接相邻时将添加 <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">XX</span></em><span class="pre">.zip</span></code> 作为潜在的标志物。</p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 3.6 版本弃用: </span>在 <code class="docutils literal notranslate"><span class="pre">Modules</span></code> (不是 <code class="docutils literal notranslate"><span class="pre">PythonPath</span></code>) 下的注册表中指定的模块可以通过 <a class="reference internal" href="../library/importlib.html#importlib.machinery.WindowsRegistryFinder" title="importlib.machinery.WindowsRegistryFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.machinery.WindowsRegistryFinder</span></code></a> 导入。 在 Windows 上此查找器在 3.6.0 及更早版本中被启用，但在将来可能需要显式地添加到 <a class="reference internal" href="../library/sys.html#sys.meta_path" title="sys.meta_path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.meta_path</span></code></a>。</p>
</div>
</section>
<section id="additional-modules">
<h2 class="translated"><span class="section-number">4.9. </span>附加模块<a class="headerlink" href="#additional-modules" title="Link to this heading">¶</a></h2>
<p class="translated">尽管Python的目标是在所有平台中都可移植，但是Windows有一些独特的特性。在标准库和外部都有一些模块和代码片段在使用这些特性。</p>
<p class="translated">特定于Windows的标准模块记录在 <a class="reference internal" href="../library/windows.html#mswin-specific-services"><span class="std std-ref">Windows系统相关模块</span></a> 中。</p>
<section id="pywin32">
<h3 class="translated"><span class="section-number">4.9.1. </span>PyWin32<a class="headerlink" href="#pywin32" title="Link to this heading">¶</a></h3>
<p class="translated">Mark Hammond 编写的 <a class="extlink-pypi reference external" href="https://pypi.org/project/PyWin32/">PyWin32</a> 模块是一组用于高级 Windows 专属支持的模块。 这包括以下实用工具：</p>
<ul class="simple">
<li><p class="translated"><a class="reference external" href="https://learn.microsoft.com/windows/win32/com/component-object-model--com--portal">Component Object Model</a>
(COM)</p></li>
<li><p class="translated">Win32 API 调用</p></li>
<li><p class="translated">注册</p></li>
<li><p class="translated">事件日志</p></li>
<li><p class="translated"><a class="reference external" href="https://learn.microsoft.com/cpp/mfc/mfc-desktop-applications">Microsoft Foundation Classes</a> (MFC) 用户接口</p></li>
</ul>
<p class="translated"><a class="reference external" href="https://web.archive.org/web/20060524042422/https://www.python.org/windows/pythonwin/">PythonWin</a> 是PyWin32附带的一个示例MFC应用程序。它是一个内置调试器的可嵌入IDE。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><a class="reference external" href="https://timgolden.me.uk/python/win32_how_do_i.html">Win32 How Do I...?</a></dt><dd><p class="translated">Tim Golden 著</p>
</dd>
<dt class="translated"><a class="reference external" href="https://www.boddie.org.uk/python/COM.html">Python and COM</a></dt><dd><p class="translated">David 和 Paul Boddie 著</p>
</dd>
</dl>
</div>
</section>
<section id="cx-freeze">
<h3 class="translated"><span class="section-number">4.9.2. </span>cx_Freeze<a class="headerlink" href="#cx-freeze" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference external" href="https://cx-freeze.readthedocs.io/en/latest/">cx_Freeze</a> 将 Python 脚本包装成可执行的 Windows 程序 (<code class="file docutils literal notranslate"><em><span class="pre">*</span></em><span class="pre">.exe</span></code> 文件)。 当你完成此操作后，你就可以分发你的应用程序而无需用户安装 Python。</p>
</section>
</section>
<section id="compiling-python-on-windows">
<h2 class="translated"><span class="section-number">4.10. </span>在Windows上编译Python<a class="headerlink" href="#compiling-python-on-windows" title="Link to this heading">¶</a></h2>
<p class="translated">如果你想要自己编译 CPython，首先要做的是获取 <a class="reference external" href="https://www.python.org/downloads/source/">源代码</a>。 你可以下载最新发行版的源代码或是执行最新的 <a class="reference external" href="https://devguide.python.org/setup/#get-the-source-code">签出</a>。</p>
<p class="translated">源代码树包含Microsoft Visual Studio的构建解决方案和项目文件，它是用于构建官方Python版本的编译器。这些文件位于 <code class="file docutils literal notranslate"><span class="pre">PCbuild</span></code> 目录中。</p>
<p class="translated">检查 <code class="file docutils literal notranslate"><span class="pre">PCbuild/readme.txt</span></code> 以获取有关构建过程的一般信息。</p>
<p class="translated">有关扩展模块，请参阅 <a class="reference internal" href="../extending/windows.html#building-on-windows"><span class="std std-ref">在 Windows 上构建 C 和 C++ 扩展</span></a> 。</p>
</section>
<section id="the-full-installer-deprecated">
<span id="windows-full"></span><h2 class="translated"><span class="section-number">4.11. </span>完整安装程序（已弃用）<a class="headerlink" href="#the-full-installer-deprecated" title="Link to this heading">¶</a></h2>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 3.14 版本弃用: </span>此安装程序自 3.14 版本起已弃用，Python 3.16 及更高版本将不再提供。现代安装程序请参阅 <a class="reference internal" href="#pymanager"><span class="std std-ref">Python 安装管理器</span></a>。</p>
</div>
<section id="installation-steps">
<h3 class="translated"><span class="section-number">4.11.1. </span>安装步骤<a class="headerlink" href="#installation-steps" title="Link to this heading">¶</a></h3>
<p class="translated">四个 Python 3.14 安装程序可供下载 - 32位和64位版本的各有两个。 <em>web installer</em> （网络安装包）是一个小的初始化工具，它将在安装过程中，根据需要自动下载所需的组件。 <em>offline installer</em> （离线安装包）内含默认安装所需的组件，可选择功能仍需要Internet连接下载。请参阅 <a class="reference internal" href="#install-layout-option"><span class="std std-ref">免下载安装</span></a> 以了解在安装过程中避免下载的其他方法。</p>
<p class="translated">启动安装程序后，可以选择以下两个选项之一：</p>
<img alt="../_images/win_installer.png" src="../_images/win_installer.png" />
<p class="translated">如果选择“Install Now（立即安装）”：</p>
<ul class="simple">
<li><p class="translated">您 <em>不</em> 需要成为管理员（除非需要对C运行库进行系统更新，或者为所有用户安装 <a class="reference internal" href="#launcher"><span class="std std-ref">Python 安装管理器</span></a> ）</p></li>
<li><p class="translated">Python将安装到您的用户目录中</p></li>
<li><p class="translated"><a class="reference internal" href="#launcher"><span class="std std-ref">Python 安装管理器</span></a> 将根据第一页底部的选项安装</p></li>
<li><p class="translated">将安装标准库，测试套件，启动器和pip</p></li>
<li><p class="translated">如果选择将安装目录将添加到 <span class="target" id="index-105"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></p></li>
<li><p class="translated">快捷方式仅对当前用户可见</p></li>
</ul>
<p class="translated">选择“自定义安装”将允许您选择：要安装的功能、安装位置、其他选项或安装后的操作。如果要安装调试符号或二进制文件，您需要使用此选项。</p>
<p class="translated">如要为全部用户安装，应选择“自定义安装”。在这种情况下:</p>
<ul class="simple">
<li><p class="translated">您可能需要提供管理凭据或批准</p></li>
<li><p class="translated">Python 将安装到Program Files目录中</p></li>
<li><p class="translated"><a class="reference internal" href="#launcher"><span class="std std-ref">Python 安装管理器</span></a> 将安装到Windows目录中</p></li>
<li><p class="translated">安装期间可以选择可选功能</p></li>
<li><p class="translated">标准库可以预编译为字节码</p></li>
<li><p class="translated">如果选中，安装目录将添加到系统 <span class="target" id="index-106"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></p></li>
<li><p class="translated">快捷方式所有用户可用</p></li>
</ul>
</section>
<section id="id2">
<h3 class="translated"><span class="section-number">4.11.2. </span>移除 MAX_PATH 限制<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p class="translated">历史上Windows的路径长度限制为260个字符。这意味着长于此的路径将无法解决并导致错误。</p>
<p class="translated">在最新版本的 Windows 中，此限制可被扩展到大约 32,000 个字符。 但需要让管理员激活“启用 Win32 长路径”组策略，或在注册表键 <code class="docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem</span></code> 中设置 <code class="docutils literal notranslate"><span class="pre">LongPathsEnabled</span></code> 为 <code class="docutils literal notranslate"><span class="pre">1</span></code>。</p>
<p class="translated">这允许 <a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> 函数，<a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块和大多数其他路径功能接受并返回长度超过 260 个字符的路径。</p>
<p class="translated">更改上述选项后，无需进一步配置。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.6 版本发生变更: </span>Python中启用了对长路径的支持。</p>
</div>
</section>
<section id="installing-without-ui">
<span id="install-quiet-option"></span><h3 class="translated"><span class="section-number">4.11.3. </span>无 UI 安装<a class="headerlink" href="#installing-without-ui" title="Link to this heading">¶</a></h3>
<p class="translated">安装程序UI中的所有选项也可以从命令行指定，允许脚本安装程序在许多机器上复制安装，而无需用户交互。还可以在不禁用UI的情况下设置这些选项，以更改一些默认值。</p>
<p class="translated">下列选项（通过附带 <code class="docutils literal notranslate"><span class="pre">/?</span></code> 执行安装器来查看）可被传给安装器:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p class="translated">名称</p></th>
<th class="head"><p class="translated">描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated">/passive</p></td>
<td><p class="translated">显示进度而无需用户交互</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">/quiet</p></td>
<td><p class="translated">安装/卸载时不显示任何 UI</p></td>
</tr>
<tr class="row-even"><td><p class="translated">/simple</p></td>
<td><p class="translated">防止用户定制</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">/uninstall</p></td>
<td><p class="translated">移除 Python（无需确认）</p></td>
</tr>
<tr class="row-even"><td><p class="translated">/layout [directory]</p></td>
<td><p class="translated">预下载所有组件</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">/log [filename]</p></td>
<td><p class="translated">指定日志记录文件位置</p></td>
</tr>
</tbody>
</table>
<p class="translated">所有其他选项都传递为 <code class="docutils literal notranslate"><span class="pre">name=value</span></code> ，其中值通常是 <code class="docutils literal notranslate"><span class="pre">0</span></code> 来禁用某个特性， <code class="docutils literal notranslate"><span class="pre">1</span></code> 来启用某个特性或路径。可用选项的完整列表如下所示。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p class="translated">名称</p></th>
<th class="head"><p class="translated">描述</p></th>
<th class="head"><p class="translated">默认值</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated">InstallAllUsers</p></td>
<td><p class="translated">为所有用户安装。</p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">TargetDir</p></td>
<td><p class="translated">安装目录</p></td>
<td><p class="translated">基于InstallAllUsers选择</p></td>
</tr>
<tr class="row-even"><td><p class="translated">DefaultAllUsersTargetDir</p></td>
<td><p class="translated">为所有用户安装时的默认安装路径</p></td>
<td><p class="translated"><code class="file docutils literal notranslate"><span class="pre">%ProgramFiles%\Python</span> <span class="pre">X.Y</span></code> 或 <code class="file docutils literal notranslate"><span class="pre">%ProgramFiles(x86)%\Python</span> <span class="pre">X.Y</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="translated">DefaultJustForMeTargetDir</p></td>
<td><p class="translated">仅为当前用户安装时的默认安装路径</p></td>
<td><p class="translated"><code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Programs\Python\PythonXY</span></code> 或 <code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Programs\Python\PythonXY-32</span></code> 或 <code class="file docutils literal notranslate"><span class="pre">%LocalAppData%\Programs\Python\PythonXY-64</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="translated">DefaultCustomTargetDir</p></td>
<td><p class="translated">UI中显示的默认自定义安装目录</p></td>
<td><p class="translated">（空）</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">AssociateFiles</p></td>
<td><p class="translated">如果还安装了启动器，则创建文件关联。</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-even"><td><p class="translated">CompileAll</p></td>
<td><p class="translated">将所有 <code class="docutils literal notranslate"><span class="pre">.py</span></code> 文件编译为 <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> 。</p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">PrependPath</p></td>
<td><p class="translated">将安装和脚本目录添加到 <span class="target" id="index-107"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 并将 <code class="docutils literal notranslate"><span class="pre">.PY</span></code> 添加到 <span class="target" id="index-108"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATHEXT</span></code></p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-even"><td><p class="translated">AppendPath</p></td>
<td><p class="translated">将安装和脚本目录添加到 <span class="target" id="index-109"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 并将 <code class="docutils literal notranslate"><span class="pre">.PY</span></code> 添加到 <span class="target" id="index-110"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATHEXT</span></code></p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">Shortcuts</p></td>
<td><p class="translated">如果已安装，为解释器，文档和IDLE创建快捷方式</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-even"><td><p class="translated">Include_doc</p></td>
<td><p class="translated">安装Python手册</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">Include_debug</p></td>
<td><p class="translated">安装调试二进制文件</p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-even"><td><p class="translated">Include_dev</p></td>
<td><p class="translated">安装开发者头文件和库文件。 省略这一步可能导致安装不可用。</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">Include_exe</p></td>
<td><p class="translated">安装 <code class="file docutils literal notranslate"><span class="pre">python.exe</span></code> 以及相关文件。忽略此项可能会导致安装不可用。</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-even"><td><p class="translated">Include_launcher</p></td>
<td><p class="translated">安装 <a class="reference internal" href="#launcher"><span class="std std-ref">Python 安装管理器</span></a> .</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">InstallLauncherAllUsers</p></td>
<td><p class="translated">为所有用户安装启动器。还需要 <code class="docutils literal notranslate"><span class="pre">Include_launcher</span></code> 被设定为1</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-even"><td><p class="translated">Include_lib</p></td>
<td><p class="translated">安装标准库和扩展模块。 省略这一步可能导致安装不可用。</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">Include_pip</p></td>
<td><p class="translated">安装捆绑的pip和setuptools</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-even"><td><p class="translated">Include_symbols</p></td>
<td><p class="translated">安装调试符号集 (<code class="docutils literal notranslate"><span class="pre">*.pdb</span></code>)</p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">Include_tcltk</p></td>
<td><p class="translated">安装Tcl/Tk 支持和IDLE</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-even"><td><p class="translated">Include_test</p></td>
<td><p class="translated">安装标准库测试套件</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">Include_tools</p></td>
<td><p class="translated">安装实用程序脚本</p></td>
<td><p class="translated">1</p></td>
</tr>
<tr class="row-even"><td><p class="translated">LauncherOnly</p></td>
<td><p class="translated">仅安装启动器。这将覆盖大多数其他选项。</p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">SimpleInstall</p></td>
<td><p class="translated">禁用大多数安装UI</p></td>
<td><p class="translated">0</p></td>
</tr>
<tr class="row-even"><td><p class="translated">SimpleInstallDescription</p></td>
<td><p class="translated">使用简化安装UI时显示的自定义消息。</p></td>
<td><p class="translated">（空）</p></td>
</tr>
</tbody>
</table>
<p class="translated">例如，要以静默方式全局安装默认的Python，您可以（在命令提示符&gt;）使用以下命令:</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>python-3.9.0.exe /quiet InstallAllUsers=1 PrependPath=1 Include_test=0
</pre></div>
</div>
<p class="translated">要允许用户在没有测试套件的情况下轻松安装Python的个人副本，可以使用以下命令提供快捷方式。这将显示一个简化的初始页面，不允许自定义:</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>python-3.9.0.exe InstallAllUsers=0 Include_launcher=0 Include_test=0
    SimpleInstall=1 SimpleInstallDescription=&quot;Just for me, no test suite.&quot;
</pre></div>
</div>
<p class="translated">（请注意，省略启动器也会省略文件关联，并且仅在全局安装包含启动器时才建议用于每用户安装。）</p>
<p class="translated">上面列出的选项也可以在一个名为 <code class="docutils literal notranslate"><span class="pre">unattend.xml</span></code> 的文件中与可执行文件一起提供。此文件指定选项和值的列表。作为属性提供的值，（如果可能）它将转换为数字。作为文本提供的值，始终保留为字符串。此示例文件设置与上一示例采用相同的选项：</p>
<div class="translated highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Options&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;InstallAllUsers&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;Include_launcher&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;Include_test&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;SimpleInstall&quot;</span><span class="w"> </span><span class="na">Value=</span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">Name=</span><span class="s">&quot;SimpleInstallDescription&quot;</span><span class="nt">&gt;</span>Just<span class="w"> </span>for<span class="w"> </span>me,<span class="w"> </span>no<span class="w"> </span>test<span class="w"> </span>suite<span class="nt">&lt;/Option&gt;</span>
<span class="nt">&lt;/Options&gt;</span>
</pre></div>
</div>
</section>
<section id="installing-without-downloading">
<span id="install-layout-option"></span><h3 class="translated"><span class="section-number">4.11.4. </span>免下载安装<a class="headerlink" href="#installing-without-downloading" title="Link to this heading">¶</a></h3>
<p class="translated">由于下载的初始安装包中未包含Python的某些可选功能，如果选择安装这些功能可能需要Internet连接。为了避免这种需要，可以按需下载所有可能的组件，以创建一个完整的布局，该布局将不再需要internet连接，而不管所选择的特性是什么。请注意，此下载可能比要求的要大，但是如果要执行大量安装，则拥有本地缓存​​的副本非常有用。</p>
<p class="translated">从命令提示符执行以下命令以下载所有可能的必需文件。 请记得要将 <code class="docutils literal notranslate"><span class="pre">python-3.9.0.exe</span></code> 替换为安装程序的实际名称，并在单独的目录中创建子目录以避免同名文件间的冲突。</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>python-3.9.0.exe /layout [可选的目标目录]
</pre></div>
</div>
<p class="translated">您也可以指定 <code class="docutils literal notranslate"><span class="pre">/quiet</span></code> 选项来隐藏进度显示。</p>
</section>
<section id="modifying-an-install">
<h3 class="translated"><span class="section-number">4.11.5. </span>修改安装<a class="headerlink" href="#modifying-an-install" title="Link to this heading">¶</a></h3>
<p class="translated">安装Python后，您可以通过Windows中的“程序和功能”工具添加或删除功能。选择Python条目并选择“卸载/更改”以在维护模式下打开安装程序。</p>
<p class="translated">“修改” 允许您通过修改复选框来添加或删除功能 - 未更改的复选框将不会安装或删除任何内容。在此模式下无法更改某些选项，例如安装目录；要修改这些，您需要完全删除然后重新安装Python。</p>
<p class="translated">“修复” 将使用当前设置验证应安装的所有文件，并替换已删除或修改的任何文件</p>
<p class="translated">“卸载” 将完全删除Python，但 <a class="reference internal" href="#launcher"><span class="std std-ref">Python 安装管理器</span></a> 除外，它在“程序和功能”中有自己的条目。</p>
</section>
<section id="id3">
<h3 class="translated"><span class="section-number">4.11.6. </span>安装自由线程二进制文件<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.13.</span></p>
</div>
<p class="translated">要安装启用了自由线程的预编译版二进制文件 (参见 <span class="target" id="index-111"></span><a class="pep reference external" href="https://peps.python.org/pep-0703/"><strong>PEP 703</strong></a>)，你应当选择 &quot;Customize installation&quot;。 在第二个选项页中包括了 &quot;Download free-threaded binaries&quot; 复选框。</p>
<img alt="../_images/win_install_freethreaded.png" src="../_images/win_install_freethreaded.png" />
<p class="translated">选择此选项将下载并将额外的二进制文件安装到与 Python 主安装版本相同的目录下。 主可执行文件的名称为 <code class="docutils literal notranslate"><span class="pre">python3.13t.exe</span></code>，而其他二进制文件将带有 <code class="docutils literal notranslate"><span class="pre">t</span></code> 前缀或完整的 ABI 前缀。 Python 源文件和捆绑的第三方依赖将与主安装版本共享。</p>
<p class="translated">自由线程版将被注册为具有 <code class="docutils literal notranslate"><span class="pre">3.13t</span></code> 标签的常规 Python 安装版（并会按相应系统平台的惯例附带 <code class="docutils literal notranslate"><span class="pre">-32</span></code> 或 <code class="docutils literal notranslate"><span class="pre">-arm64</span></code> 后缀）。 这使得各种工具能够找到它，并使得 <a class="reference internal" href="#launcher"><span class="std std-ref">Python 安装管理器</span></a> 能够支持 <code class="docutils literal notranslate"><span class="pre">py.exe</span> <span class="pre">-3.13t</span></code>。 请注意 launcher 会将 <code class="docutils literal notranslate"><span class="pre">py.exe</span> <span class="pre">-3</span></code> (或 <code class="docutils literal notranslate"><span class="pre">python3</span></code> shebang 行) 解读为“最新的 3.x 安装版”，这将使得自由线程版二进制文件优先于常规版，而 <code class="docutils literal notranslate"><span class="pre">py.exe</span> <span class="pre">-3.13</span></code> 则会使用常规版。 如果你要使用简短风格的选项，那么目前你应该选择不安装自由线程版二进制文件。</p>
<p class="translated">要在命令行中指定安装选项，请使用 <code class="docutils literal notranslate"><span class="pre">Include_freethreaded=1</span></code>。 请参阅 <a class="reference internal" href="#install-layout-option"><span class="std std-ref">免下载安装</span></a> 获取有关预先下载额外二进制文件供离线安装的指导。 包括调试符号和二进制文件的选项也同样适用于自由线程构建版。</p>
<p class="translated">自由线程版二进制文件也可 <a class="reference internal" href="#windows-nuget"><span class="std std-ref">在 nuget.org</span></a> 获取。</p>
</section>
</section>
<section id="python-launcher-for-windows-deprecated">
<h2 class="translated"><span class="section-number">4.12. </span>Windows 版 Python 启动器（已弃用）<a class="headerlink" href="#python-launcher-for-windows-deprecated" title="Link to this heading">¶</a></h2>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 3.14 版本弃用: </span>启动器和本文档已被上文所述的 Python 安装管理器取代。保留这些内容只是暂时出于历史参考目的。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.3.</span></p>
</div>
<p class="translated">用于Windows的Python启动器是一个实用程序，可帮助定位和执行不同的Python版本。它允许脚本（或命令行）指示特定Python版本的首选项，并将定位并执行该版本。</p>
<p class="translated">与 <span class="target" id="index-112"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 变量不同，启动器将正确选择最合适的Python版本。它更倾向于按用户安装而不是系统安装，并按语言版本排序，而不是使用最新安装的版本。</p>
<p class="translated">启动器最初是在 <span class="target" id="index-113"></span><a class="pep reference external" href="https://peps.python.org/pep-0397/"><strong>PEP 397</strong></a> 中指定的。</p>
<section id="getting-started">
<h3 class="translated"><span class="section-number">4.12.1. </span>入门<a class="headerlink" href="#getting-started" title="Link to this heading">¶</a></h3>
<section id="from-the-command-line">
<h4 class="translated"><span class="section-number">4.12.1.1. </span>从命令行<a class="headerlink" href="#from-the-command-line" title="Link to this heading">¶</a></h4>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.6 版本发生变更.</span></p>
</div>
<p class="translated">全局安装Python 3.3及更高版本将把启动器放在你的 <span class="target" id="index-114"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 上。启动程序与所有可用的Python版本兼容，因此安装哪个版本无关紧要。要检查启动程序是否可用，请在命令提示符中执行以下命令：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>py
</pre></div>
</div>
<p class="translated">您应该会发现已安装的最新版本的Python已启动 - 它可以正常退出，并且将指定的任何其他命令行参数直接发送到Python。</p>
<p class="translated">如果您安装了多个版本的Python（例如，3.7和 3.14 ），您会注意到Python 3.14 启动 - 如果要启动 Python 3.7，尝试命令：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>py -3.7
</pre></div>
</div>
<p class="translated">如果您想使用已安装的 Python 2 的最新版本，请尝试以下命令：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>py -2
</pre></div>
</div>
<p class="translated">如果您看到以下错误，则表明您没有安装启动器：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;py&#39; 不是内部或外部命令，也不是可运行的程序或批处理文件。
</pre></div>
</div>
<p class="translated">Tix 命令：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>py --list
</pre></div>
</div>
<p class="translated">显示当前已安装的Python版本。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">-x.y</span></code> 参数是 <code class="docutils literal notranslate"><span class="pre">-V:Company/Tag</span></code> 参数的简短形式，它允许选择一个特定的 Python 运行时，包括可能来自于 python.org 以外地方的版本。 任何遵循 <span class="target" id="index-115"></span><a class="pep reference external" href="https://peps.python.org/pep-0514/"><strong>PEP 514</strong></a> 进行注册的运行时都将是可被发现的。 <code class="docutils literal notranslate"><span class="pre">--list</span></code> 命令将列出所有使用 <code class="docutils literal notranslate"><span class="pre">-V:</span></code> 格式的可用运行时。</p>
<p class="translated">当使用 <code class="docutils literal notranslate"><span class="pre">-V:</span></code> 参数时，指定 Company 将把选择限制到来自该提供方的运行时，而仅指定 Tag 将选择来自所有提供方的运行时。 请注意省略斜杠将会视作是一个 Tag:</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span># 选择任意带 &#39;3.*&#39; 标签的运行时
py -V:3

# 选择任何 &#39;PythonCore&#39; 发行的运行时
py -V:PythonCore/

# 选择 PythonCore 的最新 Python 3 运行时
py -V:PythonCore/3
</pre></div>
</div>
<p class="translated">该参数的简短形式 (<code class="docutils literal notranslate"><span class="pre">-3</span></code>) 将只选择来自核心 Python 发布版的运行时，而不选择其他分发版。 但是，完整形式 (<code class="docutils literal notranslate"><span class="pre">-V:3</span></code>) 则将选择来自任何版本的运行时。</p>
<p class="translated">Company 是在完整字符串上以大小写不敏感的方式进行匹配。 Tag 是在完整字符串或前缀上进行匹配，具体取决于下一个字符是点号还是连字符。 这将允许 <code class="docutils literal notranslate"><span class="pre">-V:3.1</span></code> 匹配 <code class="docutils literal notranslate"><span class="pre">3.1-32</span></code>，但不匹配 <code class="docutils literal notranslate"><span class="pre">3.10</span></code>。 Tag 是使用数字顺序进行排序的 (<code class="docutils literal notranslate"><span class="pre">3.10</span></code> 比 <code class="docutils literal notranslate"><span class="pre">3.1</span></code> 新)，但会按文本进行比较 (<code class="docutils literal notranslate"><span class="pre">-V:3.01</span></code> 将不匹配 <code class="docutils literal notranslate"><span class="pre">3.1</span></code>)。</p>
</section>
<section id="virtual-environments">
<h4 class="translated"><span class="section-number">4.12.1.2. </span>从虚拟环境<a class="headerlink" href="#virtual-environments" title="Link to this heading">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.5.</span></p>
</div>
<p class="translated">如果启动程序运行时没有明确的Python版本，并且虚拟环境（使用标准库创建 <a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code></a> 模块或外部 <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> 工具）处于活动状态，则启动程序将运行虚拟环境的解释器而不是全局的。要运行全局解释器，请停用虚拟环境，或显式指定全局Python版本。</p>
</section>
<section id="from-a-script">
<h4 class="translated"><span class="section-number">4.12.1.3. </span>从脚本<a class="headerlink" href="#from-a-script" title="Link to this heading">¶</a></h4>
<p class="translated">让我们创建一个测试Python脚本 - 创建一个名为 <code class="docutils literal notranslate"><span class="pre">hello.py</span></code> 的文件，其中包含以下内容</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! python</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;hello from Python </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">,))</span>
</pre></div>
</div>
<p class="translated">从hello.py所在的目录中，执行以下命令：</p>
<div class="translated highlight-none notranslate"><div class="highlight"><pre><span></span>py hello.py
</pre></div>
</div>
<p class="translated">您应该注意到最新的Python 2.x安装的版本号已打印出来。现在尝试将第一行更改为：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! python3</span>
</pre></div>
</div>
<p class="translated">现在重新执行该命令将打印最新的 Python 3.x 信息。 如上面的命令行示例一样，你可以更明确地指定版本限定符。 假设你已安装了 Python 3.7，请尝试将第一行改为 <code class="docutils literal notranslate"><span class="pre">#!</span> <span class="pre">python3.7</span></code> 那么你应当看到打印出了 3.7 的版本信息。</p>
<p class="translated">请注意，与交互式使用不同，裸“python”将使用您已安装的Python 2.x的最新版本。这是为了向后兼容及兼容Unix，其中命令 <code class="docutils literal notranslate"><span class="pre">python</span></code> 通常是指Python 2。</p>
</section>
<section id="from-file-associations">
<h4 class="translated"><span class="section-number">4.12.1.4. </span>从文件关联<a class="headerlink" href="#from-file-associations" title="Link to this heading">¶</a></h4>
<p class="translated">安装时应该将启动器与Python文件（即 <code class="docutils literal notranslate"><span class="pre">.py</span></code>, <code class="docutils literal notranslate"><span class="pre">.pyw</span></code>, <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> 文件）相关联。这意味着当您从Windows资源管理器中双击其中一个文件时，将使用启动程序，因此您可以使用上述相同的工具让脚本指定应使用的版本。</p>
<p class="translated">这样做的主要好处是，单个启动程序可以同时支持多个Python版本，具体取决于第一行的内容。</p>
</section>
</section>
<section id="id4">
<h3 class="translated"><span class="section-number">4.12.2. </span>Shebang 行<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p class="translated">如果脚本文件的第一行以 <code class="docutils literal notranslate"><span class="pre">#!</span></code> 开头，则称为 &quot;shebang&quot; 行。Linux和其他类Unix操作系统都有对这些行的本机支持，它们通常在此类系统上用来指示应该如何执行脚本。这个启动器允许在Windows上对Python脚本使用相同的工具，上面的示例演示了它们的使用。</p>
<p class="translated">为了允许Python脚本中的shebang行在Unix和Windows之间移植，该启动器支持许多“虚拟”命令来指定要使用的解释器。支持的虚拟命令是：</p>
<ul class="simple">
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">/usr/bin/python</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">/usr/local/bin/python</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">python</span></code></p></li>
</ul>
<p class="translated">例如，如果脚本开始的第一行为</p>
<div class="translated highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/python</span>
</pre></div>
</div>
<p class="translated">将找到并使用默认的 Python 或激活的虚拟环境。 因为在 Unix 上编写的许多 Python 脚本都已经有了这一行，你应该会发现这些脚本可以由启动器使用而无需修改。 如果你在 Windows 上编写一个新脚本并希望其在 Unix 上可用，你应当使用某个以 <code class="docutils literal notranslate"><span class="pre">/usr</span></code> 开头的 shebang 行。</p>
<p class="translated">任何上述虚拟命令都可以附带一个显式版本号的后缀（可以是只有主版本号，也可以是有主版本号和次版本号）。 此外还可以在次版本号之后添加 &quot;-32&quot; 来请求 32 位版本。 即 <code class="docutils literal notranslate"><span class="pre">/usr/bin/python3.7-32</span></code> 将请求使用 32 位的 Python 3.7。 如果激活了一个虚拟环境，则将忽略版本号并使用激活的环境。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7: </span>从 python 启动器 3.7 开始，可以通过 &quot;-64&quot; 后缀调用 64 位版本。 此外还可以指定一个主版本号加架构而不带次版本号 (即 <code class="docutils literal notranslate"><span class="pre">/usr/bin/python3-64</span></code>)。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.11 版本发生变更: </span>“-64”后缀已被弃用，现在会被视为“任何不被确定为 i386/32 位的架构”。 要请求一个特定的环境，请使用新的 <code class="samp docutils literal notranslate"><span class="pre">-V:</span><em><span class="pre">TAG</span></em></code> 参数并附带完整的标签。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.13 版本发生变更: </span>引用了 <code class="docutils literal notranslate"><span class="pre">python</span></code> 的虚拟命令现在会优先使用激活的虚拟环境再去搜索 <span class="target" id="index-116"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code>。 这是为了处理 shebang 指定了 <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">python3</span></code> 但激活的环境中没有 <code class="file docutils literal notranslate"><span class="pre">python3.exe</span></code> 的情况。</p>
</div>
<p class="translated">shebang 行的 <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span></code> 形式具有一个额外的特别属性。 在查找已安装的 Python 解释器之前，此形式将在可执行程序 <span class="target" id="index-117"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 中搜索与作为第一个参数传入的名称相匹配的 Python 可执行程序。 这对应于 Unix <code class="docutils literal notranslate"><span class="pre">env</span></code> 程序的行为，它将执行 <span class="target" id="index-118"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 搜索。 如果无法找到与 <code class="docutils literal notranslate"><span class="pre">env</span></code> 命令之后的第一个参数相匹配的可执行程序，但该参数是以 <code class="docutils literal notranslate"><span class="pre">python</span></code> 开头的，它将按针对其他虚拟命令的描述来处理。 可以对环境变量 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_NO_SEARCH_PATH</span></code> 进行设置（为任意值）来跳过对 <span class="target" id="index-119"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> 的搜索。</p>
<p class="translated">无法匹配这些模式中任何一个的井号叹号行将在启动器的 <a class="reference internal" href="#launcher-ini"><span class="std std-ref">.INI 文件</span></a> 的 <code class="docutils literal notranslate"><span class="pre">[commands]</span></code> 一节中查找。 这可被用来以对你的系统来说有意义的方式处理某些命令。 命名的名称必须是一个单独的参数（在井号叹号行的可执行程序中不可有空格），而被替代的值则是该可执行程序的完整路径（在 .INI 中指定的附加参数将作为文件名的一部分被引用）。</p>
<div class="translated highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[commands]</span>
<span class="na">/bin/xpython</span><span class="o">=</span><span class="s">C:\Program Files\XPython\python.exe</span>
</pre></div>
</div>
<p class="translated">任何未出现在 .INI 文件中的命令都会被当作 <strong>Windows</strong> 可执行程序的绝对或相对于包含脚本文件的目录的路径。 这对于 Windows 专属的脚本来说很方便，例如由安装器所生成的脚本，因为此行为与 Unix 风格的 shell 是不兼容的。 这些路径可以加上引号，并可以包含多个参数，在它之后将会加上脚本路径以及任何附加参数。</p>
</section>
<section id="arguments-in-shebang-lines">
<h3 class="translated"><span class="section-number">4.12.3. </span>shebang 行的参数<a class="headerlink" href="#arguments-in-shebang-lines" title="Link to this heading">¶</a></h3>
<p class="translated">shebang 行还可以指定要传递给Python解释器的其他选项。 举例来说，如果你有这样的 shebang 行：</p>
<div class="translated highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/python -v</span>
</pre></div>
</div>
<p class="translated">那么 Python 将以 <code class="docutils literal notranslate"><span class="pre">-v</span></code> 选项启动</p>
</section>
<section id="customization">
<h3 class="translated"><span class="section-number">4.12.4. </span>自定义<a class="headerlink" href="#customization" title="Link to this heading">¶</a></h3>
<section id="customization-via-ini-files">
<span id="launcher-ini"></span><h4 class="translated"><span class="section-number">4.12.4.1. </span>通过INI文件自定义<a class="headerlink" href="#customization-via-ini-files" title="Link to this heading">¶</a></h4>
<p class="translated">启动器将搜索两个 .ini 文件 —— 当前用户应用程序数据目录中的 <code class="docutils literal notranslate"><span class="pre">py.ini</span></code> (<code class="docutils literal notranslate"><span class="pre">%LOCALAPPDATA%</span></code> 或 <code class="docutils literal notranslate"><span class="pre">$env:LocalAppData</span></code>) 以及启动器所在目录中的 <code class="docutils literal notranslate"><span class="pre">py.ini</span></code>。 同样的 .ini 文件还会被用于启动器的‘控制台’版本 (即 py.exe) 和‘窗口’版本 (即 pyw.exe)。</p>
<p class="translated">“应用程序目录”中指定的自定义优先于可执行文件旁边.ini文件的自定义，因此对启动程序旁边的.ini文件不具有写访问权限的用户可以覆盖该全局.ini文件中的命令。</p>
</section>
<section id="customizing-default-python-versions">
<h4 class="translated"><span class="section-number">4.12.4.2. </span>自定义默认的Python版本<a class="headerlink" href="#customizing-default-python-versions" title="Link to this heading">¶</a></h4>
<p class="translated">在某些情况下，可以在命令中包含版本限定符，以指定命令将使用哪个Python版本。版本限定符以主版本号开头，可以选择后跟 ('.') 和次版本说明符。此外，可以通过添加 &quot;-32&quot; 或 “-64” 来指定是请求32位还是64位实现。</p>
<p class="translated">例如，一个shebang 行的 <code class="docutils literal notranslate"><span class="pre">#!python</span></code> 行没有版本限定符，而 <code class="docutils literal notranslate"><span class="pre">#!python3</span></code> 有一个版本限定符，它只指定一个主版本。</p>
<p class="translated">如果在命令中找不到版本限定符，则可以设置环境变量 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">PY_PYTHON</span></code> 以指定默认版本限定符。 如果未设置，则默认为 &quot;3&quot;。 该变量可以指定能通过命令行传递的任何值，比如 &quot;3&quot;, &quot;3.7&quot;, &quot;3.7-32&quot; 或 &quot;3.7-64&quot;。 （请注意 &quot;-64&quot; 选项仅适用于 Python 3.7 或更高版本中包含的启动器。）</p>
<p class="translated">如果没有找到次版本限定符，则可以设置环境变量 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON{major}</span></code> （其中 <code class="docutils literal notranslate"><span class="pre">{major}</span></code> 是上面确定的当前主要版本限定符）以指定完整版本。如果没有找到这样的选项，启动器将枚举已安装的Python版本并使用为主要版本找到的最新次要版本，尽管不能保证，但该版本可能是该系列中最新安装的版本。</p>
<p class="translated">在安装了相同（major.minor）Python版本的32位和64位的64位Windows上，64位版本将始终是首选。对于启动程序的32位和64位实现都是如此 -- 这对于启动程序32位和64位都是正确的 -- 如果可用，32位启动程序将倾向于执行指定版本的64位Python安装。这样就可以预测启动器的行为，只知道PC上安装了哪些版本，而不考虑它们的安装顺序（即，不知道32位或64位版本的Python和相应的启动器是否是最后安装）。如上所述，可以在版本说明符上使用可选的“-32”或“-64”后缀来更改此行为。</p>
<p class="translated">示例：</p>
<ul class="simple">
<li><p class="translated">如果没有设置相关选项，命令 <code class="docutils literal notranslate"><span class="pre">python</span></code> 和 <code class="docutils literal notranslate"><span class="pre">python2</span></code> 将使用安装的最新Python 2.x版本，命令 <code class="docutils literal notranslate"><span class="pre">python3</span></code> 将使用最新安装的Python 3.x.</p></li>
<li><p class="translated">命令 <code class="docutils literal notranslate"><span class="pre">python3.7</span></code> 根本不会查阅任何选项，因为版本已完全指定。</p></li>
<li><p class="translated">如果 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3</span></code> ，命令 <code class="docutils literal notranslate"><span class="pre">python</span></code> 和 <code class="docutils literal notranslate"><span class="pre">python3</span></code> 都将使用最新安装的Python 3版本。</p></li>
<li><p class="translated">如果 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3.7-32</span></code> ，命令 <code class="docutils literal notranslate"><span class="pre">python</span></code> 将使用3.7的32位实现，而命令 <code class="docutils literal notranslate"><span class="pre">python3</span></code> 将使用最新安装的Python（PY_PYTHON根本没有被视为指定了主要版本。）</p></li>
<li><p class="translated">如果 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3</span></code> 且 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON3=3.7</span></code> ，命令 <code class="docutils literal notranslate"><span class="pre">python</span></code> 和 <code class="docutils literal notranslate"><span class="pre">python3</span></code> 都将特别使用3.7</p></li>
</ul>
<p class="translated">除环境变量外，还可以在启动程序使用的.INI文件中配置相同的设置。 INI文件中的部分称为 <code class="docutils literal notranslate"><span class="pre">[defaults]</span></code> ，键名称将与没有前导 <code class="docutils literal notranslate"><span class="pre">PY_</span></code> 前缀的环境变量相同（并注意INI文件中的键名不区分大小写） 。）环境变量的内容将覆盖INI文件中指定的内容。</p>
<p class="translated">例如:</p>
<ul class="simple">
<li><p class="translated">设置 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3.7</span></code> 等同于包含以下内容的INI文件：</p></li>
</ul>
<div class="translated highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[defaults]</span>
<span class="na">python</span><span class="o">=</span><span class="s">3.7</span>
</pre></div>
</div>
<ul class="simple">
<li><p class="translated">设置 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON=3</span></code> 和 <code class="docutils literal notranslate"><span class="pre">PY_PYTHON3=3.7</span></code> 相当于包含以下内容的INI文件：</p></li>
</ul>
<div class="translated highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[defaults]</span>
<span class="na">python</span><span class="o">=</span><span class="s">3</span>
<span class="na">python3</span><span class="o">=</span><span class="s">3.7</span>
</pre></div>
</div>
</section>
</section>
<section id="diagnostics">
<h3 class="translated"><span class="section-number">4.12.5. </span>诊断<a class="headerlink" href="#diagnostics" title="Link to this heading">¶</a></h3>
<p class="translated">如果环境变量 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_DEBUG</span></code> 已被设置（为任何值），启动器将把诊断信息打印到 stderr (即控制台)。 此信息会尽量做到即详细 <em>又</em> 简洁，它应当允许你查看已被定位的 Python 的版本，特定版本为何被选择以及被用于执行目标 Python 的实际命令行。 它的主要目标是用于测试和调试。</p>
</section>
<section id="dry-run">
<h3 class="translated"><span class="section-number">4.12.6. </span>试运行<a class="headerlink" href="#dry-run" title="Link to this heading">¶</a></h3>
<p class="translated">如果环境变量 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_DRYRUN</span></code> 已被设置（为任意值），启动器将输出它将要运行的命令，但不会实际启动 Python。 这对于想要使用启动器执行检测然后再直接启动 Python 的工具来说很有用处。 请注意写入到标准输出的命令总是会使用 UTF-8 来编码，因而在控制台中可能无法正确渲染。</p>
</section>
<section id="install-on-demand">
<h3 class="translated"><span class="section-number">4.12.7. </span>按需安装<a class="headerlink" href="#install-on-demand" title="Link to this heading">¶</a></h3>
<p class="translated">如果环境变量 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_ALLOW_INSTALL</span></code> 已被设置（为任何值），而所请求的 Python 版本没有安装但可以在 Microsoft Store 上获取，启动器将尝试安装它。 这可能需要用户进行交互来完成，你可能需要再次运行此命令。</p>
<p class="translated">额外的 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_ALWAYS_INSTALL</span></code> 变量将使得启用器总是会尝试安装 Python，即使它已被检测到。 这主要是出于测试目的（并且应当与 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYLAUNCHER_DRYRUN</span></code> 一起使用）。</p>
</section>
<section id="return-codes">
<h3 class="translated"><span class="section-number">4.12.8. </span>返回码<a class="headerlink" href="#return-codes" title="Link to this heading">¶</a></h3>
<p class="translated">Python 启动器可能返回以下的退出码。 不幸的是，没有任何办法可以将这些退出码与 Python 本身的退出码区分开来。</p>
<p class="translated">退出码的名称将在源代码中使用，并且仅供参考。 除了阅读本页面以外没有其他办法可以获取或解读它们。 这些条目是以名称的字母顺序列出的。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p class="translated">名称</p></th>
<th class="head"><p class="translated">值</p></th>
<th class="head"><p class="translated">描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated">RC_BAD_VENV_CFG</p></td>
<td><p class="translated">107</p></td>
<td><p class="translated">找到了 <code class="file docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> 但文件已损坏。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">RC_CREATE_PROCESS</p></td>
<td><p class="translated">101</p></td>
<td><p class="translated">启动 Python 失败。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">RC_INSTALLING</p></td>
<td><p class="translated">111</p></td>
<td><p class="translated">安装已启动，但命令需要在其完成后重新运行。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">RC_INTERNAL_ERROR</p></td>
<td><p class="translated">109</p></td>
<td><p class="translated">未预期的错误。 请报告程序错误。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">RC_NO_COMMANDLINE</p></td>
<td><p class="translated">108</p></td>
<td><p class="translated">无法从操作系统获取命令行。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">RC_NO_PYTHON</p></td>
<td><p class="translated">103</p></td>
<td><p class="translated">无法定位所请求的版本。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">RC_NO_VENV_CFG</p></td>
<td><p class="translated">106</p></td>
<td><p class="translated">需要 <code class="file docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code> 但没有找到。</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">4. 在 Windows 上使用 Python</a><ul>
<li><a class="reference internal" href="#python-install-manager">4.1. Python 安装管理器</a><ul>
<li><a class="reference internal" href="#installation">4.1.1. 安装</a></li>
<li><a class="reference internal" href="#basic-use">4.1.2. 基础使用</a></li>
<li><a class="reference internal" href="#command-help">4.1.3. 命令帮助</a></li>
<li><a class="reference internal" href="#listing-runtimes">4.1.4. 列出运行时</a></li>
<li><a class="reference internal" href="#installing-runtimes">4.1.5. 安装运行时</a></li>
<li><a class="reference internal" href="#offline-installs">4.1.6. 离线安装</a></li>
<li><a class="reference internal" href="#uninstalling-runtimes">4.1.7. 卸载运行时</a></li>
<li><a class="reference internal" href="#configuration">4.1.8. 配置</a></li>
<li><a class="reference internal" href="#shebang-lines">4.1.9. Shebang 行</a></li>
<li><a class="reference internal" href="#advanced-installation">4.1.10. 高级安装</a></li>
<li><a class="reference internal" href="#administrative-configuration">4.1.11. 管理配置</a></li>
<li><a class="reference internal" href="#installing-free-threaded-binaries">4.1.12. 安装自由线程二进制文件</a></li>
<li><a class="reference internal" href="#troubleshooting">4.1.13. 故障排除</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-embeddable-package">4.2. 可嵌入的包</a><ul>
<li><a class="reference internal" href="#python-application">4.2.1. Python 应用程序</a></li>
<li><a class="reference internal" href="#embedding-python">4.2.2. 嵌入Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-nuget-org-packages">4.3. nuget.org 安装包</a><ul>
<li><a class="reference internal" href="#free-threaded-packages">4.3.1. 自由线程版软件包</a></li>
</ul>
</li>
<li><a class="reference internal" href="#alternative-bundles">4.4. 替代捆绑包</a></li>
<li><a class="reference internal" href="#supported-windows-versions">4.5. 支持的 Windows 版本</a></li>
<li><a class="reference internal" href="#removing-the-max-path-limitation">4.6. 移除 MAX_PATH 限制</a></li>
<li><a class="reference internal" href="#utf-8-mode">4.7. UTF-8 模式</a></li>
<li><a class="reference internal" href="#finding-modules">4.8. 查找模块</a></li>
<li><a class="reference internal" href="#additional-modules">4.9. 附加模块</a><ul>
<li><a class="reference internal" href="#pywin32">4.9.1. PyWin32</a></li>
<li><a class="reference internal" href="#cx-freeze">4.9.2. cx_Freeze</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compiling-python-on-windows">4.10. 在Windows上编译Python</a></li>
<li><a class="reference internal" href="#the-full-installer-deprecated">4.11. 完整安装程序（已弃用）</a><ul>
<li><a class="reference internal" href="#installation-steps">4.11.1. 安装步骤</a></li>
<li><a class="reference internal" href="#id2">4.11.2. 移除 MAX_PATH 限制</a></li>
<li><a class="reference internal" href="#installing-without-ui">4.11.3. 无 UI 安装</a></li>
<li><a class="reference internal" href="#installing-without-downloading">4.11.4. 免下载安装</a></li>
<li><a class="reference internal" href="#modifying-an-install">4.11.5. 修改安装</a></li>
<li><a class="reference internal" href="#id3">4.11.6. 安装自由线程二进制文件</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python-launcher-for-windows-deprecated">4.12. Windows 版 Python 启动器（已弃用）</a><ul>
<li><a class="reference internal" href="#getting-started">4.12.1. 入门</a><ul>
<li><a class="reference internal" href="#from-the-command-line">4.12.1.1. 从命令行</a></li>
<li><a class="reference internal" href="#virtual-environments">4.12.1.2. 从虚拟环境</a></li>
<li><a class="reference internal" href="#from-a-script">4.12.1.3. 从脚本</a></li>
<li><a class="reference internal" href="#from-file-associations">4.12.1.4. 从文件关联</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">4.12.2. Shebang 行</a></li>
<li><a class="reference internal" href="#arguments-in-shebang-lines">4.12.3. shebang 行的参数</a></li>
<li><a class="reference internal" href="#customization">4.12.4. 自定义</a><ul>
<li><a class="reference internal" href="#customization-via-ini-files">4.12.4.1. 通过INI文件自定义</a></li>
<li><a class="reference internal" href="#customizing-default-python-versions">4.12.4.2. 自定义默认的Python版本</a></li>
</ul>
</li>
<li><a class="reference internal" href="#diagnostics">4.12.5. 诊断</a></li>
<li><a class="reference internal" href="#dry-run">4.12.6. 试运行</a></li>
<li><a class="reference internal" href="#install-on-demand">4.12.7. 按需安装</a></li>
<li><a class="reference internal" href="#return-codes">4.12.8. 返回码</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="configure.html"
                          title="上一章"><span class="section-number">3. </span>配置 Python</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="mac.html"
                          title="下一章"><span class="section-number">5. </span>在 macOS 上使用 Python</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告代码错误</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/using/windows.rst?plain=1"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="折叠边栏">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="mac.html" title="5. 在 macOS 上使用 Python"
             >下一页</a> |</li>
        <li class="right" >
          <a href="configure.html" title="3. 配置 Python"
             >上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python安装和使用</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">4. </span>在 Windows 上使用 Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box">
          <input type="submit" value="转到">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">版权</a> 2001 Python Software Foundation.
    <br>
    本页面采用 Python 软件基金会许可证第 2 版授权。
    <br>
    文档中的示例、代码片段及其他代码内容额外采用零条款 BSD 许可证授权。
    <br>
    
      更多信息请参阅《<a href="/license.html"> 历史与许可 </a>》。<br>
    
    
    <br>

    Python 软件基金会是一家非营利性公司。
<a href="https://www.python.org/psf/donations/">请进行捐赠。</a>
<br>
    <br>
      最后更新于11月 25, 2025 (07:24 UTC) 。
    
      <a href="/bugs.html">发现了错误</a>？
    
    <br>

    使用<a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3 创建。
    </div>

  </body>
</html>