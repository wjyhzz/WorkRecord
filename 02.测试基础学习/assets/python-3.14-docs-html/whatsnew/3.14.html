<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Python 3.14 有什么新变化" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/whatsnew/3.14.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="编者, Adam Turner 和 Hugo van Kemenade,. 本文介绍了 Python 3.14 相比 3.13 增加的新特性。 Python 3.14 发布于 2025 年 10 月 7 日。 要了解详细信息，请参阅 更新日志 。 摘要 -- 发布重点: Python 3.14 是 Python 编程语言的最新稳定发布版，包含多项针对语言、实现和标准库的改变。 最大的变化包括..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://docs.python.org/3.14/zh-cn/_images/social_previews/summary_whatsnew_3.14_89b263ad.png" />
<meta property="og:image:alt" content="编者, Adam Turner 和 Hugo van Kemenade,. 本文介绍了 Python 3.14 相比 3.13 增加的新特性。 Python 3.14 发布于 2025 年 10 月 7 日。 要了解详细信息，请参阅 更新日志 。 摘要 -- 发布重点: Python 3.14 是 Python 编程语言的最新稳定发布版，包含多项针对语言、实现和标准库的改变。 最大的变化包括..." />
<meta name="description" content="编者, Adam Turner 和 Hugo van Kemenade,. 本文介绍了 Python 3.14 相比 3.13 增加的新特性。 Python 3.14 发布于 2025 年 10 月 7 日。 要了解详细信息，请参阅 更新日志 。 摘要 -- 发布重点: Python 3.14 是 Python 编程语言的最新稳定发布版，包含多项针对语言、实现和标准库的改变。 最大的变化包括..." />
<meta name="twitter:card" content="summary_large_image" />
<meta name="theme-color" content="#3776ab">

    <title>Python 3.14 有什么新变化 &#8212; Python 3.14.0 文档</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=234b1a7c" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=8cd84f99" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=5349f25f" />
    
    <script src="../_static/documentation_options.js?v=a595ec0e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.14.0 文档 中搜索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="关于此文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="copyright" title="版权" href="../copyright.html" />
    <link rel="next" title="Python 3.13 有什么新变化" href="3.13.html" />
    <link rel="prev" title="Python的新变化" href="index.html" />
    
      
      <script defer file-types="bz2,epub,zip" data-domain="docs.python.org" src="https://analytics.python.org/js/script.file-downloads.outbound-links.js"></script>
      
      <link rel="canonical" href="https://docs.python.org/3/whatsnew/3.14.html">
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg">
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="菜单">
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo">
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q">
                <input type="submit" value="转到">
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.14 有什么新变化</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">摘要 -- 发布重点</a></li>
<li><a class="reference internal" href="#new-features">新的特性</a><ul>
<li><a class="reference internal" href="#pep-649-pep-749-deferred-evaluation-of-annotations"><strong>PEP 649</strong> &amp; <strong>PEP 749</strong>: 标注的迟延求值</a></li>
<li><a class="reference internal" href="#pep-734-multiple-interpreters-in-the-standard-library"><strong>PEP 734</strong>: 标准库中的多解释器</a></li>
<li><a class="reference internal" href="#pep-750-template-string-literals"><strong>PEP 750</strong>: 模板字符串字面值</a></li>
<li><a class="reference internal" href="#pep-768-safe-external-debugger-interface"><strong>PEP 768</strong>: 安全的外部调试器接口</a></li>
<li><a class="reference internal" href="#a-new-type-of-interpreter">一种新型的解释器</a></li>
<li><a class="reference internal" href="#free-threaded-mode-improvements">自由线程模式的改进</a></li>
<li><a class="reference internal" href="#improved-error-messages">改进的错误消息</a></li>
<li><a class="reference internal" href="#pep-784-zstandard-support-in-the-standard-library"><strong>PEP 784</strong>: 标准库中的 Zstandard 支持support in the standard library</a></li>
<li><a class="reference internal" href="#asyncio-introspection-capabilities">asyncio 内省能力</a></li>
<li><a class="reference internal" href="#concurrent-safe-warnings-control">并发安全的警告控制</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他语言特性修改</a><ul>
<li><a class="reference internal" href="#built-ins">内置</a></li>
<li><a class="reference internal" href="#command-line-and-environment">命令行与环境</a></li>
<li><a class="reference internal" href="#pep-758-allow-except-and-except-expressions-without-brackets">PEP 758: 允许不带圆括号的 <code class="docutils literal notranslate"><span class="pre">except</span></code> 和 <code class="docutils literal notranslate"><span class="pre">except*</span></code> 表达式</a></li>
<li><a class="reference internal" href="#pep-765-control-flow-in-finally-blocks">PEP 765: <code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code> 代码块中的控制流</a></li>
<li><a class="reference internal" href="#incremental-garbage-collection">增量式垃圾回收</a></li>
<li><a class="reference internal" href="#default-interactive-shell">默认的交互式 shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-modules">新增模块</a></li>
<li><a class="reference internal" href="#improved-modules">改进的模块</a><ul>
<li><a class="reference internal" href="#argparse">argparse</a></li>
<li><a class="reference internal" href="#ast">ast（抽象语法树）</a></li>
<li><a class="reference internal" href="#asyncio">asyncio</a></li>
<li><a class="reference internal" href="#calendar">calendar（日历）</a></li>
<li><a class="reference internal" href="#concurrent-futures">concurrent.futures</a></li>
<li><a class="reference internal" href="#configparser">configparser</a></li>
<li><a class="reference internal" href="#contextvars">contextvars</a></li>
<li><a class="reference internal" href="#ctypes">ctypes</a></li>
<li><a class="reference internal" href="#curses">curses</a></li>
<li><a class="reference internal" href="#datetime">datetime</a></li>
<li><a class="reference internal" href="#decimal">decimal</a></li>
<li><a class="reference internal" href="#difflib">difflib</a></li>
<li><a class="reference internal" href="#dis">dis</a></li>
<li><a class="reference internal" href="#errno">errno</a></li>
<li><a class="reference internal" href="#faulthandler">faulthandler</a></li>
<li><a class="reference internal" href="#fnmatch">fnmatch</a></li>
<li><a class="reference internal" href="#fractions">fractions</a></li>
<li><a class="reference internal" href="#functools">functools</a></li>
<li><a class="reference internal" href="#getopt">getopt</a></li>
<li><a class="reference internal" href="#getpass">getpass</a></li>
<li><a class="reference internal" href="#graphlib">graphlib</a></li>
<li><a class="reference internal" href="#heapq">heapq</a></li>
<li><a class="reference internal" href="#hmac">hmac</a></li>
<li><a class="reference internal" href="#http">http</a></li>
<li><a class="reference internal" href="#imaplib">imaplib</a></li>
<li><a class="reference internal" href="#inspect">inspect</a></li>
<li><a class="reference internal" href="#io">io</a></li>
<li><a class="reference internal" href="#json">json</a></li>
<li><a class="reference internal" href="#linecache">linecache</a></li>
<li><a class="reference internal" href="#logging-handlers">logging.handlers</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#mimetypes">mimetypes</a></li>
<li><a class="reference internal" href="#multiprocessing">multiprocessing</a></li>
<li><a class="reference internal" href="#operator">operator</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#os-path">os.path</a></li>
<li><a class="reference internal" href="#pathlib">pathlib</a></li>
<li><a class="reference internal" href="#pdb">pdb</a></li>
<li><a class="reference internal" href="#pickle">pickle</a></li>
<li><a class="reference internal" href="#platform">platform</a></li>
<li><a class="reference internal" href="#pydoc">pydoc</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#socket">socket</a></li>
<li><a class="reference internal" href="#ssl">ssl</a></li>
<li><a class="reference internal" href="#struct">struct</a></li>
<li><a class="reference internal" href="#symtable">symtable</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#sys-monitoring">sys.monitoring</a></li>
<li><a class="reference internal" href="#sysconfig">sysconfig</a></li>
<li><a class="reference internal" href="#tarfile">tarfile</a></li>
<li><a class="reference internal" href="#threading">threading</a></li>
<li><a class="reference internal" href="#tkinter">tkinter</a></li>
<li><a class="reference internal" href="#turtle">turtle（海龟绘图）</a></li>
<li><a class="reference internal" href="#types">types（类型）</a></li>
<li><a class="reference internal" href="#typing">typing</a></li>
<li><a class="reference internal" href="#unicodedata">unicodedata</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#urllib">urllib</a></li>
<li><a class="reference internal" href="#uuid">uuid</a></li>
<li><a class="reference internal" href="#webbrowser">webbrowser</a></li>
<li><a class="reference internal" href="#zipfile">zipfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">性能优化</a><ul>
<li><a class="reference internal" href="#id2">asyncio</a></li>
<li><a class="reference internal" href="#base64">base64</a></li>
<li><a class="reference internal" href="#bdb">bdb</a></li>
<li><a class="reference internal" href="#id3">difflib</a></li>
<li><a class="reference internal" href="#gc">gc</a></li>
<li><a class="reference internal" href="#id4">io</a></li>
<li><a class="reference internal" href="#id5">pathlib</a></li>
<li><a class="reference internal" href="#id6">pdb</a></li>
<li><a class="reference internal" href="#id7">uuid</a></li>
<li><a class="reference internal" href="#zlib">zlib</a></li>
</ul>
</li>
<li><a class="reference internal" href="#removed">移除</a><ul>
<li><a class="reference internal" href="#id8">argparse</a></li>
<li><a class="reference internal" href="#id9">ast（抽象语法树）</a></li>
<li><a class="reference internal" href="#id10">asyncio</a></li>
<li><a class="reference internal" href="#email">email</a></li>
<li><a class="reference internal" href="#importlib-abc">importlib.abc</a></li>
<li><a class="reference internal" href="#itertools">itertools</a></li>
<li><a class="reference internal" href="#id11">pathlib</a></li>
<li><a class="reference internal" href="#pkgutil">pkgutil</a></li>
<li><a class="reference internal" href="#pty">pty</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#id12">urllib</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deprecated">弃用</a><ul>
<li><a class="reference internal" href="#new-deprecations">新的弃用</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-15">计划在 Python 3.15 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-16">计划在 Python 3.16 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-17">计划在 Python 3.17 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-19">计划在 Python 3.19 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-future-versions">计划在未来版本中移除</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpython-bytecode-changes">CPython 字节码的改变</a><ul>
<li><a class="reference internal" href="#pseudo-instructions">伪指令</a></li>
</ul>
</li>
<li><a class="reference internal" href="#c-api-changes">C API 的变化</a><ul>
<li><a class="reference internal" href="#python-configuration-c-api">Python 配置 C API</a></li>
<li><a class="reference internal" href="#new-features-in-the-c-api">C API 中的新特性</a></li>
<li><a class="reference internal" href="#limited-c-api-changes">受限 C API 的变化</a></li>
<li><a class="reference internal" href="#removed-c-apis">被移除的 C API</a></li>
<li><a class="reference internal" href="#deprecated-c-apis">已弃用的 C API</a><ul>
<li><a class="reference internal" href="#id13">计划在 Python 3.15 中移除</a></li>
<li><a class="reference internal" href="#id14">计划在 Python 3.16 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-18">计划在 Python 3.18 中移除</a></li>
<li><a class="reference internal" href="#id15">计划在未来版本中移除</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#build-changes">构建的改变</a><ul>
<li><a class="reference internal" href="#build-details-json"><code class="file docutils literal notranslate"><span class="pre">build-details.json</span></code></a></li>
<li><a class="reference internal" href="#discontinuation-of-pgp-signatures">PGP 签名的停用</a></li>
<li><a class="reference internal" href="#free-threaded-python-is-officially-supported">自由线程版 Python 已获官方支持</a></li>
<li><a class="reference internal" href="#binary-releases-for-the-experimental-just-in-time-compiler">实验性即时编译器（JIT）的二进制发布版本</a></li>
</ul>
</li>
<li><a class="reference internal" href="#porting-to-python-3-14">移植到 Python 3.14</a><ul>
<li><a class="reference internal" href="#changes-in-the-python-api">Python API 的变化</a></li>
<li><a class="reference internal" href="#changes-in-annotations-pep-649-and-pep-749">标注中的变化 (<strong>PEP 649</strong> 和 <strong>PEP 749</strong>)</a><ul>
<li><a class="reference internal" href="#implications-for-annotated-code">注解代码的影响</a></li>
<li><a class="reference internal" href="#implications-for-readers-of-annotations">访问 <code class="docutils literal notranslate"><span class="pre">__annotations__</span></code> 的影响</a></li>
<li><a class="reference internal" href="#related-changes">相关变更</a></li>
<li><a class="reference internal" href="#from-future-import-annotations"><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#changes-in-the-c-api">C API 的变化</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="index.html"
                          title="上一章">Python的新变化</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="3.13.html"
                          title="下一章">Python 3.13 有什么新变化</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告代码错误</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.14.rst?plain=1"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="3.13.html" title="Python 3.13 有什么新变化"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="index.html" title="Python的新变化"
             accesskey="P">上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python的新变化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.14 有什么新变化</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box">
          <input type="submit" value="转到">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="what-s-new-in-python-3-14">
<h1 class="translated">Python 3.14 有什么新变化<a class="headerlink" href="#what-s-new-in-python-3-14" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd translated">编者<span class="colon">:</span></dt>
<dd class="field-odd translated"><p class="translated">Adam Turner 和 Hugo van Kemenade</p>
</dd>
</dl>
<p class="translated">本文介绍了 Python 3.14 相比 3.13 增加的新特性。 Python 3.14 发布于 2025 年 10 月 7 日。 要了解详细信息，请参阅 <a class="reference internal" href="changelog.html#changelog"><span class="std std-ref">更新日志</span></a>。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-173"></span><a class="pep reference external" href="https://peps.python.org/pep-0745/"><strong>PEP 745</strong></a> -- Python 3.14 发布计划</p>
</div>
<section id="summary-release-highlights">
<h2 class="translated">摘要 -- 发布重点<a class="headerlink" href="#summary-release-highlights" title="Link to this heading">¶</a></h2>
<p class="translated">Python 3.14 是 Python 编程语言的最新稳定发布版，包含多项针对语言、实现和标准库的改变。 最大的变化包括 <a class="reference internal" href="#whatsnew314-template-string-literals"><span class="std std-ref">模板字符串字面值</span></a>, <a class="reference internal" href="#whatsnew314-deferred-annotations"><span class="std std-ref">标注的迟延求值</span></a>，以及在标准库中对 <a class="reference internal" href="#whatsnew314-multiple-interpreters"><span class="std std-ref">子解释器</span></a> 的支持。</p>
<p class="translated">标准库的变化包括大幅改进 <a class="reference internal" href="#whatsnew314-asyncio-introspection"><span class="std std-ref">在 asyncio 中的内省</span></a> 的功能，新增 <a class="reference internal" href="../library/compression.zstd.html#module-compression.zstd" title="compression.zstd: Low-level interface to compression and decompression routines in the zstd library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.zstd</span></code></a> 模块以 <a class="reference internal" href="#whatsnew314-zstandard"><span class="std std-ref">支持 Zstandard</span></a>，REPL 中的语法高亮，还有用户友好度和正确性方面的改进。</p>
<p class="translated">本文并不试图提供所有新特性的完整规范说明，只是给出一个便捷的概览。 要了解完整细语请参阅相应文档，如 <a class="reference internal" href="../library/index.html#library-index"><span class="std std-ref">标准库参考</span></a> 和 <a class="reference internal" href="../reference/index.html#reference-index"><span class="std std-ref">语言参考</span></a>。 要了解某项改变的完整实现和设计理念，请参阅相应新特性的 PEP；但请注意一旦某项特性已完全实现则相应 PEP 通常不会再持续更新。 请参阅 <a class="reference internal" href="#porting-to-python-3-14">移植到 Python 3.14</a> 了解如何从较早的 Python 版本进行升级的指导。</p>
<hr class="docutils" />
<p class="translated">解释器的改进:</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-174"></span><a class="pep reference external" href="https://peps.python.org/pep-0649/"><strong>PEP 649</strong></a> 和 <span class="target" id="index-175"></span><a class="pep reference external" href="https://peps.python.org/pep-0749/"><strong>PEP 749</strong></a>: <a class="reference internal" href="#whatsnew314-deferred-annotations"><span class="std std-ref">标注的迟延求值</span></a></p></li>
<li><p class="translated"><span class="target" id="index-176"></span><a class="pep reference external" href="https://peps.python.org/pep-0734/"><strong>PEP 734</strong></a>: <a class="reference internal" href="#whatsnew314-multiple-interpreters"><span class="std std-ref">标准库中的多解释器</span></a></p></li>
<li><p class="translated"><span class="target" id="index-177"></span><a class="pep reference external" href="https://peps.python.org/pep-0750/"><strong>PEP 750</strong></a>: <a class="reference internal" href="#whatsnew314-template-string-literals"><span class="std std-ref">模板字符串</span></a></p></li>
<li><p class="translated"><span class="target" id="index-178"></span><a class="pep reference external" href="https://peps.python.org/pep-0758/"><strong>PEP 758</strong></a>: <a class="reference internal" href="#whatsnew314-bracketless-except"><span class="std std-ref">允许不带圆括号的 except 和 except* 表达式</span></a></p></li>
<li><p class="translated"><span class="target" id="index-179"></span><a class="pep reference external" href="https://peps.python.org/pep-0765/"><strong>PEP 765</strong></a>: <a class="reference internal" href="#whatsnew314-finally-syntaxwarning"><span class="std std-ref">finally 代码块中的控制流</span></a></p></li>
<li><p class="translated"><span class="target" id="index-180"></span><a class="pep reference external" href="https://peps.python.org/pep-0768/"><strong>PEP 768</strong></a>: <a class="reference internal" href="#whatsnew314-remote-debugging"><span class="std std-ref">安全的 CPython 外部调试器接口</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-tail-call-interpreter"><span class="std std-ref">一种新的解释器类型</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-free-threaded-cpython"><span class="std std-ref">自由线程模式的改进</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-improved-error-messages"><span class="std std-ref">改进的错误消息</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-incremental-gc"><span class="std std-ref">增量式垃圾回收</span></a></p></li>
</ul>
<p class="translated">标准库中的重大改进：</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-181"></span><a class="pep reference external" href="https://peps.python.org/pep-0784/"><strong>PEP 784</strong></a>: <a class="reference internal" href="#whatsnew314-zstandard"><span class="std std-ref">标准库中的 Zstandard 支持</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-asyncio-introspection"><span class="std std-ref">asyncio 内省能力</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-concurrent-warnings-control"><span class="std std-ref">并发安全的警告控制</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-pyrepl-highlighting"><span class="std std-ref">默认交互式 shell 中的语法高亮</span></a>，以及多个标准库 CLI 中的彩色输出</p></li>
</ul>
<p class="translated">C API 的改进：</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-182"></span><a class="pep reference external" href="https://peps.python.org/pep-0741/"><strong>PEP 741</strong></a>: <a class="reference internal" href="#whatsnew314-capi-config"><span class="std std-ref">Python 配置 C API</span></a></p></li>
</ul>
<p class="translated">平台支持：</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-183"></span><a class="pep reference external" href="https://peps.python.org/pep-0776/"><strong>PEP 776</strong></a>: 现在 Emscripten 是 <a class="reference internal" href="#whatsnew314-build-changes"><span class="std std-ref">官方支持的平台</span></a>，处于 <span class="target" id="index-184"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/#tier-3"><strong>第 3 层级</strong></a>。</p></li>
</ul>
<p class="translated">发布包的变更：</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-185"></span><a class="pep reference external" href="https://peps.python.org/pep-0779/"><strong>PEP 779</strong></a>: <a class="reference internal" href="#whatsnew314-free-threaded-now-supported"><span class="std std-ref">自由线程 Python 已获官方支持</span></a></p></li>
<li><p class="translated"><span class="target" id="index-186"></span><a class="pep reference external" href="https://peps.python.org/pep-0761/"><strong>PEP 761</strong></a>: <a class="reference internal" href="#whatsnew314-no-more-pgp"><span class="std std-ref">官方发布包已停止使用 PGP 签名</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-jit-compiler"><span class="std std-ref">Windows 和 macOS 二进制发布包现已支持实验性的即时编译器</span></a></p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-build-changes"><span class="std std-ref">现已提供针对 Android 的二进制发布包</span></a></p></li>
</ul>
</section>
<section id="new-features">
<h2 class="translated">新的特性<a class="headerlink" href="#new-features" title="Link to this heading">¶</a></h2>
<section id="pep-649-pep-749-deferred-evaluation-of-annotations">
<span id="whatsnew314-deferred-annotations"></span><h3 class="translated"><span class="target" id="index-104"></span><a class="pep reference external" href="https://peps.python.org/pep-0649/"><strong>PEP 649</strong></a> &amp; <span class="target" id="index-105"></span><a class="pep reference external" href="https://peps.python.org/pep-0749/"><strong>PEP 749</strong></a>: 标注的迟延求值<a class="headerlink" href="#pep-649-pep-749-deferred-evaluation-of-annotations" title="Link to this heading">¶</a></h3>
<p class="translated">在函数、类和模块上的 <a class="reference internal" href="../glossary.html#term-annotation"><span class="xref std std-term">标注</span></a> 将不再被立即求值。 相反，标注会被存储在专门的 <a class="reference internal" href="../glossary.html#term-annotate-function"><span class="xref std std-term">标注函数</span></a> 中并仅在必要时进行求值 (除非使用了 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code>)。</p>
<p class="translated">这一改进旨在使得 Python 中的标注在大多数情况下具有更好的性能和可用性。 定义标注的运行时开销被最小化，但仍可在运行时对标注进行内省。  当标注包含前向引用时也不再需要将其包裹在字符串中。</p>
<p class="translated">新引入的 <a class="reference internal" href="../library/annotationlib.html#module-annotationlib" title="annotationlib: Functionality for introspecting annotations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">annotationlib</span></code></a> 模块提供了检查延迟注解的工具。注解可以通过以下格式进行求值：<a class="reference internal" href="../library/annotationlib.html#annotationlib.Format.VALUE" title="annotationlib.Format.VALUE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">VALUE</span></code></a> 格式（将注解求值为运行时值，类似于早期Python版本的行为）、<a class="reference internal" href="../library/annotationlib.html#annotationlib.Format.FORWARDREF" title="annotationlib.Format.FORWARDREF"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FORWARDREF</span></code></a> 格式（用特殊标记替换未定义名称）、<a class="reference internal" href="../library/annotationlib.html#annotationlib.Format.STRING" title="annotationlib.Format.STRING"><code class="xref py py-attr docutils literal notranslate"><span class="pre">STRING</span></code></a> 格式（以字符串形式返回注解）。</p>
<p class="translated">以下示例展示了这些格式的具体行为：</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">annotationlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_annotations</span><span class="p">,</span> <span class="n">Format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Undefined</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_annotations</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">Format</span><span class="o">.</span><span class="n">VALUE</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">NameError</span>: <span class="n">name &#39;Undefined&#39; is not defined</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_annotations</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">Format</span><span class="o">.</span><span class="n">FORWARDREF</span><span class="p">)</span>
<span class="go">{&#39;arg&#39;: ForwardRef(&#39;Undefined&#39;, owner=&lt;function func at 0x...&gt;)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_annotations</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">Format</span><span class="o">.</span><span class="n">STRING</span><span class="p">)</span>
<span class="go">{&#39;arg&#39;: &#39;Undefined&#39;}</span>
</pre></div>
</div>
<p class="translated"><a class="reference internal" href="#whatsnew314-porting-annotations"><span class="std std-ref">移植</span></a> 一节包含了有关因这些改变而可能需要的修改指导，不过大大部分情况下，原来的代码将可继续工作。</p>
<p class="translated">（由 Jelle Zijlstra 在 <span class="target" id="index-187"></span><a class="pep reference external" href="https://peps.python.org/pep-0749/"><strong>PEP 749</strong></a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/119180">gh-119180</a> 中贡献；<span class="target" id="index-188"></span><a class="pep reference external" href="https://peps.python.org/pep-0649/"><strong>PEP 649</strong></a> 由 Larry Hastings 编写。）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-18"></span><a class="pep reference external" href="https://peps.python.org/pep-0649/"><strong>PEP 649</strong></a></dt><dd><p class="translated">使用描述器进行标注的迟延求值</p>
</dd>
<dt class="translated"><span class="target" id="index-19"></span><a class="pep reference external" href="https://peps.python.org/pep-0749/"><strong>PEP 749</strong></a></dt><dd><p class="translated">实现 PEP 649</p>
</dd>
</dl>
</div>
</section>
<section id="pep-734-multiple-interpreters-in-the-standard-library">
<span id="whatsnew314-multiple-interpreters"></span><h3 class="translated"><span class="target" id="index-108"></span><a class="pep reference external" href="https://peps.python.org/pep-0734/"><strong>PEP 734</strong></a>: 标准库中的多解释器<a class="headerlink" href="#pep-734-multiple-interpreters-in-the-standard-library" title="Link to this heading">¶</a></h3>
<p class="translated">CPython 运行时支持在同一个进程中同时运行多个 Python 的副本并且已经这样做了 20 多年。 每个这样的副本被称为‘解释器’。 不过，该特性过去只能通过 <a class="reference internal" href="../c-api/init.html#sub-interpreter-support"><span class="std std-ref">C-API</span></a> 来使用。.</p>
<p class="translated">由于新增的 <a class="reference internal" href="../library/concurrent.interpreters.html#module-concurrent.interpreters" title="concurrent.interpreters: Multiple interpreters in the same process"><code class="xref py py-mod docutils literal notranslate"><span class="pre">concurrent.interpreters</span></code></a> 模块，此限制已在 Python 3.14 中被移除。</p>
<p class="translated">至少有两个重要理由能说明为何使用多解释器可以带来显著的益处：</p>
<ul class="simple">
<li><p class="translated">它们支持（对 Python 来说）全新的、用户友好的并发模型</p></li>
<li><p class="translated">真正的多核心并行</p></li>
</ul>
<p class="translated">对于某些用例来说，软件中的并发机制能够在更高的层级上提升效率并简化设计。 与此同时，实现和维护除最简单形式以外的并发逻辑对人脑来说常常是很困难的。 这一点尤其适用于普通线程 (例如 <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a>)，其中所有的线程之间会共享所有的内存。</p>
<p class="translated">通过多个相互隔离的解释器，你可以利用一类在其他编程语言如 Smalltalk, Erlang, Haskell, 和 Go 中已得到成功运用的并发模型，如通信顺序进程 (CSP) 或表演者模型等。 可以将多个解释器视为具有可远择共享资源的线程。</p>
<p class="translated">关于多核并行：从 Python 3.12 开始，各个解释器彼此已实现足够的隔离从而可以并行使用 (参见 <span class="target" id="index-189"></span><a class="pep reference external" href="https://peps.python.org/pep-0684/"><strong>PEP 684</strong></a>)。 这使得 Python 能够解锁许多曾经受限于 <a class="reference internal" href="../glossary.html#term-GIL"><span class="xref std std-term">GIL</span></a> 的 CPU 密集型应用场景。</p>
<p class="translated">使用多个解释器在许多方面与 <a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a> 类似，因为它们都提供了相互隔离的逻辑“进程”，在默认情况下不共享资源并可并行运行。 然而，在使用多个解释器时，应用程序将使用更少的系统资源并具有更高的运行效率（因为它们仍处于同一个进程内）。 可以将多个解释器视为即具有进程级别的隔离性又具有线程级别的高效率。</p>
<p class="translated">尽管此特性已存在了数十年，但由于知名度较低且缺少标准库模块支持，多解释器并未被广泛使用。 因此，目前其仍存在一些明显的限制，但现在此特性正走向主流并预期会获得迅速的改进。</p>
<p class="translated">当前限制：</p>
<ul class="simple">
<li><p class="translated">启动每个解释器尚未经过优化。</p></li>
<li><p class="translated">每个解释器会占用超出实际需要的内存（正在持续努力实现解释器之间充分的内部共享）</p></li>
<li><p class="translated">解释器之间真正实现对象或其他数据共享的选项还很有限（除了 <a class="reference internal" href="../library/stdtypes.html#memoryview" title="memoryview"><code class="xref py py-type docutils literal notranslate"><span class="pre">memoryview</span></code></a>）。</p></li>
<li><p class="translated">PyPI 上的许多第三方扩展模块尚未与多解释器实现兼容（所有标准库扩展模块 <em>已经</em> 兼容）</p></li>
<li><p class="translated">目前，针对使用多个隔离解释器编写应用程序的方法，对大多数 Python 用户来说仍较为陌生。</p></li>
</ul>
<p class="translated">这些限制的影响将取决于未来 CPython 的改进、解释器的使用方式，以及社区通过 PyPI 软件包能解决哪些问题。 根据具体应用场景，这些限制可能并不会有太大影响，因此不妨尝试一下！</p>
<p class="translated">此外，未来的 CPython 发布版将进一步减少甚至消除这种开销并提供一些不太适合放到 PyPI 上的工具，大多数限制也可以通过扩展模块来解决，这意味着 PyPI 包可以为 3.14 填补各种功能缺口，甚至能上溯到 3.12 即解释器最终实现真正的隔离并停止共享 <a class="reference internal" href="../glossary.html#term-GIL"><span class="xref std std-term">GIL</span></a> 的时候。 同样地，预计在 PyPI 上将产生基于多解释器的高层级抽象库。</p>
<p class="translated">关于扩展模块，已在推进一些 PyPI 项目的更新，还有如 Cython, pybind11, nanobind 和 PyO3 这样的工具。 有关隔离扩展模块的具体步骤可参看 <a class="reference internal" href="../howto/isolating-extensions.html#isolating-extensions-howto"><span class="std std-ref">隔离扩展模块</span></a>。 隔离模块与支持 <a class="reference internal" href="#whatsnew314-free-threaded-cpython"><span class="std std-ref">自由线程</span></a> 所需的工作有大量重叠，因此社区在该领域的持续努力将有助于加快对多解释器的支持进程。</p>
<p class="translated">在 3.14 中还增加了：<a class="reference internal" href="#whatsnew314-concurrent-futures-interp-pool"><span class="std std-ref">concurrent.futures.InterpreterPoolExecutor</span></a>。</p>
<p class="translated">（由 Eric Snow 在 <a class="reference external" href="https://github.com/python/cpython/issues/134939">gh-134939</a> 中贡献。）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-22"></span><a class="pep reference external" href="https://peps.python.org/pep-0734/"><strong>PEP 734</strong></a></p>
</div>
</section>
<section id="pep-750-template-string-literals">
<span id="whatsnew314-template-string-literals"></span><h3 class="translated"><span class="target" id="index-110"></span><a class="pep reference external" href="https://peps.python.org/pep-0750/"><strong>PEP 750</strong></a>: 模板字符串字面值<a class="headerlink" href="#pep-750-template-string-literals" title="Link to this heading">¶</a></h3>
<p class="translated">模板字符串是一种用于定制字符串处理的新机制。 它们共享与 f-字符串类似的语法，但与 f-字符串不同，它们返回一个代表字符串的静态和插值部分的对象，而不是简单的 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>。</p>
<p class="translated">要编写 t-字符串，应使用 <code class="docutils literal notranslate"><span class="pre">'t'</span></code> 前缀而不是 <code class="docutils literal notranslate"><span class="pre">'f'</span></code>:</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">variety</span> <span class="o">=</span> <span class="s1">&#39;Stilton&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">template</span> <span class="o">=</span> <span class="n">t</span><span class="s1">&#39;Try some </span><span class="si">{variety}</span><span class="s1"> cheese!&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
<span class="go">&lt;class &#39;string.templatelib.Template&#39;&gt;</span>
</pre></div>
</div>
<p class="translated"><a class="reference internal" href="../library/string.templatelib.html#string.templatelib.Template" title="string.templatelib.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a> 对象在字符串的静态和插值（以花括号标示）在被组合 <em>之前</em> 提供对它们的访问。 迭代 <code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code> 实例可以按顺序访问其的各个部分：</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
<span class="go">[&#39;Try some &#39;, Interpolation(&#39;Stilton&#39;, &#39;variety&#39;, None, &#39;&#39;), &#39; cheese!&#39;]</span>
</pre></div>
</div>
<p class="translated">编写（或调用）代码对 <code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code> 实例进行处理是很容易的。 例如，下面的函数可将静态部分转为小写而将 <a class="reference internal" href="../library/string.templatelib.html#string.templatelib.Interpolation" title="string.templatelib.Interpolation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Interpolation</span></code></a> 实例转为大写：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">string.templatelib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Interpolation</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lower_upper</span><span class="p">(</span><span class="n">template</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render static parts lowercase and interpolations uppercase.&quot;&quot;&quot;</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">template</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">):</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Wenslydale&#39;</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">t</span><span class="s1">&#39;Mister </span><span class="si">{name}</span><span class="s1">&#39;</span>
<span class="k">assert</span> <span class="n">lower_upper</span><span class="p">(</span><span class="n">template</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;mister WENSLYDALE&#39;</span>
</pre></div>
</div>
<p class="translated">因为 <code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code> 实例会在运行时区分静态和插值部分，它们在无害化用户输入时将很有用处。 这里给读者留一个编写对用户输入的 HTML 进行转义的 <code class="xref py py-func docutils literal notranslate"><span class="pre">html()</span></code> 函数的作业！ 模板处理代码可以提供更高的灵活性。 举例来说，进阶版 <code class="xref py py-func docutils literal notranslate"><span class="pre">html()</span></code> 函数可以直接在模板中接受一个 HTML 属性的 <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>:</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;src&#39;</span><span class="p">:</span> <span class="s1">&#39;limburger.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;alt&#39;</span><span class="p">:</span> <span class="s1">&#39;lovely cheese&#39;</span><span class="p">}</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">t</span><span class="s1">&#39;&lt;img </span><span class="si">{attributes}</span><span class="s1">&gt;&#39;</span>
<span class="k">assert</span> <span class="n">html</span><span class="p">(</span><span class="n">template</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&lt;img src=&quot;limburger.jpg&quot; alt=&quot;lovely cheese&quot; /&gt;&#39;</span>
</pre></div>
</div>
<p class="translated">当然，模板处理代码不一定要返回字符串结果。 一个 <em>更为</em> 进阶的 <code class="xref py py-func docutils literal notranslate"><span class="pre">html()</span></code> 可以返回一个代表类似 DOM 结构的自定义类型。</p>
<p class="translated">有了 t-字符串，开发者可以编写专用系统来无害化 SQL，执行安全的 shell 操作，改进日志记录，处理 Web 开发中的现代概念（HTML, CSS  等等），以及实现轻量级的自定义业务 DSL。</p>
<p class="translated">（由 Jim Baker、Guido van Rossum、Paul Everitt、Koudai Aono、Lysandros Nikolaou、Dave Peck、Adam Turner、Jelle Zijlstra、Bénédikt Tran 和 Pablo Galindo Salgado 在 <a class="reference external" href="https://github.com/python/cpython/issues/132661">gh-132661</a> 中贡献。）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-190"></span><a class="pep reference external" href="https://peps.python.org/pep-0750/"><strong>PEP 750</strong></a>。</p>
</div>
</section>
<section id="pep-768-safe-external-debugger-interface">
<span id="whatsnew314-remote-debugging"></span><h3 class="translated"><span class="target" id="index-112"></span><a class="pep reference external" href="https://peps.python.org/pep-0768/"><strong>PEP 768</strong></a>: 安全的外部调试器接口<a class="headerlink" href="#pep-768-safe-external-debugger-interface" title="Link to this heading">¶</a></h3>
<p class="translated">Python 3.14 引入了一个零开销的调试接口，它允许调试器和性能分析工具安全地附加到正在运行的 Python 进程而不会停止或重启它们。 这显著加强了 Python 的调试能力，意味着不安全的替代方案已不再需要。</p>
<p class="translated">新的接口为附加调试器代码提供了安全的执行点而无需修改解释器的正常执行路径或增加任何运行时开销。 因此，相关工具现在可以实时地对 Python 应用程序进行检查和交互，这对于高可用性系统和生产环境来说是非常关键的能力。</p>
<p class="translated">出于便捷性考虑，本接口是在 <a class="reference internal" href="../library/sys.html#sys.remote_exec" title="sys.remote_exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.remote_exec()</span></code></a> 函数中实现的。 例如：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tempfile</span><span class="w"> </span><span class="kn">import</span> <span class="n">NamedTemporaryFile</span>

<span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.py&#39;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">script_path</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;import my_debugger; my_debugger.connect(</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># 在进程 PID 1234 中执行</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Behold! An offering:&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">remote_exec</span><span class="p">(</span><span class="mi">1234</span><span class="p">,</span> <span class="n">script_path</span><span class="p">)</span>
</pre></div>
</div>
<p class="translated">此函数允许发送 Python 代码以便在目标进程中的下一个安全执行点上执行。 不过，工具作者也可以直接实现在 PEP 中描述的协议，它详细讲解了用于安全附加到运行进程的底层机制。</p>
<p class="translated">该调试接口在设计时已充分考虑安全性，并包含多种访问控制机制：</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-191"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_DISABLE_REMOTE_DEBUG"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_DISABLE_REMOTE_DEBUG</span></code></a> 环境变量。</p></li>
<li><p class="translated"><a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">disable-remote-debug</span></code></a> 命令行选项。</p></li>
<li><p class="translated"><a class="reference internal" href="../using/configure.html#cmdoption-without-remote-debug"><code class="xref std std-option docutils literal notranslate"><span class="pre">--without-remote-debug</span></code></a> 配置标志，用于在构建时完全禁用此功能。</p></li>
</ul>
<p class="translated">（由 Pablo Galindo Salgado，Matt Wozniski 和 Ivona Stojanovic 在 <a class="reference external" href="https://github.com/python/cpython/issues/131591">gh-131591</a> 中贡献）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-192"></span><a class="pep reference external" href="https://peps.python.org/pep-0768/"><strong>PEP 768</strong></a>。</p>
</div>
</section>
<section id="a-new-type-of-interpreter">
<span id="whatsnew314-tail-call-interpreter"></span><h3 class="translated">一种新型的解释器<a class="headerlink" href="#a-new-type-of-interpreter" title="Link to this heading">¶</a></h3>
<p class="translated">CPython 新增了一种解释器类型。 它在实现各个 Python 操作码的小型 C 函数之间使用尾调用，而不是使用一个庞大的 C <code class="docutils literal notranslate"><span class="pre">case</span></code> 语句。 对于某些较新的编译器，这种解释器提供了显著的性能提升。 初步测试数据显示在标准的 <code class="docutils literal notranslate"><span class="pre">pyperformance</span></code> 基准测试套件上提速幅度的几何平均值为 3-5%，取决于具体平台和架构。 作为对比的基线是使用 Clang 19 编译，未使用此新解释器的 Python 3.14。</p>
<p class="translated">此解释器目前仅适用于 x86-64 和 AArch64 架构上的 Clang 19 及更高版本。 不过，预计 GCC 的未来版本也将支持此特性。</p>
<p class="translated">此特性目前为可选功能。 强烈建议在使用此新解释器时启用配置文件引导优化因为这是经过测试和验证可提升性能的唯一配置。 更多相关信息，请参阅 <a class="reference internal" href="../using/configure.html#cmdoption-with-tail-call-interp"><code class="xref std std-option docutils literal notranslate"><span class="pre">--with-tail-call-interp</span></code></a>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p class="translated">这不应与Python函数的 <a class="reference external" href="https://en.wikipedia.org/wiki/Tail_call">尾调用优化</a> 相混淆，该特性目前在CPython中尚未实现。</p>
<p class="translated">这一新型解释器属于CPython解释器的内部实现细节，完全不会改变Python程序的可见行为。它能提升程序性能，但不会引发任何其他变更。</p>
</div>
<p class="translated">（由 Ken Jin 在 <a class="reference external" href="https://github.com/python/cpython/issues/128563">gh-128563</a> 中贡献，CPython实现方案融合了Mark Shannon、Garrett Gu、Haoran Xu和Josh Haberman的设计理念。）</p>
</section>
<section id="free-threaded-mode-improvements">
<span id="whatsnew314-free-threaded-cpython"></span><h3 class="translated">自由线程模式的改进<a class="headerlink" href="#free-threaded-mode-improvements" title="Link to this heading">¶</a></h3>
<p class="translated">CPython 的自由线程模式 (<span class="target" id="index-193"></span><a class="pep reference external" href="https://peps.python.org/pep-0703/"><strong>PEP 703</strong></a>)，最初在 3.13 中加入，已在 Python 3.14 中得到显著改进。 PEP 703 所描述的实现已经全部完成，包括 C API 变量，并且解释器中的临时处理措施已被替换为更具持久性的方案。 专门化自适应解释器 (<span class="target" id="index-194"></span><a class="pep reference external" href="https://peps.python.org/pep-0659/"><strong>PEP 659</strong></a>) 现已在自由线程模块中启用，并与其他许多优化措施一起大幅度提升了性能。 在自由线程模式中对单线程代码的性能影响目前约为 5-10%，具体取决于平台和所使用的 C 编译器。</p>
<p class="translated">自 Python 3.14 开始，在 Windows 上为 CPython 的自由线程构建版编译扩展模块时，预处理器变量 <code class="docutils literal notranslate"><span class="pre">Py_GIL_DISABLED</span></code> 现在需要由构建后端来指定，因为它将不再由 C 编译器自由确定。 对于运行中的解释器，可使用 <a class="reference internal" href="../library/sysconfig.html#sysconfig.get_config_var" title="sysconfig.get_config_var"><code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.get_config_var()</span></code></a> 来查询在编译时使用的设置。</p>
<p class="translated">新增的 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">context_aware_warnings</span></code></a> 旗标控制是否要启用 <a class="reference internal" href="#whatsnew314-concurrent-warnings-control"><span class="std std-ref">并发安全警告控制</span></a>。 默认该旗标对自由线程构建版为真值而对启用 GIL 的构建版为假值。</p>
<p class="translated">新增了 <a class="reference internal" href="../library/sys.html#sys.flags.thread_inherit_context" title="sys.flags.thread_inherit_context"><code class="xref py py-data docutils literal notranslate"><span class="pre">thread_inherit_context</span></code></a> 旗标，如果启用则表示使用 <a class="reference internal" href="../library/threading.html#threading.Thread" title="threading.Thread"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Thread</span></code></a> 创建的线程将带有 <a class="reference internal" href="../library/threading.html#threading.Thread.start" title="threading.Thread.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start()</span></code></a> 调用方的 <a class="reference internal" href="../library/contextvars.html#contextvars.Context" title="contextvars.Context"><code class="xref py py-class docutils literal notranslate"><span class="pre">Context()</span></code></a> 副本。 最重要的是，这使得由 <a class="reference internal" href="../library/warnings.html#warnings.catch_warnings" title="warnings.catch_warnings"><code class="xref py py-class docutils literal notranslate"><span class="pre">catch_warnings</span></code></a> 建立的警告过滤上下文能被在该上下文中启动的线程（或 asyncio 任务）所“继承”。 它还会影响使用上下文变量的其他模块，如 <a class="reference internal" href="../library/decimal.html#module-decimal" title="decimal: Implementation of the General Decimal Arithmetic Specification."><code class="xref py py-mod docutils literal notranslate"><span class="pre">decimal</span></code></a> 上下文管理器。 默认该旗标对自由线程构建版为真值而对启用 GIL 的构建版为假值。</p>
<p class="translated">（贡献来自 Sam Gross, Matt Page, Neil Schemenauer, Thomas Wouters, Donghee Na, Kirill Podoprigora, Ken Jin, Itamar Oren, Brett Simmers, Dino Viehland, Nathan Goldbaum, Ralf Gommers, Lysandros Nikolaou, Kumar Aditya, Edgar Margffoy 以及其他很多人。 这些贡献者有几位是 Meta 的雇员，该公司持续提供了大量工程资源来支持此项目。）</p>
</section>
<section id="improved-error-messages">
<span id="whatsnew314-improved-error-messages"></span><h3 class="translated">改进的错误消息<a class="headerlink" href="#improved-error-messages" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">解释器现在能在检测到Python关键字拼写错误时提供有用的建议。当遇到与Python关键字高度相似的单词时，解释器将在错误信息中建议正确的关键字。该功能可帮助程序员快速识别和修复常见的输入错误。例如：</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">whille</span> <span class="kc">True</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>
<span class="w">    </span><span class="n">whille</span> <span class="kc">True</span><span class="p">:</span>
<span class="w">    </span><span class="pm">^^^^^^</span>
<span class="gr">SyntaxError</span>: <span class="n">invalid syntax. Did you mean &#39;while&#39;?</span>
</pre></div>
</div>
<p class="translated">虽然该功能主要针对最常见的拼写错误情况，但某些变体的拼写错误仍可能导致常规语法错误。（由 Pablo Galindo 在 <a class="reference external" href="https://github.com/python/cpython/issues/132449">gh-132449</a> 中贡献。）</p>
</li>
<li><p class="translated">跟在 <a class="reference internal" href="../reference/compound_stmts.html#else"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">else</span></code></a> 块后的 <a class="reference internal" href="../reference/compound_stmts.html#elif"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">elif</span></code></a> 语句现在会触发特定的错误提示。（由 Steele Farnsworth 在 <a class="reference external" href="https://github.com/python/cpython/issues/129902">gh-129902</a> 中贡献。）</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">who</span> <span class="o">==</span> <span class="s2">&quot;me&quot;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It&#39;s me!&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It&#39;s not me!&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">elif</span> <span class="n">who</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Who is it?&quot;</span><span class="p">)</span>
<span class="go">File &quot;&lt;stdin&gt;&quot;, line 5</span>
<span class="go">  elif who is None:</span>
<span class="go">  ^^^^</span>
<span class="go">SyntaxError: &#39;elif&#39; block follows an &#39;else&#39; block</span>
</pre></div>
</div>
</li>
<li><p class="translated">如果一条语句被传到 <a class="reference internal" href="../reference/compound_stmts.html#else"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">else</span></code></a> 之后的 <a class="reference internal" href="../reference/expressions.html#if-expr"><span class="std std-ref">条件表达式</span></a>，或者 <a class="reference internal" href="../reference/simple_stmts.html#pass"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">pass</span></code></a>, <a class="reference internal" href="../reference/simple_stmts.html#break"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">break</span></code></a> 或 <a class="reference internal" href="../reference/simple_stmts.html#continue"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">continue</span></code></a> 之一被传到 <a class="reference internal" href="../reference/compound_stmts.html#if"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">if</span></code></a> 之前，那么错误消息会高亮需要 <a class="reference internal" href="../reference/expressions.html#grammar-token-python-grammar-expression"><code class="xref std std-token docutils literal notranslate"><span class="pre">expression</span></code></a> 的位置。 （由 Sergey Miryanov 在 <a class="reference external" href="https://github.com/python/cpython/issues/129515">gh-129515</a> 中贡献。）（.)</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="kc">True</span> <span class="k">else</span> <span class="k">pass</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;string&gt;&quot;</span>, line <span class="m">1</span>
<span class="w">    </span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="kc">True</span> <span class="k">else</span> <span class="k">pass</span>
<span class="w">                       </span><span class="pm">^^^^</span>
<span class="gr">SyntaxError</span>: <span class="n">expected expression after &#39;else&#39;, but statement is given</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="k">continue</span> <span class="k">if</span> <span class="kc">True</span> <span class="k">else</span> <span class="k">break</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;string&gt;&quot;</span>, line <span class="m">1</span>
<span class="w">    </span><span class="n">x</span> <span class="o">=</span> <span class="k">continue</span> <span class="k">if</span> <span class="kc">True</span> <span class="k">else</span> <span class="k">break</span>
<span class="w">        </span><span class="pm">^^^^^^^^</span>
<span class="gr">SyntaxError</span>: <span class="n">expected expression before &#39;if&#39;, but statement is given</span>
</pre></div>
</div>
</li>
<li><p class="translated">当检测到未正确闭合的字符串时，错误消息会提示该字符串可能是字符串的一部分。（由 Pablo Galindo 在 <a class="reference external" href="https://github.com/python/cpython/issues/88535">gh-88535</a> 中贡献。）</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;The interesting object &quot;</span><span class="n">The</span> <span class="n">important</span> <span class="nb">object</span><span class="s2">&quot; is very important&quot;</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">SyntaxError</span>: <span class="n">invalid syntax. Is this intended to be part of the string?</span>
</pre></div>
</div>
</li>
<li><p class="translated">当字符串前缀不兼容时，错误提示现在会明确显示哪些前缀存在冲突。（由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/133197">gh-133197</a> 中贡献。）</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ub</span><span class="s1">&#39;abc&#39;</span>
  File <span class="nb">&quot;&lt;python-input-0&gt;&quot;</span>, line <span class="m">1</span>
<span class="w">    </span><span class="n">ub</span><span class="s1">&#39;abc&#39;</span>
<span class="w">    </span><span class="pm">^^</span>
<span class="gr">SyntaxError</span>: <span class="n">&#39;u&#39; and &#39;b&#39; prefixes are incompatible</span>
</pre></div>
</div>
</li>
<li><p class="translated">在以下场景中使用不兼容目标的 as 语句时，错误提示已得到改进：</p>
<ul class="simple">
<li><p class="translated">导入：<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">...</span> <span class="pre">as</span> <span class="pre">...</span></code></p></li>
<li><p class="translated">From 导入：<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">...</span> <span class="pre">import</span> <span class="pre">...</span> <span class="pre">as</span> <span class="pre">...</span></code></p></li>
<li><p class="translated">Except 处理器：<code class="docutils literal notranslate"><span class="pre">except</span> <span class="pre">...</span> <span class="pre">as</span> <span class="pre">...</span></code></p></li>
<li><p class="translated">模式匹配 case 语句：<code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">...</span> <span class="pre">as</span> <span class="pre">...</span></code></p></li>
</ul>
<p class="translated">（由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/123539">gh-123539</a>、<a class="reference external" href="https://github.com/python/cpython/issues/123562">gh-123562</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/123440">gh-123440</a> 中贡献。）</p>
</li>
<li><p class="translated">尝试向 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> 或 <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> 添加不可哈希类型的实例时，错误提示信息已改进。（由 CF Bolz-Tereick 和 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/132828">gh-132828</a> 中贡献。）</p>
<div class="translated highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">({</span><span class="s1">&#39;pages&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;python-input-1&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">({</span><span class="s1">&#39;pages&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">})</span>
<span class="w">    </span><span class="pm">~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
<span class="gr">TypeError</span>: <span class="n">cannot use &#39;dict&#39; as a set element (unhashable type: &#39;dict&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;python-input-4&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="n">d</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="w">    </span><span class="pm">~^^^</span>
<span class="gr">TypeError</span>: <span class="n">cannot use &#39;list&#39; as a dict key (unhashable type: &#39;list&#39;)</span>
</pre></div>
</div>
</li>
<li><p class="translated">当使用 <a class="reference internal" href="../reference/compound_stmts.html#async-with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span></code></a> 而非 <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> 进入支持同步上下文管理器协议的对象时，错误提示信息已改进。反之，对于异步上下文管理器协议的情况也做了相应优化。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/128398">gh-128398</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pep-784-zstandard-support-in-the-standard-library">
<span id="whatsnew314-zstandard"></span><h3 class="translated"><span class="target" id="index-117"></span><a class="pep reference external" href="https://peps.python.org/pep-0784/"><strong>PEP 784</strong></a>: 标准库中的 Zstandard 支持support in the standard library<a class="headerlink" href="#pep-784-zstandard-support-in-the-standard-library" title="Link to this heading">¶</a></h3>
<p class="translated">新增的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression</span></code> 包内包含了 <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.lzma</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.bz2</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.gzip</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.zlib</span></code> 等模块，它们分别重新导出了 <a class="reference internal" href="../library/lzma.html#module-lzma" title="lzma: A Python wrapper for the liblzma compression library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">lzma</span></code></a>, <a class="reference internal" href="../library/bz2.html#module-bz2" title="bz2: Interfaces for bzip2 compression and decompression."><code class="xref py py-mod docutils literal notranslate"><span class="pre">bz2</span></code></a>, <a class="reference internal" href="../library/gzip.html#module-gzip" title="gzip: Interfaces for gzip compression and decompression using file objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gzip</span></code></a> 和 <a class="reference internal" href="../library/zlib.html#module-zlib" title="zlib: Low-level interface to compression and decompression routines compatible with gzip."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zlib</span></code></a> 模块。 在 <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression</span></code> 之下的新增导入名称自 Python 3.14 起成为这些压缩模块的建议导入名称。 不过，现有的模块名称尚未被弃用。  任何对现有压缩模块的弃用或移除都不会早于 3.14 发布五年之后。</p>
<p class="translated">新引入的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.zstd</span></code> 模块通过绑定 <a class="reference external" href="https://facebook.github.io/zstd/">Meta的zstd库</a> 提供了Zstandard格式的压缩和解压API。Zstandard是一种被广泛采用、高效且快速的压缩格式。除了 <code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.zstd</span></code> 中引入的API外，对Zstandard压缩归档文件的读写支持也已添加到 <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a>、<a class="reference internal" href="../library/zipfile.html#module-zipfile" title="zipfile: Read and write ZIP-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a> 和 <a class="reference internal" href="../library/shutil.html#module-shutil" title="shutil: High-level file operations, including copying."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a> 模块中。</p>
<p class="translated">下面是一个使用新模块压缩数据的示例：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">compression</span><span class="w"> </span><span class="kn">import</span> <span class="n">zstd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">*</span> <span class="mi">20</span>
<span class="n">compressed</span> <span class="o">=</span> <span class="n">zstd</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Achieved compression ratio of </span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="translated">可以看出，该API与 <code class="xref py py-mod docutils literal notranslate"><span class="pre">lzma</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">bz2</span></code> 模块的API类似。</p>
<p class="translated">（由 Emma Harper Smith、Adam Turner、Gregory P. Smith、Tomas Roun、Victor Stinner 和 Rogdham 在 <a class="reference external" href="https://github.com/python/cpython/issues/132983">gh-132983</a> 中贡献。）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-195"></span><a class="pep reference external" href="https://peps.python.org/pep-0784/"><strong>PEP 784</strong></a>。</p>
</div>
</section>
<section id="asyncio-introspection-capabilities">
<span id="whatsnew314-asyncio-introspection"></span><h3 class="translated">asyncio 内省能力<a class="headerlink" href="#asyncio-introspection-capabilities" title="Link to this heading">¶</a></h3>
<p class="translated">新增了一个使用异步任务来检查正在运行的 Python 进程的命令行界面，可通过 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">asyncio</span> <span class="pre">ps</span> <span class="pre">PID</span></code> 或 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">asyncio</span> <span class="pre">pstree</span> <span class="pre">PID</span></code> 来使用。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">ps</span></code> 子命令会检查给定的进程 ID (PID) 并显示有关当前运行的 asyncio 任务的信息。 它将输出一个任务表格：以扁平列表显示所有任务、任务名称、任务协程栈以及有哪些任务正在等待它们。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">pstree</span></code> 子命令获取同样的信息，但改用可视化的 async 调用树形式渲染，以层级格式显示协程关系。 此命令特别适用于调试长时间运行的或卡住的异步程序。 它能帮助开发者快速识别程序阻塞位置、待处理的任务以及协程是如何链接起来的。</p>
<p class="translated">例如给定以下代码：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">play_track</span><span class="p">(</span><span class="n">track</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;🎵 Finished: </span><span class="si">{</span><span class="n">track</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">play_album</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tracks</span><span class="p">):</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TaskGroup</span><span class="p">()</span> <span class="k">as</span> <span class="n">tg</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">:</span>
            <span class="n">tg</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">play_track</span><span class="p">(</span><span class="n">track</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">track</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TaskGroup</span><span class="p">()</span> <span class="k">as</span> <span class="n">tg</span><span class="p">:</span>
        <span class="n">tg</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
          <span class="n">play_album</span><span class="p">(</span><span class="s1">&#39;Sundowning&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;TNDNBTG&#39;</span><span class="p">,</span> <span class="s1">&#39;Levitate&#39;</span><span class="p">]),</span>
          <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Sundowning&#39;</span><span class="p">)</span>
        <span class="n">tg</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
          <span class="n">play_album</span><span class="p">(</span><span class="s1">&#39;TMBTE&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;DYWTYLM&#39;</span><span class="p">,</span> <span class="s1">&#39;Aqua Regia&#39;</span><span class="p">]),</span>
          <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TMBTE&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
<p class="translated">在运行中的进程上执行该新工具将生成如下表格：</p>
<div class="translated highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>asyncio<span class="w"> </span>ps<span class="w"> </span><span class="m">12345</span>

tid<span class="w">        </span>task<span class="w"> </span>id<span class="w">              </span>task<span class="w"> </span>name<span class="w">            </span>coroutine<span class="w"> </span>stack<span class="w">                                    </span>awaiter<span class="w"> </span>chain<span class="w">                                      </span>awaiter<span class="w"> </span>name<span class="w">    </span>awaiter<span class="w"> </span>id
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
<span class="m">1935500</span><span class="w">    </span>0x7fc930c18050<span class="w">       </span>Task-1<span class="w">               </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>main<span class="w">                                                                       </span>0x0
<span class="m">1935500</span><span class="w">    </span>0x7fc930c18230<span class="w">       </span>Sundowning<span class="w">           </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>album<span class="w">   </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>main<span class="w">    </span>Task-1<span class="w">          </span>0x7fc930c18050
<span class="m">1935500</span><span class="w">    </span>0x7fc93173fa50<span class="w">       </span>TMBTE<span class="w">                </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>album<span class="w">   </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>main<span class="w">    </span>Task-1<span class="w">          </span>0x7fc930c18050
<span class="m">1935500</span><span class="w">    </span>0x7fc93173fdf0<span class="w">       </span>TNDNBTG<span class="w">              </span>sleep<span class="w"> </span>-&gt;<span class="w"> </span>play<span class="w">                                      </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>album<span class="w">   </span>Sundowning<span class="w">      </span>0x7fc930c18230
<span class="m">1935500</span><span class="w">    </span>0x7fc930d32510<span class="w">       </span>Levitate<span class="w">             </span>sleep<span class="w"> </span>-&gt;<span class="w"> </span>play<span class="w">                                      </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>album<span class="w">   </span>Sundowning<span class="w">      </span>0x7fc930c18230
<span class="m">1935500</span><span class="w">    </span>0x7fc930d32890<span class="w">       </span>DYWTYLM<span class="w">              </span>sleep<span class="w"> </span>-&gt;<span class="w"> </span>play<span class="w">                                      </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>album<span class="w">   </span>TMBTE<span class="w">           </span>0x7fc93173fa50
<span class="m">1935500</span><span class="w">    </span>0x7fc93161ec30<span class="w">       </span>Aqua<span class="w"> </span>Regia<span class="w">           </span>sleep<span class="w"> </span>-&gt;<span class="w"> </span>play<span class="w">                                      </span>TaskGroup._aexit<span class="w"> </span>-&gt;<span class="w"> </span>TaskGroup.__aexit__<span class="w"> </span>-&gt;<span class="w"> </span>album<span class="w">   </span>TMBTE<span class="w">           </span>0x7fc93173fa50
</pre></div>
</div>
<p class="translated">或生成如下树状结构：</p>
<div class="translated highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>asyncio<span class="w"> </span>pstree<span class="w"> </span><span class="m">12345</span>

└──<span class="w"> </span><span class="o">(</span>T<span class="o">)</span><span class="w"> </span>Task-1
<span class="w">    </span>└──<span class="w">  </span>main<span class="w"> </span>example.py:13
<span class="w">        </span>└──<span class="w">  </span>TaskGroup.__aexit__<span class="w"> </span>Lib/asyncio/taskgroups.py:72
<span class="w">            </span>└──<span class="w">  </span>TaskGroup._aexit<span class="w"> </span>Lib/asyncio/taskgroups.py:121
<span class="w">                </span>├──<span class="w"> </span><span class="o">(</span>T<span class="o">)</span><span class="w"> </span>Sundowning
<span class="w">                </span>│<span class="w">   </span>└──<span class="w">  </span>album<span class="w"> </span>example.py:8
<span class="w">                </span>│<span class="w">       </span>└──<span class="w">  </span>TaskGroup.__aexit__<span class="w"> </span>Lib/asyncio/taskgroups.py:72
<span class="w">                </span>│<span class="w">           </span>└──<span class="w">  </span>TaskGroup._aexit<span class="w"> </span>Lib/asyncio/taskgroups.py:121
<span class="w">                </span>│<span class="w">               </span>├──<span class="w"> </span><span class="o">(</span>T<span class="o">)</span><span class="w"> </span>TNDNBTG
<span class="w">                </span>│<span class="w">               </span>│<span class="w">   </span>└──<span class="w">  </span>play<span class="w"> </span>example.py:4
<span class="w">                </span>│<span class="w">               </span>│<span class="w">       </span>└──<span class="w">  </span>sleep<span class="w"> </span>Lib/asyncio/tasks.py:702
<span class="w">                </span>│<span class="w">               </span>└──<span class="w"> </span><span class="o">(</span>T<span class="o">)</span><span class="w"> </span>Levitate
<span class="w">                </span>│<span class="w">                   </span>└──<span class="w">  </span>play<span class="w"> </span>example.py:4
<span class="w">                </span>│<span class="w">                       </span>└──<span class="w">  </span>sleep<span class="w"> </span>Lib/asyncio/tasks.py:702
<span class="w">                </span>└──<span class="w"> </span><span class="o">(</span>T<span class="o">)</span><span class="w"> </span>TMBTE
<span class="w">                    </span>└──<span class="w">  </span>album<span class="w"> </span>example.py:8
<span class="w">                        </span>└──<span class="w">  </span>TaskGroup.__aexit__<span class="w"> </span>Lib/asyncio/taskgroups.py:72
<span class="w">                            </span>└──<span class="w">  </span>TaskGroup._aexit<span class="w"> </span>Lib/asyncio/taskgroups.py:121
<span class="w">                                </span>├──<span class="w"> </span><span class="o">(</span>T<span class="o">)</span><span class="w"> </span>DYWTYLM
<span class="w">                                </span>│<span class="w">   </span>└──<span class="w">  </span>play<span class="w"> </span>example.py:4
<span class="w">                                </span>│<span class="w">       </span>└──<span class="w">  </span>sleep<span class="w"> </span>Lib/asyncio/tasks.py:702
<span class="w">                                </span>└──<span class="w"> </span><span class="o">(</span>T<span class="o">)</span><span class="w"> </span>Aqua<span class="w"> </span>Regia
<span class="w">                                    </span>└──<span class="w">  </span>play<span class="w"> </span>example.py:4
<span class="w">                                        </span>└──<span class="w">  </span>sleep<span class="w"> </span>Lib/asyncio/tasks.py:702
</pre></div>
</div>
<p class="translated">当检测到异步等待图中存在循环引用（可能表明存在编程问题）时，该工具将报错并列出阻碍树形结构构建的循环路径：</p>
<div class="translated highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>asyncio<span class="w"> </span>pstree<span class="w"> </span><span class="m">12345</span>

ERROR:<span class="w"> </span>await-graph<span class="w"> </span>contains<span class="w"> </span>cycles<span class="w"> </span>-<span class="w"> </span>cannot<span class="w"> </span>print<span class="w"> </span>a<span class="w"> </span>tree!

cycle:<span class="w"> </span>Task-2<span class="w"> </span>→<span class="w"> </span>Task-3<span class="w"> </span>→<span class="w"> </span>Task-2
</pre></div>
</div>
<p class="translated">（由 Pablo Galindo、 Łukasz Langa、 Yury Selivanov 和 Marta Gomez Macias 在 <a class="reference external" href="https://github.com/python/cpython/issues/91048">gh-91048</a> 中贡献。）</p>
</section>
<section id="concurrent-safe-warnings-control">
<span id="whatsnew314-concurrent-warnings-control"></span><h3 class="translated">并发安全的警告控制<a class="headerlink" href="#concurrent-safe-warnings-control" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../library/warnings.html#warnings.catch_warnings" title="warnings.catch_warnings"><code class="xref py py-class docutils literal notranslate"><span class="pre">warnings.catch_warnings</span></code></a> 上下文管理器将可选择使用一个上下文变量作为警告过滤器。 此特性是通过设置 <a class="reference internal" href="../library/sys.html#sys.flags.context_aware_warnings" title="sys.flags.context_aware_warnings"><code class="xref py py-data docutils literal notranslate"><span class="pre">context_aware_warnings</span></code></a> 旗标来启用的，使用 <code class="docutils literal notranslate"><span class="pre">-X</span></code> 命令行选项或环境变量均可。 当使用 <a class="reference internal" href="../library/warnings.html#warnings.catch_warnings" title="warnings.catch_warnings"><code class="xref py py-class docutils literal notranslate"><span class="pre">catch_warnings</span></code></a> 配合多线程或异步任务时将能给出可预测的警告控制。 该旗标默认在自由线程构建版中为真值而在启用 GIL 的构建版中为假值。</p>
<p class="translated">（由 Neil Schemenauer 和 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/130010">gh-130010</a> 中贡献。）</p>
</section>
</section>
<section id="other-language-changes">
<h2 class="translated">其他语言特性修改<a class="headerlink" href="#other-language-changes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p class="translated">现在Windows平台已支持所有Windows代码页作为 ‘cpXXX’ 编解码器使用。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/123803">gh-123803</a> 中贡献。）</p></li>
<li><p class="translated">实现了符合C99以来C标准规范的实数与复数混合运算规则。（由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/69639">gh-69639</a> 中贡献。）</p></li>
<li><p class="translated">现在将有更多语法错误被检测出来而不受优化和 <a class="reference internal" href="../using/cmdline.html#cmdoption-O"><code class="xref std std-option docutils literal notranslate"><span class="pre">-O</span></code></a> 命令行选项的影响。 这包括向 <code class="docutils literal notranslate"><span class="pre">__debug__</span></code> 写入，<a class="reference internal" href="../reference/expressions.html#await"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">await</span></code></a> 的不正确使用，以及在异步函数之外的异步推导式。 例如，<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-O</span> <span class="pre">-c</span> <span class="pre">'assert</span> <span class="pre">(__debug__</span> <span class="pre">:=</span> <span class="pre">1)'</span></code> 或 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-O</span> <span class="pre">-c</span> <span class="pre">'assert</span> <span class="pre">await</span> <span class="pre">1'</span></code> 现在将产生 <a class="reference internal" href="../library/exceptions.html#SyntaxError" title="SyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxError</span></code></a>。 （由 Irit Katriel 和 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/122245">gh-122245</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/121637">gh-121637</a> 中贡献。）.)</p></li>
<li><p class="translated">当纯C类型派生子类时，若子类未显式重写相关方法，新建类型的C槽位将不再被替换为封装版本。（由 Tomasz Pytel 在 <a class="reference external" href="https://github.com/python/cpython/issues/132284">gh-132284</a> 中贡献。）</p></li>
</ul>
<section id="built-ins">
<h3 class="translated">内置<a class="headerlink" href="#built-ins" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/stdtypes.html#bytes.fromhex" title="bytes.fromhex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bytes.fromhex()</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#bytearray.fromhex" title="bytearray.fromhex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bytearray.fromhex()</span></code></a> 方法现在支持 ASCII 格式的 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 及 <a class="reference internal" href="../glossary.html#term-bytes-like-object"><span class="xref std std-term">字节型对象</span></a> 作为输入参数。（由 Daniel Pope 在 <a class="reference external" href="https://github.com/python/cpython/issues/129349">gh-129349</a> 中贡献。）</p></li>
<li><p class="translated">新增类方法 <a class="reference internal" href="../library/stdtypes.html#float.from_number" title="float.from_number"><code class="xref py py-meth docutils literal notranslate"><span class="pre">float.from_number()</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#complex.from_number" title="complex.from_number"><code class="xref py py-meth docutils literal notranslate"><span class="pre">complex.from_number()</span></code></a>，用于将数值分别转换为 <a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> 或 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a> 类型。若参数不是一个实数则会引发 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/84978">gh-84978</a> 中贡献。）</p></li>
<li><p class="translated">在新式字符串格式化（通过 <a class="reference internal" href="../library/functions.html#format" title="format"><code class="xref py py-func docutils literal notranslate"><span class="pre">format()</span></code></a> 或 <a class="reference internal" href="../reference/lexical_analysis.html#f-strings"><span class="std std-ref">f-字符串</span></a> 实现）的浮点数表示类型中，现支持使用下划线和逗号作为小数部分的千位分隔符。（由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/87790">gh-87790</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a> 函数不再委托给 <a class="reference internal" href="../reference/datamodel.html#object.__trunc__" title="object.__trunc__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__trunc__()</span></code></a>。 希望支持转换为 <code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code> 的类必须实现 <a class="reference internal" href="../reference/datamodel.html#object.__int__" title="object.__int__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__int__()</span></code></a> 或 <a class="reference internal" href="../reference/datamodel.html#object.__index__" title="object.__index__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__index__()</span></code></a>。 （由 Mark Dickinson 在 <a class="reference external" href="https://github.com/python/cpython/issues/119743">gh-119743</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/functions.html#map" title="map"><code class="xref py py-func docutils literal notranslate"><span class="pre">map()</span></code></a> 函数现在新增了一个可选的仅限关键字参数 <em>strict</em> （与 <a class="reference internal" href="../library/functions.html#zip" title="zip"><code class="xref py py-func docutils literal notranslate"><span class="pre">zip()</span></code></a> 类似），用于校验所有可迭代对象长度是否一致。（由 Wannes Boeykens 在 <a class="reference external" href="https://github.com/python/cpython/issues/119793">gh-119793</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/stdtypes.html#memoryview" title="memoryview"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a> 类型现已支持下标，使其成为 <a class="reference internal" href="../glossary.html#term-generic-type"><span class="xref std std-term">generic type</span></a>。 （由 Brian Schubert 在 <a class="reference external" href="https://github.com/python/cpython/issues/126012">gh-126012</a> 中贡献。）</p></li>
<li><p class="translated">在布尔上下文中使用 <a class="reference internal" href="../library/constants.html#NotImplemented" title="NotImplemented"><code class="xref py py-data docutils literal notranslate"><span class="pre">NotImplemented</span></code></a> 现在会引发 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> 异常。该用法自 Python 3.9 起已引发 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> 弃用警告。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/118767">gh-118767</a> 中贡献。）</p></li>
<li><p class="translated">三参数 <a class="reference internal" href="../library/functions.html#pow" title="pow"><code class="xref py py-func docutils literal notranslate"><span class="pre">pow()</span></code></a> 现在会在必要时尝试调用 <a class="reference internal" href="../reference/datamodel.html#object.__rpow__" title="object.__rpow__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__rpow__()</span></code></a> 方法。此前该方法仅在双参数 <code class="xref py py-func docutils literal notranslate"><span class="pre">pow()</span></code> 和二元幂运算符中被调用。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/130104">gh-130104</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/functions.html#super" title="super"><code class="xref py py-class docutils literal notranslate"><span class="pre">super</span></code></a> 对象现在支持 <a class="reference internal" href="../library/copy.html#module-copy" title="copy: Shallow and deep copy operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">复制</span></code></a> 和 <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal notranslate"><span class="pre">序列化</span></code></a> 操作。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/125767">gh-125767</a> 中贡献。）</p></li>
</ul>
</section>
<section id="command-line-and-environment">
<h3 class="translated">命令行与环境<a class="headerlink" href="#command-line-and-environment" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">导入时间分析标志现可通过新增的 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">importtime=2</span></code></a> 选项追踪已加载（'缓存'）模块。当导入此类模块时，<code class="docutils literal notranslate"><span class="pre">self</span></code> 和 <code class="docutils literal notranslate"><span class="pre">cumulative</span></code> 时间值将被替换为字符串 <code class="docutils literal notranslate"><span class="pre">cached</span></code>。</p>
<p class="translated">对 <code class="docutils literal notranslate"><span class="pre">-X</span> <span class="pre">importtime</span></code> 取大于 <code class="docutils literal notranslate"><span class="pre">2</span></code> 的值被保留供未来使用。</p>
<p class="translated">（由 Noah Kim 和 Adam Turner 在 <a class="reference external" href="https://github.com/python/cpython/issues/118655">gh-118655</a> 中贡献。）</p>
</li>
<li><p class="translated">命令行选项 <a class="reference internal" href="../using/cmdline.html#cmdoption-c"><code class="xref std std-option docutils literal notranslate"><span class="pre">-c</span></code></a> 现在会在执行前自动对其代码参数进行去缩进处理，该行为与 <a class="reference internal" href="../library/textwrap.html#textwrap.dedent" title="textwrap.dedent"><code class="xref py py-func docutils literal notranslate"><span class="pre">textwrap.dedent()</span></code></a> 函数保持一致。（由 Jon Crall 和 Steven Sun 在 <a class="reference external" href="https://github.com/python/cpython/issues/103998">gh-103998</a> 中贡献。）</p></li>
<li><p class="translated"><code class="xref std std-option docutils literal notranslate"><span class="pre">-J</span></code> 不再是 <a class="reference external" href="https://www.jython.org/">Jython</a> 的保留标志，目前不具任何特殊含义。（由 Adam Turner 在 <a class="reference external" href="https://github.com/python/cpython/issues/133336">gh-133336</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="pep-758-allow-except-and-except-expressions-without-brackets">
<span id="whatsnew314-bracketless-except"></span><h3 class="translated">PEP 758: 允许不带圆括号的 <code class="docutils literal notranslate"><span class="pre">except</span></code> 和 <code class="docutils literal notranslate"><span class="pre">except*</span></code> 表达式<a class="headerlink" href="#pep-758-allow-except-and-except-expressions-without-brackets" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../reference/compound_stmts.html#except"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">except</span></code></a> 和 <a class="reference internal" href="../reference/compound_stmts.html#except-star"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">except*</span></code></a> 表达式允许存在多个异常类型且未使用 <code class="docutils literal notranslate"><span class="pre">as</span></code> 子句时省略圆括号。 例如：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">connect_to_server</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">,</span> <span class="ne">ConnectionRefusedError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The network has ceased to be!&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="translated">（由 Pablo Galindo 和 Brett Cannon 在 <span class="target" id="index-196"></span><a class="pep reference external" href="https://peps.python.org/pep-0758/"><strong>PEP 758</strong></a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/131831">gh-131831</a> 中贡献。）</p>
</section>
<section id="pep-765-control-flow-in-finally-blocks">
<span id="whatsnew314-finally-syntaxwarning"></span><h3 class="translated">PEP 765: <a class="reference internal" href="../reference/compound_stmts.html#finally"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code></a> 代码块中的控制流<a class="headerlink" href="#pep-765-control-flow-in-finally-blocks" title="Link to this heading">¶</a></h3>
<p class="translated">编译器在检测到 <a class="reference internal" href="../reference/simple_stmts.html#return"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">return</span></code></a>、<a class="reference internal" href="../reference/simple_stmts.html#break"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">break</span></code></a> 或 <a class="reference internal" href="../reference/simple_stmts.html#continue"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">continue</span></code></a> 语句跳出 <a class="reference internal" href="../reference/compound_stmts.html#finally"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code></a> 代码块时，现在将触发 <a class="reference internal" href="../library/exceptions.html#SyntaxWarning" title="SyntaxWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxWarning</span></code></a>。此项变更遵循 <span class="target" id="index-197"></span><a class="pep reference external" href="https://peps.python.org/pep-0765/"><strong>PEP 765</strong></a> 规范。</p>
<p class="translated">在不方便修改的情况下（例如由于代码语法检查导致警告的冗余），可以使用 <a class="reference internal" href="../library/warnings.html#warning-filter"><span class="std std-ref">警告过滤器</span></a> 通过添加 <code class="docutils literal notranslate"><span class="pre">ignore::SyntaxWarning</span></code> 作为过滤器来关闭所有语法警告。 这可以配合一个将其他警告转换为错误的过滤器来指明（例如，传递 <code class="docutils literal notranslate"><span class="pre">-Werror</span> <span class="pre">-Wignore::SyntaxWarning</span></code> 作为 CLI 选项，或者设置 <code class="docutils literal notranslate"><span class="pre">PYTHONWARNINGS=error,ignore::SyntaxWarning</span></code> 等）。</p>
<p class="translated">请注意在运行时使用 <a class="reference internal" href="../library/warnings.html#module-warnings" title="warnings: Issue warning messages and control their disposition."><code class="xref py py-mod docutils literal notranslate"><span class="pre">warnings</span></code></a> 模块应用这样的过滤器仅会屏蔽在过滤器调整 <em>之后</em> 编译的代码中的警告。 在过滤器调整之前编译的代码（例如，当模块被导入时）仍然会发出语法警告。</p>
<p class="translated">（由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/130080">gh-130080</a> 中贡献。）</p>
</section>
<section id="incremental-garbage-collection">
<span id="whatsnew314-incremental-gc"></span><h3 class="translated">增量式垃圾回收<a class="headerlink" href="#incremental-garbage-collection" title="Link to this heading">¶</a></h3>
<p class="translated">循环垃圾回收器现在采用增量式处理。这意味着对于较大的堆内存，最大暂停时间将减少一个数量级或更多。</p>
<p class="translated">现在垃圾回收机制仅包含两个代际：新生代和老年代。当未直接调用 <a class="reference internal" href="../library/gc.html#gc.collect" title="gc.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code></a> 函数时，垃圾回收器的触发频率会稍有降低。而在调用时，它会回收新生代以及部分老年代对象（即增量回收），而非一次性回收一个或多个完整的代际。</p>
<p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code> 函数的行为略有变化：</p>
<ul class="simple">
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">gc.collect(1)</span></code>：执行一次增量式垃圾回收，而非专门回收第1代对象。</p></li>
<li><p class="translated">对 <code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code> 的其他调用保持不变。</p></li>
</ul>
<p class="translated">（由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/108362">gh-108362</a> 中贡献。）</p>
</section>
<section id="default-interactive-shell">
<h3 class="translated">默认的交互式 shell<a class="headerlink" href="#default-interactive-shell" title="Link to this heading">¶</a></h3>
<ul id="whatsnew314-pyrepl-highlighting">
<li><p class="translated">默认的 <a class="reference internal" href="../glossary.html#term-interactive"><span class="xref std std-term">interactive</span></a> shell 现已支持 Python 语法高亮。 此特性默认启用，除非设置了 <span class="target" id="index-198"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_BASIC_REPL"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_BASIC_REPL</span></code></a> 或任何其他禁用颜色的环境变量。 请参阅 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">控制颜色</span></a> 了解详情。</p>
<p class="translated">语法高亮的默认配色主题追求高对比度并仅使用 4 位 VGA 标准 ANSI 颜色代码以保证全大兼容性。 可以使用实验性的 API <code class="xref py py-func docutils literal notranslate"><span class="pre">_colorize.set_theme()</span></code> 来自定义配色主题。 此函数可以交互式地调用或是在 <span class="target" id="index-199"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONSTARTUP"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONSTARTUP</span></code></a> 脚本中调用。 请注意此函数没有稳定性保证，可能被修改或者移除。</p>
<p class="translated">（由 Łukasz Langa 在 <a class="reference external" href="https://github.com/python/cpython/issues/131507">gh-131507</a> 中贡献。）</p>
</li>
<li><p class="translated">默认的 <a class="reference internal" href="../glossary.html#term-interactive"><span class="xref std std-term">interactive</span></a> shell 现已支持导入自动补全。 这意味着当键入 <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">co</span></code> 并按下 <kbd class="kbd docutils literal notranslate">&lt;Tab&gt;</kbd> 时将会提示以 <code class="docutils literal notranslate"><span class="pre">co</span></code> 打头的模块。 类似地，键入 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">concurrent</span> <span class="pre">import</span> <span class="pre">i</span></code> 将会提示以 <code class="docutils literal notranslate"><span class="pre">i</span></code> 打头的 <code class="docutils literal notranslate"><span class="pre">concurrent</span></code> 子模块。 请注意模块属性的自动补全目前尚未受到支持。 （由 Tomas Roun 在 <a class="reference external" href="https://github.com/python/cpython/issues/69605">gh-69605</a> 中贡献。）.)</p></li>
</ul>
</section>
</section>
<section id="new-modules">
<h2 class="translated">新增模块<a class="headerlink" href="#new-modules" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/annotationlib.html#module-annotationlib" title="annotationlib: Functionality for introspecting annotations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">annotationlib</span></code></a>: 用于对 <a class="reference internal" href="../glossary.html#term-annotation"><span class="xref std std-term">标注</span></a> 进行内省。 请参阅 <a class="reference internal" href="#whatsnew314-deferred-annotations"><span class="std std-ref">PEP 749</span></a> 了解详情。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/119180">gh-119180</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/compression.html#module-compression" title="compression"><code class="xref py py-mod docutils literal notranslate"><span class="pre">compression</span></code></a> (包括 <a class="reference internal" href="../library/compression.zstd.html#module-compression.zstd" title="compression.zstd: Low-level interface to compression and decompression routines in the zstd library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">compression.zstd</span></code></a>): 针对压缩相关模块的包，包括一个支持 Zstandard 压缩格式的新模块。 请参阅 <a class="reference internal" href="#whatsnew314-zstandard"><span class="std std-ref">PEP 784</span></a> 了解详情。 （由 Emma Harper Smith, Adam Turner, Gregory P. Smith, Tomas Roun, Victor Stinner 和 Rogdham 在 <a class="reference external" href="https://github.com/python/cpython/issues/132983">gh-132983</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/concurrent.interpreters.html#module-concurrent.interpreters" title="concurrent.interpreters: Multiple interpreters in the same process"><code class="xref py py-mod docutils literal notranslate"><span class="pre">concurrent.interpreters</span></code></a>: 在标准库中支持多解释器。 请参阅 <a class="reference internal" href="#whatsnew314-multiple-interpreters"><span class="std std-ref">PEP 734</span></a> 了解详情。 （由 Eric Snow 在 <a class="reference external" href="https://github.com/python/cpython/issues/134939">gh-134939</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/string.templatelib.html#module-string.templatelib" title="string.templatelib: Support for template string literals."><code class="xref py py-mod docutils literal notranslate"><span class="pre">string.templatelib</span></code></a>: 对模板字符串字面值（t-字符串）的支持。 详情参见 <a class="reference internal" href="#whatsnew314-template-string-literals"><span class="std std-ref">PEP 750</span></a>。 （由 Jim Baker, Guido van Rossum, Paul Everitt, Koudai Aono, Lysandros Nikolaou, Dave Peck, Adam Turner, Jelle Zijlstra, Bénédikt Tran 和 Pablo Galindo Salgado 在 <a class="reference external" href="https://github.com/python/cpython/issues/132661">gh-132661</a> 中贡献。）</p></li>
</ul>
</section>
<section id="improved-modules">
<h2 class="translated">改进的模块<a class="headerlink" href="#improved-modules" title="Link to this heading">¶</a></h2>
<section id="argparse">
<h3 class="translated">argparse<a class="headerlink" href="#argparse" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser" title="argparse.ArgumentParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.ArgumentParser</span></code></a> 的 <a class="reference internal" href="../library/argparse.html#prog"><span class="std std-ref">程序名称</span></a> 默认值现在会反映 Python 解释器定位 <code class="docutils literal notranslate"><span class="pre">__main__</span></code> 模块代码的方式。（由 Serhiy Storchaka 和 Alyssa Coghlan 在 <a class="reference external" href="https://github.com/python/cpython/issues/66436">gh-66436</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser" title="argparse.ArgumentParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.ArgumentParser</span></code></a> 新增可选形参 <em>suggest_on_error</em>，可在用户输入错误时提供参数选项及子解析器名称的建议。（由 Savannah Ostrowski 在 <a class="reference external" href="https://github.com/python/cpython/issues/124456">gh-124456</a> 中贡献。）</p></li>
<li><p class="translated">为帮助文本启用颜色显示，你可以通过向 <a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser" title="argparse.ArgumentParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.ArgumentParser</span></code></a> 传递可选的 <em>color</em> 形参来禁用此功能。此外，该功能还可以通过 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">环境变量</span></a> 进行控制。（由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/130645">gh-130645</a> 中贡献。）</p></li>
</ul>
</section>
<section id="ast">
<h3 class="translated">ast（抽象语法树）<a class="headerlink" href="#ast" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/ast.html#ast.compare" title="ast.compare"><code class="xref py py-func docutils literal notranslate"><span class="pre">compare()</span></code></a> 函数用于比较两个 AST。 （由 Batuhan Taskaya 和 Jeremy Hylton 在 <a class="reference external" href="https://github.com/python/cpython/issues/60191">gh-60191</a> 中贡献。）</p></li>
<li><p class="translated">新增对AST节点 <a class="reference internal" href="../library/copy.html#copy.replace" title="copy.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy.replace()</span></code></a> 操作的支持。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/121141">gh-121141</a> 中贡献。）</p></li>
<li><p class="translated">在优化级别为2时，文档字符串现会从优化后的AST中移除。（由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/123958">gh-123958</a> 中贡献。）</p></li>
<li><p class="translated">现在 AST 节点的 <a class="reference internal" href="../library/functions.html#repr" title="repr"><code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code></a> 输出会包含更多信息。 （由 Tomas Roun 在 <a class="reference external" href="https://github.com/python/cpython/issues/116022">gh-116022</a> 中贡献。）</p></li>
<li><p class="translated">在调用时附带 AST 作为输入时，<a class="reference internal" href="../library/ast.html#ast.parse" title="ast.parse"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse()</span></code></a> 函数现在总是会验证根节点类型是否合规。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/130139">gh-130139</a> 中贡献。）</p></li>
<li><p class="translated">为命令行界面添加新的选项: <a class="reference internal" href="../library/ast.html#cmdoption-ast-feature-version"><code class="xref std std-option docutils literal notranslate"><span class="pre">--feature-version</span></code></a>, <a class="reference internal" href="../library/ast.html#cmdoption-ast-optimize"><code class="xref std std-option docutils literal notranslate"><span class="pre">--optimize</span></code></a> 和 <a class="reference internal" href="../library/ast.html#cmdoption-ast-show-empty"><code class="xref std std-option docutils literal notranslate"><span class="pre">--show-empty</span></code></a>。 （由 Semyon Moroz 在 <a class="reference external" href="https://github.com/python/cpython/issues/133367">gh-133367</a> 中贡献。）</p></li>
</ul>
</section>
<section id="asyncio">
<h3 class="translated">asyncio<a class="headerlink" href="#asyncio" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">名为 <code class="xref py py-func docutils literal notranslate"><span class="pre">create_task()</span></code> 的函数及方法现在接受任意关键字参数列表，所有关键字参数都将传递给 <a class="reference internal" href="../library/asyncio-task.html#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> 构造器或自定义任务工厂（详见 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.set_task_factory" title="asyncio.loop.set_task_factory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_task_factory()</span></code></a>）。<code class="docutils literal notranslate"><span class="pre">name</span></code> 和 <code class="docutils literal notranslate"><span class="pre">context</span></code> 关键字参数不再具有特殊处理逻辑——名称现在应通过工厂的 <code class="docutils literal notranslate"><span class="pre">name</span></code> 关键字参数设置，而 <code class="docutils literal notranslate"><span class="pre">context</span></code> 可设为 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p>
<p class="translated">这会影响下列函数和方法: <a class="reference internal" href="../library/asyncio-task.html#asyncio.create_task" title="asyncio.create_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.create_task()</span></code></a>, <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.create_task" title="asyncio.loop.create_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.loop.create_task()</span></code></a>, <a class="reference internal" href="../library/asyncio-task.html#asyncio.TaskGroup.create_task" title="asyncio.TaskGroup.create_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.TaskGroup.create_task()</span></code></a>。</p>
<p class="translated">（由 Thomas Grainger 在 <a class="reference external" href="https://github.com/python/cpython/issues/128307">gh-128307</a> 中贡献。）</p>
</li>
<li><p class="translated">新增两个工具函数用于内省和打印程序的调用图: <a class="reference internal" href="../library/asyncio-graph.html#asyncio.capture_call_graph" title="asyncio.capture_call_graph"><code class="xref py py-func docutils literal notranslate"><span class="pre">capture_call_graph()</span></code></a> 和 <a class="reference internal" href="../library/asyncio-graph.html#asyncio.print_call_graph" title="asyncio.print_call_graph"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_call_graph()</span></code></a>。 请参阅 <a class="reference internal" href="#whatsnew314-asyncio-introspection"><span class="std std-ref">Asyncio 内省功能</span></a> 了解详情。 （由 Yury Selivanov, Pablo Galindo Salgado 和 Łukasz Langa 在 <a class="reference external" href="https://github.com/python/cpython/issues/91048">gh-91048</a> 中贡献。）</p></li>
</ul>
</section>
<section id="calendar">
<h3 class="translated">calendar（日历）<a class="headerlink" href="#calendar" title="Link to this heading">¶</a></h3>
<ul class="simple" id="whatsnew314-color-calendar">
<li><p class="translated">默认情况下，<a class="reference internal" href="../library/calendar.html#module-calendar" title="calendar: Functions for working with calendars, including some emulation of the Unix cal program."><code class="xref py py-mod docutils literal notranslate"><span class="pre">calendar</span></code></a> 模块的 <a class="reference internal" href="../library/calendar.html#calendar-cli"><span class="std std-ref">命令行</span></a> 文本输出会以彩色高亮显示当日日期，该功能可通过 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">环境变量</span></a> 控制。（由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/128317">gh-128317</a> 中贡献。）</p></li>
</ul>
</section>
<section id="concurrent-futures">
<h3 class="translated">concurrent.futures<a class="headerlink" href="#concurrent-futures" title="Link to this heading">¶</a></h3>
<ul id="whatsnew314-concurrent-futures-interp-pool">
<li><p class="translated">新增一个执行器类 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.InterpreterPoolExecutor" title="concurrent.futures.InterpreterPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterpreterPoolExecutor</span></code></a>，它会将同一个进程中的多个 Python 解释器 ('子解释器') 暴露给 Python 代码。 它会使用一个独立的 Python 解释器池来异步地执行调用。</p>
<p class="translated">此特性是从 <a class="reference internal" href="#whatsnew314-multiple-interpreters"><span class="std std-ref">PEP 734</span></a> 引入的新增模块 <a class="reference internal" href="../library/concurrent.interpreters.html#module-concurrent.interpreters" title="concurrent.interpreters: Multiple interpreters in the same process"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interpreters</span></code></a> 中分离出来的。 （由 Eric Snow 在 <a class="reference external" href="https://github.com/python/cpython/issues/124548">gh-124548</a> 中贡献。）</p>
</li>
</ul>
<ul id="whatsnew314-concurrent-futures-start-method">
<li><p class="translated">在 macOS 以外的 Unix 平台上，<a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-method-forkserver"><span class="std std-ref">'forkserver'</span></a> 现在是用于 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor" title="concurrent.futures.ProcessPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessPoolExecutor</span></code></a> 的默认 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-methods"><span class="std std-ref">启动方法</span></a> (替代 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-method-fork"><span class="std std-ref">'fork'</span></a>)。 此项更改不会影响 Windows 或 macOS，在这两个平台上 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-method-spawn"><span class="std std-ref">'spawn'</span></a> 仍是默认启动方法。</p>
<p class="translated">如需使用与线程不兼容的 <em>fork</em> 启动方法，必须通过向 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor" title="concurrent.futures.ProcessPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessPoolExecutor</span></code></a> 提供 <em>mp_context</em> 多进程上下文参数来显式指定。</p>
<p class="translated">请参阅 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-programming-forkserver"><span class="std std-ref">forkserver 限制说明</span></a> 了解与 <em>fork</em> 方法的差异信息，以及此项变更对存在以下情况的现有代码可能产生的影响：(1) 使用可变全局共享变量 (2) 包含无法被 <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> 自动序列化的共享对象。</p>
<p class="translated">（由 Gregory P. Smith 在 <a class="reference external" href="https://github.com/python/cpython/issues/84559">gh-84559</a> 中贡献）</p>
</li>
<li><p class="translated">为 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor" title="concurrent.futures.ProcessPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessPoolExecutor</span></code></a> 增加两个新方法，<a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor.terminate_workers" title="concurrent.futures.ProcessPoolExecutor.terminate_workers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">terminate_workers()</span></code></a> 和 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor.kill_workers" title="concurrent.futures.ProcessPoolExecutor.kill_workers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kill_workers()</span></code></a>，作为终结或杀掉给定进程池中所有存活工作进程的方法。 （由 Charles Machalow 在 <a class="reference external" href="https://github.com/python/cpython/issues/130849">gh-130849</a> 中贡献。）</p></li>
<li><p class="translated">为 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.Executor.map" title="concurrent.futures.Executor.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Executor.map</span></code></a> 增加可选的 <em>buffersize</em> 形参用来限制已提交但尚未产生结果的任务数量。 如果缓冲区已满，对 <em>iterables</em> 的迭代将暂停直到缓冲区产生一个结果。 （由 Enzo Bonnal 和 Josh Rosenberg 在 <a class="reference external" href="https://github.com/python/cpython/issues/74028">gh-74028</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="configparser">
<h3 class="translated">configparser<a class="headerlink" href="#configparser" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><code class="xref py py-mod docutils literal notranslate"><span class="pre">configparser</span></code> 将不再写入它无法读取的配置文件，以提升安全性。 尝试使用 <a class="reference internal" href="../library/configparser.html#configparser.ConfigParser.write" title="configparser.ConfigParser.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> 写入包含定界符或以节标头模式开头的键将会引发 <a class="reference internal" href="../library/configparser.html#configparser.InvalidWriteError" title="configparser.InvalidWriteError"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidWriteError</span></code></a>。 （由 Jacob Lincoln 在 <a class="reference external" href="https://github.com/python/cpython/issues/129270">gh-129270</a> 中贡献。）</p></li>
</ul>
</section>
<section id="contextvars">
<h3 class="translated">contextvars<a class="headerlink" href="#contextvars" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">已为 <a class="reference internal" href="../library/contextvars.html#contextvars.Token" title="contextvars.Token"><code class="xref py py-class docutils literal notranslate"><span class="pre">Token</span></code></a> 对象提供 <a class="reference internal" href="../glossary.html#term-context-manager"><span class="xref std std-term">context manager</span></a> 协议支持。 （由 Andrew Svetlov 在 <a class="reference external" href="https://github.com/python/cpython/issues/129889">gh-129889</a> 中贡献。）</p></li>
</ul>
</section>
<section id="ctypes">
<h3 class="translated">ctypes<a class="headerlink" href="#ctypes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">现在 <a class="reference internal" href="../library/ctypes.html#ctypes.Structure" title="ctypes.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a> 和 <a class="reference internal" href="../library/ctypes.html#ctypes.Union" title="ctypes.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">Union</span></code></a> 对象中的 <a class="reference internal" href="../library/ctypes.html#ctypes-bit-fields-in-structures-unions"><span class="std std-ref">位字段</span></a> 现在将更紧密地匹配平台默认值 (GCC/Clang 或 MSVC)。 具体而言，字段间不会再出现重叠。 （由 Matthias Görgens 在 <a class="reference external" href="https://github.com/python/cpython/issues/97702">gh-97702</a> 中贡献。）</p></li>
<li><p class="translated">现在可通过设置 <a class="reference internal" href="../library/ctypes.html#ctypes.Structure._layout_" title="ctypes.Structure._layout_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Structure._layout_</span></code></a> 类属性来匹配非默认ABI。（由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/97702">gh-97702</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ctypes.html#ctypes.Structure" title="ctypes.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a>/<a class="reference internal" href="../library/ctypes.html#ctypes.Union" title="ctypes.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">Union</span></code></a> 的字段描述符类现以 <a class="reference internal" href="../library/ctypes.html#ctypes.CField" title="ctypes.CField"><code class="xref py py-class docutils literal notranslate"><span class="pre">CField</span></code></a> 形式提供，并新增了辅助调试和内省的属性。（由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/128715">gh-128715</a> 中贡献。）</p></li>
<li><p class="translated">在Windows平台上，<a class="reference internal" href="../library/ctypes.html#ctypes.COMError" title="ctypes.COMError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">COMError</span></code></a> 异常现已公开。（由 Jun Komoda 在 <a class="reference external" href="https://github.com/python/cpython/issues/126686">gh-126686</a> 中贡献。）</p></li>
<li><p class="translated">在Windows平台上，<a class="reference internal" href="../library/ctypes.html#ctypes.CopyComPointer" title="ctypes.CopyComPointer"><code class="xref py py-func docutils literal notranslate"><span class="pre">CopyComPointer()</span></code></a> 函数现已公开。（由 Jun Komoda 在 <a class="reference external" href="https://github.com/python/cpython/issues/127275">gh-127275</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/ctypes.html#ctypes.memoryview_at" title="ctypes.memoryview_at"><code class="xref py py-func docutils literal notranslate"><span class="pre">memoryview_at()</span></code></a> 函数，用于创建一个引用指定的指针和长度的 <a class="reference internal" href="../library/stdtypes.html#memoryview" title="memoryview"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a> 对象。 该函数功能类似于 <a class="reference internal" href="../library/ctypes.html#ctypes.string_at" title="ctypes.string_at"><code class="xref py py-func docutils literal notranslate"><span class="pre">ctypes.string_at()</span></code></a> 但它避免了缓冲区复制，通常适用于实现接受动态大小缓冲区的纯 Python 回调函数。 （由 Rian Hunter 在 <a class="reference external" href="https://github.com/python/cpython/issues/112018">gh-112018</a> 中贡献。）</p></li>
<li><p class="translated">复数类型，<a class="reference internal" href="../library/ctypes.html#ctypes.c_float_complex" title="ctypes.c_float_complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">c_float_complex</span></code></a>, <a class="reference internal" href="../library/ctypes.html#ctypes.c_double_complex" title="ctypes.c_double_complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">c_double_complex</span></code></a> 和 <a class="reference internal" href="../library/ctypes.html#ctypes.c_longdouble_complex" title="ctypes.c_longdouble_complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">c_longdouble_complex</span></code></a> 现已在编译器和 <code class="docutils literal notranslate"><span class="pre">libffi</span></code> 库支持复数 complex C 类型时可用。 （由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/61103">gh-61103</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../library/ctypes.html#ctypes.util.dllist" title="ctypes.util.dllist"><code class="xref py py-func docutils literal notranslate"><span class="pre">ctypes.util.dllist()</span></code></a> 函数，用于列出当前进程已加载的共享库。（由 Brian Ward 在 <a class="reference external" href="https://github.com/python/cpython/issues/119349">gh-119349</a> 中贡献。）</p></li>
<li><p class="translated">将 <a class="reference internal" href="../library/ctypes.html#ctypes.POINTER" title="ctypes.POINTER"><code class="xref py py-func docutils literal notranslate"><span class="pre">ctypes.POINTER()</span></code></a> 类型缓存从全局内部缓存 (<code class="docutils literal notranslate"><span class="pre">_pointer_type_cache</span></code>) 移至对应 <code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code> 类型的 <a class="reference internal" href="../library/ctypes.html#ctypes._CData.__pointer_type__" title="ctypes._CData.__pointer_type__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_CData.__pointer_type__</span></code></a> 属性。 这将防止在某些情况下缓存的无限增长。 （由 Sergey Miryanov 在 <a class="reference external" href="https://github.com/python/cpython/issues/100926">gh-100926</a> 中贡献。）</p></li>
<li><p class="translated">现在 <a class="reference internal" href="../library/ctypes.html#ctypes.py_object" title="ctypes.py_object"><code class="xref py py-class docutils literal notranslate"><span class="pre">py_object</span></code></a> 类型已支持下标，使其成为 <a class="reference internal" href="../glossary.html#term-generic-type"><span class="xref std std-term">generic type</span></a>。 （由 Brian Schubert 在 <a class="reference external" href="https://github.com/python/cpython/issues/132168">gh-132168</a> 中贡献。）</p></li>
<li><p class="translated">现在 <code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code> 已支持 <a class="reference internal" href="../glossary.html#term-free-threading"><span class="xref std std-term">自由线程构建版</span></a>。 （由 Kumar Aditya 和 Peter Bierma 在 <a class="reference external" href="https://github.com/python/cpython/issues/127945">gh-127945</a> 中贡献。）</p></li>
</ul>
</section>
<section id="curses">
<h3 class="translated">curses<a class="headerlink" href="#curses" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/curses.html#curses.assume_default_colors" title="curses.assume_default_colors"><code class="xref py py-func docutils literal notranslate"><span class="pre">assume_default_colors()</span></code></a> 函数，是将 <a class="reference internal" href="../library/curses.html#curses.use_default_colors" title="curses.use_default_colors"><code class="xref py py-func docutils literal notranslate"><span class="pre">use_default_colors()</span></code></a> 函数改进为允许修改颜色对 <code class="docutils literal notranslate"><span class="pre">0</span></code>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/133139">gh-133139</a> 中贡献。）</p></li>
</ul>
</section>
<section id="datetime">
<h3 class="translated">datetime<a class="headerlink" href="#datetime" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">为 <a class="reference internal" href="../library/datetime.html#datetime.date" title="datetime.date"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a> 和 and <a class="reference internal" href="../library/datetime.html#datetime.time" title="datetime.time"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.time</span></code></a> 类增加 <a class="reference internal" href="../library/datetime.html#datetime.date.strptime" title="datetime.date.strptime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strptime()</span></code></a> 方法。 （由 Wannes Boeykens 在 <a class="reference external" href="https://github.com/python/cpython/issues/41431">gh-41431</a> 中贡献。）</p></li>
</ul>
</section>
<section id="decimal">
<h3 class="translated">decimal<a class="headerlink" href="#decimal" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/decimal.html#decimal.Decimal.from_number" title="decimal.Decimal.from_number"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Decimal.from_number()</span></code></a> 作为 <a class="reference internal" href="../library/decimal.html#decimal.Decimal" title="decimal.Decimal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Decimal</span></code></a> 的替代性构造器。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/121798">gh-121798</a> 中贡献。）</p></li>
<li><p class="translated">对外公开 <a class="reference internal" href="../library/decimal.html#decimal.IEEEContext" title="decimal.IEEEContext"><code class="xref py py-func docutils literal notranslate"><span class="pre">IEEEContext()</span></code></a> 以支持创建对应与 IEEE 754 (2008) 十进制交换格式的上下文。 （由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/53032">gh-53032</a> 中贡献。）</p></li>
</ul>
</section>
<section id="difflib">
<h3 class="translated">difflib<a class="headerlink" href="#difflib" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">由 <a class="reference internal" href="../library/difflib.html#difflib.HtmlDiff" title="difflib.HtmlDiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">HtmlDiff</span></code></a> 类生成的高亮显示更改的比较页面现在支持 '黑暗模式'。 （由李佳昊在 <a class="reference external" href="https://github.com/python/cpython/issues/129939">gh-129939</a> 中贡献。）</p></li>
</ul>
</section>
<section id="dis">
<h3 class="translated">dis<a class="headerlink" href="#dis" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">新增对 <a class="reference internal" href="../library/dis.html#dis.Instruction" title="dis.Instruction"><code class="xref py py-class docutils literal notranslate"><span class="pre">指令</span></code></a> 完整源码位置信息（而非仅行号）的渲染支持，该特性通过 <em>show_positions</em> 关键字参数添加到以下接口：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/dis.html#dis.Bytecode" title="dis.Bytecode"><code class="xref py py-class docutils literal notranslate"><span class="pre">dis.Bytecode</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/dis.html#dis.dis" title="dis.dis"><code class="xref py py-func docutils literal notranslate"><span class="pre">dis.dis()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/dis.html#dis.distb" title="dis.distb"><code class="xref py py-func docutils literal notranslate"><span class="pre">dis.distb()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/dis.html#dis.disassemble" title="dis.disassemble"><code class="xref py py-func docutils literal notranslate"><span class="pre">dis.disassemble()</span></code></a></p></li>
</ul>
<p class="translated">该特性同时通过 <a class="reference internal" href="../library/dis.html#cmdoption-dis-P"><code class="xref std std-option docutils literal notranslate"><span class="pre">dis</span> <span class="pre">--show-positions</span></code></a> 命令行选项提供。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/123165">gh-123165</a> 中贡献。）</p>
</li>
<li><p class="translated">新增 <a class="reference internal" href="../library/dis.html#cmdoption-dis-S"><code class="xref std std-option docutils literal notranslate"><span class="pre">dis</span> <span class="pre">--specialized</span></code></a> 命令行选项，用于显示特化字节码。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/127413">gh-127413</a> 中贡献。）</p></li>
</ul>
</section>
<section id="errno">
<h3 class="translated">errno<a class="headerlink" href="#errno" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加了 <a class="reference internal" href="../library/errno.html#errno.EHWPOISON" title="errno.EHWPOISON"><code class="xref py py-data docutils literal notranslate"><span class="pre">EHWPOISON</span></code></a> 错误码常量。 （由 James Roy 在 <a class="reference external" href="https://github.com/python/cpython/issues/126585">gh-126585</a> 中贡献。）</p></li>
</ul>
</section>
<section id="faulthandler">
<h3 class="translated">faulthandler<a class="headerlink" href="#faulthandler" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">通过新的 <a class="reference internal" href="../library/faulthandler.html#faulthandler.dump_c_stack" title="faulthandler.dump_c_stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">dump_c_stack()</span></code></a> 函数或通过 <a class="reference internal" href="../library/faulthandler.html#faulthandler.enable" title="faulthandler.enable"><code class="xref py py-func docutils literal notranslate"><span class="pre">faulthandler.enable()</span></code></a> 中的 <em>c_stack</em> 参数添加在 <a class="reference internal" href="../library/faulthandler.html#c-stack-compatibility"><span class="std std-ref">支持 C 栈回溯</span></a> 的系统上增加打印相应信息的支持。 （由 Peter Bierma 在 <a class="reference external" href="https://github.com/python/cpython/issues/127604">gh-127604</a> 中贡献。）</p></li>
</ul>
</section>
<section id="fnmatch">
<h3 class="translated">fnmatch<a class="headerlink" href="#fnmatch" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加了 <a class="reference internal" href="../library/fnmatch.html#fnmatch.filterfalse" title="fnmatch.filterfalse"><code class="xref py py-func docutils literal notranslate"><span class="pre">filterfalse()</span></code></a> 函数用于拒绝匹配给定模式的名称。 （由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/74598">gh-74598</a> 中贡献。）</p></li>
</ul>
</section>
<section id="fractions">
<h3 class="translated">fractions<a class="headerlink" href="#fractions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">现在可以基于任何具有 <code class="xref py py-meth docutils literal notranslate"><span class="pre">as_integer_ratio()</span></code> 方法的对象构造 <a class="reference internal" href="../library/fractions.html#fractions.Fraction" title="fractions.Fraction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fraction</span></code></a> 对象。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/82017">gh-82017</a> 中贡献。）.)</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/fractions.html#fractions.Fraction.from_number" title="fractions.Fraction.from_number"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Fraction.from_number()</span></code></a> 作为 <a class="reference internal" href="../library/fractions.html#fractions.Fraction" title="fractions.Fraction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fraction</span></code></a> 的替代性构造器。 （由 Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/121797">gh-121797</a> 中贡献。）</p></li>
</ul>
</section>
<section id="functools">
<h3 class="translated">functools<a class="headerlink" href="#functools" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/functools.html#functools.Placeholder" title="functools.Placeholder"><code class="xref py py-data docutils literal notranslate"><span class="pre">Placeholder</span></code></a> 哨兵对象。 这可与 <a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><code class="xref py py-func docutils literal notranslate"><span class="pre">partial()</span></code></a> 或 <a class="reference internal" href="../library/functools.html#functools.partialmethod" title="functools.partialmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">partialmethod()</span></code></a> 函数一起使用以便在返回的 <a class="reference internal" href="../library/functools.html#partial-objects"><span class="std std-ref">partial 对象</span></a> 保留位置参数的位置。 （由 Dominykas Grigonis 在 <a class="reference external" href="https://github.com/python/cpython/issues/119127">gh-119127</a> 中贡献。）</p></li>
<li><p class="translated">允许将 <a class="reference internal" href="../library/functools.html#functools.reduce" title="functools.reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">reduce()</span></code></a> 的 <em>initial</em> 形参作为关键字参数传递。 （由 Sayandip Dutta 在 <a class="reference external" href="https://github.com/python/cpython/issues/125916">gh-125916</a> 中贡献。）</p></li>
</ul>
</section>
<section id="getopt">
<h3 class="translated">getopt<a class="headerlink" href="#getopt" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">新增对可选参数选项的支持。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/126374">gh-126374</a> 中贡献。）</p></li>
<li><p class="translated">新增对按顺序返回混合选项和非选项参数的支持。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/126390">gh-126390</a> 中贡献。）</p></li>
</ul>
</section>
<section id="getpass">
<h3 class="translated">getpass<a class="headerlink" href="#getpass" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">在 <a class="reference internal" href="../library/getpass.html#getpass.getpass" title="getpass.getpass"><code class="xref py py-func docutils literal notranslate"><span class="pre">getpass()</span></code></a> 函数中通过可选的仅限关键字参数 <em>echo_char</em> 支持键盘反馈。 每当输入字符时会显示占位符，并在删除字符时将其移除。 （由 Semyon Moroz 在 <a class="reference external" href="https://github.com/python/cpython/issues/77065">gh-77065</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="graphlib">
<h3 class="translated">graphlib<a class="headerlink" href="#graphlib" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">允许在排序尚未开始的情况下多次调用 <a class="reference internal" href="../library/graphlib.html#graphlib.TopologicalSorter.prepare" title="graphlib.TopologicalSorter.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TopologicalSorter.prepare()</span></code></a>。 （由 Daniel Pope 在 <a class="reference external" href="https://github.com/python/cpython/issues/130914">gh-130914</a> 中贡献。）</p></li>
</ul>
</section>
<section id="heapq">
<h3 class="translated">heapq<a class="headerlink" href="#heapq" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">通过下列新增函数，<code class="xref py py-mod docutils literal notranslate"><span class="pre">heapq</span></code> 模块改进了对最大堆的支持：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/heapq.html#heapq.heapify_max" title="heapq.heapify_max"><code class="xref py py-func docutils literal notranslate"><span class="pre">heapify_max()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/heapq.html#heapq.heappush_max" title="heapq.heappush_max"><code class="xref py py-func docutils literal notranslate"><span class="pre">heappush_max()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/heapq.html#heapq.heappop_max" title="heapq.heappop_max"><code class="xref py py-func docutils literal notranslate"><span class="pre">heappop_max()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/heapq.html#heapq.heapreplace_max" title="heapq.heapreplace_max"><code class="xref py py-func docutils literal notranslate"><span class="pre">heapreplace_max()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/heapq.html#heapq.heappushpop_max" title="heapq.heappushpop_max"><code class="xref py py-func docutils literal notranslate"><span class="pre">heappushpop_max()</span></code></a></p></li>
</ul>
</li>
</ul>
</section>
<section id="hmac">
<h3 class="translated">hmac<a class="headerlink" href="#hmac" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">新增基于 <a class="reference external" href="https://github.com/hacl-star/hacl-star/">HACL*</a> 项目形式化验证代码的 HMAC (<span class="target" id="index-200"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2104.html"><strong>RFC 2104</strong></a>) 内置实现。当 OpenSSL 的 HMAC 实现不可用时，该实现将作为备用方案。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/99108">gh-99108</a> 中贡献。）</p></li>
</ul>
</section>
<section id="http">
<h3 class="translated">http<a class="headerlink" href="#http" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">由 <a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a> 模块生成的目录列表和错误页面允许浏览器应用其默认暗模式。（由 Yorik Hansen 在 <a class="reference external" href="https://github.com/python/cpython/issues/123430">gh-123430</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a> 模块现在支持使用 <a class="reference internal" href="../library/http.server.html#http.server.HTTPSServer" title="http.server.HTTPSServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.server.HTTPSServer</span></code></a> 类通过 HTTPS 提供服务。此功能通过命令行界面 (<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">http.server</span></code>) 通过以下选项公开：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/http.server.html#cmdoption-http.server-tls-cert"><code class="xref std std-option docutils literal notranslate"><span class="pre">--tls-cert</span> <span class="pre">&lt;path&gt;</span></code></a>: TLS 证书文件的路径。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/http.server.html#cmdoption-http.server-tls-key"><code class="xref std std-option docutils literal notranslate"><span class="pre">--tls-key</span> <span class="pre">&lt;path&gt;</span></code></a>: 可选的私钥文件路径。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/http.server.html#cmdoption-http.server-tls-password-file"><code class="xref std std-option docutils literal notranslate"><span class="pre">--tls-password-file</span> <span class="pre">&lt;path&gt;</span></code></a>: 可选的私钥密码文件路径。</p></li>
</ul>
<p class="translated">（由 Semyon Moroz 在 <a class="reference external" href="https://github.com/python/cpython/issues/85162">gh-85162</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="imaplib">
<h3 class="translated">imaplib<a class="headerlink" href="#imaplib" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/imaplib.html#imaplib.IMAP4.idle" title="imaplib.IMAP4.idle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IMAP4.idle()</span></code></a>，实现了在 <span class="target" id="index-201"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2177.html"><strong>RFC 2177</strong></a> 中定义的 IMAP4 <code class="docutils literal notranslate"><span class="pre">IDLE</span></code> 命令。 （由 Forest 在 <a class="reference external" href="https://github.com/python/cpython/issues/55454">gh-55454</a> 中贡献。）</p></li>
</ul>
</section>
<section id="inspect">
<h3 class="translated">inspect<a class="headerlink" href="#inspect" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal notranslate"><span class="pre">signature()</span></code></a> 接受一个新参数 <em>annotation_format</em> 用于控制表示标注所使用的 <a class="reference internal" href="../library/annotationlib.html#annotationlib.Format" title="annotationlib.Format"><code class="xref py py-class docutils literal notranslate"><span class="pre">annotationlib.Format</span></code></a>。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/101552">gh-101552</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/inspect.html#inspect.Signature.format" title="inspect.Signature.format"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signature.format()</span></code></a> 接受一个新参数 <em>unquote_annotations</em>。 如其为真值，字符串 <a class="reference internal" href="../glossary.html#term-annotation"><span class="xref std std-term">标注</span></a> 将不带引号地显示。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/101552">gh-101552</a> 中贡献。）.)</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/inspect.html#inspect.ispackage" title="inspect.ispackage"><code class="xref py py-func docutils literal notranslate"><span class="pre">ispackage()</span></code></a> 函数用于确定一个对象是否为 <a class="reference internal" href="../glossary.html#term-package"><span class="xref std std-term">package</span></a>。 （由 Zhikang Yan 在 <a class="reference external" href="https://github.com/python/cpython/issues/125634">gh-125634</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="io">
<h3 class="translated">io<a class="headerlink" href="#io" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">使用 <code class="docutils literal notranslate"><span class="pre">read</span></code> 从非阻塞流读取文本时，如果操作无法立即返回字节，现在可能会引发 <a class="reference internal" href="../library/exceptions.html#BlockingIOError" title="BlockingIOError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BlockingIOError</span></code></a>。（由 Giovanni Siragusa 在 <a class="reference external" href="https://github.com/python/cpython/issues/109523">gh-109523</a> 中贡献。）</p></li>
<li><p class="translated">添加 <a class="reference internal" href="../library/io.html#io.Reader" title="io.Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reader</span></code></a> 和 <a class="reference internal" href="../library/io.html#io.Writer" title="io.Writer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Writer</span></code></a> 协议作为 <a class="reference internal" href="../library/typing.html#typing.IO" title="typing.IO"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.IO</span></code></a>, <a class="reference internal" href="../library/typing.html#typing.TextIO" title="typing.TextIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.TextIO</span></code></a> 和 <a class="reference internal" href="../library/typing.html#typing.BinaryIO" title="typing.BinaryIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.BinaryIO</span></code></a> 等伪协议的最简单替代。 （由 Sebastian Rittau 在 <a class="reference external" href="https://github.com/python/cpython/issues/127648">gh-127648</a> 中贡献。）</p></li>
</ul>
</section>
<section id="json">
<h3 class="translated">json<a class="headerlink" href="#json" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">为 JSON 序列化错误添加异常说明以允许标识错误来源。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/122163">gh-122163</a> 中贡献。）</p></li>
<li><p class="translated">通过 <a class="reference internal" href="../using/cmdline.html#cmdoption-m"><code class="xref std std-option docutils literal notranslate"><span class="pre">-m</span></code></a> 开关来允许将 <a class="reference internal" href="../library/json.html#module-json" title="json: Encode and decode the JSON format."><code class="xref py py-mod docutils literal notranslate"><span class="pre">json</span></code></a> 模块作为脚本使用: <strong class="program">python -m json</strong>。 现在推荐以此用法替代 <strong class="program">python -m json.tool</strong>，后者已处于 <a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">soft deprecated</span></a> 状态。 参见 <a class="reference internal" href="../library/json.html#json-commandline"><span class="std std-ref">JSON 命令行界面</span></a> 文档。 （由 Trey Hunner 在 <a class="reference external" href="https://github.com/python/cpython/issues/122873">gh-122873</a> 中贡献。）</p></li>
<li><p class="translated">默认情况下，<a class="reference internal" href="../library/json.html#json-commandline"><span class="std std-ref">JSON 命令行界面</span></a> 的输出会以彩色突出显示。这可以通过 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">环境变量</span></a> 进行控制。（由 Tomas Roun 在 <a class="reference external" href="https://github.com/python/cpython/issues/131952">gh-131952</a> 中贡献。）</p></li>
</ul>
</section>
<section id="linecache">
<h3 class="translated">linecache<a class="headerlink" href="#linecache" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">现在 <a class="reference internal" href="../library/linecache.html#linecache.getline" title="linecache.getline"><code class="xref py py-func docutils literal notranslate"><span class="pre">getline()</span></code></a> 可以获取冻结模块的源代码。 （由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/131638">gh-131638</a> 中贡献。）</p></li>
</ul>
</section>
<section id="logging-handlers">
<h3 class="translated">logging.handlers<a class="headerlink" href="#logging-handlers" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">现在 <a class="reference internal" href="../library/logging.handlers.html#logging.handlers.QueueListener" title="logging.handlers.QueueListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueueListener</span></code></a> 对象可支持 <a class="reference internal" href="../glossary.html#term-context-manager"><span class="xref std std-term">context manager</span></a> 协议。 （由 Charles Machalow 在 <a class="reference external" href="https://github.com/python/cpython/issues/132106">gh-132106</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/logging.handlers.html#logging.handlers.QueueListener.start" title="logging.handlers.QueueListener.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QueueListener.start</span></code></a> 现在如果监听器已启动，会引发 <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>。（由 Charles Machalow 在 <a class="reference external" href="https://github.com/python/cpython/issues/132106">gh-132106</a> 中贡献。）</p></li>
</ul>
</section>
<section id="math">
<h3 class="translated">math<a class="headerlink" href="#math" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">为模块中的域错误添加了更详细的错误消息。（由 Charlie Zhao 和 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/101410">gh-101410</a> 中贡献。）</p></li>
</ul>
</section>
<section id="mimetypes">
<h3 class="translated">mimetypes<a class="headerlink" href="#mimetypes" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">为模块增加公有的 <a class="reference internal" href="../library/mimetypes.html#mimetypes-cli"><span class="std std-ref">命令行界面</span></a>，通过 <strong class="program">python -m mimetypes</strong> 唤起。 （由 Oleg Iarygin 和 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/93096">gh-93096</a> 中贡献。）</p></li>
<li><p class="translated">增加了一些基于 RFC 和通常用例的新 MIME 类型：</p>
<p class="translated rubric">用于字体的 Microsoft 和 <span class="target" id="index-202"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8081.html"><strong>RFC 8081</strong></a> MIME 类型</p>
<ul class="simple">
<li><p class="translated">嵌入式 OpenType： <code class="docutils literal notranslate"><span class="pre">application/vnd.ms-fontobject</span></code></p></li>
<li><p class="translated">OpenType 布局(OTF) <code class="docutils literal notranslate"><span class="pre">font/otf</span></code></p></li>
<li><p class="translated">TrueType: <code class="docutils literal notranslate"><span class="pre">font/ttf</span></code></p></li>
<li><p class="translated">WOFF 1.0 <code class="docutils literal notranslate"><span class="pre">font/woff</span></code></p></li>
<li><p class="translated">WOFF 2.0 <code class="docutils literal notranslate"><span class="pre">font/woff2</span></code></p></li>
</ul>
<p class="translated rubric">用于 Matroska 音视频数据容器结构的 <span class="target" id="index-203"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9559.html"><strong>RFC 9559</strong></a> MIME 类型</p>
<ul class="simple">
<li><p class="translated">仅有音频，无视频： <code class="docutils literal notranslate"><span class="pre">audio/matroska</span></code> (<code class="docutils literal notranslate"><span class="pre">.mka</span></code>)</p></li>
<li><p class="translated">视频：<code class="docutils literal notranslate"><span class="pre">video/matroska</span></code> (<code class="docutils literal notranslate"><span class="pre">.mkv</span></code>)</p></li>
<li><p class="translated">立体视频: <code class="docutils literal notranslate"><span class="pre">video/matroska-3d</span></code> (<code class="docutils literal notranslate"><span class="pre">.mk3d</span></code>)</p></li>
</ul>
<p class="translated rubric">基于 RFC 的图像</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-40"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc1494.html"><strong>RFC 1494</strong></a>: CCITT Group 3 (<code class="docutils literal notranslate"><span class="pre">.g3</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-41"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc3362.html"><strong>RFC 3362</strong></a>: Real-time Facsimile, T.38 (<code class="docutils literal notranslate"><span class="pre">.t38</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-204"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc3745.html"><strong>RFC 3745</strong></a>: JPEG 2000 (<code class="docutils literal notranslate"><span class="pre">.jp2</span></code>)、扩展格式 (<code class="docutils literal notranslate"><span class="pre">.jpx</span></code>) 和复合格式 (<code class="docutils literal notranslate"><span class="pre">.jpm</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-205"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc3950.html"><strong>RFC 3950</strong></a>: 标签图像文件格式传真扩展，TIFF-FX (<code class="docutils literal notranslate"><span class="pre">.tfx</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-206"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc4047.html"><strong>RFC 4047</strong></a>: 灵活图像传输系统 (<code class="docutils literal notranslate"><span class="pre">.fits</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-207"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7903.html"><strong>RFC 7903</strong></a>: 增强型图元文件 (<code class="docutils literal notranslate"><span class="pre">.emf</span></code>) 和 Windows 图元文件 (<code class="docutils literal notranslate"><span class="pre">.wmf</span></code>)</p></li>
</ul>
<p class="translated rubric">其他 MIME 类型的增加和改变</p>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-208"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2361.html"><strong>RFC 2361</strong></a>: 将 <code class="docutils literal notranslate"><span class="pre">.avi</span></code> 的类型更改为 <code class="docutils literal notranslate"><span class="pre">video/vnd.avi</span></code>，将 <code class="docutils literal notranslate"><span class="pre">.wav</span></code> 的类型更改为 <code class="docutils literal notranslate"><span class="pre">audio/vnd.wave</span></code></p></li>
<li><p class="translated"><span class="target" id="index-209"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc4337.html"><strong>RFC 4337</strong></a>：添加 MPEG-4 <code class="docutils literal notranslate"><span class="pre">audio/mp4</span></code> (<code class="docutils literal notranslate"><span class="pre">.m4a</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-210"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5334.html"><strong>RFC 5334</strong></a>：添加 Ogg 媒体（<code class="docutils literal notranslate"><span class="pre">.oga</span></code>，<code class="docutils literal notranslate"><span class="pre">.ogg</span></code> 和 <code class="docutils literal notranslate"><span class="pre">.ogx</span></code>）</p></li>
<li><p class="translated"><span class="target" id="index-211"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6713.html"><strong>RFC 6713</strong></a>：添加 <code class="docutils literal notranslate"><span class="pre">application/gzip</span></code> (<code class="docutils literal notranslate"><span class="pre">.gz</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-212"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9639.html"><strong>RFC 9639</strong></a>: 添加 FLAC 格式的 <code class="docutils literal notranslate"><span class="pre">audio/flac</span></code> (<code class="docutils literal notranslate"><span class="pre">.flac</span></code>)</p></li>
<li><p class="translated"><span class="target" id="index-213"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9512.html"><strong>RFC 9512</strong></a> 针对 YAML 文件 (<code class="docutils literal notranslate"><span class="pre">.yaml</span></code> 和 <code class="docutils literal notranslate"><span class="pre">.yml</span></code>) 的 <code class="docutils literal notranslate"><span class="pre">application/yaml</span></code> MIME 类型</p></li>
<li><p class="translated">添加 7z <code class="docutils literal notranslate"><span class="pre">application/x-7z-compressed</span></code> (<code class="docutils literal notranslate"><span class="pre">.7z</span></code>)</p></li>
<li><p class="translated">非严格模式下，添加Android安装包 <code class="docutils literal notranslate"><span class="pre">application/vnd.android.package-archive</span></code> (<code class="docutils literal notranslate"><span class="pre">.apk</span></code>)</p></li>
<li><p class="translated">添加 deb <code class="docutils literal notranslate"><span class="pre">application/x-debian-package</span></code> (<code class="docutils literal notranslate"><span class="pre">.deb</span></code>)</p></li>
<li><p class="translated">添加 glTF 二进制格式 <code class="docutils literal notranslate"><span class="pre">model/gltf-binary</span></code> (<code class="docutils literal notranslate"><span class="pre">.glb</span></code>)</p></li>
<li><p class="translated">添加glTF JSON/ASCII格式 <code class="docutils literal notranslate"><span class="pre">model/gltf+json</span></code> (<code class="docutils literal notranslate"><span class="pre">.gltf</span></code>)</p></li>
<li><p class="translated">添加 M4V <code class="docutils literal notranslate"><span class="pre">video/x-m4v</span></code> (<code class="docutils literal notranslate"><span class="pre">.m4v</span></code>)</p></li>
<li><p class="translated">添加 PHP <code class="docutils literal notranslate"><span class="pre">application/x-httpd-php</span></code> (<code class="docutils literal notranslate"><span class="pre">.php</span></code>)</p></li>
<li><p class="translated">添加 RAR <code class="docutils literal notranslate"><span class="pre">application/vnd.rar</span></code> (<code class="docutils literal notranslate"><span class="pre">.rar</span></code>)</p></li>
<li><p class="translated">添加 RPM <code class="docutils literal notranslate"><span class="pre">application/x-rpm</span></code> (<code class="docutils literal notranslate"><span class="pre">.rpm</span></code>)</p></li>
<li><p class="translated">添加STL格式 <code class="docutils literal notranslate"><span class="pre">model/stl</span></code> (<code class="docutils literal notranslate"><span class="pre">.stl</span></code>)</p></li>
<li><p class="translated">添加 Windows 媒体视频 <code class="docutils literal notranslate"><span class="pre">video/x-ms-wmv</span></code> (<code class="docutils literal notranslate"><span class="pre">.wmv</span></code>)</p></li>
<li><p class="translated">事实上：添加WebM格式 <code class="docutils literal notranslate"><span class="pre">audio/webm</span></code> (<code class="docutils literal notranslate"><span class="pre">.weba</span></code>)</p></li>
<li><p class="translated"><a class="reference external" href="https://ecma-international.org/publications-and-standards/standards/ecma-376/">ECMA-376</a>: 添加 <code class="docutils literal notranslate"><span class="pre">.docx</span></code>、<code class="docutils literal notranslate"><span class="pre">.pptx</span></code> 和 <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code> 类型</p></li>
<li><p class="translated"><a class="reference external" href="https://docs.oasis-open.org/office/v1.2/cs01/OpenDocument-v1.2-cs01-part1.html#Appendix_C">OASIS</a>: 添加 OpenDocument 格式的 <code class="docutils literal notranslate"><span class="pre">.odg</span></code>、<code class="docutils literal notranslate"><span class="pre">.odp</span></code>、<code class="docutils literal notranslate"><span class="pre">.ods</span></code> 和 <code class="docutils literal notranslate"><span class="pre">.odt</span></code> 类型</p></li>
<li><p class="translated"><a class="reference external" href="https://www.w3.org/TR/epub-33/#app-media-type">W3C</a>: 添加 EPUB 格式的 <code class="docutils literal notranslate"><span class="pre">application/epub+zip</span></code> (<code class="docutils literal notranslate"><span class="pre">.epub</span></code>)</p></li>
</ul>
<p class="translated">（由Contributed by Sahil Prajapati 和 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/84852">gh-84852</a> 中，由 Sasha &quot;Nelie&quot; Chernykh 和 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/132056">gh-132056</a> 中，以及由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/89416">gh-89416</a>, <a class="reference external" href="https://github.com/python/cpython/issues/85957">gh-85957</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/129965">gh-129965</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="multiprocessing">
<h3 class="translated">multiprocessing<a class="headerlink" href="#multiprocessing" title="Link to this heading">¶</a></h3>
<ul id="whatsnew314-multiprocessing-start-method">
<li><p class="translated">在 macOS 以外的 Unix 平台上，<a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-method-forkserver"><span class="std std-ref">'forkserver'</span></a> 现在是默认的 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-methods"><span class="std std-ref">启动方法</span></a> (替代 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-method-fork"><span class="std std-ref">'fork'</span></a>)。 此项更改不会影响 Windows 或 macOS，在这两个平台上 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-method-spawn"><span class="std std-ref">'spawn'</span></a> 仍是默认的启动方法。</p>
<p class="translated">如果需要使用不兼容线程的 <em>fork</em> 方法，你必须通过来自 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_context" title="multiprocessing.get_context"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_context()</span></code></a> 的上下文显式地发起请求（推荐方式）或通过 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.set_start_method" title="multiprocessing.set_start_method"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_start_method()</span></code></a> 更改默认方法。</p>
<p class="translated">请参阅 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-programming-forkserver"><span class="std std-ref">forkserver 限制说明</span></a> 了解与 <em>fork</em> 方法的差异信息，以及此项变更对存在以下情况的现有代码可能产生的影响：(1) 使用可变全局共享变量 (2) 包含无法被 <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> 自动序列化的共享对象。</p>
<p class="translated">（由 Gregory P. Smith 在 <a class="reference external" href="https://github.com/python/cpython/issues/84559">gh-84559</a> 中贡献）</p>
</li>
<li><p class="translated">现在 <a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a> 的 <code class="docutils literal notranslate"><span class="pre">'forkserver'</span></code> 启动方法会验证其控制套接字以避免单纯依赖文件系统权限来限制其他进程可能导致 forkserver 产生工作进程并运行代码。 （由 Gregory P. Smith 在 <a class="reference external" href="https://github.com/python/cpython/issues/97514">gh-97514</a> 中贡献。）</p></li>
<li><p class="translated">针对 <em>list</em> 和 <em>dict</em> 类型的 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-proxy-objects"><span class="std std-ref">多进程代理对象</span></a> 增加了此前被忽略的缺失方法：</p>
<blockquote>
<div><ul class="simple">
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clear()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code> 用于 <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> 的代理</p></li>
<li><p class="translated"><a class="reference internal" href="../library/stdtypes.html#dict.fromkeys" title="dict.fromkeys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fromkeys()</span></code></a>、<code class="docutils literal notranslate"><span class="pre">reversed(d)</span></code>、<code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">|</span> <span class="pre">{}</span></code>、<code class="docutils literal notranslate"><span class="pre">{}</span> <span class="pre">|</span> <span class="pre">d</span></code>、<code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">|=</span> <span class="pre">{'b':</span> <span class="pre">2}</span></code> 用于 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> 的代理</p></li>
</ul>
</div></blockquote>
<p class="translated">（由 Roy Hyunjin Han 在 <a class="reference external" href="https://github.com/python/cpython/issues/103134">gh-103134</a> 中贡献。）</p>
</li>
<li><p class="translated">通过 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.managers.SyncManager.set" title="multiprocessing.managers.SyncManager.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SyncManager.set()</span></code></a> 增加对共享 <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> 对象的支持。 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.Manager" title="multiprocessing.Manager"><code class="xref py py-func docutils literal notranslate"><span class="pre">Manager()</span></code></a> 方法中的 <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-func docutils literal notranslate"><span class="pre">set()</span></code></a> 现已可用。 （由 Mingyu Park 在 <a class="reference external" href="https://github.com/python/cpython/issues/129949">gh-129949</a> 中贡献。）</p></li>
<li><p class="translated">为 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.Process" title="multiprocessing.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">multiprocessing.Process</span></code></a> 对象增加 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.Process.interrupt" title="multiprocessing.Process.interrupt"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interrupt()</span></code></a>，该方法通过发送 <a class="reference internal" href="../library/signal.html#signal.SIGINT" title="signal.SIGINT"><code class="xref py py-const docutils literal notranslate"><span class="pre">SIGINT</span></code></a> 来终结子进程。 这使得 <a class="reference internal" href="../reference/compound_stmts.html#finally"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code></a> 子句能为被终止的进程打印栈回溯信息。 （由 Artem Pulkin 在 <a class="reference external" href="https://github.com/python/cpython/issues/131913">gh-131913</a> 中贡献。）</p></li>
</ul>
</section>
<section id="operator">
<h3 class="translated">operator<a class="headerlink" href="#operator" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/operator.html#operator.is_none" title="operator.is_none"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_none()</span></code></a> 和 <a class="reference internal" href="../library/operator.html#operator.is_not_none" title="operator.is_not_none"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_not_none()</span></code></a> 函数对，其中 <code class="docutils literal notranslate"><span class="pre">operator.is_none(obj)</span></code> 等价于 <code class="docutils literal notranslate"><span class="pre">obj</span> <span class="pre">is</span> <span class="pre">None</span></code> 而 <code class="docutils literal notranslate"><span class="pre">operator.is_not_none(obj)</span></code> 等价于 <code class="docutils literal notranslate"><span class="pre">obj</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>。 （由 Raymond Hettinger 和 Nico Mexis 在 <a class="reference external" href="https://github.com/python/cpython/issues/115808">gh-115808</a> 中贡献。）</p></li>
</ul>
</section>
<section id="os">
<h3 class="translated">os<a class="headerlink" href="#os" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/os.html#os.reload_environ" title="os.reload_environ"><code class="xref py py-func docutils literal notranslate"><span class="pre">reload_environ()</span></code></a> 函数用于根据 <a class="reference internal" href="../library/os.html#os.putenv" title="os.putenv"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.putenv()</span></code></a>, by <a class="reference internal" href="../library/os.html#os.unsetenv" title="os.unsetenv"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.unsetenv()</span></code></a> 或同一进程中在 Python 外部所做的环境变量来更新 <a class="reference internal" href="../library/os.html#os.environ" title="os.environ"><code class="xref py py-data docutils literal notranslate"><span class="pre">os.environ</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.environb" title="os.environb"><code class="xref py py-data docutils literal notranslate"><span class="pre">os.environb</span></code></a>。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/120057">gh-120057</a> 中贡献。）</p></li>
<li><p class="translated">为 <code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code> 模块增加 <a class="reference internal" href="../library/os.html#os.SCHED_DEADLINE" title="os.SCHED_DEADLINE"><code class="xref py py-data docutils literal notranslate"><span class="pre">SCHED_DEADLINE</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.SCHED_NORMAL" title="os.SCHED_NORMAL"><code class="xref py py-data docutils literal notranslate"><span class="pre">SCHED_NORMAL</span></code></a> 常量。 （由 James Roy 在 <a class="reference external" href="https://github.com/python/cpython/issues/127688">gh-127688</a> 中贡献。）.)</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/os.html#os.readinto" title="os.readinto"><code class="xref py py-func docutils literal notranslate"><span class="pre">readinto()</span></code></a> 函数用于从文件描述符读取数据到 <a class="reference internal" href="../c-api/buffer.html#bufferobjects"><span class="std std-ref">缓冲区对象</span></a>。 （由 Cody Maloney 在 <a class="reference external" href="https://github.com/python/cpython/issues/129205">gh-129205</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="os-path">
<h3 class="translated">os.path<a class="headerlink" href="#os-path" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">传给 <a class="reference internal" href="../library/os.path.html#os.path.realpath" title="os.path.realpath"><code class="xref py py-func docutils literal notranslate"><span class="pre">realpath()</span></code></a> 的 <em>strict</em> 形参接受一个新值 <a class="reference internal" href="../library/os.path.html#os.path.ALLOW_MISSING" title="os.path.ALLOW_MISSING"><code class="xref py py-data docutils literal notranslate"><span class="pre">ALLOW_MISSING</span></code></a>。 如果使用该值，则 <a class="reference internal" href="../library/exceptions.html#FileNotFoundError" title="FileNotFoundError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">FileNotFoundError</span></code></a> 以外的错误将被重新引发；结果路径可能会缺失但它将不会有符号链接。 （由 Petr Viktorin 为 <span class="target" id="index-214"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2025-4517"><strong>CVE 2025-4517</strong></a> 贡献。）</p></li>
</ul>
</section>
<section id="pathlib">
<h3 class="translated">pathlib<a class="headerlink" href="#pathlib" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">为 <a class="reference internal" href="../library/pathlib.html#pathlib.Path" title="pathlib.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a> 新增递归复制/移动文件和目录的方法：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#pathlib.Path.copy" title="pathlib.Path.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code></a> 将一个文件或目录树复制到目标位置。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#pathlib.Path.copy_into" title="pathlib.Path.copy_into"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_into()</span></code></a> 会将内容复制 <em>到</em> 目标目录中。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#pathlib.Path.move" title="pathlib.Path.move"><code class="xref py py-meth docutils literal notranslate"><span class="pre">move()</span></code></a> 将一个文件或目录树移动到目标位置。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#pathlib.Path.move_into" title="pathlib.Path.move_into"><code class="xref py py-meth docutils literal notranslate"><span class="pre">move_into()</span></code></a> 会将内容移动 <em>到</em> 目标目录中。</p></li>
</ul>
<p class="translated">（由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/73991">gh-73991</a> 中贡献。）</p>
</li>
<li><p class="translated">增加 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.info" title="pathlib.Path.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">info</span></code></a> 属性，该属性将存储一个实现了新的 <a class="reference internal" href="../library/pathlib.html#pathlib.types.PathInfo" title="pathlib.types.PathInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.types.PathInfo</span></code></a> 协议的对象。 此对象支持查询文件类型并会在内部缓存 <a class="reference internal" href="../library/os.html#os.stat" title="os.stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">stat()</span></code></a> 的结果。 通过 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.iterdir" title="pathlib.Path.iterdir"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iterdir()</span></code></a> 创建的 Path 对象会根据扫描父目录时收集到的文件类型信息进行初始化。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/125413">gh-125413</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pdb">
<h3 class="translated">pdb<a class="headerlink" href="#pdb" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">现在 <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 模块支持使用新的 <a class="reference internal" href="../library/pdb.html#cmdoption-pdb-p"><code class="xref std std-option docutils literal notranslate"><span class="pre">-p</span> <span class="pre">PID</span></code></a> 命令行选项远程附加到正在运行的 Python 进程：</p>
<div class="translated highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pdb<span class="w"> </span>-p<span class="w"> </span><span class="m">1234</span>
</pre></div>
</div>
<p class="translated">该操作将连接到指定PID的Python进程，并允许您进行交互式调试。请注意，由于Python解释器的工作原理，当附加到阻塞在系统调用或等待I/O的远程进程时，调试功能只有在执行下一条字节码指令或进程收到信号时才会生效。</p>
<p class="translated">此特性使用 <a class="reference internal" href="#whatsnew314-remote-debugging"><span class="std std-ref">PEP 768</span></a> 和新的 <a class="reference internal" href="../library/sys.html#sys.remote_exec" title="sys.remote_exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.remote_exec()</span></code></a> 函数来附加到远程进程并向其发送 PDB 命令。commands to it.</p>
<p class="translated">（由 Matt Wozniski 和 Pablo Galindo 在 <a class="reference external" href="https://github.com/python/cpython/issues/131591">gh-131591</a> 中贡献。）</p>
</li>
<li><p class="translated">硬编码的断点 (<a class="reference internal" href="../library/functions.html#breakpoint" title="breakpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">breakpoint()</span></code></a> 和 <a class="reference internal" href="../library/pdb.html#pdb.set_trace" title="pdb.set_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_trace()</span></code></a>) 现在会重用最近一次调用 <a class="reference internal" href="../library/pdb.html#pdb.Pdb.set_trace" title="pdb.Pdb.set_trace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_trace()</span></code></a> 的 <a class="reference internal" href="../library/pdb.html#pdb.Pdb" title="pdb.Pdb"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pdb</span></code></a> 实例，而不是每次都新建一个实例。 因此，所有实例特定的数据如 <a class="reference internal" href="../library/pdb.html#pdbcommand-display"><code class="xref std std-pdbcmd docutils literal notranslate"><span class="pre">display</span></code></a> 和 <a class="reference internal" href="../library/pdb.html#pdbcommand-commands"><code class="xref std std-pdbcmd docutils literal notranslate"><span class="pre">commands</span></code></a> 在硬编码的断点之间都会被保留。 （由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/121450">gh-121450</a> 中贡献。）</p></li>
<li><p class="translated">为 <a class="reference internal" href="../library/pdb.html#pdb.Pdb" title="pdb.Pdb"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdb.Pdb</span></code></a> 新增一个 <em>mode</em> 参数。当 <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 处于 <code class="docutils literal notranslate"><span class="pre">inline</span></code> 模式时，禁用 <code class="docutils literal notranslate"><span class="pre">restart</span></code> 命令。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/123757">gh-123757</a> 中贡献。）</p></li>
<li><p class="translated">当用户尝试在 <code class="docutils literal notranslate"><span class="pre">inline</span></code> 模式下退出 <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 时，会显示一个确认提示。输入 <code class="docutils literal notranslate"><span class="pre">y</span></code>、<code class="docutils literal notranslate"><span class="pre">Y</span></code>、按 <code class="docutils literal notranslate"><span class="pre">&lt;Enter&gt;</span></code> 或 <code class="docutils literal notranslate"><span class="pre">EOF</span></code> 将确认退出并调用 <a class="reference internal" href="../library/sys.html#sys.exit" title="sys.exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.exit()</span></code></a>，而非引发 <a class="reference internal" href="../library/bdb.html#bdb.BdbQuit" title="bdb.BdbQuit"><code class="xref py py-exc docutils literal notranslate"><span class="pre">bdb.BdbQuit</span></code></a>。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/124704">gh-124704</a> 中贡献。）</p></li>
<li><p class="translated">像 <a class="reference internal" href="../library/functions.html#breakpoint" title="breakpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">breakpoint()</span></code></a> 或 <a class="reference internal" href="../library/pdb.html#pdb.set_trace" title="pdb.set_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">pdb.set_trace()</span></code></a> 这样的内联断点将始终在调用帧处暂停程序，而忽略 <code class="docutils literal notranslate"><span class="pre">skip</span></code> 模式（如果有的话）。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/130493">gh-130493</a> 中贡献。）</p></li>
<li><p class="translated">在 <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 的多行输入中，行首的 <code class="docutils literal notranslate"><span class="pre">&lt;tab&gt;</span></code> 键现在会填充 4 个空格的缩进，而不是插入 <code class="docutils literal notranslate"><span class="pre">\t</span></code> 字符。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/130471">gh-130471</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 的多行输入中引入了自动缩进功能。当检测到新的代码块时，它会要么保持上一行的缩进，要么插入 4 个空格的缩进。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/133350">gh-133350</a> 中贡献。）</p></li>
<li><p class="translated">新增 <code class="docutils literal notranslate"><span class="pre">$_asynctask</span></code> 以在适用情况下访问当前的 asyncio 任务。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/124367">gh-124367</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../library/pdb.html#pdb.set_trace_async" title="pdb.set_trace_async"><code class="xref py py-func docutils literal notranslate"><span class="pre">pdb.set_trace_async()</span></code></a> 以支持调试 asyncio 协程。此函数支持 <a class="reference internal" href="../reference/expressions.html#await"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">await</span></code></a> 语句。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/132576">gh-132576</a> 中贡献。）</p></li>
<li><p class="translated">在Source code displayed in <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 中显示的源代码将有语法高亮。 除了 <a class="reference internal" href="../library/pdb.html#pdb.Pdb" title="pdb.Pdb"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdb.Pdb</span></code></a> 新增加的 <code class="docutils literal notranslate"><span class="pre">colorize</span></code> 参数，此特性还可使用与默认的 <a class="reference internal" href="../glossary.html#term-interactive"><span class="xref std std-term">interactive</span></a> shell 相同的方法来控制。 （由 Tian Gao 和 Łukasz Langa 在 <a class="reference external" href="https://github.com/python/cpython/issues/133355">gh-133355</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pickle">
<h3 class="translated">pickle<a class="headerlink" href="#pickle" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">将 <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> 模块的默认协议版本设置为 5。更多详细信息，请参见 <a class="reference internal" href="../library/pickle.html#pickle-protocols"><span class="std std-ref">pickle protocols</span></a>。</p></li>
<li><p class="translated">为 pickle 序列化错误添加异常说明以允许标识错误来源。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/122213">gh-122213</a> 中贡献。）</p></li>
</ul>
</section>
<section id="platform">
<h3 class="translated">platform<a class="headerlink" href="#platform" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/platform.html#platform.invalidate_caches" title="platform.invalidate_caches"><code class="xref py py-func docutils literal notranslate"><span class="pre">invalidate_caches()</span></code></a> 函数，用于使 <code class="xref py py-mod docutils literal notranslate"><span class="pre">platform</span></code> 模块中的缓存结果失效。 （由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/122549">gh-122549</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pydoc">
<h3 class="translated">pydoc<a class="headerlink" href="#pydoc" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">帮助输出中的 <a class="reference internal" href="../glossary.html#term-annotation"><span class="xref std std-term">注解</span></a> 现在通常以更接近原始源代码中的格式显示。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/101552">gh-101552</a> 中贡献。）</p></li>
</ul>
</section>
<section id="re">
<h3 class="translated">re<a class="headerlink" href="#re" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">在 <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">正则表达式</span></code></a> 中，现支持将 <code class="docutils literal notranslate"><span class="pre">\z</span></code> 作为 <code class="docutils literal notranslate"><span class="pre">\Z</span></code> 的同义符使用。与行为存在微妙差异的 <code class="docutils literal notranslate"><span class="pre">\Z</span></code> 不同，<code class="docutils literal notranslate"><span class="pre">\z</span></code> 在其他多种正则表达式引擎中具有明确无歧义的解析方式。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/133306">gh-133306</a> 中贡献。）</p></li>
<li><p class="translated">现在 <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">正则表达式</span></code></a> 中的 <code class="docutils literal notranslate"><span class="pre">\B</span></code> 将匹配空的输入字符串，这意味着它现在的行为总是与 <code class="docutils literal notranslate"><span class="pre">\b</span></code> 相反。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/124130">gh-124130</a> 中贡献。）</p></li>
</ul>
</section>
<section id="socket">
<h3 class="translated">socket<a class="headerlink" href="#socket" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">改进并修复对蓝牙套接字的支持。</p>
<ul>
<li><p class="translated">修复了 NetBSD 和 DragonFly BSD 系统上对蓝牙套接字的支持。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/132429">gh-132429</a> 中贡献。）</p></li>
<li><p class="translated">修复了 FreeBSD 系统上对 <a class="reference internal" href="../library/socket.html#socket.BTPROTO_HCI" title="socket.BTPROTO_HCI"><code class="xref py py-const docutils literal notranslate"><span class="pre">BTPROTO_HCI</span></code></a> 的支持。（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/111178">gh-111178</a> 中贡献。）</p></li>
<li><p class="translated">新增对 FreeBSD 系统上 <a class="reference internal" href="../library/socket.html#socket.BTPROTO_SCO" title="socket.BTPROTO_SCO"><code class="xref py py-const docutils literal notranslate"><span class="pre">BTPROTO_SCO</span></code></a> 的支持。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/85302">gh-85302</a> 中贡献。）</p></li>
<li><p class="translated">新增对 FreeBSD 系统上 <a class="reference internal" href="../library/socket.html#socket.BTPROTO_L2CAP" title="socket.BTPROTO_L2CAP"><code class="xref py py-const docutils literal notranslate"><span class="pre">BTPROTO_L2CAP</span></code></a> 地址中 <em>cid</em> 和 <em>bdaddr_type</em> 的支持。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/132429">gh-132429</a> 中贡献。）</p></li>
<li><p class="translated">新增对 Linux 系统上 <a class="reference internal" href="../library/socket.html#socket.BTPROTO_HCI" title="socket.BTPROTO_HCI"><code class="xref py py-const docutils literal notranslate"><span class="pre">BTPROTO_HCI</span></code></a> 地址中 <em>channel</em> 的支持。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/70145">gh-70145</a> 中贡献。）</p></li>
<li><p class="translated">在 Linux 系统上，允许将整数作为 <a class="reference internal" href="../library/socket.html#socket.BTPROTO_HCI" title="socket.BTPROTO_HCI"><code class="xref py py-const docutils literal notranslate"><span class="pre">BTPROTO_HCI</span></code></a> 的地址。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/132099">gh-132099</a> 中贡献。）</p></li>
<li><p class="translated">在 <a class="reference internal" href="../library/socket.html#socket.BTPROTO_L2CAP" title="socket.BTPROTO_L2CAP"><code class="xref py py-const docutils literal notranslate"><span class="pre">BTPROTO_L2CAP</span></code></a> 中，<a class="reference internal" href="../library/socket.html#socket.socket.getsockname" title="socket.socket.getsockname"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getsockname()</span></code></a> 会返回 <em>cid</em>。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/132429">gh-132429</a> 中贡献。）</p></li>
<li><p class="translated">新增了许多常量。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/132734">gh-132734</a> 中贡献。）</p></li>
</ul>
</li>
</ul>
</section>
<section id="ssl">
<h3 class="translated">ssl<a class="headerlink" href="#ssl" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">通过 <a class="reference internal" href="../library/ssl.html#ssl.HAS_PHA" title="ssl.HAS_PHA"><code class="xref py py-data docutils literal notranslate"><span class="pre">HAS_PHA</span></code></a> 布尔值指明 <code class="xref py py-mod docutils literal notranslate"><span class="pre">ssl</span></code> 模块是否支持 TLSv1.3 握手后客户端认证 (PHA)。 （由 Will Childs-Klein 在 <a class="reference external" href="https://github.com/python/cpython/issues/128036">gh-128036</a> 中贡献。）</p></li>
</ul>
</section>
<section id="struct">
<h3 class="translated">struct<a class="headerlink" href="#struct" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">在 <a class="reference internal" href="../library/struct.html#module-struct" title="struct: Interpret bytes as packed binary data."><code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code></a> 模块中支持 <span class="c-expr sig sig-inline c"><span class="kt">float</span><span class="w"> </span><span class="kt">complex</span></span> 和 <span class="c-expr sig sig-inline c"><span class="kt">double</span><span class="w"> </span><span class="kt">complex</span></span> 这两种 C 类型（分别对应格式字符 <code class="docutils literal notranslate"><span class="pre">'F'</span></code> 和 <code class="docutils literal notranslate"><span class="pre">'D'</span></code>）。（由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/121249">gh-121249</a> 中贡献。）</p></li>
</ul>
</section>
<section id="symtable">
<h3 class="translated">symtable<a class="headerlink" href="#symtable" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">对外暴露下列 <a class="reference internal" href="../library/symtable.html#symtable.Symbol" title="symtable.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol</span></code></a> 方法：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/symtable.html#symtable.Symbol.is_comp_cell" title="symtable.Symbol.is_comp_cell"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_comp_cell()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/symtable.html#symtable.Symbol.is_comp_iter" title="symtable.Symbol.is_comp_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_comp_iter()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/symtable.html#symtable.Symbol.is_free_class" title="symtable.Symbol.is_free_class"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_free_class()</span></code></a></p></li>
</ul>
<p class="translated">（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/120029">gh-120029</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="sys">
<h3 class="translated">sys<a class="headerlink" href="#sys" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">之前未写入文档的特殊函数 <a class="reference internal" href="../library/sys.html#sys.getobjects" title="sys.getobjects"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.getobjects()</span></code></a>，它仅存在于某些专用的 Python 构建版，现在可以从其他解释器而非调用它的解释器返回对象。 （由 Eric Snow 在 <a class="reference external" href="https://github.com/python/cpython/issues/125286">gh-125286</a> 中贡献。）.)</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../library/sys.html#sys._is_immortal" title="sys._is_immortal"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys._is_immortal()</span></code></a> 函数，用于判断一个对象是否为 <a class="reference internal" href="../glossary.html#term-immortal"><span class="xref std std-term">immortal</span></a>。 （由 Peter Bierma 在 <a class="reference external" href="https://github.com/python/cpython/issues/128509">gh-128509</a> 中贡献。）</p></li>
<li><p class="translated">在 FreeBSD 上，<a class="reference internal" href="../library/sys.html#sys.platform" title="sys.platform"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.platform</span></code></a> 将不再包含主版本号。 它将始终为 <code class="docutils literal notranslate"><span class="pre">'freebsd'</span></code>，而不是 <code class="docutils literal notranslate"><span class="pre">'freebsd13'</span></code> 或 <code class="docutils literal notranslate"><span class="pre">'freebsd14'</span></code>。 （由 Michael Osipov 在 <a class="reference external" href="https://github.com/python/cpython/issues/129393">gh-129393</a> 中贡献。）</p></li>
<li><p class="translated">为 <a class="reference internal" href="../library/sys.html#sys._clear_type_cache" title="sys._clear_type_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys._clear_type_cache()</span></code></a> 函数引发 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> 警告。该函数在 Python 3.13 中已被弃用，但此前并未引发运行时警告。</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/sys.html#sys.remote_exec" title="sys.remote_exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.remote_exec()</span></code></a> 以实现新的外部调试器接口。 请参阅 <a class="reference internal" href="#whatsnew314-remote-debugging"><span class="std std-ref">PEP 768</span></a> 了解详情。 （由 Pablo Galindo Salgado, Matt Wozniski 和 Ivona Stojanovic 在 <a class="reference external" href="https://github.com/python/cpython/issues/131591">gh-131591</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/sys.html#sys._jit" title="sys._jit"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys._jit</span></code></a> 命名空间，包含用于内省即时编译的工具。 （由 Brandt Bucher 在 <a class="reference external" href="https://github.com/python/cpython/issues/133231">gh-133231</a> 中贡献。）</p></li>
</ul>
</section>
<section id="sys-monitoring">
<h3 class="translated">sys.monitoring<a class="headerlink" href="#sys-monitoring" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">新增两个监视事件 <a class="reference internal" href="../library/sys.monitoring.html#monitoring-event-BRANCH_LEFT"><code class="xref std std-monitoring-event docutils literal notranslate"><span class="pre">BRANCH_LEFT</span></code></a> 和 <a class="reference internal" href="../library/sys.monitoring.html#monitoring-event-BRANCH_RIGHT"><code class="xref std std-monitoring-event docutils literal notranslate"><span class="pre">BRANCH_RIGHT</span></code></a>。 它们将替代并弃用 <code class="xref std std-monitoring-event docutils literal notranslate"><span class="pre">BRANCH</span></code> 事件。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/122548">gh-122548</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="sysconfig">
<h3 class="translated">sysconfig<a class="headerlink" href="#sysconfig" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">在 Windows 上为 <a class="reference internal" href="../library/sysconfig.html#sysconfig.get_config_vars" title="sysconfig.get_config_vars"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_config_vars()</span></code></a> 增加 <code class="docutils literal notranslate"><span class="pre">ABIFLAGS</span></code> 键。 （由 Xuehai Pan 在 <a class="reference external" href="https://github.com/python/cpython/issues/131799">gh-131799</a> 中贡献。）</p></li>
</ul>
</section>
<section id="tarfile">
<h3 class="translated">tarfile<a class="headerlink" href="#tarfile" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/tarfile.html#tarfile.data_filter" title="tarfile.data_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">data_filter()</span></code></a> 现在会对符号链接目标进行规范化处理，以避免路径遍历攻击。（由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/127987">gh-127987</a> 和 <span class="target" id="index-215"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2025-4138"><strong>CVE 2025-4138</strong></a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/tarfile.html#tarfile.TarFile.extractall" title="tarfile.TarFile.extractall"><code class="xref py py-func docutils literal notranslate"><span class="pre">extractall()</span></code></a> 现在在目录被移除或被其他类型的文件替换时，会跳过对目录属性的修复。（由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/127987">gh-127987</a> 和 <span class="target" id="index-216"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2024-12718"><strong>CVE 2024-12718</strong></a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/tarfile.html#tarfile.TarFile.extract" title="tarfile.TarFile.extract"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract()</span></code></a> 和 <a class="reference internal" href="../library/tarfile.html#tarfile.TarFile.extractall" title="tarfile.TarFile.extractall"><code class="xref py py-func docutils literal notranslate"><span class="pre">extractall()</span></code></a> 现在在以下两种情况会（重新）应用提取过滤器：一是用另一个归档成员的副本替换链接（硬链接或符号链接）时，二是修复目录属性时。前者会引发一个新异常 <a class="reference internal" href="../library/tarfile.html#tarfile.LinkFallbackError" title="tarfile.LinkFallbackError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">LinkFallbackError</span></code></a>。（由 Petr Viktorin 针对 <span class="target" id="index-217"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2025-4330"><strong>CVE 2025-4330</strong></a> 和 <span class="target" id="index-218"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2024-12718"><strong>CVE 2024-12718</strong></a> 贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/tarfile.html#tarfile.TarFile.extract" title="tarfile.TarFile.extract"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract()</span></code></a> 和 <a class="reference internal" href="../library/tarfile.html#tarfile.TarFile.extractall" title="tarfile.TarFile.extractall"><code class="xref py py-func docutils literal notranslate"><span class="pre">extractall()</span></code></a> 在 <a class="reference internal" href="../library/tarfile.html#tarfile.TarFile.errorlevel" title="tarfile.TarFile.errorlevel"><code class="xref py py-func docutils literal notranslate"><span class="pre">errorlevel()</span></code></a> 为 0 时，不再提取被拒绝的成员。（由 Matt Prodani 和 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/112887">gh-112887</a> 以及 <span class="target" id="index-219"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2025-4435"><strong>CVE 2025-4435</strong></a> 中贡献。）</p></li>
</ul>
</section>
<section id="threading">
<h3 class="translated">threading<a class="headerlink" href="#threading" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/threading.html#threading.Thread.start" title="threading.Thread.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.start()</span></code></a> 现在会将操作系统线程名称设置为 <a class="reference internal" href="../library/threading.html#threading.Thread.name" title="threading.Thread.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">threading.Thread.name</span></code></a>。（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/59705">gh-59705</a> 中贡献。）</p></li>
</ul>
</section>
<section id="tkinter">
<h3 class="translated">tkinter<a class="headerlink" href="#tkinter" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">让 <a class="reference internal" href="../library/tkinter.html#module-tkinter" title="tkinter: Interface to Tcl/Tk for graphical user interfaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter</span></code></a> 控件的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">after()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">after_idle()</span></code> 方法接受关键字参数。 （由 Zhikang Yan 在 <a class="reference external" href="https://github.com/python/cpython/issues/126899">gh-126899</a> 中贡献。）.)</p></li>
<li><p class="translated">增加为 <code class="xref py py-class docutils literal notranslate"><span class="pre">tkinter.OptionMenu</span></code> 和 <code class="xref py py-class docutils literal notranslate"><span class="pre">tkinter.ttk.OptionMenu</span></code> 指定名称的功能。 （由 Zhikang Yan 在 <a class="reference external" href="https://github.com/python/cpython/issues/130482">gh-130482</a> 中贡献。）</p></li>
</ul>
</section>
<section id="turtle">
<h3 class="translated">turtle（海龟绘图）<a class="headerlink" href="#turtle" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">为 <a class="reference internal" href="../library/turtle.html#turtle.fill" title="turtle.fill"><code class="xref py py-func docutils literal notranslate"><span class="pre">turtle.fill()</span></code></a>, <a class="reference internal" href="../library/turtle.html#turtle.poly" title="turtle.poly"><code class="xref py py-func docutils literal notranslate"><span class="pre">turtle.poly()</span></code></a> 和 <a class="reference internal" href="../library/turtle.html#turtle.no_animation" title="turtle.no_animation"><code class="xref py py-func docutils literal notranslate"><span class="pre">turtle.no_animation()</span></code></a> 增加上下文管理器。 （由 Marie Roald 和 Yngve Mardal Moe 在 <a class="reference external" href="https://github.com/python/cpython/issues/126350">gh-126350</a> 中贡献。）</p></li>
</ul>
</section>
<section id="types">
<h3 class="translated">types（类型）<a class="headerlink" href="#types" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/types.html#types.UnionType" title="types.UnionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.UnionType</span></code></a> 现在是 <a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Union</span></code></a> 的别名。更多详情请参见 <a class="reference internal" href="#whatsnew314-typing-union"><span class="std std-ref">下方</span></a>。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/105499">gh-105499</a> 中贡献。）</p></li>
</ul>
</section>
<section id="typing">
<h3 class="translated">typing<a class="headerlink" href="#typing" title="Link to this heading">¶</a></h3>
<ul id="whatsnew314-typing-union">
<li><p class="translated">现在 <a class="reference internal" href="../library/types.html#types.UnionType" title="types.UnionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.UnionType</span></code></a> 和 <a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Union</span></code></a> 类型互为别名，这意味着旧式联合（通过 <code class="docutils literal notranslate"><span class="pre">Union[int,</span> <span class="pre">str]</span></code> 创建）和新式联合（通过 <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">|</span> <span class="pre">str</span></code> 创建）现在都会创建相同的运行时类型的实例。 这统一了两种语法形式的行为，但也导致了一些行为差异并可能影响在运行时对类型进行内省的用户：</p>
<ul class="simple">
<li><p class="translated">两种创建联合的语法现在将在 <a class="reference internal" href="../library/functions.html#repr" title="repr"><code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code></a> 中产生相同的字符串表示形式。 例如，<code class="docutils literal notranslate"><span class="pre">repr(Union[int,</span> <span class="pre">str])</span></code> 现在将为 <code class="docutils literal notranslate"><span class="pre">&quot;int</span> <span class="pre">|</span> <span class="pre">str&quot;</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">&quot;typing.Union[int,</span> <span class="pre">str]&quot;</span></code>。</p></li>
<li><p class="translated">使用旧语法创建的联合将不再被缓存。 在之前版本中，多次运行 <code class="docutils literal notranslate"><span class="pre">Union[int,</span> <span class="pre">str]</span></code> 会返回同一个对象 (<code class="docutils literal notranslate"><span class="pre">Union[int,</span> <span class="pre">str]</span> <span class="pre">is</span> <span class="pre">Union[int,</span> <span class="pre">str]</span></code> 将为 <code class="docutils literal notranslate"><span class="pre">True</span></code>)，但现在会返回两个不同的对象。 请使用 <code class="docutils literal notranslate"><span class="pre">==</span></code> 来比较联合是否相等，而不要用 <code class="docutils literal notranslate"><span class="pre">is</span></code>。 新式联合从未以这种方式进行缓存。 这一变化可能会增加某些程序的内存占用，这些程序会通过下标 <code class="docutils literal notranslate"><span class="pre">typing.Union</span></code> 创建大量联合。 不过，有几个因素会缓解这种开销：由于 <span class="target" id="index-220"></span><a class="pep reference external" href="https://peps.python.org/pep-0649/"><strong>PEP 649</strong></a> 的引入在 Python 3.14 中默认不再对标注中使用的联合进行求值；<a class="reference internal" href="../library/types.html#types.UnionType" title="types.UnionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.UnionType</span></code></a> 的实例本身要比之前 Python 版本中 <code class="docutils literal notranslate"><span class="pre">Union[]</span></code> 返回的对象小得多；并且移除缓存也节省了部分空间。 因此对于大多数用户来说这一变化不太可能导致内存占用的显著增加。</p></li>
<li><p class="translated">在之前版本中，旧式联合是使用私有类 <code class="docutils literal notranslate"><span class="pre">typing._UnionGenericAlias</span></code> 来实现的。 该类对当前的实现来说已不再需要，但它仍被保留用于向下兼容，计划在 Python 3.17 中移除。 用户应当使用写入文档的内省辅助函数如 <a class="reference internal" href="../library/typing.html#typing.get_origin" title="typing.get_origin"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_origin()</span></code></a> 和 <a class="reference internal" href="../library/typing.html#typing.get_args" title="typing.get_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.get_args()</span></code></a> 而不是依赖私有的实现细节。</p></li>
<li><p class="translated">现在可以在 <a class="reference internal" href="../library/functions.html#isinstance" title="isinstance"><code class="xref py py-func docutils literal notranslate"><span class="pre">isinstance()</span></code></a> 检查中使用 <a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Union</span></code></a> 本身。例如，<code class="docutils literal notranslate"><span class="pre">isinstance(int</span> <span class="pre">|</span> <span class="pre">str,</span> <span class="pre">typing.Union)</span></code> 将返回 <code class="docutils literal notranslate"><span class="pre">True</span></code>；而此前这会引发 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Union</span></code></a> 对象的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">__args__</span></code> 属性已不再可写。</p></li>
<li><p class="translated">现在已无法设置 <a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">Union</span></code></a> 对象的任何属性。 在之前版本中设置操作只对双下划线属性有效，从未在文档中写明，并且在许多情况下也有潜在问题。</p></li>
</ul>
<p class="translated">（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/105499">gh-105499</a> 中贡献。）</p>
</li>
<li><p class="translated"><a class="reference internal" href="../library/typing.html#typing.TypeAliasType" title="typing.TypeAliasType"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeAliasType</span></code></a> 现在支持星号解包操作。</p></li>
</ul>
</section>
<section id="unicodedata">
<h3 class="translated">unicodedata<a class="headerlink" href="#unicodedata" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">Unicode 数据库已更新到 16.0.0 版本。</p></li>
</ul>
</section>
<section id="unittest">
<h3 class="translated">unittest<a class="headerlink" href="#unittest" title="Link to this heading">¶</a></h3>
<ul id="whatsnew314-color-unittest">
<li><p class="translated"><a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> 模块的输出现在默认启用彩色显示，可通过 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">环境变量</span></a> 进行控制。（由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/127221">gh-127221</a> 中贡献。）</p></li>
<li><p class="translated">unittest 发现机制重新支持将 <a class="reference internal" href="../glossary.html#term-namespace-package"><span class="xref std std-term">namespace package</span></a> 作为起始目录，该功能曾在 Python 3.11 中被移除。 （由 Jacob Walls 在 <a class="reference external" href="https://github.com/python/cpython/issues/80958">gh-80958</a> 中贡献。）</p></li>
<li><p class="translated">在 <a class="reference internal" href="../library/unittest.html#unittest.TestCase" title="unittest.TestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestCase</span></code></a> 类中新增了多个方法，这些方法可提供更专门化的测试。</p>
<ul class="simple">
<li><p class="untranslated"><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertHasAttr" title="unittest.TestCase.assertHasAttr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertHasAttr()</span></code></a> and
<a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotHasAttr" title="unittest.TestCase.assertNotHasAttr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotHasAttr()</span></code></a> check whether the object
has a particular attribute.</p></li>
<li><p class="translated"><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertIsSubclass" title="unittest.TestCase.assertIsSubclass"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertIsSubclass()</span></code></a> 和 <a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotIsSubclass" title="unittest.TestCase.assertNotIsSubclass"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotIsSubclass()</span></code></a> 用于检查对象是否是某个特定类的子类，或者是否是某个类元组中任一类的子类。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertStartsWith" title="unittest.TestCase.assertStartsWith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertStartsWith()</span></code></a>、<a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotStartsWith" title="unittest.TestCase.assertNotStartsWith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotStartsWith()</span></code></a>、<a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertEndsWith" title="unittest.TestCase.assertEndsWith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertEndsWith()</span></code></a> 和 <a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotEndsWith" title="unittest.TestCase.assertNotEndsWith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotEndsWith()</span></code></a> 用于检查 Unicode 字符串或字节串是否以特定字符串开头或结尾。</p></li>
</ul>
<p class="translated">（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/71339">gh-71339</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="urllib">
<h3 class="translated">urllib<a class="headerlink" href="#urllib" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">升级 <a class="reference internal" href="../library/urllib.request.html#module-urllib.request" title="urllib.request: Extensible library for opening URLs."><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib.request</span></code></a> 的 HTTP 摘要认证算法，支持 <span class="target" id="index-221"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7616.html"><strong>RFC 7616</strong></a> 中规定的 SHA-256 摘要认证。（由 Calvin Bui 在 <a class="reference external" href="https://github.com/python/cpython/issues/128193">gh-128193</a> 中贡献。）</p></li>
<li><p class="translated">改进解析和生成 <code class="docutils literal notranslate"><span class="pre">file:</span></code> URL 时的易用性和标准合规性。</p>
<p class="translated">在 <a class="reference internal" href="../library/urllib.request.html#urllib.request.url2pathname" title="urllib.request.url2pathname"><code class="xref py py-func docutils literal notranslate"><span class="pre">url2pathname()</span></code></a> 中：</p>
<ul class="simple">
<li><p class="translated">当新的 <em>require_scheme</em> 参数设为 true 时，接受完整的 URL。</p></li>
<li><p class="translated">如果 URL 的权限部分与本地主机名匹配，则舍弃该部分。</p></li>
<li><p class="translated">当新的 <em>resolve_host</em> 参数设为 true 时，若 URL 的权限部分解析为本地 IP 地址，则舍弃该部分。</p></li>
<li><p class="translated">丢弃 URL 查询和片段组件。</p></li>
<li><p class="translated">如果 URL 的权限部分不是本地的，则引发 <a class="reference internal" href="../library/urllib.error.html#urllib.error.URLError" title="urllib.error.URLError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">URLError</span></code></a>，但在 Windows 系统上，仍会像以前一样返回 UNC 路径。</p></li>
</ul>
<p class="translated">在 <a class="reference internal" href="../library/urllib.request.html#urllib.request.pathname2url" title="urllib.request.pathname2url"><code class="xref py py-func docutils literal notranslate"><span class="pre">pathname2url()</span></code></a> 中：</p>
<ul class="simple">
<li><p class="translated">当新的 <em>add_scheme</em> 参数设为 true 时，返回完整的 URL。</p></li>
<li><p class="translated">当路径以斜杠开头时，包含一个空的 URL 权限部分。例如，路径 <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code> 会被转换为 URL <code class="docutils literal notranslate"><span class="pre">///etc/hosts</span></code>。</p></li>
</ul>
<p class="translated">在 Windows 系统上，盘符不再转换为大写，且非紧跟在驱动器号后的 <code class="docutils literal notranslate"><span class="pre">:</span></code> 字符不再引发 <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 异常。</p>
<p class="translated">（由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/125866">gh-125866</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="uuid">
<h3 class="translated">uuid<a class="headerlink" href="#uuid" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">通过 <a class="reference internal" href="../library/uuid.html#uuid.uuid6" title="uuid.uuid6"><code class="xref py py-func docutils literal notranslate"><span class="pre">uuid6()</span></code></a>, <a class="reference internal" href="../library/uuid.html#uuid.uuid7" title="uuid.uuid7"><code class="xref py py-func docutils literal notranslate"><span class="pre">uuid7()</span></code></a> 和 <a class="reference internal" href="../library/uuid.html#uuid.uuid8" title="uuid.uuid8"><code class="xref py py-func docutils literal notranslate"><span class="pre">uuid8()</span></code></a> 分别添加对 UUID 第 6, 7 和 8 版的支持，具体规范见 <span class="target" id="index-222"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9562.html"><strong>RFC 9562</strong></a>。 （由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/89083">gh-89083</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/uuid.html#uuid.NIL" title="uuid.NIL"><code class="xref py py-const docutils literal notranslate"><span class="pre">NIL</span></code></a> 和 <a class="reference internal" href="../library/uuid.html#uuid.MAX" title="uuid.MAX"><code class="xref py py-const docutils literal notranslate"><span class="pre">MAX</span></code></a> 现已可用于表示 <span class="target" id="index-223"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9562.html"><strong>RFC 9562</strong></a> 中定义的 Nil 和 Max UUID 格式。 （由 Nick Pope 在 <a class="reference external" href="https://github.com/python/cpython/issues/128427">gh-128427</a> 中贡献。）</p></li>
<li><p class="translated">允许通过 <a class="reference internal" href="../library/uuid.html#cmdoption-uuid-count"><code class="xref std std-option docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">uuid</span> <span class="pre">--count</span></code></a> 在命令行中同时生成多个 UUID。 （由 Simon Legner 在 <a class="reference external" href="https://github.com/python/cpython/issues/131236">gh-131236</a> 中贡献。）</p></li>
</ul>
</section>
<section id="webbrowser">
<h3 class="translated">webbrowser<a class="headerlink" href="#webbrowser" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated"><span class="target" id="index-224"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">BROWSER</span></code> 环境变量中的名称现在可以引用 <a class="reference internal" href="../library/webbrowser.html#module-webbrowser" title="webbrowser: Easy-to-use controller for web browsers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">webbrowser</span></code></a> 模块中已注册的浏览器，而不必总是生成新的浏览器命令。</p>
<p class="translated">这使得可以将 <span class="target" id="index-225"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">BROWSER</span></code> 设置为 macOS 上受支持的浏览器之一的值。</p>
</li>
</ul>
</section>
<section id="zipfile">
<h3 class="translated">zipfile<a class="headerlink" href="#zipfile" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <a class="reference internal" href="../library/zipfile.html#zipfile.ZipInfo._for_archive" title="zipfile.ZipInfo._for_archive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ZipInfo._for_archive</span></code></a> 方法，用于为 <a class="reference internal" href="../library/zipfile.html#zipfile.ZipInfo" title="zipfile.ZipInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZipInfo</span></code></a> 对象解析适当的默认值并由 <a class="reference internal" href="../library/zipfile.html#zipfile.ZipFile.writestr" title="zipfile.ZipFile.writestr"><code class="xref py py-func docutils literal notranslate"><span class="pre">ZipFile.writestr</span></code></a> 使用。 （由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/123424">gh-123424</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/zipfile.html#zipfile.ZipFile.writestr" title="zipfile.ZipFile.writestr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ZipFile.writestr()</span></code></a> 现在会遵从 <span class="target" id="index-226"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">SOURCE_DATE_EPOCH</span></code> 环境变量设置以便更好地支持可复现的构建。 （由 Jiahao Li 在 <a class="reference external" href="https://github.com/python/cpython/issues/91279">gh-91279</a> 中贡献。）</p></li>
</ul>
</section>
</section>
<section id="optimizations">
<h2 class="translated">性能优化<a class="headerlink" href="#optimizations" title="Link to this heading">¶</a></h2>
<ul>
<li><p class="translated">几个标准库模块的导入时间已得到改进，包括 <a class="reference internal" href="../library/annotationlib.html#module-annotationlib" title="annotationlib: Functionality for introspecting annotations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">annotationlib</span></code></a>、<a class="reference internal" href="../library/ast.html#module-ast" title="ast: Abstract Syntax Tree classes and manipulation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ast</span></code></a>、<a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a>、<a class="reference internal" href="../library/base64.html#module-base64" title="base64: RFC 4648: Base16, Base32, Base64 Data Encodings; Base85 and Ascii85"><code class="xref py py-mod docutils literal notranslate"><span class="pre">base64</span></code></a>、<a class="reference internal" href="../library/cmd.html#module-cmd" title="cmd: Build line-oriented command interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">cmd</span></code></a>、<a class="reference internal" href="../library/csv.html#module-csv" title="csv: Write and read tabular data to and from delimited files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">csv</span></code></a>、<a class="reference internal" href="../library/gettext.html#module-gettext" title="gettext: Multilingual internationalization services."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gettext</span></code></a>、<a class="reference internal" href="../library/importlib.html#module-importlib.util" title="importlib.util: Utility code for importers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.util</span></code></a>、<a class="reference internal" href="../library/locale.html#module-locale" title="locale: Internationalization services."><code class="xref py py-mod docutils literal notranslate"><span class="pre">locale</span></code></a>、<a class="reference internal" href="../library/mimetypes.html#module-mimetypes" title="mimetypes: Mapping of filename extensions to MIME types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code></a>、<a class="reference internal" href="../library/optparse.html#module-optparse" title="optparse: Command-line option parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>、<a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>、<a class="reference internal" href="../library/pprint.html#module-pprint" title="pprint: Data pretty printer."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pprint</span></code></a>、<a class="reference internal" href="../library/profile.html#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a>、<a class="reference internal" href="../library/shlex.html#module-shlex" title="shlex: Simple lexical analysis for Unix shell-like languages."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shlex</span></code></a>、<a class="reference internal" href="../library/socket.html#module-socket" title="socket: Low-level networking interface."><code class="xref py py-mod docutils literal notranslate"><span class="pre">socket</span></code></a>、<a class="reference internal" href="../library/string.html#module-string" title="string: Common string operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">string</span></code></a>、<a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a>、<a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a>、<a class="reference internal" href="../library/tomllib.html#module-tomllib" title="tomllib: Parse TOML files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tomllib</span></code></a>、<a class="reference internal" href="../library/types.html#module-types" title="types: Names for built-in types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">types</span></code></a> 和 <a class="reference internal" href="../library/zipfile.html#module-zipfile" title="zipfile: Read and write ZIP-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a>。</p>
<p class="translated">（由 Adam Turner、Bénédikt Tran、Chris Markiewicz、Eli Schwartz、Hugo van Kemenade、Jelle Zijlstra 等人在 <a class="reference external" href="https://github.com/python/cpython/issues/118761">gh-118761</a> 中贡献。）</p>
</li>
<li><p class="translated">现在解释器会在确保安全时避免某些引用计数修改。 这可能导致从 <a class="reference internal" href="../library/sys.html#sys.getrefcount" title="sys.getrefcount"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.getrefcount()</span></code></a> 和 <a class="reference internal" href="../c-api/refcounting.html#c.Py_REFCNT" title="Py_REFCNT"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_REFCNT()</span></code></a> 返回的值相比之前的 Python 版本出现差异。 请参阅 <a class="reference internal" href="#whatsnew314-refcount"><span class="std std-ref">下文</span></a> 了解详情。</p></li>
</ul>
<section id="id2">
<h3 class="translated">asyncio<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">在为 <a class="reference internal" href="../library/asyncio-task.html#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">原生任务</span></code></a> 实现新的每线程双链表之后标准的基准测试结果有 10-20% 的提升，同时还减少了内存使用。 这使得外部内省工具如 <a class="reference internal" href="#whatsnew314-asyncio-introspection"><span class="std std-ref">python -m asyncio pstree</span></a> 能够对在所有线程中运行的 asyncio 任务的调用图进行内省。 （由 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/107803">gh-107803</a> 中贡献。）</p></li>
<li><p class="translated">该模块现在对 <a class="reference internal" href="../glossary.html#term-free-threading"><span class="xref std std-term">自由线程构建</span></a> 提供了一流的支持。这使得多个事件循环可以在不同线程中并行执行，并且随着线程数量的增加线性扩展。（由 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/128002">gh-128002</a> 中贡献。）</p></li>
</ul>
</section>
<section id="base64">
<h3 class="translated">base64<a class="headerlink" href="#base64" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/base64.html#base64.b16decode" title="base64.b16decode"><code class="xref py py-func docutils literal notranslate"><span class="pre">b16decode()</span></code></a> 的速度现在提升了高达六倍。（由 Bénédikt Tran、Chris Markiewicz 和 Adam Turner 在 <a class="reference external" href="https://github.com/python/cpython/issues/118761">gh-118761</a> 中贡献。）</p></li>
</ul>
</section>
<section id="bdb">
<h3 class="translated">bdb<a class="headerlink" href="#bdb" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">基本调试器现在有了基于 <a class="reference internal" href="../library/sys.monitoring.html#module-sys.monitoring" title="sys.monitoring: Access and control event monitoring"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys.monitoring</span></code></a> 的后端，可以通过将 <code class="docutils literal notranslate"><span class="pre">'monitoring'</span></code> 传递给 <a class="reference internal" href="../library/bdb.html#bdb.Bdb" title="bdb.Bdb"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bdb</span></code></a> 类的新 <em>backend</em> 参数来选择。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/124533">gh-124533</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id3">
<h3 class="translated">difflib<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/difflib.html#difflib.IS_LINE_JUNK" title="difflib.IS_LINE_JUNK"><code class="xref py py-func docutils literal notranslate"><span class="pre">IS_LINE_JUNK()</span></code></a> 函数的速度现在提升了一倍。（由 Adam Turner 和 Semyon Moroz 在 <a class="reference external" href="https://github.com/python/cpython/issues/130167">gh-130167</a> 中贡献。）</p></li>
</ul>
</section>
<section id="gc">
<h3 class="translated">gc<a class="headerlink" href="#gc" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">新的 <a class="reference internal" href="#whatsnew314-incremental-gc"><span class="std std-ref">增量垃圾回收器</span></a> 意味着对于较大的堆，最大暂停时间减少了至少一个数量级。</p>
<p class="translated">由于这种优化，<a class="reference internal" href="../library/gc.html#gc.get_threshold" title="gc.get_threshold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_threshold()</span></code></a> 和 <a class="reference internal" href="../library/gc.html#gc.set_threshold" title="gc.set_threshold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_threshold()</span></code></a> 的结果含义发生了变化，同时还有 <a class="reference internal" href="../library/gc.html#gc.get_count" title="gc.get_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_count()</span></code></a> 和 <a class="reference internal" href="../library/gc.html#gc.get_stats" title="gc.get_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stats()</span></code></a>。</p>
<ul class="simple">
<li><p class="translated">为了向后兼容，<a class="reference internal" href="../library/gc.html#gc.get_threshold" title="gc.get_threshold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_threshold()</span></code></a> 继续返回一个三项元组。第一个值是年轻代回收的阈值，与之前相同；第二个值决定了老年代回收的扫描速率（默认值为10，值越高意味着老年代回收扫描越慢）。第三个值现在没有意义，总是为零。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/gc.html#gc.set_threshold" title="gc.set_threshold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_threshold()</span></code></a> 现在会忽略第二个之后的任何项。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/gc.html#gc.get_count" title="gc.get_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_count()</span></code></a> 和 <a class="reference internal" href="../library/gc.html#gc.get_stats" title="gc.get_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stats()</span></code></a> 方法仍返回相同格式的结果。唯一的区别在于，结果不再分别对应新生代、老化代和老年代，而是对应新生代以及老年代的待老化空间和回收空间。</p></li>
</ul>
<p class="translated">总之，尝试操控循环垃圾回收器行为的代码可能无法完全按预期工作，但几乎不会造成危害。其他所有代码都将正常运行。</p>
<p class="translated">（由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/108362">gh-108362</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="id4">
<h3 class="translated">io<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">打开和读取文件现在执行更少的系统调用。完整读取一个小型操作系统缓存文件的速度提高了最多15%。（由 Cody Maloney 和 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/120754">gh-120754</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/90102">gh-90102</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id5">
<h3 class="translated">pathlib<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#pathlib.Path.read_bytes" title="pathlib.Path.read_bytes"><code class="xref py py-func docutils literal notranslate"><span class="pre">Path.read_bytes</span></code></a> 现在使用无缓冲模式打开文件，完整读取的速度提高了 9% 到 17%。（由 Cody Maloney 在 <a class="reference external" href="https://github.com/python/cpython/issues/120754">gh-120754</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id6">
<h3 class="translated">pdb<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 现在支持两种后端，基于 <a class="reference internal" href="../library/sys.html#sys.settrace" title="sys.settrace"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.settrace()</span></code></a> 或 <a class="reference internal" href="../library/sys.monitoring.html#module-sys.monitoring" title="sys.monitoring: Access and control event monitoring"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys.monitoring</span></code></a>。使用 <a class="reference internal" href="../library/pdb.html#pdb-cli"><span class="std std-ref">pdb CLI</span></a> 或 <a class="reference internal" href="../library/functions.html#breakpoint" title="breakpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">breakpoint()</span></code></a> 将始终使用 <a class="reference internal" href="../library/sys.monitoring.html#module-sys.monitoring" title="sys.monitoring: Access and control event monitoring"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys.monitoring</span></code></a> 后端。显式实例化 <a class="reference internal" href="../library/pdb.html#pdb.Pdb" title="pdb.Pdb"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdb.Pdb</span></code></a> 及其派生类将默认使用 <a class="reference internal" href="../library/sys.html#sys.settrace" title="sys.settrace"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.settrace()</span></code></a> 后端，这是可配置的。（由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/124533">gh-124533</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id7">
<h3 class="translated">uuid<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/uuid.html#uuid.uuid3" title="uuid.uuid3"><code class="xref py py-func docutils literal notranslate"><span class="pre">uuid3()</span></code></a> 和 <a class="reference internal" href="../library/uuid.html#uuid.uuid5" title="uuid.uuid5"><code class="xref py py-func docutils literal notranslate"><span class="pre">uuid5()</span></code></a> 对于16字节名称的速度现在大约提高了40%，对于1024字节名称的速度提高了20%。更长名称的性能保持不变。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/128150">gh-128150</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/uuid.html#uuid.uuid4" title="uuid.uuid4"><code class="xref py py-func docutils literal notranslate"><span class="pre">uuid4()</span></code></a> 的速度现在提高了约30%。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/128150">gh-128150</a> 中贡献。）</p></li>
</ul>
</section>
<section id="zlib">
<h3 class="translated">zlib<a class="headerlink" href="#zlib" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">在 Windows 上，<a class="reference external" href="https://github.com/zlib-ng/zlib-ng">zlib-ng</a> 现在用作默认二进制文件中 <a class="reference internal" href="../library/zlib.html#module-zlib" title="zlib: Low-level interface to compression and decompression routines compatible with gzip."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zlib</span></code></a> 模块的实现。已知 <code class="docutils literal notranslate"><span class="pre">zlib-ng</span></code> 与之前使用的 <code class="docutils literal notranslate"><span class="pre">zlib</span></code> 实现之间没有不兼容性。这应在所有压缩级别上带来更好的性能。</p>
<p class="translated">值得注意的是，<code class="docutils literal notranslate"><span class="pre">zlib.Z_BEST_SPEED</span></code> （<code class="docutils literal notranslate"><span class="pre">1</span></code>） 可能会导致比之前的实现显著更低的压缩率，同时显著减少压缩所需的时间。</p>
<p class="translated">（由 Steve Dower 在 <a class="reference external" href="https://github.com/python/cpython/issues/91349">gh-91349</a> 中贡献。）</p>
</li>
</ul>
</section>
</section>
<section id="removed">
<h2 class="translated">移除<a class="headerlink" href="#removed" title="Link to this heading">¶</a></h2>
<section id="id8">
<h3 class="translated">argparse<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">移除 <code class="xref py py-class docutils literal notranslate"><span class="pre">BooleanOptionalAction</span></code> 的 <em>type</em>、 <em>choices</em> 和 <em>metavar</em> 形参。 它们自 Python 3.12 起已被弃用。 （由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/118805">gh-118805</a> 中贡献。）</p></li>
<li><p class="translated">在参数组上调用 <a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser.add_argument_group" title="argparse.ArgumentParser.add_argument_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_argument_group()</span></code></a> 现在会引发 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。 类似地，在互斥组上调用 <a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser.add_argument_group" title="argparse.ArgumentParser.add_argument_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_argument_group()</span></code></a> 或 <a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser.add_mutually_exclusive_group" title="argparse.ArgumentParser.add_mutually_exclusive_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_mutually_exclusive_group()</span></code></a> 现在都会引发 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。 这种“嵌套调用”从未被支持，经常无法正常工作，且通过继承关系被意外暴露。 该功能自 Python 3.11 起已被弃用。 （由 Savannah Ostrowski 在 <a class="reference external" href="https://github.com/python/cpython/issues/127186">gh-127186</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id9">
<h3 class="translated">ast（抽象语法树）<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">移除以下自 Python 3.8 起作为 <a class="reference internal" href="../library/ast.html#ast.Constant" title="ast.Constant"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code></a> 的已弃用别名，且自 Python 3.12 起已发出弃用警告的类：</p>
<ul class="simple">
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bytes</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ellipsis</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">NameConstant</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">Num</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">Str</span></code></p></li>
</ul>
<p class="translated">由于这些移除操作，当自定义的 <a class="reference internal" href="../library/ast.html#ast.NodeVisitor" title="ast.NodeVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeVisitor</span></code></a> 子类访问抽象语法树（AST）时，用户定义的 <code class="docutils literal notranslate"><span class="pre">visit_Num</span></code>、<code class="docutils literal notranslate"><span class="pre">visit_Str</span></code>、<code class="docutils literal notranslate"><span class="pre">visit_Bytes</span></code>、<code class="docutils literal notranslate"><span class="pre">visit_NameConstant</span></code> 和 <code class="docutils literal notranslate"><span class="pre">visit_Ellipsis</span></code> 方法将不再被调用。请改用定义 <code class="docutils literal notranslate"><span class="pre">visit_Constant</span></code> 方法。</p>
<p class="translated">（由 Alex Waygood 在 <a class="reference external" href="https://github.com/python/cpython/issues/119562">gh-119562</a> 中贡献。）</p>
</li>
<li><p class="translated">移除以下 <a class="reference internal" href="../library/ast.html#ast.Constant" title="ast.Constant"><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.Constant</span></code></a> 为兼容现已移除的 AST 类而保留的已弃用属性：</p>
<ul class="simple">
<li><p class="translated"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Constant.n</span></code></p></li>
<li><p class="translated"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Constant.s</span></code></p></li>
</ul>
<p class="translated">改用 <code class="xref py py-attr docutils literal notranslate"><span class="pre">Constant.value</span></code>。 （由 Alex Waygood 在 <a class="reference external" href="https://github.com/python/cpython/issues/119562">gh-119562</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="id10">
<h3 class="translated">asyncio<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">移除以下自 Python 3.12 起已被弃用的类、方法和函数：</p>
<ul class="simple">
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractChildWatcher</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastChildWatcher</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiLoopChildWatcher</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">PidfdChildWatcher</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">SafeChildWatcher</span></code></p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadedChildWatcher</span></code></p></li>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AbstractEventLoopPolicy.get_child_watcher()</span></code></p></li>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AbstractEventLoopPolicy.set_child_watcher()</span></code></p></li>
<li><p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_child_watcher()</span></code></p></li>
<li><p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_child_watcher()</span></code></p></li>
</ul>
<p class="translated">（由 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/120804">gh-120804</a> 中贡献。）</p>
</li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.get_event_loop" title="asyncio.get_event_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.get_event_loop()</span></code></a> 现在如果没有当前事件循环，会引发 <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> 异常，且不再隐式创建事件循环。</p>
<p class="translated">（由 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/126353">gh-126353</a> 中贡献。）</p>
<p class="translated">当前存在几种使用 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.get_event_loop" title="asyncio.get_event_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.get_event_loop()</span></code></a> 的模式，其中大多数可替换为 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.run()</span></code></a>。</p>
<p class="translated">如果正在运行异步函数，直接使用 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.run()</span></code></a> 即可。</p>
<p class="translated">之前：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>


<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p class="translated">之后：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
<p class="translated">如果需要启动某些持续运行的服务，例如监听套接字的服务器，请使用 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.run()</span></code></a> 配合 <a class="reference internal" href="../library/asyncio-sync.html#asyncio.Event" title="asyncio.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.Event</span></code></a> 实现。</p>
<p class="translated">之前：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">start_server</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span> <span class="o">...</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">start_server</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p class="translated">之后：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">start_server</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span> <span class="o">...</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">start_server</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">())</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
<p class="translated">如果需要在事件循环中运行某些任务，同时在其前后执行阻塞代码，请使用 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.Runner" title="asyncio.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.Runner</span></code></a>。</p>
<p class="translated">之前：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">operation_one</span><span class="p">():</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">blocking_code</span><span class="p">():</span> <span class="o">...</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">operation_two</span><span class="p">():</span> <span class="o">...</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">operation_one</span><span class="p">())</span>
    <span class="n">blocking_code</span><span class="p">()</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">operation_two</span><span class="p">())</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p class="translated">之后：</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">operation_one</span><span class="p">():</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">blocking_code</span><span class="p">():</span> <span class="o">...</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">operation_two</span><span class="p">():</span> <span class="o">...</span>

<span class="k">with</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Runner</span><span class="p">()</span> <span class="k">as</span> <span class="n">runner</span><span class="p">:</span>
    <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">operation_one</span><span class="p">())</span>
    <span class="n">blocking_code</span><span class="p">()</span>
    <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">operation_two</span><span class="p">())</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="email">
<h3 class="translated">email<a class="headerlink" href="#email" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">移除 <a class="reference internal" href="../library/email.utils.html#email.utils.localtime" title="email.utils.localtime"><code class="xref py py-func docutils literal notranslate"><span class="pre">email.utils.localtime()</span></code></a> 函数的 <em>isdst</em> 形参。该参数自 Python 3.12 起已被弃用且一直被忽略。（由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/118798">gh-118798</a> 中贡献。）</p></li>
</ul>
</section>
<section id="importlib-abc">
<h3 class="translated">importlib.abc<a class="headerlink" href="#importlib-abc" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">移除已弃用的 <a class="reference internal" href="../library/importlib.html#module-importlib.abc" title="importlib.abc: Abstract base classes related to import"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.abc</span></code></a> 类：</p>
<ul class="simple">
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceReader</span></code> (使用 <a class="reference internal" href="../library/importlib.resources.abc.html#importlib.resources.abc.TraversableResources" title="importlib.resources.abc.TraversableResources"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraversableResources</span></code></a>)</p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">Traversable</span></code> (使用 <a class="reference internal" href="../library/importlib.resources.abc.html#importlib.resources.abc.Traversable" title="importlib.resources.abc.Traversable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Traversable</span></code></a>)</p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraversableResources</span></code> (使用 <a class="reference internal" href="../library/importlib.resources.abc.html#importlib.resources.abc.TraversableResources" title="importlib.resources.abc.TraversableResources"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraversableResources</span></code></a>)</p></li>
</ul>
<p class="translated">（由 Jason R. Coombs 和 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/93963">gh-93963</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="itertools">
<h3 class="translated">itertools<a class="headerlink" href="#itertools" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">移除 <a class="reference internal" href="../library/itertools.html#module-itertools" title="itertools: Functions creating iterators for efficient looping."><code class="xref py py-mod docutils literal notranslate"><span class="pre">itertools</span></code></a> 迭代器对复制（copy）、深度复制（deepcopy）和序列化（pickle）操作的支持。自 Python 3.12 起，这些操作已触发 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> 警告。（由 Raymond Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/101588">gh-101588</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id11">
<h3 class="translated">pathlib<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">移除向 <a class="reference internal" href="../library/pathlib.html#pathlib.Path" title="pathlib.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> 传递额外关键字参数的支持。在先前版本中，此类参数均会被忽略。（由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/74033">gh-74033</a> 中贡献。）</p></li>
<li><p class="translated">移除向 <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.relative_to" title="pathlib.PurePath.relative_to"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PurePath.relative_to()</span></code></a> 和 <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.is_relative_to" title="pathlib.PurePath.is_relative_to"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_relative_to()</span></code></a> 方法传递额外位置参数的支持。在先前版本中，此类参数会被拼接到 <em>other</em> 参数上。（由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/78707">gh-78707</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pkgutil">
<h3 class="translated">pkgutil<a class="headerlink" href="#pkgutil" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">移除 <code class="xref py py-func docutils literal notranslate"><span class="pre">get_loader()</span></code> 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">find_loader()</span></code> 函数，这两个函数自 Python 3.12 起已被弃用。（由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/97850">gh-97850</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pty">
<h3 class="translated">pty<a class="headerlink" href="#pty" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">移除 <code class="xref py py-func docutils literal notranslate"><span class="pre">master_open()</span></code> 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">slave_open()</span></code> 函数，这两个函数自 Python 3.12 起已被弃用。请改用 <a class="reference internal" href="../library/pty.html#pty.openpty" title="pty.openpty"><code class="xref py py-func docutils literal notranslate"><span class="pre">pty.openpty()</span></code></a> 函数。</p></li>
</ul>
</section>
<section id="sqlite3">
<h3 class="translated">sqlite3<a class="headerlink" href="#sqlite3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">从 <a class="reference internal" href="../library/sqlite3.html#module-sqlite3" title="sqlite3: A DB-API 2.0 implementation using SQLite 3.x."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code></a> 模块中移除 <code class="xref py py-data docutils literal notranslate"><span class="pre">version</span></code> 和 <code class="xref py py-data docutils literal notranslate"><span class="pre">version_info</span></code>；请使用 <a class="reference internal" href="../library/sqlite3.html#sqlite3.sqlite_version" title="sqlite3.sqlite_version"><code class="xref py py-data docutils literal notranslate"><span class="pre">sqlite_version</span></code></a> 和 <a class="reference internal" href="../library/sqlite3.html#sqlite3.sqlite_version_info" title="sqlite3.sqlite_version_info"><code class="xref py py-data docutils literal notranslate"><span class="pre">sqlite_version_info</span></code></a> 来获取运行时 SQLite 库的实际版本号。（由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/118924">gh-118924</a> 中贡献。）</p></li>
<li><p class="translated">现在，使用带具名占位符的形参序列会引发 <a class="reference internal" href="../library/sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ProgrammingError</span></code></a> 异常，该用法自 Python 3.12 起已被弃用。（由 Erlend E. Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/118928">gh-118928</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/101693">gh-101693</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id12">
<h3 class="translated">urllib<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">从 <a class="reference internal" href="../library/urllib.parse.html#module-urllib.parse" title="urllib.parse: Parse URLs into or assemble them from components."><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib.parse</span></code></a> 模块中移除 <code class="xref py py-class docutils literal notranslate"><span class="pre">Quoter</span></code> 类，该类自 Python 3.11 起已被弃用。（由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/118827">gh-118827</a> 中贡献。）</p></li>
<li><p class="translated">从 <a class="reference internal" href="../library/urllib.request.html#module-urllib.request" title="urllib.request: Extensible library for opening URLs."><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib.request</span></code></a> 模块中移除 <code class="xref py py-class docutils literal notranslate"><span class="pre">URLopener</span></code> 和 <code class="xref py py-class docutils literal notranslate"><span class="pre">FancyURLopener</span></code> 类，这两个类自 Python 3.3 起已被弃用。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">myopener.open()</span></code> 可以替换为 <a class="reference internal" href="../library/urllib.request.html#urllib.request.urlopen" title="urllib.request.urlopen"><code class="xref py py-func docutils literal notranslate"><span class="pre">urlopen()</span></code></a>。<code class="docutils literal notranslate"><span class="pre">myopener.retrieve()</span></code> 可以替换为 <a class="reference internal" href="../library/urllib.request.html#urllib.request.urlretrieve" title="urllib.request.urlretrieve"><code class="xref py py-func docutils literal notranslate"><span class="pre">urlretrieve()</span></code></a>。对 opener 类的自定义操作可以通过向 <a class="reference internal" href="../library/urllib.request.html#urllib.request.build_opener" title="urllib.request.build_opener"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_opener()</span></code></a> 传递定制化的处理程序来实现替换。（由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/84850">gh-84850</a> 中贡献。）</p>
</li>
</ul>
</section>
</section>
<section id="deprecated">
<h2 class="translated">弃用<a class="headerlink" href="#deprecated" title="Link to this heading">¶</a></h2>
<section id="new-deprecations">
<h3 class="translated">新的弃用<a class="headerlink" href="#new-deprecations" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">传入一个复数作为 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex()</span></code></a> 构造器中的 <em>real</em> 或 <em>imag</em> 参数的做法现已被弃用；复数应当仅作为单个位置参数被传入。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/109218">gh-109218</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a>：</p>
<ul class="simple">
<li><p class="translated">将未写入文档的关键字参数 <em>prefix_chars</em> 传给 <a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser.add_argument_group" title="argparse.ArgumentParser.add_argument_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_argument_group()</span></code></a> 方法的做法现已被弃用。 （由 Savannah Ostrowski 在 <a class="reference external" href="https://github.com/python/cpython/issues/125563">gh-125563</a> 中贡献。）</p></li>
<li><p class="translated">已弃用 <a class="reference internal" href="../library/argparse.html#argparse.FileType" title="argparse.FileType"><code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.FileType</span></code></a> 类型转换器。 任何涉及资源管理的操作都应在参数解析完成之后在下游进行处理。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/58032">gh-58032</a> 中贡献。）</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a>:</p>
<ul>
<li><p class="translated">现在 <code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.iscoroutinefunction()</span></code> 已被弃用并将在 Python 3.16 中移除；请改用 <a class="reference internal" href="../library/inspect.html#inspect.iscoroutinefunction" title="inspect.iscoroutinefunction"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.iscoroutinefunction()</span></code></a>。 （由 Jiahao Li 和 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/122875">gh-122875</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a> 策略系统已被弃用并将在 Python 3.16 中移除。 具体而言，是弃用了下列类和函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.AbstractEventLoopPolicy" title="asyncio.AbstractEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.AbstractEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.DefaultEventLoopPolicy" title="asyncio.DefaultEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.DefaultEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.WindowsSelectorEventLoopPolicy" title="asyncio.WindowsSelectorEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.WindowsSelectorEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.WindowsProactorEventLoopPolicy" title="asyncio.WindowsProactorEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.WindowsProactorEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.get_event_loop_policy" title="asyncio.get_event_loop_policy"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.get_event_loop_policy()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.set_event_loop_policy" title="asyncio.set_event_loop_policy"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.set_event_loop_policy()</span></code></a></p></li>
</ul>
<p class="translated">用户应当使用 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.run()</span></code></a> 或 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.Runner" title="asyncio.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.Runner</span></code></a> 并附带 <em>loop_factory</em> 参数以使用想要的事件循环实现。</p>
<p class="translated">例如，在 Windows 上使用 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.SelectorEventLoop" title="asyncio.SelectorEventLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.SelectorEventLoop</span></code></a>:</p>
<div class="translated highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">(),</span> <span class="n">loop_factory</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">SelectorEventLoop</span><span class="p">)</span>
</pre></div>
</div>
<p class="translated">（由 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/127949">gh-127949</a> 中贡献。）</p>
</li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/codecs.html#module-codecs" title="codecs: Encode and decode data and streams."><code class="xref py py-mod docutils literal notranslate"><span class="pre">codecs</span></code></a>: <a class="reference internal" href="../library/codecs.html#codecs.open" title="codecs.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">codecs.open()</span></code></a> 函数现已被弃用，并将在未来的 Python 版本中移除。 请改用 <a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a>。 （由 Inada Naoki 在 <a class="reference external" href="https://github.com/python/cpython/issues/133036">gh-133036</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a>:</p>
<ul class="simple">
<li><p class="translated">在非 Windows 平台上，设置 <a class="reference internal" href="../library/ctypes.html#ctypes.Structure._pack_" title="ctypes.Structure._pack_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Structure._pack_</span></code></a> 以使用 MSVC 兼容的默认内存布局的做法现已被弃用而应改为设置 <a class="reference internal" href="../library/ctypes.html#ctypes.Structure._layout_" title="ctypes.Structure._layout_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Structure._layout_</span></code></a> to <code class="docutils literal notranslate"><span class="pre">'ms'</span></code>，并将在 Python 3.19 中移除。 （由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/131747">gh-131747</a> 中贡献。）</p></li>
<li><p class="translated">在字符串上调用 <a class="reference internal" href="../library/ctypes.html#ctypes.POINTER" title="ctypes.POINTER"><code class="xref py py-func docutils literal notranslate"><span class="pre">ctypes.POINTER()</span></code></a> 的做法现已被弃用。 对于自引用的结构体请使用 <a class="reference internal" href="../library/ctypes.html#ctypes-incomplete-types"><span class="std std-ref">不完整类型</span></a>。 此外，内部的 <code class="docutils literal notranslate"><span class="pre">ctypes._pointer_type_cache</span></code> 也已被弃用。 请参阅 <a class="reference internal" href="../library/ctypes.html#ctypes.POINTER" title="ctypes.POINTER"><code class="xref py py-func docutils literal notranslate"><span class="pre">ctypes.POINTER()</span></code></a> 了解更新的实现细节。 （由 Sergey Myrianov 在 <a class="reference external" href="https://github.com/python/cpython/issues/100926">gh-100926</a> 中贡献。）</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/functools.html#module-functools" title="functools: Higher-order functions and operations on callable objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">functools</span></code></a>: 调用 <a class="reference internal" href="../library/functools.html#functools.reduce" title="functools.reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.reduce()</span></code></a> 的 Python 实现时以关键字参数形式传入 <em>function</em> 或 <em>sequence</em> 的做法现已被弃用；这两个形参将在 Python 3.16 中改为仅限位置形参。 （由 Kirill Podoprigora 在 <a class="reference external" href="https://github.com/python/cpython/issues/121676">gh-121676</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a>: 对使用 <em>strm</em> 参数的自定义日志处理器的支持现已被弃用并计划在 Python 3.16 中移除。 请改为定义伤脑筋 <em>stream</em> 参数的处理器。 （由 Mariusz Felisiak 在 <a class="reference external" href="https://github.com/python/cpython/issues/115032">gh-115032</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/mimetypes.html#module-mimetypes" title="mimetypes: Mapping of filename extensions to MIME types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code></a>: 对于 <a class="reference internal" href="../library/mimetypes.html#mimetypes.MimeTypes.add_type" title="mimetypes.MimeTypes.add_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mimetypes.MimeTypes.add_type()</span></code></a> 有效的扩展名应为空或者必须以 '.' 打头。 不带点号的扩展名已被弃用并将在 Python 3.16 中引发 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/75223">gh-75223</a> 中贡献。）</p></li>
<li><p class="translated"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nturl2path</span></code>: 该模块现已弃用，请改用 <a class="reference internal" href="../library/urllib.request.html#urllib.request.url2pathname" title="urllib.request.url2pathname"><code class="xref py py-func docutils literal notranslate"><span class="pre">urllib.request.url2pathname()</span></code></a> 和 <a class="reference internal" href="../library/urllib.request.html#urllib.request.pathname2url" title="urllib.request.pathname2url"><code class="xref py py-func docutils literal notranslate"><span class="pre">pathname2url()</span></code></a>。（由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/125866">gh-125866</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a>: 现在 <a class="reference internal" href="../library/os.html#os.popen" title="os.popen"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.popen()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.spawnl" title="os.spawnl"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.spawn*</span></code></a> 函数都被设为 <a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">soft deprecated</span></a>。 它们不应再用于编写新的代码。 建议改用 <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> 模块。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/120743">gh-120743</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#module-pathlib" title="pathlib: Object-oriented filesystem paths"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>: 现在 <code class="xref py py-meth docutils literal notranslate"><span class="pre">pathlib.PurePath.as_uri()</span></code> 已被弃用将计划在 Python 3.19 中移除。 请改用 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.as_uri" title="pathlib.Path.as_uri"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pathlib.Path.as_uri()</span></code></a>。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/123599">gh-123599</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a>: 未写入文档的 <code class="docutils literal notranslate"><span class="pre">pdb.Pdb.curframe_locals</span></code> 属性现在成为已弃用的只读特性属性，它将在未来的 Python 版本中被移除。 通过 <span class="target" id="index-227"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a> 在 Python 3.13 中添加的低开销动态帧局部变量访问机制使得之前存储在该属性中的帧局部变量缓存引用已不再需要。 派生的调试器在 Python 3.13 及更高版本中应当直接访问 <code class="docutils literal notranslate"><span class="pre">pdb.Pdb.curframe.f_locals</span></code>。 （由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/124369">gh-124369</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/125951">gh-125951</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/symtable.html#module-symtable" title="symtable: Interface to the compiler's internal symbol tables."><code class="xref py py-mod docutils literal notranslate"><span class="pre">symtable</span></code></a>: 由于缺少兴趣 <a class="reference internal" href="../library/symtable.html#symtable.Class.get_methods" title="symtable.Class.get_methods"><code class="xref py py-meth docutils literal notranslate"><span class="pre">symtable.Class.get_methods()</span></code></a> 已被弃用，计划在 Python 3.16 中移除。 （由 Bénédikt Tran 在 <a class="reference external" href="https://github.com/python/cpython/issues/119698">gh-119698</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/tkinter.html#module-tkinter" title="tkinter: Interface to Tcl/Tk for graphical user interfaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter</span></code></a>：<code class="xref py py-class docutils literal notranslate"><span class="pre">tkinter.Variable</span></code> 的方法 <code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_variable()</span></code>、<code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_vdelete()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_vinfo()</span></code> 现已被弃用。请改用 <code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_add()</span></code>、<code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_remove()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_info()</span></code>。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/120220">gh-120220</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/urllib.parse.html#module-urllib.parse" title="urllib.parse: Parse URLs into or assemble them from components."><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib.parse</span></code></a>: 在 <a class="reference internal" href="../library/urllib.parse.html#urllib.parse.parse_qsl" title="urllib.parse.parse_qsl"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_qsl()</span></code></a> 和 <a class="reference internal" href="../library/urllib.parse.html#urllib.parse.parse_qs" title="urllib.parse.parse_qs"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_qs()</span></code></a> 中接受除空字符串、字节型对象以及 <code class="docutils literal notranslate"><span class="pre">None</span></code> 之外的假值 (如 <code class="docutils literal notranslate"><span class="pre">0</span></code> 和 <code class="docutils literal notranslate"><span class="pre">[]</span></code>) 的做法现已被弃用。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/116897">gh-116897</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pending-removal-in-python-3-15">
<h3 class="translated">计划在 Python 3.15 中移除<a class="headerlink" href="#pending-removal-in-python-3-15" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">导入系统：</p>
<ul>
<li><p class="translated">当设置 <a class="reference internal" href="../library/importlib.html#importlib.machinery.ModuleSpec.cached" title="importlib.machinery.ModuleSpec.cached"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__spec__.cached</span></code></a> 失败时在模块上设置 <a class="reference internal" href="../reference/datamodel.html#module.__cached__" title="module.__cached__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__cached__</span></code></a> 的做法已被弃用。 在 Python 3.15 中，<code class="xref py py-attr docutils literal notranslate"><span class="pre">__cached__</span></code> 将不会再被导入系统或标准库纳入考虑。 (<a class="reference external" href="https://github.com/python/cpython/issues/97879">gh-97879</a>)</p></li>
<li><p class="translated">当设备 <a class="reference internal" href="../library/importlib.html#importlib.machinery.ModuleSpec.parent" title="importlib.machinery.ModuleSpec.parent"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__spec__.parent</span></code></a> 失败时在模块上设置 <a class="reference internal" href="../reference/datamodel.html#module.__package__" title="module.__package__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__package__</span></code></a> 的做法已被弃用。 在 Python 3.15 中，<code class="xref py py-attr docutils literal notranslate"><span class="pre">__package__</span></code> 将不会再被导入系统或标准库纳入考虑。 (<a class="reference external" href="https://github.com/python/cpython/issues/97879">gh-97879</a>)</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a>:</p>
<ul>
<li><p class="translated">未写入文档的 <code class="xref py py-func docutils literal notranslate"><span class="pre">ctypes.SetPointerType()</span></code> 函数自 Python 3.13 起已被弃用。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a>:</p>
<ul>
<li><p class="translated">过时且很少被使用的 <a class="reference internal" href="../library/http.server.html#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> 自 Python 3.13 起已被弃用。 不存在直接的替代品。 对于建立带有请求处理器的 Web 服务程序来说 <em>任何东西</em> 都比 CGI 要好。</p></li>
<li><p class="translated">用于 <strong class="program">python -m http.server</strong> 命令行界面的 <code class="xref std std-option docutils literal notranslate"><span class="pre">--cgi</span></code> 旗标自 Python 3.13 起已被弃用。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a>:</p>
<ul>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">load_module()</span></code> 方法：改用 <code class="docutils literal notranslate"><span class="pre">exec_module()</span></code>。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/locale.html#module-locale" title="locale: Internationalization services."><code class="xref py py-class docutils literal notranslate"><span class="pre">locale</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/locale.html#locale.getdefaultlocale" title="locale.getdefaultlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">getdefaultlocale()</span></code></a> 函数自 Python 3.11 起已被弃用。 最初计划在 Python 3.13 中移除它 (<a class="reference external" href="https://github.com/python/cpython/issues/90817">gh-90817</a>)，但已被推迟至 Python 3.15。 请改用 <a class="reference internal" href="../library/locale.html#locale.getlocale" title="locale.getlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">getlocale()</span></code></a>, <a class="reference internal" href="../library/locale.html#locale.setlocale" title="locale.setlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">setlocale()</span></code></a> 和 <a class="reference internal" href="../library/locale.html#locale.getencoding" title="locale.getencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">getencoding()</span></code></a>。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/111187">gh-111187</a> 中贡献。）</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#module-pathlib" title="pathlib: Object-oriented filesystem paths"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.is_reserved" title="pathlib.PurePath.is_reserved"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PurePath.is_reserved()</span></code></a> 自 Python 3.13 起已被弃用。 请使用 <a class="reference internal" href="../library/os.path.html#os.path.isreserved" title="os.path.isreserved"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.path.isreserved()</span></code></a> 来检测 Windows 上的保留路径。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/platform.html#module-platform" title="platform: Retrieves as much platform identifying data as possible."><code class="xref py py-mod docutils literal notranslate"><span class="pre">platform</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/platform.html#platform.java_ver" title="platform.java_ver"><code class="xref py py-func docutils literal notranslate"><span class="pre">java_ver()</span></code></a> 自 Python 3.13 起已被弃用。 此函数仅对 Jython 支持有用，具有令人困惑的 API，并且大部分未经测试。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/sysconfig.html#module-sysconfig" title="sysconfig: Python's configuration information"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sysconfig</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/sysconfig.html#sysconfig.is_python_build" title="sysconfig.is_python_build"><code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.is_python_build()</span></code></a> 的 <em>check_home</em> 参数自 Python 3.12 起已被弃用。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a>:</p>
<ul>
<li><p class="translated">在 Python 3.15 中 <a class="reference internal" href="../library/threading.html#threading.RLock" title="threading.RLock"><code class="xref py py-func docutils literal notranslate"><span class="pre">RLock()</span></code></a> 将不再接受参数。 传入参数的做法自 Python 3.14 起已被弃用，因为 Python 版本不接受任何参数，而 C 版本允许任意数量的位置或关键字参数，但会忽略所有参数。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/types.html#module-types" title="types: Names for built-in types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">types</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/types.html#types.CodeType" title="types.CodeType"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.CodeType</span></code></a>: 访问 <a class="reference internal" href="../reference/datamodel.html#codeobject.co_lnotab" title="codeobject.co_lnotab"><code class="xref py py-attr docutils literal notranslate"><span class="pre">co_lnotab</span></code></a> 的做法自 3.10 起已根据 <span class="target" id="index-228"></span><a class="pep reference external" href="https://peps.python.org/pep-0626/"><strong>PEP 626</strong></a> 被弃用并曾计划在 3.12 中移除，但在 3.12 中实际仅设置了 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>。 可能会在 3.15 中移除。 （由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/101866">gh-101866</a> 中贡献。）</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a>:</p>
<ul>
<li><p class="translated">未写入文档的用于创建 <a class="reference internal" href="../library/typing.html#typing.NamedTuple" title="typing.NamedTuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a> 类的关键字参数语法（例如 <code class="docutils literal notranslate"><span class="pre">Point</span> <span class="pre">=</span> <span class="pre">NamedTuple(&quot;Point&quot;,</span> <span class="pre">x=int,</span> <span class="pre">y=int)</span></code>）自 Python 3.13 起已被弃用。 请改用基于类的语法或函数语法。</p></li>
<li><p class="translated">当使用 <a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></a> 的函数式语法时，不向 <em>fields</em> 形参传递值 (<code class="docutils literal notranslate"><span class="pre">TD</span> <span class="pre">=</span> <span class="pre">TypedDict(&quot;TD&quot;)</span></code>) 或传递 <code class="docutils literal notranslate"><span class="pre">None</span></code> (<code class="docutils literal notranslate"><span class="pre">TD</span> <span class="pre">=</span> <span class="pre">TypedDict(&quot;TD&quot;,</span> <span class="pre">None)</span></code>) 的做法自 Python 3.13 起已被弃用。 请改用 <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">TD(TypedDict):</span> <span class="pre">pass</span></code> 或 <code class="docutils literal notranslate"><span class="pre">TD</span> <span class="pre">=</span> <span class="pre">TypedDict(&quot;TD&quot;,</span> <span class="pre">{})</span></code> 来创建一个零字段的 TypedDict。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/typing.html#typing.no_type_check_decorator" title="typing.no_type_check_decorator"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.no_type_check_decorator()</span></code></a> 装饰器自 Python 3.13 起已被弃用。 存在于 <a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a> 模块八年之后，它仍未被任何主要类型检查器所支持。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/wave.html#module-wave" title="wave: Provide an interface to the WAV sound format."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wave</span></code></a>：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/wave.html#wave.Wave_read" title="wave.Wave_read"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave_read</span></code></a> 和 <a class="reference internal" href="../library/wave.html#wave.Wave_write" title="wave.Wave_write"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave_write</span></code></a> 类的 <a class="reference internal" href="../library/wave.html#wave.Wave_read.getmark" title="wave.Wave_read.getmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getmark()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">setmark()</span></code> 和 <a class="reference internal" href="../library/wave.html#wave.Wave_read.getmarkers" title="wave.Wave_read.getmarkers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getmarkers()</span></code></a> 方法自 Python 3.13 起已被弃用。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/zipimport.html#module-zipimport" title="zipimport: Support for importing Python modules from ZIP archives."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipimport</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/zipimport.html#zipimport.zipimporter.load_module" title="zipimport.zipimporter.load_module"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_module()</span></code></a> 自 Python 3.10 起已被弃用。请改用 <a class="reference internal" href="../library/zipimport.html#zipimport.zipimporter.exec_module" title="zipimport.zipimporter.exec_module"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exec_module()</span></code></a> 。
（由李佳昊在 <a class="reference external" href="https://github.com/python/cpython/issues/125746">gh-125746</a> 中贡献。）</p></li>
</ul>
</li>
</ul>
</section>
<section id="pending-removal-in-python-3-16">
<h3 class="translated">计划在 Python 3.16 中移除<a class="headerlink" href="#pending-removal-in-python-3-16" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">导入系统：</p>
<ul class="simple">
<li><p class="translated">当设置 <a class="reference internal" href="../library/importlib.html#importlib.machinery.ModuleSpec.loader" title="importlib.machinery.ModuleSpec.loader"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__spec__.loader</span></code></a> 失败时在模块上设置 <a class="reference internal" href="../reference/datamodel.html#module.__loader__" title="module.__loader__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__loader__</span></code></a> 的做法已被弃用。 在 Python 3.16 中，<code class="xref py py-attr docutils literal notranslate"><span class="pre">__loader__</span></code> 将不会再被设置或是被导入系统或标准库纳入考虑。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal notranslate"><span class="pre">array</span></code></a>:</p>
<ul class="simple">
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">'u'</span></code> 格式代码 (<code class="xref c c-type docutils literal notranslate"><span class="pre">wchar_t</span></code>) 自 Python 3.3 起已在文档中弃用并自 Python 3.13 起在运行时弃用。 对于 Unicode 字符请改用 <code class="docutils literal notranslate"><span class="pre">'w'</span></code> 格式代码 (<a class="reference internal" href="../c-api/unicode.html#c.Py_UCS4" title="Py_UCS4"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UCS4</span></code></a>)。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a>:</p>
<ul>
<li><p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.iscoroutinefunction()</span></code> 已被弃用并将在 Python 3.16 中移除，请改用 <a class="reference internal" href="../library/inspect.html#inspect.iscoroutinefunction" title="inspect.iscoroutinefunction"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.iscoroutinefunction()</span></code></a>。
（由李佳昊和 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/122875">gh-122875</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a> 策略系统已被弃用并将在 Python 3.16 中移除。 具体而言，是弃用了下列类和函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.AbstractEventLoopPolicy" title="asyncio.AbstractEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.AbstractEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.DefaultEventLoopPolicy" title="asyncio.DefaultEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.DefaultEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.WindowsSelectorEventLoopPolicy" title="asyncio.WindowsSelectorEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.WindowsSelectorEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.WindowsProactorEventLoopPolicy" title="asyncio.WindowsProactorEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.WindowsProactorEventLoopPolicy</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.get_event_loop_policy" title="asyncio.get_event_loop_policy"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.get_event_loop_policy()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/asyncio-policy.html#asyncio.set_event_loop_policy" title="asyncio.set_event_loop_policy"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.set_event_loop_policy()</span></code></a></p></li>
</ul>
<p class="translated">用户应当使用 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.run()</span></code></a> 或 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.Runner" title="asyncio.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.Runner</span></code></a> 并附带 <em>loop_factory</em> 以使用想要的事件循环实现。</p>
<p class="translated">例如，在 Windows 上使用 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.SelectorEventLoop" title="asyncio.SelectorEventLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.SelectorEventLoop</span></code></a>:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">(),</span> <span class="n">loop_factory</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">SelectorEventLoop</span><span class="p">)</span>
</pre></div>
</div>
<p class="translated">（由 Kumar Aditya 在 <a class="reference external" href="https://github.com/python/cpython/issues/127949">gh-127949</a> 中贡献。）</p>
</li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/builtins.html#module-builtins" title="builtins: The module that provides the built-in namespace."><code class="xref py py-mod docutils literal notranslate"><span class="pre">builtins</span></code></a>:</p>
<ul class="simple">
<li><p class="translated">对布尔类型 <code class="docutils literal notranslate"><span class="pre">~True</span></code> 或 <code class="docutils literal notranslate"><span class="pre">~False</span></code> 执行按位取反的操作自 Python 3.12 起已被弃用，因为它会产生奇怪和不直观的结果 (<code class="docutils literal notranslate"><span class="pre">-2</span></code> and <code class="docutils literal notranslate"><span class="pre">-1</span></code>)。 请改用 <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">x</span></code> 来对布尔值执行逻辑否操作。 对于需要对下层整数执行按位取反操作的少数场合，请显式地将其转换为 <code class="docutils literal notranslate"><span class="pre">int</span></code> (<code class="docutils literal notranslate"><span class="pre">~int(x)</span></code>)。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/functools.html#module-functools" title="functools: Higher-order functions and operations on callable objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">functools</span></code></a>：</p>
<ul class="simple">
<li><p class="translated">调用 <a class="reference internal" href="../library/functools.html#functools.reduce" title="functools.reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.reduce()</span></code></a> 的 Python 实现并传入 <em>function</em> 或 <em>sequence</em> 作为关键字参数的做法自 Python 3.14 起已被弃用。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a>：</p>
<p class="translated">使用 <em>strm</em> 参数对自定义日志记录处理器提供支持的做法已被弃用并计划在 Python 3.16 中移除。 改为使用 <em>stream</em> 参数定义处理器。 （由 Mariusz Felisiak 在 <a class="reference external" href="https://github.com/python/cpython/issues/115032">gh-115032</a> 中贡献。）</p>
</li>
<li><p class="translated"><a class="reference internal" href="../library/mimetypes.html#module-mimetypes" title="mimetypes: Mapping of filename extensions to MIME types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code></a>:</p>
<ul class="simple">
<li><p class="translated">有效扩展以 &quot;. &quot; 开头或在 <a class="reference internal" href="../library/mimetypes.html#mimetypes.MimeTypes.add_type" title="mimetypes.MimeTypes.add_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mimetypes.MimeTypes.add_type()</span></code></a> 为空。 未加点的扩展已弃用，在 Python 3.16 中将引发 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/75223">gh-75223</a> 中贡献。）</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/shutil.html#module-shutil" title="shutil: High-level file operations, including copying."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a>:</p>
<ul class="simple">
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExecError</span></code> 异常自 Python 3.14 起已被弃用。 它自 Python 3.4 起就未被 <code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code> 中的任何函数所使用，现在是 <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> 的一个别名。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/symtable.html#module-symtable" title="symtable: Interface to the compiler's internal symbol tables."><code class="xref py py-mod docutils literal notranslate"><span class="pre">symtable</span></code></a>:</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/symtable.html#symtable.Class.get_methods" title="symtable.Class.get_methods"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Class.get_methods</span></code></a> 方法自 Python 3.14 起被弃用。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a>:</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/sys.html#sys._enablelegacywindowsfsencoding" title="sys._enablelegacywindowsfsencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">_enablelegacywindowsfsencoding()</span></code></a> 函数自 Python 3.13 起被弃用。 请改用 <span class="target" id="index-229"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONLEGACYWINDOWSFSENCODING"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONLEGACYWINDOWSFSENCODING</span></code></a> 环境变量。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/sysconfig.html#module-sysconfig" title="sysconfig: Python's configuration information"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sysconfig</span></code></a>:</p>
<ul class="simple">
<li><p class="translated">自Python 3.14 起，<code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.expand_makefile_vars()</span></code> 函数已被弃用。请使用 <a class="reference internal" href="../library/sysconfig.html#sysconfig.get_paths" title="sysconfig.get_paths"><code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.get_paths()</span></code></a> 的 <code class="docutils literal notranslate"><span class="pre">vars</span></code> 参数代替。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a>:</p>
<ul class="simple">
<li><p class="translated">未写入文档也未被使用的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">TarFile.tarfile</span></code> 属性自 Python 3.13 起被弃用。</p></li>
</ul>
</li>
</ul>
</section>
<section id="pending-removal-in-python-3-17">
<h3 class="translated">计划在 Python 3.17 中移除<a class="headerlink" href="#pending-removal-in-python-3-17" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/collections.abc.html#module-collections.abc" title="collections.abc: Abstract base classes for containers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">collections.abc</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/collections.abc.html#collections.abc.ByteString" title="collections.abc.ByteString"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.ByteString</span></code></a> 计划在 Python 3.17 中移除。</p>
<p class="translated">使用 <code class="docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">collections.abc.Buffer)</span></code> 来测试 <code class="docutils literal notranslate"><span class="pre">obj</span></code> 是否在运行时实现了 <a class="reference internal" href="../c-api/buffer.html#bufferobjects"><span class="std std-ref">缓冲区协议</span></a>。 要用于类型标注，则使用 <a class="reference internal" href="../library/collections.abc.html#collections.abc.Buffer" title="collections.abc.Buffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Buffer</span></code></a> 或是显式指明你的代码所支持类型的并集 (例如 <code class="docutils literal notranslate"><span class="pre">bytes</span> <span class="pre">|</span> <span class="pre">bytearray</span> <span class="pre">|</span> <span class="pre">memoryview</span></code>)。</p>
<p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">ByteString</span></code> 原本是想作为 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> 的超类型的抽象基类提供。 不过，由于 ABC 不能有任何方法，知道一个对象是 <code class="xref py py-class docutils literal notranslate"><span class="pre">ByteString</span></code> 的实例并不能真正告诉你有关该对象的任何有用信息。 其他常见缓冲区类型如 <a class="reference internal" href="../library/stdtypes.html#memoryview" title="memoryview"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a> 同样不能被当作是 <code class="xref py py-class docutils literal notranslate"><span class="pre">ByteString</span></code> 的子类型（无论是在运行时还是对于静态类型检查器）。</p>
<p class="translated">请参阅 <span class="target" id="index-230"></span><a class="pep reference external" href="https://peps.python.org/pep-0688/#current-options"><strong>PEP 688</strong></a> 了解详情。 （由 Shantanu Jain 在 <a class="reference external" href="https://github.com/python/cpython/issues/91896">gh-91896</a> 中贡献。）</p>
</li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a>:</p>
<ul>
<li><p class="translated">在 Python 3.14 之前，旧式的联合是通过私有类 <code class="docutils literal notranslate"><span class="pre">typing._UnionGenericAlias</span></code> 实现的。实现已不再需要该类，但为向后兼容性保留了该类，并计划在 Python 3.17 中删除。 用户应使用记录在案的内省助手函数，如 <a class="reference internal" href="../library/typing.html#typing.get_origin" title="typing.get_origin"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.get_origin()</span></code></a> 和 <a class="reference internal" href="../library/typing.html#typing.get_args" title="typing.get_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.get_args()</span></code></a>，而不是依赖于私有的实现细节。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/typing.html#typing.ByteString" title="typing.ByteString"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.ByteString</span></code></a> 自 Python 3.9 起已被弃用，计划在 Python 3.17 中移除。</p>
<p class="translated">使用 <code class="docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">collections.abc.Buffer)</span></code> 来测试 <code class="docutils literal notranslate"><span class="pre">obj</span></code> 是否在运行时实现了 <a class="reference internal" href="../c-api/buffer.html#bufferobjects"><span class="std std-ref">缓冲区协议</span></a>。 要用于类型标注，则使用 <a class="reference internal" href="../library/collections.abc.html#collections.abc.Buffer" title="collections.abc.Buffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Buffer</span></code></a> 或是显式指明你的代码所支持类型的并集 (例如 <code class="docutils literal notranslate"><span class="pre">bytes</span> <span class="pre">|</span> <span class="pre">bytearray</span> <span class="pre">|</span> <span class="pre">memoryview</span></code>)。</p>
<p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">ByteString</span></code> 原本是想作为 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> 的超类型的抽象基类提供。 不过，由于 ABC 不能有任何方法，知道一个对象是 <code class="xref py py-class docutils literal notranslate"><span class="pre">ByteString</span></code> 的实例并不能真正告诉你有关该对象的任何有用信息。 其他常见缓冲区类型如 <a class="reference internal" href="../library/stdtypes.html#memoryview" title="memoryview"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a> 同样不能被当作是 <code class="xref py py-class docutils literal notranslate"><span class="pre">ByteString</span></code> 的子类型（无论是在运行时还是对于静态类型检查器）。</p>
<p class="translated">请参阅 <span class="target" id="index-231"></span><a class="pep reference external" href="https://peps.python.org/pep-0688/#current-options"><strong>PEP 688</strong></a> 了解详情。 （由 Shantanu Jain 在 <a class="reference external" href="https://github.com/python/cpython/issues/91896">gh-91896</a> 中贡献。）</p>
</li>
</ul>
</li>
</ul>
</section>
<section id="pending-removal-in-python-3-19">
<h3 class="translated">计划在 Python 3.19 中移除<a class="headerlink" href="#pending-removal-in-python-3-19" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a>:</p>
<ul>
<li><p class="translated">在非 Windows 平台上，通过设置 <a class="reference internal" href="../library/ctypes.html#ctypes.Structure._pack_" title="ctypes.Structure._pack_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_pack_</span></code></a> 而非 <a class="reference internal" href="../library/ctypes.html#ctypes.Structure._layout_" title="ctypes.Structure._layout_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_layout_</span></code></a> ，隐式切换到与 MSVC 兼容的结构布局。</p></li>
</ul>
</li>
</ul>
</section>
<section id="pending-removal-in-future-versions">
<h3 class="translated">计划在未来版本中移除<a class="headerlink" href="#pending-removal-in-future-versions" title="Link to this heading">¶</a></h3>
<p class="translated">以下API将会被移除，尽管具体时间还未确定。</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a>：</p>
<ul>
<li><p class="translated">嵌套参数组和嵌套互斥组已被弃用 。</p></li>
<li><p class="translated">将未写入文档的关键字参数 <em>prefix_chars</em> 传递给 <a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser.add_argument_group" title="argparse.ArgumentParser.add_argument_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_argument_group()</span></code></a> 的做法现在已被弃用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/argparse.html#argparse.FileType" title="argparse.FileType"><code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.FileType</span></code></a> 类型转换器已弃用 。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/builtins.html#module-builtins" title="builtins: The module that provides the built-in namespace."><code class="xref py py-mod docutils literal notranslate"><span class="pre">builtins</span></code></a>:</p>
<ul>
<li><p class="translated">生成器: <code class="docutils literal notranslate"><span class="pre">throw(type,</span> <span class="pre">exc,</span> <span class="pre">tb)</span></code> 和 <code class="docutils literal notranslate"><span class="pre">athrow(type,</span> <span class="pre">exc,</span> <span class="pre">tb)</span></code> 签名已被弃用：请改用 <code class="docutils literal notranslate"><span class="pre">throw(exc)</span></code> 和 <code class="docutils literal notranslate"><span class="pre">athrow(exc)</span></code>，即单参数签名。</p></li>
<li><p class="translated">目前 Python 接受数字类字面值后面紧跟关键字的写法，例如 <code class="docutils literal notranslate"><span class="pre">0in</span> <span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">1or</span> <span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">0if</span> <span class="pre">1else</span> <span class="pre">2</span></code>。 它允许像 <code class="docutils literal notranslate"><span class="pre">[0x1for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">y]</span></code> 这样令人困惑且有歧义的表达式 (它可以被解读为 <code class="docutils literal notranslate"><span class="pre">[0x1</span> <span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">y]</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">[0x1f</span> <span class="pre">or</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">y]</span></code>)。 如果数字类字面值后面紧跟关键字 <a class="reference internal" href="../reference/expressions.html#and"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">and</span></code></a>, <a class="reference internal" href="../reference/compound_stmts.html#else"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">else</span></code></a>, <a class="reference internal" href="../reference/compound_stmts.html#for"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">for</span></code></a>, <a class="reference internal" href="../reference/compound_stmts.html#if"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">if</span></code></a>, <a class="reference internal" href="../reference/expressions.html#in"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">in</span></code></a>, <a class="reference internal" href="../reference/expressions.html#is"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">is</span></code></a> 和 <a class="reference internal" href="../reference/expressions.html#or"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">or</span></code></a> 中的一个将会引发语法警告。 在未来的版本中它将改为语法错误。 (<a class="reference external" href="https://github.com/python/cpython/issues/87999">gh-87999</a>)</p></li>
<li><p class="translated">对 <code class="docutils literal notranslate"><span class="pre">__index__()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">__int__()</span></code> 方法返回非 int 类型的支持：将要求这些方法必须返回 <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> 的子类的实例。</p></li>
<li><p class="translated">对 <code class="docutils literal notranslate"><span class="pre">__float__()</span></code> 方法返回 <a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> 的子类的支持：将要求这些方法必须返回 <a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> 的实例。</p></li>
<li><p class="translated">对 <code class="docutils literal notranslate"><span class="pre">__complex__()</span></code> 方法返回 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a> 的子类的支持：将要求这些方法必须返回 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a> 的实例。</p></li>
<li><p class="translated">将 <code class="docutils literal notranslate"><span class="pre">int()</span></code> 委托给 <code class="docutils literal notranslate"><span class="pre">__trunc__()</span></code> 方法。</p></li>
<li><p class="translated">传入一个复数作为 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex()</span></code></a> 构造器中的 <em>real</em> 或 <em>imag</em> 参数的做法现在已被弃用；它应当仅作为单个位置参数被传入。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/109218">gh-109218</a> 中贡献。）.)</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/calendar.html#module-calendar" title="calendar: Functions for working with calendars, including some emulation of the Unix cal program."><code class="xref py py-mod docutils literal notranslate"><span class="pre">calendar</span></code></a>: <code class="docutils literal notranslate"><span class="pre">calendar.January</span></code> 和 <code class="docutils literal notranslate"><span class="pre">calendar.February</span></code> 常量已被弃用并由 <a class="reference internal" href="../library/calendar.html#calendar.JANUARY" title="calendar.JANUARY"><code class="xref py py-data docutils literal notranslate"><span class="pre">calendar.JANUARY</span></code></a> 和 <a class="reference internal" href="../library/calendar.html#calendar.FEBRUARY" title="calendar.FEBRUARY"><code class="xref py py-data docutils literal notranslate"><span class="pre">calendar.FEBRUARY</span></code></a> 替代。 （由 Prince Roshan 在 <a class="reference external" href="https://github.com/python/cpython/issues/103636">gh-103636</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/codecs.html#module-codecs" title="codecs: Encode and decode data and streams."><code class="xref py py-mod docutils literal notranslate"><span class="pre">codecs</span></code></a>：<a class="reference internal" href="../library/codecs.html#codecs.open" title="codecs.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">codecs.open()</span></code></a> 请改用 <a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> 。 (<a class="reference external" href="https://github.com/python/cpython/issues/133038">gh-133038</a>)</p></li>
<li><p class="translated"><a class="reference internal" href="../reference/datamodel.html#codeobject.co_lnotab" title="codeobject.co_lnotab"><code class="xref py py-attr docutils literal notranslate"><span class="pre">codeobject.co_lnotab</span></code></a>: 改用 <a class="reference internal" href="../reference/datamodel.html#codeobject.co_lines" title="codeobject.co_lines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codeobject.co_lines()</span></code></a> 方法。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/datetime.html#datetime.datetime.utcnow" title="datetime.datetime.utcnow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utcnow()</span></code></a>: 使用 <code class="docutils literal notranslate"><span class="pre">datetime.datetime.now(tz=datetime.UTC)</span></code>。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/datetime.html#datetime.datetime.utcfromtimestamp" title="datetime.datetime.utcfromtimestamp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utcfromtimestamp()</span></code></a>: 使用 <code class="docutils literal notranslate"><span class="pre">datetime.datetime.fromtimestamp(timestamp,</span> <span class="pre">tz=datetime.UTC)</span></code>。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/gettext.html#module-gettext" title="gettext: Multilingual internationalization services."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gettext</span></code></a>: 复数值必须是一个整数。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a>:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/importlib.html#importlib.util.cache_from_source" title="importlib.util.cache_from_source"><code class="xref py py-func docutils literal notranslate"><span class="pre">cache_from_source()</span></code></a> <em>debug_override</em> 形参已被弃用：改用 <em>optimization</em> 形参。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/importlib.metadata.html#module-importlib.metadata" title="importlib.metadata: Accessing package metadata"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.metadata</span></code></a>:</p>
<ul>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">EntryPoints</span></code> 元组接口。</p></li>
<li><p class="translated">返回值中隐式的 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a>: <code class="docutils literal notranslate"><span class="pre">warn()</span></code> 方法自 Python 3.3 起已被弃用，请改用 <a class="reference internal" href="../library/logging.html#logging.warning" title="logging.warning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">warning()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/mailbox.html#module-mailbox" title="mailbox: Manipulate mailboxes in various formats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mailbox</span></code></a>: 对 StringIO 输入和文本模式的使用已被弃用，改用 BytesIO 和二进制模式。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a>: 在多线程的进程中调用 <a class="reference internal" href="../library/os.html#os.register_at_fork" title="os.register_at_fork"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.register_at_fork()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydoc.ErrorDuringImport</span></code>: 使用元组值作为 <em>exc_info</em> 形参的做法已被弃用，应使用异常实例。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a>: 现在对于正则表达式中的数字分组引用和分组名称将应用更严格的规则。 现在只接受 ASCII 数字序列作为数字引用。 字节串模式和替换字符串中的分组名称现在只能包含 ASCII 字母和数字以及下划线。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/91760">gh-91760</a> 中贡献。）</p></li>
<li><p class="translated"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_compile</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_constants</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_parse</span></code> 模块。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/shutil.html#module-shutil" title="shutil: High-level file operations, including copying."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a>: <a class="reference internal" href="../library/shutil.html#shutil.rmtree" title="shutil.rmtree"><code class="xref py py-func docutils literal notranslate"><span class="pre">rmtree()</span></code></a> 的 <em>onerror</em> 形参在 Python 3.12 中已被弃用；请改用 <em>onexc</em> 形参。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#module-ssl" title="ssl: TLS/SSL wrapper for socket objects"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ssl</span></code></a> 选项和协议：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a> 不带 protocol 参数的做法已被弃用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a>: <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_npn_protocols" title="ssl.SSLContext.set_npn_protocols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_npn_protocols()</span></code></a> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">selected_npn_protocol()</span></code> 已被弃用：请改用 ALPN。</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.OP_NO_SSL*</span></code> 选项</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.OP_NO_TLS*</span></code> 选项</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_SSLv3</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLS</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLSv1</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLSv1_1</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLSv1_2</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.TLSVersion.SSLv3</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.TLSVersion.TLSv1</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ssl.TLSVersion.TLSv1_1</span></code></p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a> 的方法：</p>
<ul>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Condition.notifyAll()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.Condition.notify_all" title="threading.Condition.notify_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">notify_all()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Event.isSet()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.Event.is_set" title="threading.Event.is_set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_set()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.isDaemon()</span></code>, <a class="reference internal" href="../library/threading.html#threading.Thread.setDaemon" title="threading.Thread.setDaemon"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.setDaemon()</span></code></a>: 使用 <a class="reference internal" href="../library/threading.html#threading.Thread.daemon" title="threading.Thread.daemon"><code class="xref py py-attr docutils literal notranslate"><span class="pre">threading.Thread.daemon</span></code></a> 属性。</p></li>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.getName()</span></code>, <a class="reference internal" href="../library/threading.html#threading.Thread.setName" title="threading.Thread.setName"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.setName()</span></code></a>: 使用 <a class="reference internal" href="../library/threading.html#threading.Thread.name" title="threading.Thread.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">threading.Thread.name</span></code></a> 属性。</p></li>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.currentThread()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.current_thread" title="threading.current_thread"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.current_thread()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.activeCount()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.active_count" title="threading.active_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.active_count()</span></code></a>。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/typing.html#typing.Text" title="typing.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Text</span></code></a> (<a class="reference external" href="https://github.com/python/cpython/issues/92332">gh-92332</a>)。</p></li>
<li><p class="translated">内部类 <code class="docutils literal notranslate"><span class="pre">typing._UnionGenericAlias</span></code> 不再用于实现 <a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Union</span></code></a>。为了保护使用该私有类的用户的兼容性 ，将至少在 Python 3.17 之前提供兼容性。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/105499">gh-105499</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/unittest.html#unittest.IsolatedAsyncioTestCase" title="unittest.IsolatedAsyncioTestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.IsolatedAsyncioTestCase</span></code></a>: 从测试用例返回不为 <code class="docutils literal notranslate"><span class="pre">None</span></code> 的值的做法已被弃用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/urllib.parse.html#module-urllib.parse" title="urllib.parse: Parse URLs into or assemble them from components."><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib.parse</span></code></a> 函数已被弃用：改用 <a class="reference internal" href="../library/urllib.parse.html#urllib.parse.urlparse" title="urllib.parse.urlparse"><code class="xref py py-func docutils literal notranslate"><span class="pre">urlparse()</span></code></a></p>
<ul>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splitattr()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splithost()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splitnport()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splitpasswd()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splitport()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splitquery()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splittag()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splittype()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splituser()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">splitvalue()</span></code></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">to_bytes()</span></code></p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/wsgiref.html#module-wsgiref" title="wsgiref: WSGI Utilities and Reference Implementation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code></a>: <code class="docutils literal notranslate"><span class="pre">SimpleHandler.stdout.write()</span></code> 不应执行部分写入。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/xml.etree.elementtree.html#module-xml.etree.ElementTree" title="xml.etree.ElementTree: Implementation of the ElementTree API."><code class="xref py py-mod docutils literal notranslate"><span class="pre">xml.etree.ElementTree</span></code></a>: 对 <a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.Element" title="xml.etree.ElementTree.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> 的真值测试已被弃用。 在未来的发布版中它将始终返回 <code class="docutils literal notranslate"><span class="pre">True</span></code>。 建议改用显式的 <code class="docutils literal notranslate"><span class="pre">len(elem)</span></code> 或 <code class="docutils literal notranslate"><span class="pre">elem</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code> 测试。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/sys.html#sys._clear_type_cache" title="sys._clear_type_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys._clear_type_cache()</span></code></a> 已弃用，请改用 <a class="reference internal" href="../library/sys.html#sys._clear_internal_caches" title="sys._clear_internal_caches"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys._clear_internal_caches()</span></code></a> 。</p></li>
</ul>
</section>
</section>
<section id="cpython-bytecode-changes">
<h2 class="translated">CPython 字节码的改变<a class="headerlink" href="#cpython-bytecode-changes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p class="translated">将操作码 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">BINARY_SUBSCR</span></code> 替换为附带操作数 <code class="docutils literal notranslate"><span class="pre">NB_SUBSCR</span></code> 的 <a class="reference internal" href="../library/dis.html#opcode-BINARY_OP"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">BINARY_OP</span></code></a> 操作码。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/100239">gh-100239</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-BUILD_INTERPOLATION"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">BUILD_INTERPOLATION</span></code></a> 和 <a class="reference internal" href="../library/dis.html#opcode-BUILD_TEMPLATE"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">BUILD_TEMPLATE</span></code></a> 操作码分别用于构造新的 <a class="reference internal" href="../library/string.templatelib.html#string.templatelib.Interpolation" title="string.templatelib.Interpolation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Interpolation</span></code></a> 和 <a class="reference internal" href="../library/string.templatelib.html#string.templatelib.Template" title="string.templatelib.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a> 实例。 （由 Lysandros Nikolaou 等人在 <a class="reference external" href="https://github.com/python/cpython/issues/132661">gh-132661</a> 中贡献；另请参阅 <a class="reference internal" href="#whatsnew314-template-string-literals"><span class="std std-ref">PEP 750: Template strings</span></a>。）</p></li>
<li><p class="translated">移除了 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">BUILD_CONST_KEY_MAP</span></code> 操作码。 改用 <a class="reference internal" href="../library/dis.html#opcode-BUILD_MAP"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">BUILD_MAP</span></code></a>。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/122160">gh-122160</a> 中贡献。）</p></li>
<li><p class="translated">将 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_ASSERTION_ERROR</span></code> 操作码替换为 <a class="reference internal" href="../library/dis.html#opcode-LOAD_COMMON_CONSTANT"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_COMMON_CONSTANT</span></code></a> 并添加对载入 <a class="reference internal" href="../library/exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> 的支持。</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-LOAD_FAST_BORROW"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_FAST_BORROW</span></code></a> 和 <a class="reference internal" href="../library/dis.html#opcode-LOAD_FAST_BORROW_LOAD_FAST_BORROW"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_FAST_BORROW_LOAD_FAST_BORROW</span></code></a> 操作码用于在解释器能证明帧内引用的生命期长于载入到栈的引用时减少引用计数开销。 （由 Matt Page 在 <a class="reference external" href="https://github.com/python/cpython/issues/130704">gh-130704</a> 中贡献。）.)</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-LOAD_SMALL_INT"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_SMALL_INT</span></code></a> 操作码，它会将一个等于 <code class="docutils literal notranslate"><span class="pre">oparg</span></code> 的小整数推入栈。 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">RETURN_CONST</span></code> 操作码已被移除因为它已不再被使用。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/125837">gh-125837</a> 中贡献。）.)</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../library/dis.html#opcode-LOAD_SPECIAL"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_SPECIAL</span></code></a> 指令。 为 <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> 和 <a class="reference internal" href="../reference/compound_stmts.html#async-with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span></code></a> 语句生成代码将使用此新指令。 移除了 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">BEFORE_WITH</span></code> 和 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">BEFORE_ASYNC_WITH</span></code> 指令。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/120507">gh-120507</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-POP_ITER"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">POP_ITER</span></code></a> 指令以支持 '虚拟' 迭代器。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/132554">gh-132554</a> 中贡献。）</p></li>
</ul>
<section id="pseudo-instructions">
<h3 class="translated">伪指令<a class="headerlink" href="#pseudo-instructions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">增加 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">ANNOTATIONS_PLACEHOLDER</span></code> 伪指令以支持部分执行的使用 <a class="reference internal" href="#whatsnew314-deferred-annotations"><span class="std std-ref">标注迟延求值</span></a> 的模块级标注。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/130907">gh-130907</a> 中贡献。）</p></li>
<li><p class="translated">增加 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">BINARY_OP_EXTEND</span></code> 伪指令，它会执行从内联缓存中访问的一对函数（守卫函数和特化函数）。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/100239">gh-100239</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-CALL_KW"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL_KW</span></code></a> 的三个特化版本； <code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL_KW_PY</span></code> 用于对 Python 函数的调用，<code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL_KW_BOUND_METHOD</span></code> 用于对绑定方法的调用，而 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL_KW_NON_PY</span></code> 用于所有其他调用。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/118093">gh-118093</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-JUMP_IF_TRUE"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_IF_TRUE</span></code></a> 和 <a class="reference internal" href="../library/dis.html#opcode-JUMP_IF_FALSE"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_IF_FALSE</span></code></a> 伪指令，即不影响栈的条件跳转。 由序列 <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">TO_BOOL</span></code>, <code class="docutils literal notranslate"><span class="pre">POP_JUMP_IF_TRUE/FALSE</span></code> 替换。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/124285">gh-124285</a> 中贡献。）</p></li>
<li><p class="translated">增加 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_CONST_MORTAL</span></code> 伪指令。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/128685">gh-128685</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-LOAD_CONST_IMMORTAL"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_CONST_IMMORTAL</span></code></a> 伪指令，它会执行与 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">LOAD_CONST</span></code> 相同的操作，但对永生对象更有效率。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/125837">gh-125837</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../library/dis.html#opcode-NOT_TAKEN"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">NOT_TAKEN</span></code></a> 伪指令，由 <a class="reference internal" href="../library/sys.monitoring.html#module-sys.monitoring" title="sys.monitoring: Access and control event monitoring"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys.monitoring</span></code></a> 用来记录分支事件 (如 <a class="reference internal" href="../library/sys.monitoring.html#monitoring-event-BRANCH_LEFT"><code class="xref std std-monitoring-event docutils literal notranslate"><span class="pre">BRANCH_LEFT</span></code></a>)。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/122548">gh-122548</a> 中贡献。）</p></li>
</ul>
</section>
</section>
<section id="c-api-changes">
<h2 class="translated">C API 的变化<a class="headerlink" href="#c-api-changes" title="Link to this heading">¶</a></h2>
<section id="python-configuration-c-api">
<span id="whatsnew314-capi-config"></span><h3 class="translated">Python 配置 C API<a class="headerlink" href="#python-configuration-c-api" title="Link to this heading">¶</a></h3>
<p class="translated">新增 <a class="reference internal" href="../c-api/init_config.html#pyinitconfig-api"><span class="std std-ref">PyInitConfig C API</span></a> 用于配置 Python 初始化过程，无需依赖 C 结构体，同时支持未来进行 ABI 兼容性变更。</p>
<p class="translated">通过添加 <a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_AddModule" title="PyInitConfig_AddModule"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_AddModule()</span></code></a> 来完成 <span class="target" id="index-232"></span><a class="pep reference external" href="https://peps.python.org/pep-0587/"><strong>PEP 587</strong></a> <a class="reference internal" href="../c-api/init_config.html#pyconfig-api"><span class="std std-ref">PyConfig C API</span></a>，它可被用于添加内置扩展模块；该特性此前被称为 &quot;inittab&quot;。</p>
<p class="translated">新增 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get()</span></code></a> 和 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Set" title="PyConfig_Set"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Set()</span></code></a> 函数，用于获取和设置当前运行时配置。</p>
<p class="translated"><span class="target" id="index-233"></span><a class="pep reference external" href="https://peps.python.org/pep-0587/"><strong>PEP 587</strong></a> 'Python 初始化配置' 统一了所有配置 Python 初始化的方式。 这个 PEP 还将 Python 的预初始化和初始化配置整合至单个 API 中。 此外，这个 PEP 只提供了单个选项用于嵌入 Python，而不是有 'Python' 和 '隔离' 两种选项 (PEP 587)，以进一步简化 API。</p>
<p class="translated">较低层级的 PEP 587 PyConfig API 仍然保留用于需要有与 CPython 实现细节较高耦合度的使用场景（如模拟 CPython 的 CLI 的完整功能，包括其配置机制）。</p>
<p class="translated">（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/107954">gh-107954</a> 中贡献。）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-234"></span><a class="pep reference external" href="https://peps.python.org/pep-0741/"><strong>PEP 741</strong></a> 和 <span class="target" id="index-235"></span><a class="pep reference external" href="https://peps.python.org/pep-0587/"><strong>PEP 587</strong></a></p>
</div>
</section>
<section id="new-features-in-the-c-api">
<h3 class="translated">C API 中的新特性<a class="headerlink" href="#new-features-in-the-c-api" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">增加 <a class="reference internal" href="../c-api/apiabiversion.html#c.Py_PACK_VERSION" title="Py_PACK_VERSION"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_PACK_VERSION()</span></code></a> 和 <a class="reference internal" href="../c-api/apiabiversion.html#c.Py_PACK_FULL_VERSION" title="Py_PACK_FULL_VERSION"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_PACK_FULL_VERSION()</span></code></a>，两个用于对 Python 版本号进行位打包操作的新宏。 这在比较 <a class="reference internal" href="../c-api/apiabiversion.html#c.Py_Version" title="Py_Version"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_Version</span></code></a> 或 <a class="reference internal" href="../c-api/apiabiversion.html#c.PY_VERSION_HEX" title="PY_VERSION_HEX"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PY_VERSION_HEX</span></code></a> 时很有用处。 （由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/128629">gh-128629</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/bytes.html#c.PyBytes_Join" title="PyBytes_Join"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBytes_Join(sep,</span> <span class="pre">iterable)</span></code></a> 函数，其功能类似于Python中的 <code class="docutils literal notranslate"><span class="pre">sep.join(iterable)</span></code> 操作。（由Victor Stinner在 <a class="reference external" href="https://github.com/python/cpython/issues/121645">gh-121645</a> 中贡献。）</p></li>
<li><p class="translated">增加了用于操作当前运行时 Python 解释器的配置的函数 (<a class="reference internal" href="#whatsnew314-capi-config"><span class="std std-ref">PEP 741: Python configuration C API</span></a>):</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyConfig_GetInt" title="PyConfig_GetInt"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_GetInt()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Set" title="PyConfig_Set"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Set()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Names" title="PyConfig_Names"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Names()</span></code></a></p></li>
</ul>
<p class="translated">（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/107954">gh-107954</a> 中贡献。）</p>
</li>
<li><p class="translated">增加了用于配置 Python 初始化的函数 (<a class="reference internal" href="#whatsnew314-capi-config"><span class="std std-ref">PEP 741: Python configuration C API</span></a>):</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.Py_InitializeFromInitConfig" title="Py_InitializeFromInitConfig"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_InitializeFromInitConfig()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_AddModule" title="PyInitConfig_AddModule"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_AddModule()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_Create" title="PyInitConfig_Create"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_Create()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_Free" title="PyInitConfig_Free"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_Free()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_FreeStrList" title="PyInitConfig_FreeStrList"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_FreeStrList()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_GetError" title="PyInitConfig_GetError"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_GetError()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_GetExitCode" title="PyInitConfig_GetExitCode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_GetExitCode()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_GetInt" title="PyInitConfig_GetInt"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_GetInt()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_GetStr" title="PyInitConfig_GetStr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_GetStr()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_GetStrList" title="PyInitConfig_GetStrList"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_GetStrList()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_HasOption" title="PyInitConfig_HasOption"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_HasOption()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_SetInt" title="PyInitConfig_SetInt"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_SetInt()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_SetStr" title="PyInitConfig_SetStr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_SetStr()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init_config.html#c.PyInitConfig_SetStrList" title="PyInitConfig_SetStrList"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInitConfig_SetStrList()</span></code></a></p></li>
</ul>
<p class="translated">（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/107954">gh-107954</a> 中贡献。）</p>
</li>
<li><p class="translated">增加 <a class="reference internal" href="../c-api/sys.html#c.Py_fopen" title="Py_fopen"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_fopen()</span></code></a> 函数用于打开文件。 该函数功能类似于标准 C <code class="xref c c-func docutils literal notranslate"><span class="pre">fopen()</span></code> 函数，但它接受一个 Python 对象作为 <em>path</em> 形参并会在出错时设置异常。 对应的新增函数 <a class="reference internal" href="../c-api/sys.html#c.Py_fclose" title="Py_fclose"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_fclose()</span></code></a> 函数应当用来关闭文件。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/127350">gh-127350</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/hash.html#c.Py_HashBuffer" title="Py_HashBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_HashBuffer()</span></code></a> 函数用于计算并返回缓冲区的哈希值。（由 Antoine Pitrou 和 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/122854">gh-122854</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleAttr" title="PyImport_ImportModuleAttr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleAttr()</span></code></a> 和 <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleAttrString" title="PyImport_ImportModuleAttrString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleAttrString()</span></code></a> 辅助函数，用于导入模块并获取该模块的属性。（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/128911">gh-128911</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/iter.html#c.PyIter_NextItem" title="PyIter_NextItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyIter_NextItem()</span></code></a> 函数以替代返回值含义模糊的 <a class="reference internal" href="../c-api/iter.html#c.PyIter_Next" title="PyIter_Next"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyIter_Next()</span></code></a> 函数。（由 Irit Katriel 和 Erlend Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/105201">gh-105201</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/long.html#c.PyLong_GetSign" title="PyLong_GetSign"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_GetSign()</span></code></a> 函数用于获取 <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> 对象的符号位。（由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/116560">gh-116560</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/long.html#c.PyLong_IsPositive" title="PyLong_IsPositive"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_IsPositive()</span></code></a>、<a class="reference internal" href="../c-api/long.html#c.PyLong_IsNegative" title="PyLong_IsNegative"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_IsNegative()</span></code></a> 和 <a class="reference internal" href="../c-api/long.html#c.PyLong_IsZero" title="PyLong_IsZero"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_IsZero()</span></code></a> 三个函数，分别用于检查 <a class="reference internal" href="../c-api/long.html#c.PyLongObject" title="PyLongObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyLongObject</span></code></a> 是否为正数、负数或零。（由 James Roy 和 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/126061">gh-126061</a> 中贡献。）</p></li>
<li><p class="translated">新增用于在 C <code class="docutils literal notranslate"><span class="pre">&lt;stdint.h&gt;</span></code> 数字类型与 Python <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> 对象之间进行转换的新函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_AsInt32" title="PyLong_AsInt32"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsInt32()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_AsInt64" title="PyLong_AsInt64"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsInt64()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_AsUInt32" title="PyLong_AsUInt32"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsUInt32()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_AsUInt64" title="PyLong_AsUInt64"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsUInt64()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_FromInt32" title="PyLong_FromInt32"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_FromInt32()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_FromInt64" title="PyLong_FromInt64"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_FromInt64()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_FromUInt32" title="PyLong_FromUInt32"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_FromUInt32()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_FromUInt64" title="PyLong_FromUInt64"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_FromUInt64()</span></code></a></p></li>
</ul>
<p class="translated">（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/120389">gh-120389</a> 中贡献。）</p>
</li>
<li><p class="translated">新增用于 Python <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> 对象的导入导出API（参见 <span class="target" id="index-236"></span><a class="pep reference external" href="https://peps.python.org/pep-0757/"><strong>PEP 757</strong></a>）：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_GetNativeLayout" title="PyLong_GetNativeLayout"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_GetNativeLayout()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_Export" title="PyLong_Export"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_Export()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLong_FreeExport" title="PyLong_FreeExport"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_FreeExport()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLongWriter_Create" title="PyLongWriter_Create"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLongWriter_Create()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLongWriter_Finish" title="PyLongWriter_Finish"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLongWriter_Finish()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/long.html#c.PyLongWriter_Discard" title="PyLongWriter_Discard"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLongWriter_Discard()</span></code></a></p></li>
</ul>
<p class="translated">（由 Sergey B Kirpichev 和 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/102471">gh-102471</a> 中贡献。）</p>
</li>
<li><p class="translated">增加 <a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireBranchLeftEvent" title="PyMonitoring_FireBranchLeftEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireBranchLeftEvent()</span></code></a> 和 <a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireBranchRightEvent" title="PyMonitoring_FireBranchRightEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireBranchRightEvent()</span></code></a> 分别用于生成 <a class="reference internal" href="../library/sys.monitoring.html#monitoring-event-BRANCH_LEFT"><code class="xref std std-monitoring-event docutils literal notranslate"><span class="pre">BRANCH_LEFT</span></code></a> 和 <a class="reference internal" href="../library/sys.monitoring.html#monitoring-event-BRANCH_RIGHT"><code class="xref std std-monitoring-event docutils literal notranslate"><span class="pre">BRANCH_RIGHT</span></code></a> 事件。 （由 Mark Shannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/122548">gh-122548</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/type.html#c.PyType_Freeze" title="PyType_Freeze"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_Freeze()</span></code></a> 函数用于将类型设为不可变。（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/121654">gh-121654</a> 中贡献。）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../c-api/type.html#c.PyType_GetBaseByToken" title="PyType_GetBaseByToken"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_GetBaseByToken()</span></code></a> 和 <a class="reference internal" href="../c-api/type.html#c.Py_tp_token" title="Py_tp_token"><code class="xref c c-data docutils literal notranslate"><span class="pre">Py_tp_token</span></code></a> 槽位用于简化超类的标识，该特性尝试解决在 <span class="target" id="index-237"></span><a class="pep reference external" href="https://peps.python.org/pep-0630/#type-checking"><strong>PEP 630</strong></a> 中提到的类型检查问题。 （在 <a class="reference external" href="https://github.com/python/cpython/issues/124153">gh-124153</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Equal" title="PyUnicode_Equal"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Equal()</span></code></a> 函数用于测试两个字符串是否相等。 此函数也被加入到受限 C API 中。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/124502">gh-124502</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter" title="PyUnicodeWriter"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyUnicodeWriter</span></code></a> API 用于创建 Python <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 对象，具有下列函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Create" title="PyUnicodeWriter_Create"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Create()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_DecodeUTF8Stateful" title="PyUnicodeWriter_DecodeUTF8Stateful"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_DecodeUTF8Stateful()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Discard" title="PyUnicodeWriter_Discard"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Discard()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Finish" title="PyUnicodeWriter_Finish"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Finish()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Format" title="PyUnicodeWriter_Format"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Format()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteASCII" title="PyUnicodeWriter_WriteASCII"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteASCII()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteChar" title="PyUnicodeWriter_WriteChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteChar()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteRepr" title="PyUnicodeWriter_WriteRepr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteRepr()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteStr" title="PyUnicodeWriter_WriteStr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteStr()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteSubstring" title="PyUnicodeWriter_WriteSubstring"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteSubstring()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteUCS4" title="PyUnicodeWriter_WriteUCS4"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteUCS4()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteUTF8" title="PyUnicodeWriter_WriteUTF8"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteUTF8()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteWideChar" title="PyUnicodeWriter_WriteWideChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteWideChar()</span></code></a></p></li>
</ul>
<p class="translated">（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/119182">gh-119182</a> 中贡献。）</p>
</li>
<li><p class="translated">在 <a class="reference internal" href="../c-api/arg.html#c.PyArg_ParseTuple" title="PyArg_ParseTuple"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyArg_ParseTuple()</span></code></a> 及相关函数中，<code class="docutils literal notranslate"><span class="pre">k</span></code> 和 <code class="docutils literal notranslate"><span class="pre">K</span></code> 格式现在会优先使用 <a class="reference internal" href="../reference/datamodel.html#object.__index__" title="object.__index__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__index__()</span></code></a> 方法（如果可用），与其他整数格式的处理方式保持一致。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/112068">gh-112068</a> 中贡献。）</p></li>
<li><p class="translated">在 <a class="reference internal" href="../c-api/arg.html#c.Py_BuildValue" title="Py_BuildValue"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_BuildValue()</span></code></a> 中增加对新的 <code class="docutils literal notranslate"><span class="pre">p</span></code> 格式单元的支持，它可根据 C 整数产生 Python <a class="reference internal" href="../library/functions.html#bool" title="bool"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> 对象。 （由 Pablo Galindo 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45325">bpo-45325</a> 中贡献。）.)</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../c-api/object.html#c.PyUnstable_IsImmortal" title="PyUnstable_IsImmortal"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnstable_IsImmortal()</span></code></a> 以确定一个对象是否为 <a class="reference internal" href="../glossary.html#term-immortal"><span class="xref std std-term">immortal</span></a>，用于调试目的。 （由 Peter Bierma 在 <a class="reference external" href="https://github.com/python/cpython/issues/128509">gh-128509</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/object.html#c.PyUnstable_Object_EnableDeferredRefcount" title="PyUnstable_Object_EnableDeferredRefcount"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnstable_Object_EnableDeferredRefcount()</span></code></a> 函数用于启用延迟引用计数功能，该功能如 <span class="target" id="index-238"></span><a class="pep reference external" href="https://peps.python.org/pep-0703/"><strong>PEP 703</strong></a> 所述。</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../c-api/object.html#c.PyUnstable_Object_IsUniquelyReferenced" title="PyUnstable_Object_IsUniquelyReferenced"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnstable_Object_IsUniquelyReferenced()</span></code></a> 函数，作为 <a class="reference internal" href="../glossary.html#term-free-threading"><span class="xref std std-term">自由线程</span></a> 构建环境下 <code class="docutils literal notranslate"><span class="pre">Py_REFCNT(op)</span> <span class="pre">==</span> <span class="pre">1</span></code> 的替代方案。（由 Peter Bierma 在 <a class="reference external" href="https://github.com/python/cpython/issues/133140">gh-133140</a> 中贡献）</p></li>
<li><p class="translated">增加 <a class="reference internal" href="../c-api/object.html#c.PyUnstable_Object_IsUniqueReferencedTemporary" title="PyUnstable_Object_IsUniqueReferencedTemporary"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnstable_Object_IsUniqueReferencedTemporary()</span></code></a> 用于确定一个对象是否为解释器操作数栈上的唯一临时对象。 该函数在某些情况下可被用作通过检查 <a class="reference internal" href="../c-api/refcounting.html#c.Py_REFCNT" title="Py_REFCNT"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_REFCNT()</span></code></a> 是否为 <code class="docutils literal notranslate"><span class="pre">1</span></code> 来判断作为参数传给 C API 函数的 Python 对象的替代方案。 （由 Sam Gross 在 <a class="reference external" href="https://github.com/python/cpython/issues/133164">gh-133164</a> 中贡献。）</p></li>
</ul>
</section>
<section id="limited-c-api-changes">
<h3 class="translated">受限 C API 的变化<a class="headerlink" href="#limited-c-api-changes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">在受限 C API 3.14 及更新版本中，<a class="reference internal" href="../c-api/structures.html#c.Py_TYPE" title="Py_TYPE"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_TYPE()</span></code></a> 和 <a class="reference internal" href="../c-api/refcounting.html#c.Py_REFCNT" title="Py_REFCNT"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_REFCNT()</span></code></a> 现在被实现为不透明函数来隐藏实现细节。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/120600">gh-120600</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/124127">gh-124127</a> 中贡献。）</p></li>
<li><p class="translated">从受限 C API 移除了 <a class="reference internal" href="../c-api/sequence.html#c.PySequence_Fast_GET_SIZE" title="PySequence_Fast_GET_SIZE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PySequence_Fast_GET_SIZE</span></code></a>, <a class="reference internal" href="../c-api/sequence.html#c.PySequence_Fast_GET_ITEM" title="PySequence_Fast_GET_ITEM"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PySequence_Fast_GET_ITEM</span></code></a> 和 <a class="reference internal" href="../c-api/sequence.html#c.PySequence_Fast_ITEMS" title="PySequence_Fast_ITEMS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PySequence_Fast_ITEMS</span></code></a> 宏，因为它们在受限 C API 始终是不可用的。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/91417">gh-91417</a> 中贡献。）</p></li>
</ul>
</section>
<section id="removed-c-apis">
<span id="whatsnew314-c-api-removed"></span><h3 class="translated">被移除的 C API<a class="headerlink" href="#removed-c-apis" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">使用可变基类创建 <a class="reference internal" href="../c-api/typeobj.html#c.Py_TPFLAGS_IMMUTABLETYPE" title="Py_TPFLAGS_IMMUTABLETYPE"><code class="xref c c-data docutils literal notranslate"><span class="pre">不可变类型</span></code></a> 的做法自 Python 3.12 起已被弃用，现在将会引发 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>。 （由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/119775">gh-119775</a> 中贡献。）</p></li>
<li><p class="translated">移除在 Python 3.12 中已被弃用的 <code class="docutils literal notranslate"><span class="pre">PyDictObject.ma_version_tag</span></code> 成员。 请改用 <a class="reference internal" href="../c-api/dict.html#c.PyDict_AddWatcher" title="PyDict_AddWatcher"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_AddWatcher()</span></code></a> API。 （由 Sam Gross 在 <a class="reference external" href="https://github.com/python/cpython/issues/124296">gh-124296</a> 中贡献。）</p></li>
<li><p class="translated">移除私有函数 <code class="docutils literal notranslate"><span class="pre">_Py_InitializeMain()</span></code>。该函数是 <span class="target" id="index-239"></span><a class="pep reference external" href="https://peps.python.org/pep-0587/"><strong>PEP 587</strong></a> 在 Python 3.8 中引入的 <a class="reference internal" href="../glossary.html#term-provisional-API"><span class="xref std std-term">provisional API</span></a>。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/129033">gh-129033</a> 中贡献。）</p></li>
<li><p class="translated">移除了未写入文档的 API <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_C_RECURSION_LIMIT</span></code> 和 <code class="xref c c-member docutils literal notranslate"><span class="pre">PyThreadState.c_recursion_remaining</span></code>。 它们在 3.13 中增加并且未宣布弃用即被移除。 请在 C 代码中使用 <a class="reference internal" href="../c-api/exceptions.html#c.Py_EnterRecursiveCall" title="Py_EnterRecursiveCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_EnterRecursiveCall()</span></code></a> 来防范无限递归问题。 （由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/133079">gh-133079</a> 中移除，另请参阅 <a class="reference external" href="https://github.com/python/cpython/issues/130396">gh-130396</a>。）</p></li>
</ul>
</section>
<section id="deprecated-c-apis">
<span id="whatsnew314-c-api-deprecated"></span><h3 class="translated">已弃用的 C API<a class="headerlink" href="#deprecated-c-apis" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">现在 <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_HUGE_VAL</span></code> 宏已被设为 <a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">soft deprecated</span></a>。 请改用 <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_INFINITY</span></code>。 （由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/120026">gh-120026</a> 中贡献。）</p></li>
<li><p class="translated">现在 <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_IS_NAN</span></code>, <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_IS_INFINITY</span></code> 和 <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_IS_FINITE</span></code> 等宏已被设为 <a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">soft deprecated</span></a>。 请改用 <code class="xref c c-macro docutils literal notranslate"><span class="pre">isnan</span></code>, <code class="xref c c-macro docutils literal notranslate"><span class="pre">isinf</span></code> 和 <code class="xref c c-macro docutils literal notranslate"><span class="pre">isfinite</span></code>，它们自 C99 起在 <code class="file docutils literal notranslate"><span class="pre">math.h</span></code> 中可用。 （由 Sergey B Kirpichev 在 <a class="reference external" href="https://github.com/python/cpython/issues/119613">gh-119613</a> 中贡献。）</p></li>
<li><p class="translated">非元组序列当 <em>items</em> 包含存储 <a class="reference internal" href="../c-api/arg.html#c-arg-borrowed-buffer"><span class="std std-ref">借入缓冲区</span></a> 或 <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a> 的格式单元的情况下在 <a class="reference internal" href="../c-api/arg.html#c.PyArg_ParseTuple" title="PyArg_ParseTuple"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyArg_ParseTuple()</span></code></a> 和其他 <a class="reference internal" href="../c-api/arg.html#arg-parsing"><span class="std std-ref">参数解析</span></a> 函数中用作 <code class="docutils literal notranslate"><span class="pre">(items)</span></code> 格式单元参数的做法现在已被弃用。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/50333">gh-50333</a> 中贡献。）</p></li>
<li><p class="translated">现在 <code class="docutils literal notranslate"><span class="pre">_PyMonitoring_FireBranchEvent</span></code> 函数已被弃用并应当替换为对 <a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireBranchLeftEvent" title="PyMonitoring_FireBranchLeftEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireBranchLeftEvent()</span></code></a> 和 <a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireBranchRightEvent" title="PyMonitoring_FireBranchRightEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireBranchRightEvent()</span></code></a> 的调用。</p></li>
<li><p class="translated">之前未写入文档的函数 <a class="reference internal" href="../c-api/sequence.html#c.PySequence_In" title="PySequence_In"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySequence_In()</span></code></a> 现在被设为 <a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">soft deprecated</span></a>。 请改用 <a class="reference internal" href="../c-api/sequence.html#c.PySequence_Contains" title="PySequence_Contains"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySequence_Contains()</span></code></a>。 （由 Yuki Kobayashi 在 <a class="reference external" href="https://github.com/python/cpython/issues/127896">gh-127896</a> 中贡献。）</p></li>
</ul>
<section id="id13">
<h4 class="translated">计划在 Python 3.15 中移除<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<ul>
<li><p class="translated">The <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleNoBlock" title="PyImport_ImportModuleNoBlock"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleNoBlock()</span></code></a>: 改用 <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModule" title="PyImport_ImportModule"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModule()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetObject" title="PyWeakref_GetObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetObject()</span></code></a> 和 <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GET_OBJECT" title="PyWeakref_GET_OBJECT"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GET_OBJECT()</span></code></a>: 改用 <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetRef" title="PyWeakref_GetRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetRef()</span></code></a>。 在 Python 3.12 及更旧的版本中可以使用 <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat 项目</a> 来获取 <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetRef" title="PyWeakref_GetRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetRef()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UNICODE</span></code></a> 类型和 <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_WIDE</span></code> 宏：改用 <code class="xref c c-type docutils literal notranslate"><span class="pre">wchar_t</span></code>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsDecodedObject()</span></code>: 改用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Decode" title="PyCodec_Decode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Decode()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsDecodedUnicode()</span></code>: 改用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Decode" title="PyCodec_Decode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Decode()</span></code></a>；请注意某些编解码器 (例如 &quot;base64&quot;) 可能返回 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 以外的类型，比如 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsEncodedObject()</span></code>: 改用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Encode" title="PyCodec_Encode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Encode()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsEncodedUnicode()</span></code>: 使用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Encode" title="PyCodec_Encode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Encode()</span></code></a> 代替；请注意，某些编解码器（如 &quot;base64&quot;）可能返回 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 之外的类型，如 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>。</p></li>
<li><p class="translated">Python 初始化函数， Python 3.13 中弃用：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_GetPath" title="Py_GetPath"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPath()</span></code></a>:使用  <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;module_search_paths&quot;)</span></code></a>   (<a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>) 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_GetPrefix" title="Py_GetPrefix"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPrefix()</span></code></a>:使用  <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;base_prefix&quot;)</span></code></a> (<a class="reference internal" href="../library/sys.html#sys.base_prefix" title="sys.base_prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.base_prefix</span></code></a>) 代替。如果需要处理 <a class="reference internal" href="../library/venv.html#venv-def"><span class="std std-ref">virtual environments</span></a> ，请使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;prefix&quot;)</span></code></a> (<a class="reference internal" href="../library/sys.html#sys.prefix" title="sys.prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.prefix</span></code></a>) 。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_GetExecPrefix" title="Py_GetExecPrefix"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetExecPrefix()</span></code></a>:使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;base_exec_prefix&quot;)</span></code></a> (<a class="reference internal" href="../library/sys.html#sys.base_exec_prefix" title="sys.base_exec_prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.base_exec_prefix</span></code></a>) 代替。如果需要处理 <a class="reference internal" href="../library/venv.html#venv-def"><span class="std std-ref">virtual environments</span></a> ，请使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;exec_prefix&quot;)</span></code></a> (<a class="reference internal" href="../library/sys.html#sys.exec_prefix" title="sys.exec_prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.exec_prefix</span></code></a>) 。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_GetProgramFullPath" title="Py_GetProgramFullPath"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetProgramFullPath()</span></code></a>:使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;executable&quot;)</span></code></a> (<a class="reference internal" href="../library/sys.html#sys.executable" title="sys.executable"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.executable</span></code></a>) 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_GetProgramName" title="Py_GetProgramName"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetProgramName()</span></code></a>:使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;executable&quot;)</span></code></a> (<a class="reference internal" href="../library/sys.html#sys.executable" title="sys.executable"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.executable</span></code></a>) 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_GetPythonHome" title="Py_GetPythonHome"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPythonHome()</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;home&quot;)</span></code></a> 或 <span class="target" id="index-240"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> 环境变量代替。</p></li>
</ul>
<p class="translated">在 Python 3.13 和更旧的版本中可以使用 <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat 项目</a> 来获取 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get()</span></code></a> 。</p>
</li>
<li><p class="translated">用于配置 Python 的初始化的函数，在 Python 3.11 中已弃用：</p>
<ul class="simple">
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetArgvEx()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.argv" title="PyConfig.argv"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.argv</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetArgv()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.argv" title="PyConfig.argv"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.argv</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetProgramName()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.program_name" title="PyConfig.program_name"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.program_name</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetPythonHome()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.home" title="PyConfig.home"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.home</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/sys.html#c.PySys_ResetWarnOptions" title="PySys_ResetWarnOptions"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_ResetWarnOptions()</span></code></a>: 改为清除 <a class="reference internal" href="../library/sys.html#sys.warnoptions" title="sys.warnoptions"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.warnoptions</span></code></a> 和 <code class="xref py py-data docutils literal notranslate"><span class="pre">warnings.filters</span></code>。</p></li>
</ul>
<p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_InitializeFromConfig" title="Py_InitializeFromConfig"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_InitializeFromConfig()</span></code></a> API 应与 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig" title="PyConfig"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyConfig</span></code></a> 一起使用。</p>
</li>
<li><p class="translated">全局配置变量：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_DebugFlag" title="Py_DebugFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_DebugFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.parser_debug" title="PyConfig.parser_debug"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.parser_debug</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;parser_debug&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_VerboseFlag" title="Py_VerboseFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_VerboseFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.verbose" title="PyConfig.verbose"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.verbose</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;verbose&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_QuietFlag" title="Py_QuietFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_QuietFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.quiet" title="PyConfig.quiet"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.quiet</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;quiet&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_InteractiveFlag" title="Py_InteractiveFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_InteractiveFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.interactive" title="PyConfig.interactive"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.interactive</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;interactive&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_InspectFlag" title="Py_InspectFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_InspectFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.inspect" title="PyConfig.inspect"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.inspect</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;inspect&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_OptimizeFlag" title="Py_OptimizeFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_OptimizeFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.optimization_level" title="PyConfig.optimization_level"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.optimization_level</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;optimization_level&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_NoSiteFlag" title="Py_NoSiteFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_NoSiteFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.site_import" title="PyConfig.site_import"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.site_import</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;site_import&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_BytesWarningFlag" title="Py_BytesWarningFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_BytesWarningFlag</span></code></a>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.bytes_warning" title="PyConfig.bytes_warning"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.bytes_warning</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;bytes_warning&quot;)</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_FrozenFlag" title="Py_FrozenFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_FrozenFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.pathconfig_warnings" title="PyConfig.pathconfig_warnings"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.pathconfig_warnings</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;pathconfig_warnings&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_IgnoreEnvironmentFlag" title="Py_IgnoreEnvironmentFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_IgnoreEnvironmentFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.use_environment" title="PyConfig.use_environment"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.use_environment</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;use_environment&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_DontWriteBytecodeFlag" title="Py_DontWriteBytecodeFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_DontWriteBytecodeFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.write_bytecode" title="PyConfig.write_bytecode"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.write_bytecode</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;write_bytecode&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_NoUserSiteDirectory" title="Py_NoUserSiteDirectory"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_NoUserSiteDirectory</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.user_site_directory" title="PyConfig.user_site_directory"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.user_site_directory</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;user_site_directory&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_UnbufferedStdioFlag" title="Py_UnbufferedStdioFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_UnbufferedStdioFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.buffered_stdio" title="PyConfig.buffered_stdio"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.buffered_stdio</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;buffered_stdio&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_HashRandomizationFlag" title="Py_HashRandomizationFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_HashRandomizationFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.use_hash_seed" title="PyConfig.use_hash_seed"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.use_hash_seed</span></code></a> 和 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.hash_seed" title="PyConfig.hash_seed"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.hash_seed</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;hash_seed&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_IsolatedFlag" title="Py_IsolatedFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_IsolatedFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.isolated" title="PyConfig.isolated"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.isolated</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;isolated&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_LegacyWindowsFSEncodingFlag" title="Py_LegacyWindowsFSEncodingFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_LegacyWindowsFSEncodingFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyPreConfig.legacy_windows_fs_encoding" title="PyPreConfig.legacy_windows_fs_encoding"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyPreConfig.legacy_windows_fs_encoding</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;legacy_windows_fs_encoding&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_LegacyWindowsStdioFlag" title="Py_LegacyWindowsStdioFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_LegacyWindowsStdioFlag</span></code></a>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.legacy_windows_stdio" title="PyConfig.legacy_windows_stdio"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.legacy_windows_stdio</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;legacy_windows_stdio&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_FileSystemDefaultEncoding</span></code>, <code class="xref c c-var docutils literal notranslate"><span class="pre">Py_HasFileSystemDefaultEncoding</span></code>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.filesystem_encoding" title="PyConfig.filesystem_encoding"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.filesystem_encoding</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;filesystem_encoding&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_FileSystemDefaultEncodeErrors</span></code>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.filesystem_errors" title="PyConfig.filesystem_errors"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.filesystem_errors</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;filesystem_errors&quot;)</span></code></a> 代替。</p></li>
<li><p class="translated"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_UTF8Mode</span></code>: 使用 <a class="reference internal" href="../c-api/init_config.html#c.PyPreConfig.utf8_mode" title="PyPreConfig.utf8_mode"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyPreConfig.utf8_mode</span></code></a> 或 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;utf8_mode&quot;)</span></code></a> 代替。 (参见 <a class="reference internal" href="../c-api/init_config.html#c.Py_PreInitialize" title="Py_PreInitialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_PreInitialize()</span></code></a>)。</p></li>
</ul>
<p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_InitializeFromConfig" title="Py_InitializeFromConfig"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_InitializeFromConfig()</span></code></a> API 应与 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig" title="PyConfig"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyConfig</span></code></a> 一起使用，以设置这些选项。或者使用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get()</span></code></a> 在运行时获取这些选项。</p>
</li>
</ul>
</section>
<section id="id14">
<h4 class="translated">计划在 Python 3.16 中移除<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p class="translated">捆绑的 <code class="docutils literal notranslate"><span class="pre">libmpdec</span></code> 副本。</p></li>
</ul>
</section>
<section id="pending-removal-in-python-3-18">
<h4 class="translated">计划在 Python 3.18 中移除<a class="headerlink" href="#pending-removal-in-python-3-18" title="Link to this heading">¶</a></h4>
<ul>
<li><p class="translated">以下私有函数已被弃用，并计划在 Python 3.18 中移除：</p>
<ul class="simple">
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyBytes_Join()</span></code>：使用 <a class="reference internal" href="../c-api/bytes.html#c.PyBytes_Join" title="PyBytes_Join"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBytes_Join()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyDict_GetItemStringWithError()</span></code>: 使用 <a class="reference internal" href="../c-api/dict.html#c.PyDict_GetItemStringRef" title="PyDict_GetItemStringRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItemStringRef()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyDict_Pop()</span></code>: 使用 <a class="reference internal" href="../c-api/dict.html#c.PyDict_Pop" title="PyDict_Pop"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_Pop()</span></code></a>.</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyLong_Sign()</span></code>：使用 <a class="reference internal" href="../c-api/long.html#c.PyLong_GetSign" title="PyLong_GetSign"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_GetSign()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyLong_FromDigits()</span></code> 和 <code class="xref c c-func docutils literal notranslate"><span class="pre">_PyLong_New()</span></code>：使用 <a class="reference internal" href="../c-api/long.html#c.PyLongWriter_Create" title="PyLongWriter_Create"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLongWriter_Create()</span></code></a>.</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyThreadState_UncheckedGet()</span></code>：使用 <a class="reference internal" href="../c-api/init.html#c.PyThreadState_GetUnchecked" title="PyThreadState_GetUnchecked"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_GetUnchecked()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicode_AsString()</span></code>：使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsUTF8" title="PyUnicode_AsUTF8"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUTF8()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Init()</span></code>: 将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Init(&amp;writer)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Create" title="PyUnicodeWriter_Create"><code class="xref c c-func docutils literal notranslate"><span class="pre">writer</span> <span class="pre">=</span> <span class="pre">PyUnicodeWriter_Create(0)</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Finish()</span></code>: 将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Finish(&amp;writer)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Finish" title="PyUnicodeWriter_Finish"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Finish(writer)</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Dealloc()</span></code>: 将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Dealloc(&amp;writer)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Discard" title="PyUnicodeWriter_Discard"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Discard(writer)</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteChar()</span></code>: 将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteChar(&amp;writer,</span> <span class="pre">ch)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteChar" title="PyUnicodeWriter_WriteChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteChar(writer,</span> <span class="pre">ch)</span></code></a>.</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteStr()</span></code>: 将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteStr(&amp;writer,</span> <span class="pre">str)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteStr" title="PyUnicodeWriter_WriteStr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteStr(writer,</span> <span class="pre">str)</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteSubstring()</span></code>: 将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteSubstring(&amp;writer,</span> <span class="pre">str,</span> <span class="pre">start,</span> <span class="pre">end)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteSubstring" title="PyUnicodeWriter_WriteSubstring"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteSubstring(writer,</span> <span class="pre">str,</span> <span class="pre">start,</span> <span class="pre">end)</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteASCIIString()</span></code>: 请将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteASCIIString(&amp;writer,</span> <span class="pre">str)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteASCII" title="PyUnicodeWriter_WriteASCII"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteASCII(writer,</span> <span class="pre">str)</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteLatin1String()</span></code>: 将 <code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteLatin1String(&amp;writer,</span> <span class="pre">str)</span></code> 替换为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteUTF8" title="PyUnicodeWriter_WriteUTF8"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteUTF8(writer,</span> <span class="pre">str)</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Prepare()</span></code>: (无替代)。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicodeWriter_PrepareKind()</span></code>: (无替代)。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_Py_HashPointer()</span></code>：使用 <a class="reference internal" href="../c-api/hash.html#c.Py_HashPointer" title="Py_HashPointer"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_HashPointer()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_Py_fopen_obj()</span></code>：使用 <a class="reference internal" href="../c-api/sys.html#c.Py_fopen" title="Py_fopen"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_fopen()</span></code></a>。</p></li>
</ul>
<p class="translated"><a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat 项目</a> 可被用于在 Python 3.13 及更早版本中获取这些新的公有函数。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/128863">gh-128863</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="id15">
<h4 class="translated">计划在未来版本中移除<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<p class="translated">以下 API 已被弃用，将被移除，但目前尚未确定移除日期。</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/typeobj.html#c.Py_TPFLAGS_HAVE_FINALIZE" title="Py_TPFLAGS_HAVE_FINALIZE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_TPFLAGS_HAVE_FINALIZE</span></code></a>: 自 Python 3.8 起不再需要。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_Fetch" title="PyErr_Fetch"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_Fetch()</span></code></a>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_GetRaisedException" title="PyErr_GetRaisedException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_GetRaisedException()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_NormalizeException" title="PyErr_NormalizeException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_NormalizeException()</span></code></a>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_GetRaisedException" title="PyErr_GetRaisedException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_GetRaisedException()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_Restore" title="PyErr_Restore"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_Restore()</span></code></a>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_SetRaisedException" title="PyErr_SetRaisedException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_SetRaisedException()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/module.html#c.PyModule_GetFilename" title="PyModule_GetFilename"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_GetFilename()</span></code></a>: 改用 <a class="reference internal" href="../c-api/module.html#c.PyModule_GetFilenameObject" title="PyModule_GetFilenameObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_GetFilenameObject()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/sys.html#c.PyOS_AfterFork" title="PyOS_AfterFork"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyOS_AfterFork()</span></code></a>: 改用 <a class="reference internal" href="../c-api/sys.html#c.PyOS_AfterFork_Child" title="PyOS_AfterFork_Child"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyOS_AfterFork_Child()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/slice.html#c.PySlice_GetIndicesEx" title="PySlice_GetIndicesEx"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySlice_GetIndicesEx()</span></code></a>: 改用 <a class="reference internal" href="../c-api/slice.html#c.PySlice_Unpack" title="PySlice_Unpack"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySlice_Unpack()</span></code></a> and <a class="reference internal" href="../c-api/slice.html#c.PySlice_AdjustIndices" title="PySlice_AdjustIndices"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySlice_AdjustIndices()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_READY" title="PyUnicode_READY"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_READY()</span></code></a>: 自 Python 3.12 起不再需要</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_Display()</span></code>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_DisplayException" title="PyErr_DisplayException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_DisplayException()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyErr_ChainExceptions()</span></code>: 改用 <code class="xref c c-func docutils literal notranslate"><span class="pre">_PyErr_ChainExceptions1()</span></code>。</p></li>
<li><p class="translated"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyBytesObject.ob_shash</span></code> 成员：改为调用 <a class="reference internal" href="../c-api/object.html#c.PyObject_Hash" title="PyObject_Hash"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Hash()</span></code></a>。</p></li>
<li><p class="translated">线程本地存储 (TLS) API：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.PyThread_create_key" title="PyThread_create_key"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_create_key()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_alloc" title="PyThread_tss_alloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_alloc()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.PyThread_delete_key" title="PyThread_delete_key"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_delete_key()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_free" title="PyThread_tss_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_free()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.PyThread_set_key_value" title="PyThread_set_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_set_key_value()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_set" title="PyThread_tss_set"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_set()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.PyThread_get_key_value" title="PyThread_get_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_get_key_value()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_get" title="PyThread_tss_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_get()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.PyThread_delete_key_value" title="PyThread_delete_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_delete_key_value()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_delete" title="PyThread_tss_delete"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_delete()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.PyThread_ReInitTLS" title="PyThread_ReInitTLS"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_ReInitTLS()</span></code></a>: 自 Python 3.7 起不再需要。</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="build-changes">
<span id="whatsnew314-build-changes"></span><h2 class="translated">构建的改变<a class="headerlink" href="#build-changes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p class="translated"><span class="target" id="index-241"></span><a class="pep reference external" href="https://peps.python.org/pep-0776/"><strong>PEP 776</strong></a>: Emscripten 现在是官方支持的 <span class="target" id="index-242"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/#tier-3"><strong>第 3 层级</strong></a> 平台。 作为此项工作的一部分，在 <a class="reference external" href="https://emscripten.org/docs/porting/emscripten-runtime-environment.html">Emscripten libc</a> 中有超过 25 个程序缺陷被修复。 Emscripten 现在包括了对 <a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a>, <a class="reference internal" href="../library/termios.html#module-termios" title="termios: POSIX style tty control. (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">termios</span></code></a> 和 <a class="reference internal" href="../library/fcntl.html#module-fcntl" title="fcntl: The fcntl() and ioctl() system calls. (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fcntl</span></code></a> 的支持，以及对新的 <a class="reference internal" href="../tutorial/interpreter.html#tut-interactive"><span class="std std-ref">默认交互式 shell</span></a> 的实验性支持。 （由 R. Hood Chatham 在 <a class="reference external" href="https://github.com/python/cpython/issues/127146">gh-127146</a>, <a class="reference external" href="https://github.com/python/cpython/issues/127683">gh-127683</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/136931">gh-136931</a> 中贡献。）</p>
</li>
<li><p class="translated">现在 <a class="reference external" href="https://www.python.org/downloads/android/">python.org</a> 提供了官方 Android 二进制发布包。</p>
</li>
<li><p class="translated">生成 <code class="file docutils literal notranslate"><span class="pre">configure</span></code> 文件现在需要 GNU Autoconf 2.72 版本。（由 Erlend Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/115765">gh-115765</a> 中贡献。）</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">wasm32-unknown-emscripten</span></code> 现已成为 <span class="target" id="index-243"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> 标准中的第三级（Tier 3）支持平台。（由 R. Hood Chatham 在 <a class="reference external" href="https://github.com/python/cpython/issues/127146">gh-127146</a>、<a class="reference external" href="https://github.com/python/cpython/issues/127683">gh-127683</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/136931">gh-136931</a> 中贡献。）</p></li>
<li><p class="translated">现在可以通过 <span class="c-expr sig sig-inline c"><a class="reference internal" href="../extending/windows.html#c.Py_NO_LINK_LIB" title="Py_NO_LINK_LIB"><span class="n">Py_NO_LINK_LIB</span></a></span> 关闭基于 <code class="docutils literal notranslate"><span class="pre">#pragma</span></code> 与 <code class="docutils literal notranslate"><span class="pre">python3*.lib</span></code> 的链接。（由 Jean-Christophe Fillion-Robin 在 <a class="reference external" href="https://github.com/python/cpython/issues/82909">gh-82909</a> 中贡献。）</p></li>
<li><p class="translated">CPython 现在默认启用了一组推荐的编译器选项以增强安全性。如需禁用这些选项，可使用 <a class="reference internal" href="../using/configure.html#cmdoption-disable-safety"><code class="xref std std-option docutils literal notranslate"><span class="pre">--disable-safety</span></code></a> <code class="file docutils literal notranslate"><span class="pre">configure</span></code> 选项；若希望启用更大范围的编译器安全选项（但会牺牲性能），则可使用 <a class="reference internal" href="../using/configure.html#cmdoption-enable-slower-safety"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-slower-safety</span></code></a> 选项。</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">WITH_FREELISTS</span></code> 宏和 <code class="docutils literal notranslate"><span class="pre">--without-freelists</span></code> <code class="file docutils literal notranslate"><span class="pre">configure</span></code> 选项已被移除。</p></li>
<li><p class="translated">新的 <code class="file docutils literal notranslate"><span class="pre">configure</span></code> 选项 <a class="reference internal" href="../using/configure.html#cmdoption-with-tail-call-interp"><code class="xref std std-option docutils literal notranslate"><span class="pre">--with-tail-call-interp</span></code></a> 可被用来启用实验性的尾调用解释器。 请参阅 <a class="reference internal" href="#whatsnew314-tail-call-interpreter"><span class="std std-ref">一种新型的解释器</span></a> 了解详情。</p></li>
<li><p class="translated">要禁用新的远程调试支持，请使用 <a class="reference internal" href="../using/configure.html#cmdoption-without-remote-debug"><code class="xref std std-option docutils literal notranslate"><span class="pre">--without-remote-debug</span></code></a> <code class="file docutils literal notranslate"><span class="pre">configure</span></code> 选项。 出于安全原因，这可能会有用。</p></li>
<li><p class="translated">iOS 和 macOS 应用程序现在可配置为将 <code class="docutils literal notranslate"><span class="pre">stdout</span></code> 和 <code class="docutils literal notranslate"><span class="pre">stderr</span></code> 输出内容重定向至系统日志。（由 Russell Keith-Magee 在 <a class="reference external" href="https://github.com/python/cpython/issues/127592">gh-127592</a> 中贡献。）</p></li>
<li><p class="translated">iOS 测试平台现已支持在测试运行时实时流式传输测试输出，并可用于运行除 CPython 之外的其他项目测试套件。（由 Russell Keith-Magee 在 <a class="reference external" href="https://github.com/python/cpython/issues/127592">gh-127592</a> 中贡献。）</p></li>
</ul>
<section id="build-details-json">
<span id="whatsnew314-build-details"></span><h3 class="translated"><code class="file docutils literal notranslate"><span class="pre">build-details.json</span></code><a class="headerlink" href="#build-details-json" title="Link to this heading">¶</a></h3>
<p class="translated">现在的 Python 安装包中包含一个新文件：<code class="file docutils literal notranslate"><span class="pre">build-details.json</span></code>。这是一个静态的 JSON 文档，包含 CPython 的构建详情，无需运行代码即可进行内省。这对于 Python 启动器、交叉编译等使用场景很有帮助。</p>
<p class="translated"><code class="file docutils literal notranslate"><span class="pre">build-details.json</span></code> 必须安装在与平台无关的标准库目录中。这对应于 <a class="reference internal" href="../library/sysconfig.html#installation-paths"><span class="std std-ref">'stdlib'</span></a> <a class="reference internal" href="../library/sysconfig.html#module-sysconfig" title="sysconfig: Python's configuration information"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sysconfig</span></code></a> 安装路径，可通过运行 <code class="docutils literal notranslate"><span class="pre">sysconfig.get_path('stdlib')</span></code> 找到该路径。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-244"></span><a class="pep reference external" href="https://peps.python.org/pep-0739/"><strong>PEP 739</strong></a> —— <code class="docutils literal notranslate"><span class="pre">build-details.json</span></code> 1.0——Python 构建详情的静态描述文件</p>
</div>
</section>
<section id="discontinuation-of-pgp-signatures">
<span id="whatsnew314-no-more-pgp"></span><h3 class="translated">PGP 签名的停用<a class="headerlink" href="#discontinuation-of-pgp-signatures" title="Link to this heading">¶</a></h3>
<p class="translated">Python 3.14 及未来的版本将不再提供 PGP (Pretty Good Privacy) 签名。 要验证 CPython 制品，用户必须使用 <a class="reference external" href="https://www.python.org/downloads/metadata/sigstore/">Sigstore 验证材料</a>。 自 Python 3.11 起的发布版就已采用 <a class="reference external" href="https://www.sigstore.dev/">Sigstore</a> 进行签名。</p>
<p class="translated">发布流程中的这一变更已在 <span class="target" id="index-245"></span><a class="pep reference external" href="https://peps.python.org/pep-0761/"><strong>PEP 761</strong></a> 中明确规定。</p>
</section>
<section id="free-threaded-python-is-officially-supported">
<span id="whatsnew314-free-threaded-now-supported"></span><h3 class="translated">自由线程版 Python 已获官方支持<a class="headerlink" href="#free-threaded-python-is-officially-supported" title="Link to this heading">¶</a></h3>
<p class="translated">自由线程的 Python 构建版现在已被支持而不再是实验性的。 这是自由线程 Python 获得官方支持但仍为可选项的 <a class="reference external" href="https://discuss.python.org/t/37075">第二阶段</a> 的开始。</p>
<p class="translated">自由线程团队相信此项目走在正确的路径上，并赞赏各位持续努力的贡献使得自由线程特性已准备好在 Python 社区获得更广泛的接受。</p>
<p class="translated">随着这个 PEP 被提议和被接受，Python 开发者社区应当广泛宣传自由线程已成为受支持的 Python 构建选项并将在未来继续发展，它不会在没有适当弃用计划的情况下被移除。</p>
<p class="translated">任何过渡到 <a class="reference external" href="https://discuss.python.org/t/37075">第三阶段</a>，即将自由线程作为 Python 默认或唯一的构建版的决定尚未明确作出，这取决于 CPython 本身和社区内部的许多因素。 这个决定会留给未来。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-84"></span><a class="pep reference external" href="https://peps.python.org/pep-0779/"><strong>PEP 779</strong></a></p>
<p class="translated"><a class="reference external" href="https://discuss.python.org/t/84319/123">PEP 779 的接受</a></p>
</div>
</section>
<section id="binary-releases-for-the-experimental-just-in-time-compiler">
<span id="whatsnew314-jit-compiler"></span><h3 class="translated">实验性即时编译器（JIT）的二进制发布版本<a class="headerlink" href="#binary-releases-for-the-experimental-just-in-time-compiler" title="Link to this heading">¶</a></h3>
<p class="translated">官方 macOS 和 Windows 发布版二进制文件现已包含 <em>实验性</em> 即时编译（JIT）器。虽然不建议在生产环境中使用，但可通过设置环境变量 <span class="target" id="index-246"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_JIT"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_JIT=1</span></code></a> 进行测试。下游源码构建和再分发方可使用配置选项 <a class="reference internal" href="../using/configure.html#cmdoption-enable-experimental-jit"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-experimental-jit=yes-off</span></code></a> 实现类似行为。</p>
<p class="translated">该JIT编译器尚处于早期开发阶段，性能表现存在波动：启用后根据工作负载不同，可能产生10%的性能下降至20%的性能提升。为便于测试评估，<a class="reference internal" href="../library/sys.html#sys._jit" title="sys._jit"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys._jit</span></code></a> 命名空间提供了一组内省函数：<a class="reference internal" href="../library/sys.html#sys._jit.is_available" title="sys._jit.is_available"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys._jit.is_available()</span></code></a> 用于检测当前可执行文件是否支持JIT编译，而 <a class="reference internal" href="../library/sys.html#sys._jit.is_available" title="sys._jit.is_available"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys._jit.is_available()</span></code></a> 则可判断当前进程是否已启用JIT编译功能。</p>
<p class="translated">当前最显著的功能缺失是原生调试器（如 <code class="docutils literal notranslate"><span class="pre">gdb</span></code>）和性能分析工具（如 <code class="docutils literal notranslate"><span class="pre">perf</span></code>）无法展开JIT调用栈（而Python原生调试器如 <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 和性能分析器如 <a class="reference internal" href="../library/profile.html#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> 仍可无需修改直接使用）。此外，自由线程构建版本暂不支持JIT编译功能。</p>
<p class="translated">如遇任何错误或严重性能退化问题，请务必提交报告！</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-86"></span><a class="pep reference external" href="https://peps.python.org/pep-0744/"><strong>PEP 744</strong></a></p>
</div>
</section>
</section>
<section id="porting-to-python-3-14">
<h2 class="translated">移植到 Python 3.14<a class="headerlink" href="#porting-to-python-3-14" title="Link to this heading">¶</a></h2>
<p class="translated">本节列出了先前描述的更改以及可能需要更改代码的其他错误修正.</p>
<section id="changes-in-the-python-api">
<h3 class="translated">Python API 的变化<a class="headerlink" href="#changes-in-the-python-api" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">在 macOS 以外的 Unix 平台上，<em>forkserver</em> 现在是用于 <a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a> 和 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor" title="concurrent.futures.ProcessPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessPoolExecutor</span></code></a> 的默认 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-methods"><span class="std std-ref">启动方法</span></a>，代替了 <em>fork</em>。</p>
<p class="translated">请参阅 <a class="reference internal" href="#whatsnew314-concurrent-futures-start-method"><span class="std std-ref">(1)</span></a> 和 <a class="reference internal" href="#whatsnew314-multiprocessing-start-method"><span class="std std-ref">(2)</span></a> 了解详情。</p>
<p class="translated">如果你在 <a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a> 或 <a class="reference internal" href="../library/concurrent.futures.html#module-concurrent.futures" title="concurrent.futures: Execute computations concurrently using threads or processes."><code class="xref py py-mod docutils literal notranslate"><span class="pre">concurrent.futures</span></code></a> 中遇到 <a class="reference internal" href="../library/exceptions.html#NameError" title="NameError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NameError</span></code></a> 或 pickle 错误，请参阅 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-programming-forkserver"><span class="std std-ref">forkserver 的限制</span></a>。</p>
<p class="translated">这一更改不会影响 Windows 或 macOS，在这两个平台上 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-method-spawn"><span class="std std-ref">'spawn'</span></a> 仍是默认的启动方法。remains the default start method.</p>
</li>
<li><p class="translated"><a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><code class="xref py py-class docutils literal notranslate"><span class="pre">functools.partial</span></code></a> 现在是一个方法描述符。若需保持原有行为，请将其包装在 <a class="reference internal" href="../library/functions.html#staticmethod" title="staticmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">staticmethod()</span></code></a> 中。（由 Serhiy Storchaka 和 Dominykas Grigonis 在 <a class="reference external" href="https://github.com/python/cpython/issues/121027">gh-121027</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="#whatsnew314-incremental-gc"><span class="std std-ref">垃圾回收器现在是增量式的</span></a>，这意味着 <a class="reference internal" href="../library/gc.html#gc.collect" title="gc.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code></a> 的行为有轻微改变：</p>
<ul class="simple">
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">gc.collect(1)</span></code>：执行一次增量式垃圾回收，而非专门回收第1代对象。</p></li>
<li><p class="translated">对 <code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code> 的其他调用保持不变。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/locale.html#locale.nl_langinfo" title="locale.nl_langinfo"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.nl_langinfo()</span></code></a> 函数现在会在某些情况下临时设置 <code class="docutils literal notranslate"><span class="pre">LC_CTYPE</span></code> 区域设置。这种临时修改会影响其他线程。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/69998">gh-69998</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/types.html#types.UnionType" title="types.UnionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.UnionType</span></code></a> 现在是 <a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Union</span></code></a> 的别名，这会导致部分行为发生变化。更多细节请参见 <a class="reference internal" href="#whatsnew314-typing-union"><span class="std std-ref">上文</span></a>。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/105499">gh-105499</a> 中贡献。）</p></li>
<li><p class="translated">标注的运行时行为在多个方面发生了改变；请参阅 <a class="reference internal" href="#whatsnew314-deferred-annotations"><span class="std std-ref">上文</span></a> 了解详情。 虽然大多数与标注交互的代码应该能继续工作，但某些未写入文档的细节行为可能有所不同。for details. While most code that interacts with annotations should continue to work, some undocumented details may behave differently.</p></li>
<li><p class="translated">由于要将 <a class="reference internal" href="../library/mimetypes.html#module-mimetypes" title="mimetypes: Mapping of filename extensions to MIME types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code></a> CLI 对外公开，现在当它执行失败时的退出码将为 <code class="docutils literal notranslate"><span class="pre">1</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">0</span></code>，当有不正确的命令行形参时的退出码为 <code class="docutils literal notranslate"><span class="pre">2</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">1</span></code>。 错误消息现在将被打印到 stderr。</p></li>
<li><p class="translated">现在当作为整个模式给出时正则表达式中的 <code class="docutils literal notranslate"><span class="pre">\B</span></code> 模式将会匹配空字符串，这可能导致行为上的变化。</p></li>
<li><p class="translated">在 FreeBSD 上，<a class="reference internal" href="../library/sys.html#sys.platform" title="sys.platform"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.platform</span></code></a> 不再包含主版本号。</p></li>
</ul>
</section>
<section id="changes-in-annotations-pep-649-and-pep-749">
<span id="whatsnew314-porting-annotations"></span><h3 class="translated">标注中的变化 (<span class="target" id="index-170"></span><a class="pep reference external" href="https://peps.python.org/pep-0649/"><strong>PEP 649</strong></a> 和 <span class="target" id="index-171"></span><a class="pep reference external" href="https://peps.python.org/pep-0749/"><strong>PEP 749</strong></a>)<a class="headerlink" href="#changes-in-annotations-pep-649-and-pep-749" title="Link to this heading">¶</a></h3>
<p class="translated">本节包含因为与 <a class="reference internal" href="#whatsnew314-deferred-annotations"><span class="std std-ref">标注的迟延求值</span></a> 相关的变化而可能需要对标注或者与标注内省交互的 Python 代码进行的修改的指导。</p>
<p class="translated">在大部分情况下，来自较旧 Python 版本的可用代码将不需要任何修改。</p>
<section id="implications-for-annotated-code">
<h4 class="translated">注解代码的影响<a class="headerlink" href="#implications-for-annotated-code" title="Link to this heading">¶</a></h4>
<p class="translated">如果在代码中定义注解（例如用于静态类型检查器），那么这一变更可能不会产生影响：你可以继续保持与之前Python版本相同的注解书写方式。</p>
<p class="translated">你很可能可以移除注解中的引号字符串（这些通常用于前向引用）。同样地，如果使用 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code> 来避免在注解中书写字符串，当你仅支持 Python 3.14 及更新版本时，很可能可以移除该导入。不过，如果依赖读取注解的第三方库，这些库可能需要相应修改以支持无引号注解，才能正常工作。</p>
</section>
<section id="implications-for-readers-of-annotations">
<h4 class="translated">访问 <code class="docutils literal notranslate"><span class="pre">__annotations__</span></code> 的影响<a class="headerlink" href="#implications-for-readers-of-annotations" title="Link to this heading">¶</a></h4>
<p class="translated">如果你的代码会读取对象的 <a class="reference internal" href="../reference/datamodel.html#object.__annotations__" title="object.__annotations__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__annotations__</span></code></a> 属性，你可能需要进行修改以支持依赖于标注的迟延求值的代码。 例如，你可以使用 <a class="reference internal" href="../library/annotationlib.html#annotationlib.get_annotations" title="annotationlib.get_annotations"><code class="xref py py-func docutils literal notranslate"><span class="pre">annotationlib.get_annotations()</span></code></a> 并附带 <a class="reference internal" href="../library/annotationlib.html#annotationlib.Format.FORWARDREF" title="annotationlib.Format.FORWARDREF"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FORWARDREF</span></code></a> 格式，就像 <a class="reference internal" href="../library/dataclasses.html#module-dataclasses" title="dataclasses: Generate special methods on user-defined classes."><code class="xref py py-mod docutils literal notranslate"><span class="pre">dataclasses</span></code></a> 模块现在所做的那样。</p>
<p class="translated">外部包 <a class="extlink-pypi reference external" href="https://pypi.org/project/typing_extensions/">typing_extensions</a> 提供了 <a class="reference internal" href="../library/annotationlib.html#module-annotationlib" title="annotationlib: Functionality for introspecting annotations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">annotationlib</span></code></a> 模块部分功能的向后兼容实现，包括 <a class="reference internal" href="../library/annotationlib.html#annotationlib.Format" title="annotationlib.Format"><code class="xref py py-class docutils literal notranslate"><span class="pre">Format</span></code></a> 枚举和 <a class="reference internal" href="../library/annotationlib.html#annotationlib.get_annotations" title="annotationlib.get_annotations"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_annotations()</span></code></a> 函数。这些可用于编写跨版本代码，以利用 Python 3.14 中的新行为。</p>
</section>
<section id="related-changes">
<h4 class="translated">相关变更<a class="headerlink" href="#related-changes" title="Link to this heading">¶</a></h4>
<p class="translated">Python 3.14 中的改变的设计思路是对于 <code class="xref py py-attr docutils literal notranslate"><span class="pre">__annotations__</span></code> 在运行时的工作方式进行调整的同时最小化对于在源代码中包含标注的代码和读取 <code class="xref py py-attr docutils literal notranslate"><span class="pre">__annotations__</span></code> 的代码的破坏性影响。 不过，如果你依赖于标注行为未写入文档的细节或标准库中的私有函数，那么你的代码可能出于多种原因而无法在 Python 3.14 中正常工作。 为保证你的代码不受未来变化的影响，请仅使用 <a class="reference internal" href="../library/annotationlib.html#module-annotationlib" title="annotationlib: Functionality for introspecting annotations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">annotationlib</span></code></a> 模块已写入文档的功能。</p>
<p class="translated">特别需要注意的是，不要直接从类型对象的命名空间字典属性中读取注解。在类构造期间应使用 <a class="reference internal" href="../library/annotationlib.html#annotationlib.get_annotate_from_class_namespace" title="annotationlib.get_annotate_from_class_namespace"><code class="xref py py-func docutils literal notranslate"><span class="pre">annotationlib.get_annotate_from_class_namespace()</span></code></a> 函数，之后则使用 <a class="reference internal" href="../library/annotationlib.html#annotationlib.get_annotations" title="annotationlib.get_annotations"><code class="xref py py-func docutils literal notranslate"><span class="pre">annotationlib.get_annotations()</span></code></a> 函数。</p>
<p class="translated">在之前的版本中，有时可以通过带注解类的实例访问类注解。这种行为属于未文档化的意外实现，在 Python 3.14 中将不再有效。</p>
</section>
<section id="from-future-import-annotations">
<h4 class="translated"><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code><a class="headerlink" href="#from-future-import-annotations" title="Link to this heading">¶</a></h4>
<p class="translated">在 Python 3.7 中，<span class="target" id="index-247"></span><a class="pep reference external" href="https://peps.python.org/pep-0563/"><strong>PEP 563</strong></a> 引入了 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code> <a class="reference internal" href="../reference/simple_stmts.html#future"><span class="std std-ref">future 语句</span></a>，这会将所有标注转为字符串。</p>
<p class="translated">不过，这条语句现在已被弃用并预计会在未来的 Python 中移除。 此项移除将不会立即执行而是直到 2029 年 Python 3.13 的生命期结束之后，它是不支持标注迟延求值的最后一个 Python 版本。</p>
<p class="translated">在 Python 3.14 中，使用 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code> 的代码的行为将没有变化。</p>
</section>
</section>
<section id="changes-in-the-c-api">
<h3 class="translated">C API 的变化<a class="headerlink" href="#changes-in-the-c-api" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../c-api/init.html#c.Py_Finalize" title="Py_Finalize"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_Finalize()</span></code></a> 现在会删除所有已驻留字符串。 这一变更将不向下兼容任何在调用 <a class="reference internal" href="../c-api/init.html#c.Py_Finalize" title="Py_Finalize"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_Finalize()</span></code></a> 后仍拥有驻留字符串并在后续调用 <a class="reference internal" href="../c-api/init.html#c.Py_Initialize" title="Py_Initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_Initialize()</span></code></a> 时重复使用的 C 扩展模块。 此行为引发的任何问题通常会导致在后续 <a class="reference internal" href="../c-api/init.html#c.Py_Initialize" title="Py_Initialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_Initialize()</span></code></a> 调用执行期间因访问未初始化内存而引发崩溃。 要修复此问题，应使用地址静化器来标识任何来自驻留字符串的释放后使用并在模块关闭期间释放它。 （由 Eddie Elizondo 在 <a class="reference external" href="https://github.com/python/cpython/issues/113601">gh-113601</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/exceptions.html#unicodeexceptions"><span class="std std-ref">Unicode异常对象</span></a> C API现会在异常参数不是 <a class="reference internal" href="../library/exceptions.html#UnicodeError" title="UnicodeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">UnicodeError</span></code></a> 对象时抛出 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> 异常。（由Bénédikt Tran在 <a class="reference external" href="https://github.com/python/cpython/issues/127691">gh-127691</a> 中贡献）</p></li>
</ul>
<ul id="whatsnew314-refcount">
<li><p class="translated">解释器在将对象加载到操作数栈时，会通过尽可能 <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">借用</span></a> 引用来避免部分引用计数的修改。 这可能导致引用计数值比先前 Python 版本更小。 之前通过检查 <a class="reference internal" href="../c-api/refcounting.html#c.Py_REFCNT" title="Py_REFCNT"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_REFCNT()</span></code></a> 是否为 <code class="docutils literal notranslate"><span class="pre">1</span></code> 来判断函数参数是否未被其他代码引用的 C 扩展 API，现在应改用更安全的替代方案 <a class="reference internal" href="../c-api/object.html#c.PyUnstable_Object_IsUniqueReferencedTemporary" title="PyUnstable_Object_IsUniqueReferencedTemporary"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnstable_Object_IsUniqueReferencedTemporary()</span></code></a>。</p></li>
<li><p class="translated">以下私有函数已提升为公开 C API：</p>
<ul class="simple">
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyBytes_Join()</span></code>：<a class="reference internal" href="../c-api/bytes.html#c.PyBytes_Join" title="PyBytes_Join"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBytes_Join()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyLong_IsNegative()</span></code>：<a class="reference internal" href="../c-api/long.html#c.PyLong_IsNegative" title="PyLong_IsNegative"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_IsNegative()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyLong_IsPositive()</span></code>：<a class="reference internal" href="../c-api/long.html#c.PyLong_IsPositive" title="PyLong_IsPositive"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_IsPositive()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyLong_IsZero()</span></code>：<a class="reference internal" href="../c-api/long.html#c.PyLong_IsZero" title="PyLong_IsZero"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_IsZero()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyLong_Sign()</span></code>：<a class="reference internal" href="../c-api/long.html#c.PyLong_GetSign" title="PyLong_GetSign"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_GetSign()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Dealloc()</span></code>：<a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Discard" title="PyUnicodeWriter_Discard"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Discard()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Finish()</span></code>：<a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Finish" title="PyUnicodeWriter_Finish"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Finish()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Init()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_Create" title="PyUnicodeWriter_Create"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_Create()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_Prepare()</span></code>: (无替代)</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_PrepareKind()</span></code>: (无替代)</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteChar()</span></code>：<a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteChar" title="PyUnicodeWriter_WriteChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteChar()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteStr()</span></code>：<a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteStr" title="PyUnicodeWriter_WriteStr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteStr()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicodeWriter_WriteSubstring()</span></code>：<a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeWriter_WriteSubstring" title="PyUnicodeWriter_WriteSubstring"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicodeWriter_WriteSubstring()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicode_EQ()</span></code>：<a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Equal" title="PyUnicode_Equal"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Equal()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_PyUnicode_Equal()</span></code>：<a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Equal" title="PyUnicode_Equal"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Equal()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_Py_GetConfig()</span></code>: <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get()</span></code></a> 和 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_GetInt" title="PyConfig_GetInt"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_GetInt()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_Py_HashBytes()</span></code>: <a class="reference internal" href="../c-api/hash.html#c.Py_HashBuffer" title="Py_HashBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_HashBuffer()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">_Py_fopen_obj()</span></code>：<a class="reference internal" href="../c-api/sys.html#c.Py_fopen" title="Py_fopen"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_fopen()</span></code></a></p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">PyMutex_IsLocked()</span></code> : <a class="reference internal" href="../c-api/init.html#c.PyMutex_IsLocked" title="PyMutex_IsLocked"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMutex_IsLocked()</span></code></a></p></li>
</ul>
<p class="translated">在 Python 3.13 和更早的版本中可以使用 <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat project</a> 来充分利用这些新函数。</p>
</li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.14 有什么新变化</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">摘要 -- 发布重点</a></li>
<li><a class="reference internal" href="#new-features">新的特性</a><ul>
<li><a class="reference internal" href="#pep-649-pep-749-deferred-evaluation-of-annotations"><strong>PEP 649</strong> &amp; <strong>PEP 749</strong>: 标注的迟延求值</a></li>
<li><a class="reference internal" href="#pep-734-multiple-interpreters-in-the-standard-library"><strong>PEP 734</strong>: 标准库中的多解释器</a></li>
<li><a class="reference internal" href="#pep-750-template-string-literals"><strong>PEP 750</strong>: 模板字符串字面值</a></li>
<li><a class="reference internal" href="#pep-768-safe-external-debugger-interface"><strong>PEP 768</strong>: 安全的外部调试器接口</a></li>
<li><a class="reference internal" href="#a-new-type-of-interpreter">一种新型的解释器</a></li>
<li><a class="reference internal" href="#free-threaded-mode-improvements">自由线程模式的改进</a></li>
<li><a class="reference internal" href="#improved-error-messages">改进的错误消息</a></li>
<li><a class="reference internal" href="#pep-784-zstandard-support-in-the-standard-library"><strong>PEP 784</strong>: 标准库中的 Zstandard 支持support in the standard library</a></li>
<li><a class="reference internal" href="#asyncio-introspection-capabilities">asyncio 内省能力</a></li>
<li><a class="reference internal" href="#concurrent-safe-warnings-control">并发安全的警告控制</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他语言特性修改</a><ul>
<li><a class="reference internal" href="#built-ins">内置</a></li>
<li><a class="reference internal" href="#command-line-and-environment">命令行与环境</a></li>
<li><a class="reference internal" href="#pep-758-allow-except-and-except-expressions-without-brackets">PEP 758: 允许不带圆括号的 <code class="docutils literal notranslate"><span class="pre">except</span></code> 和 <code class="docutils literal notranslate"><span class="pre">except*</span></code> 表达式</a></li>
<li><a class="reference internal" href="#pep-765-control-flow-in-finally-blocks">PEP 765: <code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code> 代码块中的控制流</a></li>
<li><a class="reference internal" href="#incremental-garbage-collection">增量式垃圾回收</a></li>
<li><a class="reference internal" href="#default-interactive-shell">默认的交互式 shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-modules">新增模块</a></li>
<li><a class="reference internal" href="#improved-modules">改进的模块</a><ul>
<li><a class="reference internal" href="#argparse">argparse</a></li>
<li><a class="reference internal" href="#ast">ast（抽象语法树）</a></li>
<li><a class="reference internal" href="#asyncio">asyncio</a></li>
<li><a class="reference internal" href="#calendar">calendar（日历）</a></li>
<li><a class="reference internal" href="#concurrent-futures">concurrent.futures</a></li>
<li><a class="reference internal" href="#configparser">configparser</a></li>
<li><a class="reference internal" href="#contextvars">contextvars</a></li>
<li><a class="reference internal" href="#ctypes">ctypes</a></li>
<li><a class="reference internal" href="#curses">curses</a></li>
<li><a class="reference internal" href="#datetime">datetime</a></li>
<li><a class="reference internal" href="#decimal">decimal</a></li>
<li><a class="reference internal" href="#difflib">difflib</a></li>
<li><a class="reference internal" href="#dis">dis</a></li>
<li><a class="reference internal" href="#errno">errno</a></li>
<li><a class="reference internal" href="#faulthandler">faulthandler</a></li>
<li><a class="reference internal" href="#fnmatch">fnmatch</a></li>
<li><a class="reference internal" href="#fractions">fractions</a></li>
<li><a class="reference internal" href="#functools">functools</a></li>
<li><a class="reference internal" href="#getopt">getopt</a></li>
<li><a class="reference internal" href="#getpass">getpass</a></li>
<li><a class="reference internal" href="#graphlib">graphlib</a></li>
<li><a class="reference internal" href="#heapq">heapq</a></li>
<li><a class="reference internal" href="#hmac">hmac</a></li>
<li><a class="reference internal" href="#http">http</a></li>
<li><a class="reference internal" href="#imaplib">imaplib</a></li>
<li><a class="reference internal" href="#inspect">inspect</a></li>
<li><a class="reference internal" href="#io">io</a></li>
<li><a class="reference internal" href="#json">json</a></li>
<li><a class="reference internal" href="#linecache">linecache</a></li>
<li><a class="reference internal" href="#logging-handlers">logging.handlers</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#mimetypes">mimetypes</a></li>
<li><a class="reference internal" href="#multiprocessing">multiprocessing</a></li>
<li><a class="reference internal" href="#operator">operator</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#os-path">os.path</a></li>
<li><a class="reference internal" href="#pathlib">pathlib</a></li>
<li><a class="reference internal" href="#pdb">pdb</a></li>
<li><a class="reference internal" href="#pickle">pickle</a></li>
<li><a class="reference internal" href="#platform">platform</a></li>
<li><a class="reference internal" href="#pydoc">pydoc</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#socket">socket</a></li>
<li><a class="reference internal" href="#ssl">ssl</a></li>
<li><a class="reference internal" href="#struct">struct</a></li>
<li><a class="reference internal" href="#symtable">symtable</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#sys-monitoring">sys.monitoring</a></li>
<li><a class="reference internal" href="#sysconfig">sysconfig</a></li>
<li><a class="reference internal" href="#tarfile">tarfile</a></li>
<li><a class="reference internal" href="#threading">threading</a></li>
<li><a class="reference internal" href="#tkinter">tkinter</a></li>
<li><a class="reference internal" href="#turtle">turtle（海龟绘图）</a></li>
<li><a class="reference internal" href="#types">types（类型）</a></li>
<li><a class="reference internal" href="#typing">typing</a></li>
<li><a class="reference internal" href="#unicodedata">unicodedata</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#urllib">urllib</a></li>
<li><a class="reference internal" href="#uuid">uuid</a></li>
<li><a class="reference internal" href="#webbrowser">webbrowser</a></li>
<li><a class="reference internal" href="#zipfile">zipfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">性能优化</a><ul>
<li><a class="reference internal" href="#id2">asyncio</a></li>
<li><a class="reference internal" href="#base64">base64</a></li>
<li><a class="reference internal" href="#bdb">bdb</a></li>
<li><a class="reference internal" href="#id3">difflib</a></li>
<li><a class="reference internal" href="#gc">gc</a></li>
<li><a class="reference internal" href="#id4">io</a></li>
<li><a class="reference internal" href="#id5">pathlib</a></li>
<li><a class="reference internal" href="#id6">pdb</a></li>
<li><a class="reference internal" href="#id7">uuid</a></li>
<li><a class="reference internal" href="#zlib">zlib</a></li>
</ul>
</li>
<li><a class="reference internal" href="#removed">移除</a><ul>
<li><a class="reference internal" href="#id8">argparse</a></li>
<li><a class="reference internal" href="#id9">ast（抽象语法树）</a></li>
<li><a class="reference internal" href="#id10">asyncio</a></li>
<li><a class="reference internal" href="#email">email</a></li>
<li><a class="reference internal" href="#importlib-abc">importlib.abc</a></li>
<li><a class="reference internal" href="#itertools">itertools</a></li>
<li><a class="reference internal" href="#id11">pathlib</a></li>
<li><a class="reference internal" href="#pkgutil">pkgutil</a></li>
<li><a class="reference internal" href="#pty">pty</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#id12">urllib</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deprecated">弃用</a><ul>
<li><a class="reference internal" href="#new-deprecations">新的弃用</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-15">计划在 Python 3.15 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-16">计划在 Python 3.16 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-17">计划在 Python 3.17 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-19">计划在 Python 3.19 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-future-versions">计划在未来版本中移除</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpython-bytecode-changes">CPython 字节码的改变</a><ul>
<li><a class="reference internal" href="#pseudo-instructions">伪指令</a></li>
</ul>
</li>
<li><a class="reference internal" href="#c-api-changes">C API 的变化</a><ul>
<li><a class="reference internal" href="#python-configuration-c-api">Python 配置 C API</a></li>
<li><a class="reference internal" href="#new-features-in-the-c-api">C API 中的新特性</a></li>
<li><a class="reference internal" href="#limited-c-api-changes">受限 C API 的变化</a></li>
<li><a class="reference internal" href="#removed-c-apis">被移除的 C API</a></li>
<li><a class="reference internal" href="#deprecated-c-apis">已弃用的 C API</a><ul>
<li><a class="reference internal" href="#id13">计划在 Python 3.15 中移除</a></li>
<li><a class="reference internal" href="#id14">计划在 Python 3.16 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-18">计划在 Python 3.18 中移除</a></li>
<li><a class="reference internal" href="#id15">计划在未来版本中移除</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#build-changes">构建的改变</a><ul>
<li><a class="reference internal" href="#build-details-json"><code class="file docutils literal notranslate"><span class="pre">build-details.json</span></code></a></li>
<li><a class="reference internal" href="#discontinuation-of-pgp-signatures">PGP 签名的停用</a></li>
<li><a class="reference internal" href="#free-threaded-python-is-officially-supported">自由线程版 Python 已获官方支持</a></li>
<li><a class="reference internal" href="#binary-releases-for-the-experimental-just-in-time-compiler">实验性即时编译器（JIT）的二进制发布版本</a></li>
</ul>
</li>
<li><a class="reference internal" href="#porting-to-python-3-14">移植到 Python 3.14</a><ul>
<li><a class="reference internal" href="#changes-in-the-python-api">Python API 的变化</a></li>
<li><a class="reference internal" href="#changes-in-annotations-pep-649-and-pep-749">标注中的变化 (<strong>PEP 649</strong> 和 <strong>PEP 749</strong>)</a><ul>
<li><a class="reference internal" href="#implications-for-annotated-code">注解代码的影响</a></li>
<li><a class="reference internal" href="#implications-for-readers-of-annotations">访问 <code class="docutils literal notranslate"><span class="pre">__annotations__</span></code> 的影响</a></li>
<li><a class="reference internal" href="#related-changes">相关变更</a></li>
<li><a class="reference internal" href="#from-future-import-annotations"><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#changes-in-the-c-api">C API 的变化</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="index.html"
                          title="上一章">Python的新变化</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="3.13.html"
                          title="下一章">Python 3.13 有什么新变化</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告代码错误</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.14.rst?plain=1"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="折叠边栏">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="3.13.html" title="Python 3.13 有什么新变化"
             >下一页</a> |</li>
        <li class="right" >
          <a href="index.html" title="Python的新变化"
             >上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python的新变化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.14 有什么新变化</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box">
          <input type="submit" value="转到">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">版权</a> 2001 Python Software Foundation.
    <br>
    本页面采用 Python 软件基金会许可证第 2 版授权。
    <br>
    文档中的示例、代码片段及其他代码内容额外采用零条款 BSD 许可证授权。
    <br>
    
      更多信息请参阅《<a href="/license.html"> 历史与许可 </a>》。<br>
    
    
    <br>

    Python 软件基金会是一家非营利性公司。
<a href="https://www.python.org/psf/donations/">请进行捐赠。</a>
<br>
    <br>
      最后更新于11月 25, 2025 (07:24 UTC) 。
    
      <a href="/bugs.html">发现了错误</a>？
    
    <br>

    使用<a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3 创建。
    </div>

  </body>
</html>