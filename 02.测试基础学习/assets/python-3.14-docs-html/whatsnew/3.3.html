<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Python 3.3 有什么新变化" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/whatsnew/3.3.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="本文介绍了 Python 3.3 相比 3.2 的新增特性。 Python 3.3 于 2012 年 9 月 29 日 发布。 有关完整详细信息，请参见 changelog 。 摘要 -- 发布重点: 新的语法特性： 新增 yield from 表达式用于 生成器委托 。, u&#x27;unicode&#x27; 语法重新被接受用于 str 对象。. 新的库模块： faulthandler..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://docs.python.org/3.14/zh-cn/_images/social_previews/summary_whatsnew_3.3_527c2647.png" />
<meta property="og:image:alt" content="本文介绍了 Python 3.3 相比 3.2 的新增特性。 Python 3.3 于 2012 年 9 月 29 日 发布。 有关完整详细信息，请参见 changelog 。 摘要 -- 发布重点: 新的语法特性： 新增 yield from 表达式用于 生成器委托 。, u&#x27;unicode&#x27; 语法重新被接受用于 str 对象。. 新的库模块： faulthandler..." />
<meta name="description" content="本文介绍了 Python 3.3 相比 3.2 的新增特性。 Python 3.3 于 2012 年 9 月 29 日 发布。 有关完整详细信息，请参见 changelog 。 摘要 -- 发布重点: 新的语法特性： 新增 yield from 表达式用于 生成器委托 。, u&#x27;unicode&#x27; 语法重新被接受用于 str 对象。. 新的库模块： faulthandler..." />
<meta name="twitter:card" content="summary_large_image" />
<meta name="theme-color" content="#3776ab">

    <title>Python 3.3 有什么新变化 &#8212; Python 3.14.0 文档</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=234b1a7c" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=8cd84f99" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=5349f25f" />
    
    <script src="../_static/documentation_options.js?v=a595ec0e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.14.0 文档 中搜索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="关于此文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="copyright" title="版权" href="../copyright.html" />
    <link rel="next" title="Python 3.2 有什么新变化" href="3.2.html" />
    <link rel="prev" title="Python 3.4 有什么新变化" href="3.4.html" />
    
      
      <script defer file-types="bz2,epub,zip" data-domain="docs.python.org" src="https://analytics.python.org/js/script.file-downloads.outbound-links.js"></script>
      
      <link rel="canonical" href="https://docs.python.org/3/whatsnew/3.3.html">
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg">
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="菜单">
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo">
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q">
                <input type="submit" value="转到">
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.3 有什么新变化</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">摘要 -- 发布重点</a></li>
<li><a class="reference internal" href="#pep-405-virtual-environments">PEP 405: 虚拟环境</a></li>
<li><a class="reference internal" href="#pep-420-implicit-namespace-packages">PEP 420: 隐式命名空间包</a></li>
<li><a class="reference internal" href="#pep-3118-new-memoryview-implementation-and-buffer-protocol-documentation">PEP 3118: 新的内存视图实现和缓冲协议文档</a><ul>
<li><a class="reference internal" href="#features">相关特性</a></li>
<li><a class="reference internal" href="#api-changes">API 的变化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-393-flexible-string-representation">PEP 393: 灵活的字符串表示</a><ul>
<li><a class="reference internal" href="#functionality">功能</a></li>
<li><a class="reference internal" href="#performance-and-resource-usage">性能和资源使用情况</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-397-python-launcher-for-windows">PEP 397: 适用于Windows的Python启动器</a></li>
<li><a class="reference internal" href="#pep-3151-reworking-the-os-and-io-exception-hierarchy">PEP 3151: 重写 OS 和 IO 异常的层次结构</a></li>
<li><a class="reference internal" href="#pep-380-syntax-for-delegating-to-a-subgenerator">PEP 380: 委托给子生成器的语法</a></li>
<li><a class="reference internal" href="#pep-409-suppressing-exception-context">PEP 409: 清除异常上下文</a></li>
<li><a class="reference internal" href="#pep-414-explicit-unicode-literals">PEP 414: 显式的Unicode文本</a></li>
<li><a class="reference internal" href="#pep-3155-qualified-name-for-classes-and-functions">PEP 3155: 类和函数的限定名称</a></li>
<li><a class="reference internal" href="#pep-412-key-sharing-dictionary">PEP 412: Key-Sharing Dictionary</a></li>
<li><a class="reference internal" href="#pep-362-function-signature-object">PEP 362: 函数签名对象</a></li>
<li><a class="reference internal" href="#pep-421-adding-sys-implementation">PEP 421: 添加 sys.implementation</a><ul>
<li><a class="reference internal" href="#simplenamespace">SimpleNamespace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-importlib-as-the-implementation-of-import">使用 importlib 作为导入的实现</a><ul>
<li><a class="reference internal" href="#new-apis">新的API</a></li>
<li><a class="reference internal" href="#visible-changes">可见的改变</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他语言特性修改</a></li>
<li><a class="reference internal" href="#a-finer-grained-import-lock">更细粒度的导入锁</a></li>
<li><a class="reference internal" href="#builtin-functions-and-types">内置函数和类型</a></li>
<li><a class="reference internal" href="#new-modules">新增模块</a><ul>
<li><a class="reference internal" href="#faulthandler">faulthandler</a></li>
<li><a class="reference internal" href="#ipaddress">ipaddress</a></li>
<li><a class="reference internal" href="#lzma">lzma</a></li>
</ul>
</li>
<li><a class="reference internal" href="#improved-modules">改进的模块</a><ul>
<li><a class="reference internal" href="#abc">abc</a></li>
<li><a class="reference internal" href="#array">array</a></li>
<li><a class="reference internal" href="#base64">base64</a></li>
<li><a class="reference internal" href="#binascii">binascii</a></li>
<li><a class="reference internal" href="#bz2">bz2</a></li>
<li><a class="reference internal" href="#codecs">编码器</a></li>
<li><a class="reference internal" href="#collections">collections</a></li>
<li><a class="reference internal" href="#contextlib">contextlib</a></li>
<li><a class="reference internal" href="#crypt">crypt</a></li>
<li><a class="reference internal" href="#curses">curses</a></li>
<li><a class="reference internal" href="#datetime">datetime</a></li>
<li><a class="reference internal" href="#decimal">decimal</a><ul>
<li><a class="reference internal" href="#id1">相关特性</a></li>
<li><a class="reference internal" href="#id2">API 的变化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#email">email</a><ul>
<li><a class="reference internal" href="#policy-framework">策略框架</a></li>
<li><a class="reference internal" href="#provisional-policy-with-new-header-api">带有新头部API的暂行策略</a></li>
<li><a class="reference internal" href="#other-api-changes">其他API更改</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ftplib">ftplib</a></li>
<li><a class="reference internal" href="#functools">functools</a></li>
<li><a class="reference internal" href="#gc">gc</a></li>
<li><a class="reference internal" href="#hmac">hmac</a></li>
<li><a class="reference internal" href="#http">http</a></li>
<li><a class="reference internal" href="#html">html</a></li>
<li><a class="reference internal" href="#imaplib">imaplib</a></li>
<li><a class="reference internal" href="#inspect">inspect</a></li>
<li><a class="reference internal" href="#io">io</a></li>
<li><a class="reference internal" href="#itertools">itertools</a></li>
<li><a class="reference internal" href="#logging">logging</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#mmap">mmap</a></li>
<li><a class="reference internal" href="#multiprocessing">multiprocessing</a></li>
<li><a class="reference internal" href="#nntplib">nntplib</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#pdb">pdb</a></li>
<li><a class="reference internal" href="#pickle">pickle</a></li>
<li><a class="reference internal" href="#pydoc">pydoc</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#sched">sched</a></li>
<li><a class="reference internal" href="#select">select</a></li>
<li><a class="reference internal" href="#shlex">shlex</a></li>
<li><a class="reference internal" href="#shutil">shutil</a></li>
<li><a class="reference internal" href="#signal">signal</a></li>
<li><a class="reference internal" href="#smtpd">smtpd</a></li>
<li><a class="reference internal" href="#smtplib">smtplib</a></li>
<li><a class="reference internal" href="#socket">socket</a></li>
<li><a class="reference internal" href="#socketserver">socketserver</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#ssl">ssl</a></li>
<li><a class="reference internal" href="#stat">stat</a></li>
<li><a class="reference internal" href="#struct">struct</a></li>
<li><a class="reference internal" href="#subprocess">subprocess</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#tarfile">tarfile</a></li>
<li><a class="reference internal" href="#tempfile">tempfile</a></li>
<li><a class="reference internal" href="#textwrap">textwrap</a></li>
<li><a class="reference internal" href="#threading">threading</a></li>
<li><a class="reference internal" href="#time">time</a></li>
<li><a class="reference internal" href="#types">types</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#urllib">urllib</a></li>
<li><a class="reference internal" href="#webbrowser">webbrowser</a></li>
<li><a class="reference internal" href="#xml-etree-elementtree">xml.etree.ElementTree</a></li>
<li><a class="reference internal" href="#zlib">zlib</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">性能优化</a></li>
<li><a class="reference internal" href="#build-and-c-api-changes">构建和 C API 的改变</a></li>
<li><a class="reference internal" href="#deprecated">弃用</a><ul>
<li><a class="reference internal" href="#unsupported-operating-systems">不支持的操作系统</a></li>
<li><a class="reference internal" href="#deprecated-python-modules-functions-and-methods">已弃用的 Python 模块、函数和方法</a></li>
<li><a class="reference internal" href="#deprecated-functions-and-types-of-the-c-api">已弃用的 C API 函数和类型</a></li>
<li><a class="reference internal" href="#deprecated-features">弃用的特性</a></li>
</ul>
</li>
<li><a class="reference internal" href="#porting-to-python-3-3">移植到 Python 3.3</a><ul>
<li><a class="reference internal" href="#porting-python-code">移植 Python 代码</a></li>
<li><a class="reference internal" href="#porting-c-code">移植 C 代码</a></li>
<li><a class="reference internal" href="#building-c-extensions">构建 C 扩展</a></li>
<li><a class="reference internal" href="#command-line-switch-changes">命令行开关的变化</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="3.4.html"
                          title="上一章">Python 3.4 有什么新变化</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="3.2.html"
                          title="下一章">Python 3.2 有什么新变化</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告代码错误</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.3.rst?plain=1"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="3.2.html" title="Python 3.2 有什么新变化"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="3.4.html" title="Python 3.4 有什么新变化"
             accesskey="P">上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python的新变化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.3 有什么新变化</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box">
          <input type="submit" value="转到">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="what-s-new-in-python-3-3">
<h1 class="translated">Python 3.3 有什么新变化<a class="headerlink" href="#what-s-new-in-python-3-3" title="Link to this heading">¶</a></h1>
<p class="translated">本文介绍了 Python 3.3 相比 3.2 的新增特性。 Python 3.3 于 2012 年 9 月 29 日 发布。 有关完整详细信息，请参见 <a class="reference external" href="https://docs.python.org/3.3/whatsnew/changelog.html">changelog</a>。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-75"></span><a class="pep reference external" href="https://peps.python.org/pep-0398/"><strong>PEP 398</strong></a> - Python 3.3 发布计划</p>
</div>
<section id="summary-release-highlights">
<h2 class="translated">摘要 -- 发布重点<a class="headerlink" href="#summary-release-highlights" title="Link to this heading">¶</a></h2>
<p class="translated">新的语法特性：</p>
<ul class="simple">
<li><p class="translated">新增 <code class="docutils literal notranslate"><span class="pre">yield</span> <span class="pre">from</span></code> 表达式用于 <a class="reference internal" href="#pep-380"><span class="std std-ref">生成器委托</span></a>。</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">u'unicode'</span></code> 语法重新被接受用于 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 对象。</p></li>
</ul>
<p class="translated">新的库模块：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/faulthandler.html#module-faulthandler" title="faulthandler: Dump the Python traceback."><code class="xref py py-mod docutils literal notranslate"><span class="pre">faulthandler</span></code></a> (帮助调试低层级的崩溃)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ipaddress.html#module-ipaddress" title="ipaddress: IPv4/IPv6 manipulation library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ipaddress</span></code></a> (代表 IP 地址和掩码的高层级对象)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/lzma.html#module-lzma" title="lzma: A Python wrapper for the liblzma compression library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">lzma</span></code></a> (使用 XZ / LZMA 算法压缩数据)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/unittest.mock.html#module-unittest.mock" title="unittest.mock: Mock object library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest.mock</span></code></a> (使用模拟对象替换你的受测试系统中的某些部分)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code></a> (Python <a class="reference internal" href="#pep-405"><span class="std std-ref">虚拟环境</span></a>，类似于流行的 <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> 包)</p></li>
</ul>
<p class="translated">新的内置特性：</p>
<ul class="simple">
<li><p class="translated">重写 <a class="reference internal" href="#pep-3151"><span class="std std-ref">I/O 异常的层次结构</span></a>.</p></li>
</ul>
<p class="translated">实现的改进：</p>
<ul class="simple">
<li><p class="translated">基于 <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> 重写 <a class="reference internal" href="#importlib"><span class="std std-ref">import machinery</span></a>。</p></li>
<li><p class="translated">更紧凑的 <a class="reference internal" href="#pep-393"><span class="std std-ref">Unicode 字符串</span></a>。</p></li>
<li><p class="translated">更紧凑的 <a class="reference internal" href="#pep-412"><span class="std std-ref">属性字典</span></a>。</p></li>
</ul>
<p class="translated">显著改进的库模块：</p>
<ul class="simple">
<li><p class="translated">针对 <a class="reference internal" href="#new-decimal"><span class="std std-ref">decimal</span></a> 模块的 C 加速器。</p></li>
<li><p class="translated"><a class="reference internal" href="#new-email"><span class="std std-ref">email</span></a> 模块中更好的 Unicode 处理 (<a class="reference internal" href="../glossary.html#term-provisional-package"><span class="xref std std-term">暂定</span></a>)。</p></li>
</ul>
<p class="translated">安全改进：</p>
<ul class="simple">
<li><p class="translated">哈希随机化被默认启用。</p></li>
</ul>
<p class="translated">请继续阅读有关面向用户的改变的详细清单。</p>
</section>
<section id="pep-405-virtual-environments">
<span id="pep-405"></span><h2 class="translated">PEP 405: 虚拟环境<a class="headerlink" href="#pep-405-virtual-environments" title="Link to this heading">¶</a></h2>
<p class="translated">虚拟环境有助于创建 独立的 Python 设置，同时共享全系统的基础安装，便于维护。  虚拟环境有自己的私有站点包（即本地安装的库），并可选择与系统范围的站点包分离。  虚拟环境的概念和实现 受到流行的 <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> 第三方 包 的启发，但受益于与解释器核心更紧密的集成。</p>
<p class="translated">本 PEP 添加了 <a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code></a> 模块用于编程访问，以及 <code class="docutils literal notranslate"><span class="pre">pyvenv</span></code> 脚本用于命令在线访问和管理。 Python 解释器会检查 <code class="docutils literal notranslate"><span class="pre">pyvenv.cfg</span></code>，文件的存在标志着虚拟环境目录树的基础。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-76"></span><a class="pep reference external" href="https://peps.python.org/pep-0405/"><strong>PEP 405</strong></a> - Python虚拟环境</dt><dd><p class="translated">PEP 由 Carl Meyer 撰写 ; 由 Carl Meyer 和 Vinay Sajip 实现。</p>
</dd>
</dl>
</div>
</section>
<section id="pep-420-implicit-namespace-packages">
<h2 class="translated">PEP 420: 隐式命名空间包<a class="headerlink" href="#pep-420-implicit-namespace-packages" title="Link to this heading">¶</a></h2>
<p class="translated">原生支持不要求 <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> 标记文件和可以自动跨越多个路径节的包目录（灵感来自多个命名空间包的第三方方案，如 <span class="target" id="index-77"></span><a class="pep reference external" href="https://peps.python.org/pep-0420/"><strong>PEP 420</strong></a> 中所述）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-78"></span><a class="pep reference external" href="https://peps.python.org/pep-0420/"><strong>PEP 420</strong></a> - 隐式命名空间包</dt><dd><p class="translated">PEP 由 Eric V. Smith 撰写，由 Eric V. Smith 和 Barry Warsaw 实现</p>
</dd>
</dl>
</div>
</section>
<section id="pep-3118-new-memoryview-implementation-and-buffer-protocol-documentation">
<span id="pep-3118-update"></span><h2 class="translated">PEP 3118: 新的内存视图实现和缓冲协议文档<a class="headerlink" href="#pep-3118-new-memoryview-implementation-and-buffer-protocol-documentation" title="Link to this heading">¶</a></h2>
<p class="translated"><span class="target" id="index-79"></span><a class="pep reference external" href="https://peps.python.org/pep-3118/"><strong>PEP 3118</strong></a> 的实现已获得大幅改进。</p>
<p class="translated">新的 memoryview 实现全面修复了 Py_buffer 结构体中曾导致多起崩溃报告的动态分配字段的所有权和生命周期问题。 此外，还修复了多个函数在非连续或多维输入时崩溃或返回不正确结果的问题。</p>
<p class="translated">现在 memoryview 对象具有符合 PEP-3118 标准的 getbufferproc()，可以检查使用者的请求类型。 新增了许多新的特性，其中的大部分已适用于非连续数组和带有子偏移量的数组。</p>
<p class="translated">文档已进行更新，清楚地列出了导出方和使用方的责任。 缓冲区请求旗标志被划分为基本旗标和复合旗标。 对非连续和多维的 NumPy 风格数组的内存布局进行了说明。</p>
<section id="features">
<h3 class="translated">相关特性<a class="headerlink" href="#features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">现在 struct 模块语法中所有原生单字符格式指示符（可以选择添加 '&#64;' 前缀）均受到支持。</p></li>
<li><p class="translated">在某些限制条件下，cast() 方法允许改变 C 连续数组的格式和形状。</p></li>
<li><p class="translated">任何数组类型都支持多维列表的表示形式。</p></li>
<li><p class="translated">任何数组类型都支持多维比较操作。</p></li>
<li><p class="translated">格式为 B、b 或 c 的可哈希（只读）类型的一维 memoryview 现在将是可哈希的。 （由 Antoine Pitrou 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13411">bpo-13411</a> 中贡献。）</p></li>
<li><p class="translated">支持对 1 维数据类型的任意切片。 例如，现在可以通过使用负步长值以 <em>O</em>(1) 复杂度对 memoryview 进行翻转。</p></li>
</ul>
</section>
<section id="api-changes">
<h3 class="translated">API 的变化<a class="headerlink" href="#api-changes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">官方的最大维度数量限制已更改为 64。</p></li>
<li><p class="translated">空形状、区间和子偏移量的表示形式现在是空元组而不是 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p class="translated">现在对格式为 'B' (无符号字节型) 的 memoryview 元素的访问将返回一个整数（遵循结构体模块语法）。 要返回字节串对象则必须先将视图强制转换为 'c'。</p></li>
<li><p class="translated">现在 memoryview 比较将使用操作数的逻辑结构并会按值来比较所有数组元素。 结构体模块语法中的所有格式化字符串均受到支持。 带有不可识别的格式化字符串的视图仍然被允许，但无论视图内容如何比较结果总是不相等。</p></li>
<li><p class="translated">更多改变请参阅 <a class="reference internal" href="#build-and-c-api-changes">Build and C API Changes</a> 和 <a class="reference internal" href="#porting-c-code">Porting C code</a>。</p></li>
</ul>
<p class="translated">（由 Stefan Krah 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10181">bpo-10181</a> 中贡献。）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p class="translated"><span class="target" id="index-80"></span><a class="pep reference external" href="https://peps.python.org/pep-3118/"><strong>PEP 3118</strong></a> - 修改缓冲区协议</p>
</div>
</section>
</section>
<section id="pep-393-flexible-string-representation">
<span id="pep-393"></span><h2 class="translated">PEP 393: 灵活的字符串表示<a class="headerlink" href="#pep-393-flexible-string-representation" title="Link to this heading">¶</a></h2>
<p class="translated">Unicode字符串类型已改为支持多种内部表示法，具体取决于所表示的字符串中具有最大 Unicode 序号（1、2 或 4 字节）的字符 。  这样，在常见情况下可以节省空间，但在所有系统上都能使用完整的 UCS-4。  对于使用现有应用程序接口的兼容性 来说，可能会并行存在几种表示法；随着时间的推移，这种兼容性 应逐步淘汰。</p>
<p class="translated">在 Python 一方，此项改变应当没有任何缺点。</p>
<p class="translated">在 C API 方面，<span class="target" id="index-81"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a> 完全向下兼容。 旧的 API 至少还能使用五年。 使用传统 API 的应用程序不会完全受益于内存的减少，或者更糟的是，可能会使用更多的内存，因为 Python 可能需要维护每个字符串的两个版本（传统格式和新的高效存储）。</p>
<section id="functionality">
<h3 class="translated">功能<a class="headerlink" href="#functionality" title="Link to this heading">¶</a></h3>
<p class="translated">由 <span class="target" id="index-82"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a> 引入的改变如下:</p>
<ul class="simple">
<li><p class="translated">Python 现在始终支持全部 Unicode 码位，包括非 BMP 码位 (即从 <code class="docutils literal notranslate"><span class="pre">U+0000</span></code> 到 <code class="docutils literal notranslate"><span class="pre">U+10FFFF</span></code>)。 窄编译版本和宽编译版本之间的区别已不复存在，Python 现在的行为就像宽编译版本，甚至在 Windows 下也是如此。</p></li>
<li><p class="translated">随着窄编译版本的消亡，窄编译版本特有的问题也得到了解决，例如：</p>
<ul>
<li><p class="translated">现在 <a class="reference internal" href="../library/functions.html#len" title="len"><code class="xref py py-func docutils literal notranslate"><span class="pre">len()</span></code></a> 对于非 BMP 字符总是返回 1，因此 <code class="docutils literal notranslate"><span class="pre">len('\U0010FFFF')</span> <span class="pre">==</span> <span class="pre">1</span></code>；</p></li>
<li><p class="translated">替换对不会在字符串字面值中重新合并，因此 <code class="docutils literal notranslate"><span class="pre">'\uDBFF\uDFFF'</span> <span class="pre">!=</span> <span class="pre">'\U0010FFFF'</span></code>；</p></li>
<li><p class="translated">索引或切分非 BMP 字符会返回预期的值，因此 <code class="docutils literal notranslate"><span class="pre">'\U0010FFFF'[0]</span></code> 现在会返回 <code class="docutils literal notranslate"><span class="pre">'\U0010FFFF'</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">'\uDBFF'</span></code>；</p></li>
<li><p class="translated">标准库中的所有其他函数现在都能正确处理非 BMP 代码点。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/sys.html#sys.maxunicode" title="sys.maxunicode"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.maxunicode</span></code></a> 的值现在总是 <code class="docutils literal notranslate"><span class="pre">1114111</span></code> (十六进制为 <code class="docutils literal notranslate"><span class="pre">0x10FFFF</span></code>)。 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GetMax()</span></code> 函数仍返回 <code class="docutils literal notranslate"><span class="pre">0xFFFF</span></code> 或 <code class="docutils literal notranslate"><span class="pre">0x10FFFF</span></code> 以便向下兼容，但不应与新的 Unicode API 一起使用 (参见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13054">bpo-13054</a>)。</p></li>
<li><p class="translated"><code class="file docutils literal notranslate"><span class="pre">./configure</span></code> 标志 <code class="docutils literal notranslate"><span class="pre">--with-wide-unicode</span></code> 已被移除。</p></li>
</ul>
</section>
<section id="performance-and-resource-usage">
<h3 class="translated">性能和资源使用情况<a class="headerlink" href="#performance-and-resource-usage" title="Link to this heading">¶</a></h3>
<p class="translated">现在，Unicode 字符串的存储取决于字符串中的最高码位：</p>
<ul class="simple">
<li><p class="translated">纯 ASCII 和 Latin1 字符串 (<code class="docutils literal notranslate"><span class="pre">U+0000-U+00FF</span></code>) 每个码位使用 1 个字节；</p></li>
<li><p class="translated">BMP 字符串 (<code class="docutils literal notranslate"><span class="pre">U+0000-U+FFFF</span></code>) 每个码位使用 2 个字节；</p></li>
<li><p class="translated">非 BMP 字符串 (<code class="docutils literal notranslate"><span class="pre">U+10000-U+10FFFF</span></code>) 每个码位使用 4 个字节。</p></li>
</ul>
<p class="translated">这样做的效果是，对于大多数应用而言，字符串存储的内存使用量应该会大幅减少 —— 尤其是与以前的宽 unicode 版本相比 —— 因为在许多情况下，即使在国际环境中，字符串也将是纯 ASCII 格式（因为许多字符串存储的是非人类语言数据，如 XML 片段、HTTP 标头、JSON 编码数据等）。 出于同样的原因，我们还希望它能提高非小应用程序的 CPU 缓存效率。 在 Django 基准测试中，Python 3.3 的内存使用量比 Python 3.2 少两到三倍，比 Python 2.7 略好一些（详情请参见 PEP）。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-83"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a> - 灵活的字符串表示</dt><dd><p class="translated">PEP 由 Martin von Löwis 撰写 ; 由 Torsten Becker 和 Martin von Löwis 实现。</p>
</dd>
</dl>
</div>
</section>
</section>
<section id="pep-397-python-launcher-for-windows">
<span id="pep-397"></span><h2 class="translated">PEP 397: 适用于Windows的Python启动器<a class="headerlink" href="#pep-397-python-launcher-for-windows" title="Link to this heading">¶</a></h2>
<p class="translated">Python 3.3 的 Windows 安装程序现在包含一个 <code class="docutils literal notranslate"><span class="pre">py</span></code> 启动程序，可用于以版本无关的方式启动 Python 应用程序。</p>
<p class="translated">双击 <code class="docutils literal notranslate"><span class="pre">*.py</span></code> 文件时会隐式调用该启动器。 如果系统中只安装了一个 Python 版本，则将使用该版本运行文件。 如果安装了多个版本，则默认使用最新版本，但也可以通过在 Python 脚本中加入 Unix 风格的“shebang 行”来覆盖该版本。</p>
<p class="translated">启动器也可以作为 <code class="docutils literal notranslate"><span class="pre">py</span></code> 应用程序在命令行中显式使用。运行 <code class="docutils literal notranslate"><span class="pre">py</span></code> 遵循与隐式启动脚本相同的版本选择规则，但可以通过传递适当的参数来选择更具体的版本（例如，当 Python 2 也已安装时，使用 <code class="docutils literal notranslate"><span class="pre">-3</span></code> 来请求 Python 3；当安装了较新的 Python 版本时，使用 <code class="docutils literal notranslate"><span class="pre">-2.6</span></code> 来特别请求较早的 Python 版本）。</p>
<p class="translated">除了启动器之外，Windows 安装程序现在还包含一个选项，可将新安装的 Python 添加到系统 PATH 中。 （由 Brian Curtin 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=3561">bpo-3561</a> 中贡献）。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-84"></span><a class="pep reference external" href="https://peps.python.org/pep-0397/"><strong>PEP 397</strong></a> - 适用于Windows的Python启动器</dt><dd><p class="translated">PEP 由 Mark Hammond 和 Martin v. Löwis 撰写 ; 由 Vinay Sajip实现。</p>
</dd>
</dl>
<p class="translated">启动器文档: <a class="reference internal" href="../using/windows.html#launcher"><span class="std std-ref">Python 安装管理器</span></a></p>
<p class="translated">安装器 PATH 修改: <a class="reference internal" href="../using/windows.html#windows-path-mod"><span class="std std-ref">Python 安装管理器</span></a></p>
</div>
</section>
<section id="pep-3151-reworking-the-os-and-io-exception-hierarchy">
<span id="pep-3151"></span><h2 class="translated">PEP 3151: 重写 OS 和 IO 异常的层次结构<a class="headerlink" href="#pep-3151-reworking-the-os-and-io-exception-hierarchy" title="Link to this heading">¶</a></h2>
<p class="translated">现在，由操作系统错误引发的异常层次结构既得到了简化，又更加精细。</p>
<p class="translated">你不必再为在 <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a>, <a class="reference internal" href="../library/exceptions.html#IOError" title="IOError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">IOError</span></code></a>, <a class="reference internal" href="../library/exceptions.html#EnvironmentError" title="EnvironmentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">EnvironmentError</span></code></a>, <a class="reference internal" href="../library/exceptions.html#WindowsError" title="WindowsError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">WindowsError</span></code></a>, <code class="xref py py-exc docutils literal notranslate"><span class="pre">mmap.error</span></code>, <a class="reference internal" href="../library/socket.html#socket.error" title="socket.error"><code class="xref py py-exc docutils literal notranslate"><span class="pre">socket.error</span></code></a> 或 <a class="reference internal" href="../library/select.html#select.error" title="select.error"><code class="xref py py-exc docutils literal notranslate"><span class="pre">select.error</span></code></a> 之间选择合适的异常类型而烦恼。 所有这些异常类型现在只有一个: <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a>。 出于兼容性考虑其他名称将作为别名保留。</p>
<p class="translated">此外，现在捕捉特定错误条件也更容易了。无需从 <a class="reference internal" href="../library/errno.html#module-errno" title="errno: Standard errno system symbols."><code class="xref py py-mod docutils literal notranslate"><span class="pre">errno</span></code></a> 模块中检查 <code class="docutils literal notranslate"><span class="pre">errno</span></code> 属性（或 <code class="docutils literal notranslate"><span class="pre">args[0]</span></code> ）中的特定常量，您可以捕捉适当的 <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 子类。可用的子类如下：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#BlockingIOError" title="BlockingIOError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BlockingIOError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#ChildProcessError" title="ChildProcessError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ChildProcessError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#ConnectionError" title="ConnectionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConnectionError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#FileExistsError" title="FileExistsError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">FileExistsError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#FileNotFoundError" title="FileNotFoundError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">FileNotFoundError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#InterruptedError" title="InterruptedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InterruptedError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#IsADirectoryError" title="IsADirectoryError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">IsADirectoryError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#NotADirectoryError" title="NotADirectoryError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotADirectoryError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#PermissionError" title="PermissionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">PermissionError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#ProcessLookupError" title="ProcessLookupError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ProcessLookupError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#TimeoutError" title="TimeoutError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TimeoutError</span></code></a></p></li>
</ul>
<p class="translated">并且 <a class="reference internal" href="../library/exceptions.html#ConnectionError" title="ConnectionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConnectionError</span></code></a> 本身具有细粒度的子类:</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#BrokenPipeError" title="BrokenPipeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BrokenPipeError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#ConnectionAbortedError" title="ConnectionAbortedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConnectionAbortedError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#ConnectionRefusedError" title="ConnectionRefusedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConnectionRefusedError</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#ConnectionResetError" title="ConnectionResetError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConnectionResetError</span></code></a></p></li>
</ul>
<p class="translated">有了新的异常，现在就可以避免 <a class="reference internal" href="../library/errno.html#module-errno" title="errno: Standard errno system symbols."><code class="xref py py-mod docutils literal notranslate"><span class="pre">errno</span></code></a> 的常见用法了。 例如，下面是为 Python 3.2 编写的代码：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">errno</span><span class="w"> </span><span class="kn">import</span> <span class="n">ENOENT</span><span class="p">,</span> <span class="n">EACCES</span><span class="p">,</span> <span class="n">EPERM</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;document.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">ENOENT</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;document.txt file is missing&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="ow">in</span> <span class="p">(</span><span class="n">EACCES</span><span class="p">,</span> <span class="n">EPERM</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are not allowed to read document.txt&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span>
</pre></div>
</div>
<p class="translated">现在无需导入 <a class="reference internal" href="../library/errno.html#module-errno" title="errno: Standard errno system symbols."><code class="xref py py-mod docutils literal notranslate"><span class="pre">errno</span></code></a>，也无需手动检查异常属性：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;document.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;document.txt file is missing&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are not allowed to read document.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-85"></span><a class="pep reference external" href="https://peps.python.org/pep-3151/"><strong>PEP 3151</strong></a> - 重写 OS 和 IO 异常的层次结构</dt><dd><p class="translated">PEP 由 Antoine Pitrou 撰写并实现</p>
</dd>
</dl>
</div>
</section>
<section id="pep-380-syntax-for-delegating-to-a-subgenerator">
<span id="pep-380"></span><span id="index-11"></span><h2 class="translated">PEP 380: 委托给子生成器的语法<a class="headerlink" href="#pep-380-syntax-for-delegating-to-a-subgenerator" title="Link to this heading">¶</a></h2>
<p class="translated">PEP 380 增加了 <code class="docutils literal notranslate"><span class="pre">yield</span> <span class="pre">from</span></code> 表达式，允许 <a class="reference internal" href="../glossary.html#term-generator"><span class="xref std std-term">generator</span></a> 将其部分操作委托给另一个生成器。 这样，包含 <a class="reference internal" href="../reference/simple_stmts.html#yield"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">yield</span></code></a> 的代码部分就可以被分解出来，放在另一个生成器中。 此外，还允许子生成器返回一个值，并将该值提供给委托生成器。</p>
<p class="translated">虽然 <code class="docutils literal notranslate"><span class="pre">yield</span> <span class="pre">from</span></code> 表达式主要用于委托给子生成器，但它实际上允许委托给任意子生成器。</p>
<p class="translated">对于简单的迭代器而言，<code class="docutils literal notranslate"><span class="pre">yield</span> <span class="pre">from</span> <span class="pre">iterable</span></code> 本质上只是 <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">item</span> <span class="pre">in</span> <span class="pre">iterable:</span> <span class="pre">yield</span> <span class="pre">item</span></code> 的简写形式：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">yield from</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">yield from</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[5, 4, 3, 2, 1, 0, 1, 2, 3, 4]</span>
</pre></div>
</div>
<p class="translated">但是，与普通的循环不同，<code class="docutils literal notranslate"><span class="pre">yield</span> <span class="pre">from</span></code> 允许子生成器直接从调用方作用域获取、发送和抛出值，并向外层生成器返回一个最终值:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">accumulate</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">tally</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">next</span> <span class="o">=</span> <span class="k">yield</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">next</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="n">tally</span>
<span class="gp">... </span>        <span class="n">tally</span> <span class="o">+=</span> <span class="nb">next</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">gather_tallies</span><span class="p">(</span><span class="n">tallies</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">tally</span> <span class="o">=</span> <span class="k">yield from</span> <span class="n">accumulate</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">tallies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tally</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tallies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span> <span class="o">=</span> <span class="n">gather_tallies</span><span class="p">(</span><span class="n">tallies</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>  <span class="c1"># 确保累计器准备好接受值</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">acc</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># 完成第一次记录</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">acc</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># 完成第二次记录</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tallies</span>
<span class="go">[6, 10]</span>
</pre></div>
</div>
<p class="translated">推动这项改变的主要原则是允许即便被设计用来配合 <code class="docutils literal notranslate"><span class="pre">send</span></code> 和 <code class="docutils literal notranslate"><span class="pre">throw</span></code> 方法使用的生成器也能像一个大函数能拆分成多个子函数那样容易地拆分为多个子生成器。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-86"></span><a class="pep reference external" href="https://peps.python.org/pep-0380/"><strong>PEP 380</strong></a> - 委托给子生成器的语法</dt><dd><p class="translated">PEP 由 Greg Ewing 撰写，由 Greg Ewing 实现。由 Renaud Blanch，Ryan Kelly 和 Nick Coghlan 集成到3.3，由 Zbigniew Jędrzejewski-Szmek 和 Nick Coghlan 编写文档</p>
</dd>
</dl>
</div>
</section>
<section id="pep-409-suppressing-exception-context">
<h2 class="translated">PEP 409: 清除异常上下文<a class="headerlink" href="#pep-409-suppressing-exception-context" title="Link to this heading">¶</a></h2>
<p class="translated">PEP 409 引入了允许禁用串连的异常上下文显示的新语法。 这允许在不同异常类型间进行转换的应用程序具有更清晰的错误消息:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">D</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_extra_attributes</span> <span class="o">=</span> <span class="n">extra</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extra_attributes</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
<span class="gp">... </span>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="p">({})</span><span class="o">.</span><span class="n">x</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">8</span>, in <span class="n">__getattr__</span>
<span class="gr">AttributeError</span>: <span class="n">x</span>
</pre></div>
</div>
<p class="translated">如果后面没有 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">None</span></code> 来屏蔽异常原因，则默认原始异常将被显示:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">C</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_extra_attributes</span> <span class="o">=</span> <span class="n">extra</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extra_attributes</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
<span class="gp">... </span>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">({})</span><span class="o">.</span><span class="n">x</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">6</span>, in <span class="n">__getattr__</span>
<span class="gr">KeyError</span>: <span class="n">&#39;x&#39;</span>

<span class="gt">During handling of the above exception, another exception occurred:</span>

<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">8</span>, in <span class="n">__getattr__</span>
<span class="gr">AttributeError</span>: <span class="n">x</span>
</pre></div>
</div>
<p class="translated">调试功能并未丢失，因为原始异常上下文在需要时仍然可用（举例来说，如果某个中间库不正确地抑制了有价值的下层细节）:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">D</span><span class="p">({})</span><span class="o">.</span><span class="n">x</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">__context__</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">KeyError(&#39;x&#39;,)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-87"></span><a class="pep reference external" href="https://peps.python.org/pep-0409/"><strong>PEP 409</strong></a> - 清除异常上下文</dt><dd><p class="translated">PEP 由 Ethan Furman 撰写 ，由 Ethan Furman 和 Nick Coghlan 实现。</p>
</dd>
</dl>
</div>
</section>
<section id="pep-414-explicit-unicode-literals">
<h2 class="translated">PEP 414: 显式的Unicode文本<a class="headerlink" href="#pep-414-explicit-unicode-literals" title="Link to this heading">¶</a></h2>
<p class="translated">为使从 Python 2 迁移重度使用 Unicode 字面值的 Unicode 自适应型 Python 应用程序更为容易，Python 3.3 重新支持字符串字面值使用 &quot;<code class="docutils literal notranslate"><span class="pre">u</span></code>&quot; 前缀。 该前缀在 Python 3 中并无语法意义，提供它只是为了减少在迁移到 Python 3 时纯粹机械性的修改数量，让开发者能更轻松的关注更重要的语法变化（比如默认更严格的二进制和文本数据的区分）。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-88"></span><a class="pep reference external" href="https://peps.python.org/pep-0414/"><strong>PEP 414</strong></a> - 显式的Unicode文本</dt><dd><p class="translated">PEP 由 Armin Ronacher 撰写。</p>
</dd>
</dl>
</div>
</section>
<section id="pep-3155-qualified-name-for-classes-and-functions">
<h2 class="translated">PEP 3155: 类和函数的限定名称<a class="headerlink" href="#pep-3155-qualified-name-for-classes-and-functions" title="Link to this heading">¶</a></h2>
<p class="translated">函数和类对象新增了 <a class="reference internal" href="../library/stdtypes.html#definition.__qualname__" title="definition.__qualname__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__qualname__</span></code></a> 属性来表示从模块最高层级到其定义位置的“路径”。 对于全局函数和类，这将与 <a class="reference internal" href="../library/stdtypes.html#definition.__name__" title="definition.__name__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__name__</span></code></a> 相同。 对于其他函数和类，它提供了有关这些对象实际定义所在位置，以及如何从全局作用域访问它们的更详细信息。</p>
<p class="translated">包含（未绑定）方法的示例:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">C</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">meth</span><span class="o">.</span><span class="vm">__name__</span>
<span class="go">&#39;meth&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">meth</span><span class="o">.</span><span class="vm">__qualname__</span>
<span class="go">&#39;C.meth&#39;</span>
</pre></div>
</div>
<p class="translated">包含嵌套类的示例:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">C</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">class</span><span class="w"> </span><span class="nc">D</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">def</span><span class="w"> </span><span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>            <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">D</span><span class="o">.</span><span class="vm">__name__</span>
<span class="go">&#39;D&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">D</span><span class="o">.</span><span class="vm">__qualname__</span>
<span class="go">&#39;C.D&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">D</span><span class="o">.</span><span class="n">meth</span><span class="o">.</span><span class="vm">__name__</span>
<span class="go">&#39;meth&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">D</span><span class="o">.</span><span class="n">meth</span><span class="o">.</span><span class="vm">__qualname__</span>
<span class="go">&#39;C.D.meth&#39;</span>
</pre></div>
</div>
<p class="translated">包含嵌套函数的示例:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">outer</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">():</span>
<span class="gp">... </span>        <span class="k">pass</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">inner</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outer</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span>
<span class="go">&#39;inner&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outer</span><span class="p">()</span><span class="o">.</span><span class="vm">__qualname__</span>
<span class="go">&#39;outer.&lt;locals&gt;.inner&#39;</span>
</pre></div>
</div>
<p class="translated">这些对象的字符串表示形式也被修改以包括新的更准确的信息:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
<span class="go">&quot;&lt;class &#39;__main__.C.D&#39;&gt;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">D</span><span class="o">.</span><span class="n">meth</span><span class="p">)</span>
<span class="go">&#39;&lt;function C.D.meth at 0x7f46b9fe31e0&gt;&#39;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-89"></span><a class="pep reference external" href="https://peps.python.org/pep-3155/"><strong>PEP 3155</strong></a> - 类和函数的限定名称</dt><dd><p class="translated">PEP 由 Antoine Pitrou 撰写并实现。</p>
</dd>
</dl>
</div>
</section>
<section id="pep-412-key-sharing-dictionary">
<span id="pep-412"></span><h2 class="translated">PEP 412: Key-Sharing Dictionary<a class="headerlink" href="#pep-412-key-sharing-dictionary" title="Link to this heading">¶</a></h2>
<p class="translated">用于存储对象属性的字典现在能够在彼此之间共享部分内部存储（比如说，存储键及其对应哈希值的部分）。 这减少了程序创建多个非内置类型实例的内存消耗。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-16"></span><a class="pep reference external" href="https://peps.python.org/pep-0412/"><strong>PEP 412</strong></a> - Key-Sharing Dictionary</dt><dd><p class="translated">PEP 由 Mark Shannon 撰写并实现。</p>
</dd>
</dl>
</div>
</section>
<section id="pep-362-function-signature-object">
<h2 class="translated">PEP 362: 函数签名对象<a class="headerlink" href="#pep-362-function-signature-object" title="Link to this heading">¶</a></h2>
<p class="translated">新增的函数 <a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.signature()</span></code></a> 使得对 python 可调用对象的内省更为简单直观。 多种可调用对象均受到支持：不论是否带装饰器的 python 函数，类以及 <a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.partial()</span></code></a> 对象。 新增的类 <a class="reference internal" href="../library/inspect.html#inspect.Signature" title="inspect.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">inspect.Signature</span></code></a>, <a class="reference internal" href="../library/inspect.html#inspect.Parameter" title="inspect.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">inspect.Parameter</span></code></a> 和 <a class="reference internal" href="../library/inspect.html#inspect.BoundArguments" title="inspect.BoundArguments"><code class="xref py py-class docutils literal notranslate"><span class="pre">inspect.BoundArguments</span></code></a> 保存了有关调用签名的信息，如标注、默认值、形参类别和绑定参数等，这极大地简化了编写装饰器和其他任何验证或修改调用签名或参数的工作。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-90"></span><a class="pep reference external" href="https://peps.python.org/pep-0362/"><strong>PEP 362</strong></a>: -  函数签名对象</dt><dd><p class="translated">PEP 由 Brett Cannon，Yury Selivanov，Larry Hastings，Jiwon Seo 撰写，由 Yury Selivanov 实现。</p>
</dd>
</dl>
</div>
</section>
<section id="pep-421-adding-sys-implementation">
<h2 class="translated">PEP 421: 添加 sys.implementation<a class="headerlink" href="#pep-421-adding-sys-implementation" title="Link to this heading">¶</a></h2>
<p class="translated">新增的 <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a> 模块属性将对外公开当前运行的解释器实现的专属细节。 <a class="reference internal" href="../library/sys.html#sys.implementation" title="sys.implementation"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.implementation</span></code></a> 上的初始属性集合包括 <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">version</span></code>, <code class="docutils literal notranslate"><span class="pre">hexversion</span></code> 和 <code class="docutils literal notranslate"><span class="pre">cache_tag</span></code>。</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">sys.implementation</span></code> 的目的是将标准库所使用的具体实现专属数据合并到一个命名空间中。 这允许不同的 Python 实现能更方便地共享同一个标准库基准代码。 在其初始状态中，<code class="docutils literal notranslate"><span class="pre">sys.implementation</span></code> 只保持具体实现专属数据的一小部分。 随着时间推移这个比例将进行调整以使标准库具有更好的可移植性。</p>
<p class="translated">标准库可移植性提高的一个例子是 <code class="docutils literal notranslate"><span class="pre">cache_tag</span></code>。 在 Python 3.3 中，<code class="docutils literal notranslate"><span class="pre">sys.implementation.cache_tag</span></code> 被 <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> 用来支持与 <span class="target" id="index-91"></span><a class="pep reference external" href="https://peps.python.org/pep-3147/"><strong>PEP 3147</strong></a> 的一致性。 任何使用 <code class="docutils literal notranslate"><span class="pre">importlib</span></code> 来处理内置导入系统的 Python 实现都可使用 <code class="docutils literal notranslate"><span class="pre">cache_tag</span></code> 来控制各个模块的缓存行为。</p>
<section id="simplenamespace">
<h3 class="translated">SimpleNamespace<a class="headerlink" href="#simplenamespace" title="Link to this heading">¶</a></h3>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">sys.implementation</span></code> 的实现还为 Python 引入了一个新类型: <a class="reference internal" href="../library/types.html#types.SimpleNamespace" title="types.SimpleNamespace"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.SimpleNamespace</span></code></a>。 相比基于映射的命名空间像是 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>，<code class="docutils literal notranslate"><span class="pre">SimpleNamespace</span></code> 是基于属性的，像是 <a class="reference internal" href="../library/functions.html#object" title="object"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a>。 不过，与 <code class="docutils literal notranslate"><span class="pre">object</span></code> 不同，<code class="docutils literal notranslate"><span class="pre">SimpleNamespace</span></code> 实例是可写的。 这意味着你可以通过常规的属性访问来添加、移除和修改命名空间。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<dl class="simple">
<dt class="translated"><span class="target" id="index-92"></span><a class="pep reference external" href="https://peps.python.org/pep-0421/"><strong>PEP 421</strong></a> - 添加 sys.implementation</dt><dd><p class="translated">PEP 由 Eric Snow 撰写并实现。</p>
</dd>
</dl>
</div>
</section>
</section>
<section id="using-importlib-as-the-implementation-of-import">
<span id="importlib"></span><h2 class="translated">使用 importlib 作为导入的实现<a class="headerlink" href="#using-importlib-as-the-implementation-of-import" title="Link to this heading">¶</a></h2>
<p class="translated"><a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=2377">bpo-2377</a> - 以 importlib.__import__ 替代 __import__ <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13959">bpo-13959</a> - 以纯 Python 重新实现部分 <code class="xref py py-mod docutils literal notranslate"><span class="pre">imp</span></code> <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14605">bpo-14605</a> - 使导入机制成为显式的 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14646">bpo-14646</a> - 要求加载器设置 __loader__ 和 __package__</p>
<p class="translated">现在 <a class="reference internal" href="../library/functions.html#import__" title="__import__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__import__()</span></code></a> 函数是由 <a class="reference internal" href="../library/importlib.html#importlib.__import__" title="importlib.__import__"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.__import__()</span></code></a> 驱动的。 这项工作标志着 <span class="target" id="index-93"></span><a class="pep reference external" href="https://peps.python.org/pep-0302/"><strong>PEP 302</strong></a> 的“第 2 阶段”的结束。 这一变化带来了许多好处。 首先，它允许更多驱动导入的机制对外公开而不是保持隐式并藏在 C 代码内部。 它还提供了单一的实现给所有支持 Python 3.3 的 Python VM 使用，有助于结束导入语义中有关特定 VM 的偏差。 最后它还减轻了导入的维护负担，以允许未来的更多改进。</p>
<p class="translated">对于普通用户来说，语义上的变化应该是不可见的。 对于目前直接操纵 import 或以程序方式调用 import 的代码来说，可能需要进行的代码修改将在本文档的 <a class="reference internal" href="#porting-python-code">Porting Python code</a> 一节中阐述。</p>
<section id="new-apis">
<h3 class="translated">新的API<a class="headerlink" href="#new-apis" title="Link to this heading">¶</a></h3>
<p class="translated">此项工作的一个好处是对外公开了实现 import 语句所涉及的机制。 这意味着过去保持隐式的各种导入器现在都作为 <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> 包的组成部分被完整暴露出来。</p>
<p class="translated">在 <a class="reference internal" href="../library/importlib.html#module-importlib.abc" title="importlib.abc: Abstract base classes related to import"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.abc</span></code></a> 中定义的抽象基类已分别通过 <a class="reference internal" href="../library/importlib.html#importlib.abc.MetaPathFinder" title="importlib.abc.MetaPathFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.MetaPathFinder</span></code></a> 和 <a class="reference internal" href="../library/importlib.html#importlib.abc.PathEntryFinder" title="importlib.abc.PathEntryFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.PathEntryFinder</span></code></a> 进行扩展以正确地描述 <a class="reference internal" href="../glossary.html#term-meta-path-finder"><span class="xref std std-term">元路径查找器</span></a> 和 <a class="reference internal" href="../glossary.html#term-path-entry-finder"><span class="xref std std-term">路径条目查找器</span></a>。 现在提供旧的 ABC <code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.Finder</span></code> 只是为了保持向下兼容性而没有包含任何方法要求。</p>
<p class="translated">对于查找器，<a class="reference internal" href="../library/importlib.html#importlib.machinery.FileFinder" title="importlib.machinery.FileFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.machinery.FileFinder</span></code></a> 对外公开了用于查找一个模块的源代码和字节码文件的机制。 在之前版本中该类则是 <a class="reference internal" href="../library/sys.html#sys.path_hooks" title="sys.path_hooks"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_hooks</span></code></a> 的一个隐式成员。</p>
<p class="translated">对于加载器，新的抽象基类 <a class="reference internal" href="../library/importlib.html#importlib.abc.FileLoader" title="importlib.abc.FileLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.FileLoader</span></code></a> 可帮助编写使用文件系统作为模块代码的存储机制的加载器。 针对源代码的 (<a class="reference internal" href="../library/importlib.html#importlib.machinery.SourceFileLoader" title="importlib.machinery.SourceFileLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.machinery.SourceFileLoader</span></code></a>), 不带源代码的字节码文件的 (<a class="reference internal" href="../library/importlib.html#importlib.machinery.SourcelessFileLoader" title="importlib.machinery.SourcelessFileLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.machinery.SourcelessFileLoader</span></code></a>) 以及扩展模块的 (<a class="reference internal" href="../library/importlib.html#importlib.machinery.ExtensionFileLoader" title="importlib.machinery.ExtensionFileLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.machinery.ExtensionFileLoader</span></code></a>) 加载器现在均可被直接使用。</p>
<p class="translated">现在 <a class="reference internal" href="../library/exceptions.html#ImportError" title="ImportError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ImportError</span></code></a> 具有 <code class="docutils literal notranslate"><span class="pre">name</span></code> 和 <code class="docutils literal notranslate"><span class="pre">path</span></code> 属性并会在有相关数据要提供时被设置。 针对导入失败的消息现在也会提供模块的完整名称而不是仅有模块名称的末尾部分。</p>
<p class="translated">现在 <a class="reference internal" href="../library/importlib.html#importlib.invalidate_caches" title="importlib.invalidate_caches"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.invalidate_caches()</span></code></a> 函数会调用缓存在 <a class="reference internal" href="../library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_importer_cache</span></code></a> 中的所有查找器上具有相同名称的方法以帮助根据需要清理任何已储存的状态。</p>
</section>
<section id="visible-changes">
<h3 class="translated">可见的改变<a class="headerlink" href="#visible-changes" title="Link to this heading">¶</a></h3>
<p class="translated">对于可能需要修改的代码，请参阅 <a class="reference internal" href="#porting-python-code">Porting Python code</a> 一节。</p>
<p class="translated">在 <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> 当前对外公开的范围之外，还有其他可见的针对 import 的改变。 最大的改变是 <a class="reference internal" href="../library/sys.html#sys.meta_path" title="sys.meta_path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.meta_path</span></code></a> 和 <a class="reference internal" href="../library/sys.html#sys.path_hooks" title="sys.path_hooks"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_hooks</span></code></a> 现在将储存 import 用到的所有元路径查找器和路径条目钩子。 在之前版本中这些查找器是隐式地藏在 import 的 C 代码内部而不是直接对外公开。 这意味着现在你可以方便地移除或修改各个查找器的顺序以适合你的需要。</p>
<p class="translated">另一个变化是所有模块都具有 <code class="docutils literal notranslate"><span class="pre">__loader__</span></code> 属性，它储存被用于创建该模块的加载器。 <span class="target" id="index-94"></span><a class="pep reference external" href="https://peps.python.org/pep-0302/"><strong>PEP 302</strong></a> 已被更新以强制要求加载器实现该属性，因此未来的第 3 方加载器一旦被更新人们将能确定该属性的存在。 但在此之前，import 都需要在加载之后设置模块。</p>
<p class="translated">加载器现在还需要根据 <span class="target" id="index-95"></span><a class="pep reference external" href="https://peps.python.org/pep-0366/"><strong>PEP 366</strong></a> 设置 <code class="docutils literal notranslate"><span class="pre">__package__</span></code> 属性。 同样地，import 本身已经在所有来自 <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> 的加载器上设置了该属性并且 import 是在加载之后自行设置该属性。</p>
<p class="translated">现在当 <a class="reference internal" href="../library/sys.html#sys.path_hooks" title="sys.path_hooks"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_hooks</span></code></a> 上未找到查找器时将把 <code class="docutils literal notranslate"><span class="pre">None</span></code> 插入到 <a class="reference internal" href="../library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_importer_cache</span></code></a> 中。 由于 <code class="xref py py-class docutils literal notranslate"><span class="pre">imp.NullImporter</span></code> 不是直接暴露在 <a class="reference internal" href="../library/sys.html#sys.path_hooks" title="sys.path_hooks"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_hooks</span></code></a> 上因此该值不再能够作为表示未找到查找器的可靠依据。</p>
<p class="translated">有关语法变化的所有其他修改在为 Python 3.3 更新代码时都应当被纳入考虑，因此应当仔细阅读本文档的 <a class="reference internal" href="#porting-python-code">Porting Python code</a> 章节。</p>
<p class="translated">（由 Brett Cannon 编写的实现）</p>
</section>
</section>
<section id="other-language-changes">
<h2 class="translated">其他语言特性修改<a class="headerlink" href="#other-language-changes" title="Link to this heading">¶</a></h2>
<p class="translated">对Python 语言核心进行的小改动：</p>
<ul>
<li><p class="translated">增加了对 Unicode 别名和具名序列的支持。 现在 <a class="reference internal" href="../library/unicodedata.html#unicodedata.lookup" title="unicodedata.lookup"><code class="xref py py-func docutils literal notranslate"><span class="pre">unicodedata.lookup()</span></code></a> 和 <code class="docutils literal notranslate"><span class="pre">'\N{...}'</span></code> 都能解析别名，而 <a class="reference internal" href="../library/unicodedata.html#unicodedata.lookup" title="unicodedata.lookup"><code class="xref py py-func docutils literal notranslate"><span class="pre">unicodedata.lookup()</span></code></a> 还能解析具名序列。</p>
<p class="translated">（由 Ezio Melotti 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12753">bpo-12753</a> 中贡献。）</p>
</li>
<li><p class="translated">Unicode 数据库更新至 UCD 版本 6.1.0</p></li>
<li><p class="translated">现在 <a class="reference internal" href="../library/stdtypes.html#range" title="range"><code class="xref py py-func docutils literal notranslate"><span class="pre">range()</span></code></a> 对象的相等性比较将返回反映下层的由这些 range 对象生成的序列的相等性的结果。 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13201">bpo-13201</a>)</p></li>
<li><p class="translated">现在 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> 对象的 <code class="docutils literal notranslate"><span class="pre">count()</span></code>, <code class="docutils literal notranslate"><span class="pre">find()</span></code>, <code class="docutils literal notranslate"><span class="pre">rfind()</span></code>, <code class="docutils literal notranslate"><span class="pre">index()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">rindex()</span></code> 方法将接受一个 0 到 255 范围内的整数作为其第一个参数。</p>
<p class="translated">（由 Petri Lehtinen 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12170">bpo-12170</a> 中贡献。）</p>
</li>
<li><p class="translated">现在 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> 的 <code class="docutils literal notranslate"><span class="pre">rjust()</span></code>, <code class="docutils literal notranslate"><span class="pre">ljust()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">center()</span></code> 方法将接受一个 <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> 作为 <code class="docutils literal notranslate"><span class="pre">fill</span></code> 参数。 （由 Petri Lehtinen 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12380">bpo-12380</a> 中贡献。）</p></li>
<li><p class="translated">新增 <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> 方法: <code class="docutils literal notranslate"><span class="pre">copy()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">clear()</span></code> (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10516">bpo-10516</a>)。 为此，<a class="reference internal" href="../library/collections.abc.html#collections.abc.MutableSequence" title="collections.abc.MutableSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableSequence</span></code></a> 现在也定义了 <code class="xref py py-meth docutils literal notranslate"><span class="pre">clear()</span></code> 方法 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11388">bpo-11388</a>)。</p></li>
<li><p class="translated">原始字节串字面值现在可以写成 <code class="docutils literal notranslate"><span class="pre">rb&quot;...&quot;</span></code> 也可以写成 <code class="docutils literal notranslate"><span class="pre">br&quot;...&quot;</span></code>。</p>
<p class="translated">（由 Antoine Pitrou 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13748">bpo-13748</a> 中贡献。）</p>
</li>
<li><p class="translated">现在 <a class="reference internal" href="../library/stdtypes.html#dict.setdefault" title="dict.setdefault"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dict.setdefault()</span></code></a> 对给定的键将只执行一次查找，这使其在配合内置类型使用时是原子化的。</p>
<p class="translated">（由 Filip Gruszczyński 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13521">bpo-13521</a> 中贡献。）</p>
</li>
<li><p class="translated">当函数调用与函数签名不匹配时产生的错误消息已获得大幅改进。</p>
<p class="translated">（由 Benjamin Peterson 贡献。）</p>
</li>
</ul>
</section>
<section id="a-finer-grained-import-lock">
<h2 class="translated">更细粒度的导入锁<a class="headerlink" href="#a-finer-grained-import-lock" title="Link to this heading">¶</a></h2>
<p class="translated">之前版本的 CPython 是始终依赖于全局导入锁的。 这会导致预料之外的困扰，比如当导入一个模块会触发代码在其他线程中执行作为附带影响导致的死锁。 有时需要应用一些笨拙的绕过方式，比如 <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleNoBlock" title="PyImport_ImportModuleNoBlock"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleNoBlock()</span></code></a> C API 函数。</p>
<p class="translated">在 Python 3.3 中，导入一个模块会使用单独的模块级锁。 这能正确地从多个线程序列化给定模块的导入操作（防止出现被不完整初始化的模块），同时消除之前提到的困扰。</p>
<p class="translated">（由 Antoine Pitrou 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=9260">bpo-9260</a> 中贡献。）</p>
</section>
<section id="builtin-functions-and-types">
<h2 class="translated">内置函数和类型<a class="headerlink" href="#builtin-functions-and-types" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> 新增了 <em>opener</em> 形参：文件对象下层的文件描述符将随后通过调用 <em>opener</em> 并附带 (<em>file</em>, <em>flags</em>) 来获取。 它可以被用来使用自定义旗标例如 <a class="reference internal" href="../library/os.html#os.O_CLOEXEC" title="os.O_CLOEXEC"><code class="xref py py-const docutils literal notranslate"><span class="pre">os.O_CLOEXEC</span></code></a>。 增加了 <code class="docutils literal notranslate"><span class="pre">'x'</span></code> 模式：打开为独占创建，如果文件已存在则打开失败。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/functions.html#print" title="print"><code class="xref py py-func docutils literal notranslate"><span class="pre">print()</span></code></a>: 增加了 <em>flush</em> 关键字参数。 如果 <em>flush</em> 关键字参数为真值，流会被强制刷新。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/functions.html#hash" title="hash"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash()</span></code></a>: 默认将启用哈希随机化，参见 <a class="reference internal" href="../reference/datamodel.html#object.__hash__" title="object.__hash__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">object.__hash__()</span></code></a> 和 <span class="target" id="index-96"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONHASHSEED"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHASHSEED</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 类型新增了一个 <a class="reference internal" href="../library/stdtypes.html#str.casefold" title="str.casefold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">casefold()</span></code></a> 方法：返回字符串的大小写折叠副本，大小写折叠形式的字符串可被用于不区分大小写的匹配。 例如，<code class="docutils literal notranslate"><span class="pre">'ß'.casefold()</span></code> 将返回 <code class="docutils literal notranslate"><span class="pre">'ss'</span></code>。</p></li>
<li><p class="translated">序列的文档已被大幅重写以更好地解释二进制/序列的区别并为各种内置序列类型提供专属的文档章节 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=4966">bpo-4966</a>)。</p></li>
</ul>
</section>
<section id="new-modules">
<h2 class="translated">新增模块<a class="headerlink" href="#new-modules" title="Link to this heading">¶</a></h2>
<section id="faulthandler">
<h3 class="translated">faulthandler<a class="headerlink" href="#faulthandler" title="Link to this heading">¶</a></h3>
<p class="translated">新增的调试模块 <a class="reference internal" href="../library/faulthandler.html#module-faulthandler" title="faulthandler: Dump the Python traceback."><code class="xref py py-mod docutils literal notranslate"><span class="pre">faulthandler</span></code></a> 包含用于在发生错误（如段错误之类的程序崩溃）、达到超时限制或收到用户信号时显式转储 Python 回溯的函数。 调用 <a class="reference internal" href="../library/faulthandler.html#faulthandler.enable" title="faulthandler.enable"><code class="xref py py-func docutils literal notranslate"><span class="pre">faulthandler.enable()</span></code></a> 可安装针对 <a class="reference internal" href="../library/signal.html#signal.SIGSEGV" title="signal.SIGSEGV"><code class="xref py py-const docutils literal notranslate"><span class="pre">SIGSEGV</span></code></a>, <a class="reference internal" href="../library/signal.html#signal.SIGFPE" title="signal.SIGFPE"><code class="xref py py-const docutils literal notranslate"><span class="pre">SIGFPE</span></code></a>, <a class="reference internal" href="../library/signal.html#signal.SIGABRT" title="signal.SIGABRT"><code class="xref py py-const docutils literal notranslate"><span class="pre">SIGABRT</span></code></a>, <a class="reference internal" href="../library/signal.html#signal.SIGBUS" title="signal.SIGBUS"><code class="xref py py-const docutils literal notranslate"><span class="pre">SIGBUS</span></code></a> 和 <a class="reference internal" href="../library/signal.html#signal.SIGILL" title="signal.SIGILL"><code class="xref py py-const docutils literal notranslate"><span class="pre">SIGILL</span></code></a> 等信号的错误处理器。 你还可以在启动时通过设置 <span class="target" id="index-97"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONFAULTHANDLER"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONFAULTHANDLER</span></code></a> 环境变量或使用 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span></code></a> <code class="docutils literal notranslate"><span class="pre">faulthandler</span></code> 命令行选项来启用它们。</p>
<p class="translated">Linux 上的段错误示例:</p>
<div class="translated highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-q<span class="w"> </span>-X<span class="w"> </span>faulthandler
<span class="go">&gt;&gt;&gt; import ctypes</span>
<span class="go">&gt;&gt;&gt; ctypes.string_at(0)</span>
<span class="go">Fatal Python error: Segmentation fault</span>

<span class="go">Current thread 0x00007fb899f39700:</span>
<span class="go">  File &quot;/home/python/cpython/Lib/ctypes/__init__.py&quot;, line 486 in string_at</span>
<span class="go">  File &quot;&lt;stdin&gt;&quot;, line 1 in &lt;module&gt;</span>
<span class="go">Segmentation fault</span>
</pre></div>
</div>
</section>
<section id="ipaddress">
<h3 class="translated">ipaddress<a class="headerlink" href="#ipaddress" title="Link to this heading">¶</a></h3>
<p class="translated">新的 <a class="reference internal" href="../library/ipaddress.html#module-ipaddress" title="ipaddress: IPv4/IPv6 manipulation library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ipaddress</span></code></a> 模块提供了用于创建和操作代表 IPv4 和 IPv6 地址、网络和接口（即关联到特定 IP 子网的 IP 地址）的工具。</p>
<p class="translated">（由 Google 和 Peter Moody 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=3144">bpo-3144</a> 中贡献。）</p>
</section>
<section id="lzma">
<h3 class="translated">lzma<a class="headerlink" href="#lzma" title="Link to this heading">¶</a></h3>
<p class="translated">新增的 <a class="reference internal" href="../library/lzma.html#module-lzma" title="lzma: A Python wrapper for the liblzma compression library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">lzma</span></code></a> 模块提供了使用 LZMA 算法的数据压缩和解压，包括对 <code class="docutils literal notranslate"><span class="pre">.xz</span></code> 和 <code class="docutils literal notranslate"><span class="pre">.lzma</span></code> 文件格式的支持。</p>
<p class="translated">（由 Nadeem Vawda 和 Per Øyvind Karlsen 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=6715">bpo-6715</a> 中贡献。）</p>
</section>
</section>
<section id="improved-modules">
<h2 class="translated">改进的模块<a class="headerlink" href="#improved-modules" title="Link to this heading">¶</a></h2>
<section id="abc">
<h3 class="translated">abc<a class="headerlink" href="#abc" title="Link to this heading">¶</a></h3>
<p class="translated">改进了对包含以抽象方法组成的描述器的抽象基类的支持。 现在声明抽象描述器推荐方式是提供 <code class="xref py py-attr docutils literal notranslate"><span class="pre">__isabstractmethod__</span></code> 作为动态更新的特征属性。 已对内置描述器进行了相应的更新。</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/abc.html#abc.abstractproperty" title="abc.abstractproperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.abstractproperty</span></code></a> 已被弃用，改为 <a class="reference internal" href="../library/functions.html#property" title="property"><code class="xref py py-class docutils literal notranslate"><span class="pre">property</span></code></a> 配合 <a class="reference internal" href="../library/abc.html#abc.abstractmethod" title="abc.abstractmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">abc.abstractmethod()</span></code></a> 使用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/abc.html#abc.abstractclassmethod" title="abc.abstractclassmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.abstractclassmethod</span></code></a> 已被弃用，改为 <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code></a> 配合 <a class="reference internal" href="../library/abc.html#abc.abstractmethod" title="abc.abstractmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">abc.abstractmethod()</span></code></a> 使用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/abc.html#abc.abstractstaticmethod" title="abc.abstractstaticmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.abstractstaticmethod</span></code></a> 已被弃用，改为 <a class="reference internal" href="../library/functions.html#staticmethod" title="staticmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">staticmethod</span></code></a> 配合 <a class="reference internal" href="../library/abc.html#abc.abstractmethod" title="abc.abstractmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">abc.abstractmethod()</span></code></a> 使用。</p></li>
</ul>
<p class="translated">（由 Pablo Galindo 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11610">bpo-11610</a> 中贡献。）</p>
<p class="translated">现在 <a class="reference internal" href="../library/abc.html#abc.ABCMeta.register" title="abc.ABCMeta.register"><code class="xref py py-meth docutils literal notranslate"><span class="pre">abc.ABCMeta.register()</span></code></a> 将返回已注册的子类，这意味着它现在可被用作类装饰器 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10868">bpo-10868</a>)。</p>
</section>
<section id="array">
<h3 class="translated">array<a class="headerlink" href="#array" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal notranslate"><span class="pre">array</span></code></a> 模块可使用 <code class="docutils literal notranslate"><span class="pre">q</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Q</span></code> 类型码支持 <span class="c-expr sig sig-inline c"><span class="kt">long</span><span class="w"> </span><span class="kt">long</span></span> 类型。</p>
<p class="translated">（由 Oren Tirosh 和 Hirokazu Yamamoto 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=1172711">bpo-1172711</a> 中贡献。）</p>
</section>
<section id="base64">
<h3 class="translated">base64<a class="headerlink" href="#base64" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../library/base64.html#module-base64" title="base64: RFC 4648: Base16, Base32, Base64 Data Encodings; Base85 and Ascii85"><code class="xref py py-mod docutils literal notranslate"><span class="pre">base64</span></code></a> 现代接口的解码函数可接受仅包含 ASCII 字符的 Unicode 字符串。 例如，<code class="docutils literal notranslate"><span class="pre">base64.b64decode('YWJj')</span></code> 将返回 <code class="docutils literal notranslate"><span class="pre">b'abc'</span></code>。 （由 Catalin Iacob 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13641">bpo-13641</a> 中贡献。）</p>
</section>
<section id="binascii">
<h3 class="translated">binascii<a class="headerlink" href="#binascii" title="Link to this heading">¶</a></h3>
<p class="translated">除了它们通常接受的二进制对象，<code class="docutils literal notranslate"><span class="pre">a2b_</span></code> 现在还接受仅包含 ASCII 字符的字符串作为输入。 （由 Antoine Pitrou 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13637">bpo-13637</a> 中贡献。）</p>
</section>
<section id="bz2">
<h3 class="translated">bz2<a class="headerlink" href="#bz2" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/bz2.html#module-bz2" title="bz2: Interfaces for bzip2 compression and decompression."><code class="xref py py-mod docutils literal notranslate"><span class="pre">bz2</span></code></a> 模块已被重新编写。 在此过程中，添加了一些新的特征:</p>
<ul>
<li><p class="translated">新的 <a class="reference internal" href="../library/bz2.html#bz2.open" title="bz2.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">bz2.open()</span></code></a> 函数：以二进制或文本模式打开 bzip2 压缩文件。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/bz2.html#bz2.BZ2File" title="bz2.BZ2File"><code class="xref py py-class docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code></a> 现在可以读写任意文件型对象，具体方式是通过其构造器的 <em>fileobj</em> 参数。</p>
<p class="translated">（由 Nadeem Vawda 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=5863">bpo-5863</a> 中贡献。）</p>
</li>
<li><p class="translated">现在 <a class="reference internal" href="../library/bz2.html#bz2.BZ2File" title="bz2.BZ2File"><code class="xref py py-class docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code></a> 和 <a class="reference internal" href="../library/bz2.html#bz2.decompress" title="bz2.decompress"><code class="xref py py-func docutils literal notranslate"><span class="pre">bz2.decompress()</span></code></a> 能解压缩多流输入（比如由 <strong class="program">pbzip2</strong> 工具所产生的输入）。 <a class="reference internal" href="../library/bz2.html#bz2.BZ2File" title="bz2.BZ2File"><code class="xref py py-class docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code></a> 现在还可被用来创建这种类型的文件，具体做法是使用 <code class="docutils literal notranslate"><span class="pre">'a'</span></code> (append) 模式。</p>
<p class="translated">（由 Nir Aides 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=1625">bpo-1625</a> 中贡献。）</p>
</li>
<li><p class="translated">现在 <a class="reference internal" href="../library/bz2.html#bz2.BZ2File" title="bz2.BZ2File"><code class="xref py py-class docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code></a> 实现了所有 <a class="reference internal" href="../library/io.html#io.BufferedIOBase" title="io.BufferedIOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BufferedIOBase</span></code></a> API，但 <code class="xref py py-meth docutils literal notranslate"><span class="pre">detach()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">truncate()</span></code> 方法除外。</p></li>
</ul>
</section>
<section id="codecs">
<h3 class="translated">编码器<a class="headerlink" href="#codecs" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/codecs.html#module-encodings.mbcs" title="encodings.mbcs: Windows ANSI codepage"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mbcs</span></code></a> 编解码器被重写以能够在所有 Windows 版本上正确处理 <code class="docutils literal notranslate"><span class="pre">replace</span></code> 和 <code class="docutils literal notranslate"><span class="pre">ignore</span></code> 错误处理器。 <a class="reference internal" href="../library/codecs.html#module-encodings.mbcs" title="encodings.mbcs: Windows ANSI codepage"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mbcs</span></code></a> 编解码器现在支持所有错误处理器，而不是仅支持将 <code class="docutils literal notranslate"><span class="pre">replace</span></code> 用于编码并将 <code class="docutils literal notranslate"><span class="pre">ignore</span></code> 用于解码。</p>
<p class="translated">新增了一个 Windows 专属的编解码器: <code class="docutils literal notranslate"><span class="pre">cp65001</span></code> (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13216">bpo-13216</a>)。 即 Windows 代码页 65001 (Windows UTF-8, <code class="docutils literal notranslate"><span class="pre">CP_UTF8</span></code>)。 举例来说，如果控制台输出代码页被设为 cp65001（例如使用 <code class="docutils literal notranslate"><span class="pre">chcp</span> <span class="pre">65001</span></code> 命令）则 <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> 就会使用它。</p>
<p class="translated">多字节 CJK 解码器现在能更快地进行再同步。 它们将只忽略非法字节序列的第一个字节。 例如，现在 <code class="docutils literal notranslate"><span class="pre">b'\xff\n'.decode('gb2312',</span> <span class="pre">'replace')</span></code> 将在替换字符后返回一个 <code class="docutils literal notranslate"><span class="pre">\n</span></code>。</p>
<p class="translated">(<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12016">bpo-12016</a>)</p>
<p class="translated">增量式 CJK 编解码器的编码器在每次调用其 encode() 方法时将不再重置。 例如:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">codecs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">getincrementalencoder</span><span class="p">(</span><span class="s1">&#39;hz&#39;</span><span class="p">)(</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s1">&#39;</span><span class="se">\u52ff\u65bd\u65bc\u4eba\u3002</span><span class="s1"> Bye.&#39;</span><span class="p">)</span>
<span class="go">b&#39;~{NpJ)l6HK!#~} Bye.&#39;</span>
</pre></div>
</div>
<p class="translated">对于旧版 Python 此示例将给出 <code class="docutils literal notranslate"><span class="pre">b'~{Np~}~{J)~}~{l6~}~{HK~}~{!#~}</span> <span class="pre">Bye.'</span></code>。</p>
<p class="translated">(<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12100">bpo-12100</a>)</p>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">unicode_internal</span></code> 编解码器已被弃用。</p>
</section>
<section id="collections">
<h3 class="translated">collections<a class="headerlink" href="#collections" title="Link to this heading">¶</a></h3>
<p class="translated">新增了一个 <a class="reference internal" href="../library/collections.html#collections.ChainMap" title="collections.ChainMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainMap</span></code></a> 类以允许将多个映射当作一个单元来处理。 （由 Raymond Hettinger 针对 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11089">bpo-11089</a> 编写，在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11297">bpo-11297</a> 中对外公开。）</p>
<p class="translated">抽象基类已被移至新的 <a class="reference internal" href="../library/collections.abc.html#module-collections.abc" title="collections.abc: Abstract base classes for containers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">collections.abc</span></code></a> 模块，以便更好地区分抽象和具体集合类。为了保留现有的导入，ABC 的别名仍然存在于 <a class="reference internal" href="../library/collections.html#module-collections" title="collections: Container datatypes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">collections</span></code></a> 模块中。(<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11085">bpo-11085</a>)</p>
<p class="translated"><a class="reference internal" href="../library/collections.html#collections.Counter" title="collections.Counter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Counter</span></code></a> 类现在支持一元 <code class="docutils literal notranslate"><span class="pre">+</span></code> 和 <code class="docutils literal notranslate"><span class="pre">-</span></code> 运算符，以及就地运算符 <code class="docutils literal notranslate"><span class="pre">+=</span></code>、<code class="docutils literal notranslate"><span class="pre">-=</span></code>、<code class="docutils literal notranslate"><span class="pre">|=</span></code> 和 <code class="docutils literal notranslate"><span class="pre">&amp;=</span></code>。（由 Raymond Hettinger在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13121">bpo-13121</a> 中贡献。）</p>
</section>
<section id="contextlib">
<h3 class="translated">contextlib<a class="headerlink" href="#contextlib" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/contextlib.html#contextlib.ExitStack" title="contextlib.ExitStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExitStack</span></code></a> 现在为程序化操作上下文管理器及类似的清理功能提供了坚实的基础。与之前的 <code class="docutils literal notranslate"><span class="pre">contextlib.nested</span></code> API（已被弃用并移除）不同，新 API 设计为上下文管理器无论是在其 <code class="docutils literal notranslate"><span class="pre">__init__</span></code> 方法中获取资源（例如，文件对象）还是在 <code class="docutils literal notranslate"><span class="pre">__enter__</span></code> 方法中获取资源（例如，来自 <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a> 模块的同步对象）都能正确工作。</p>
<p class="translated">(<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13585">bpo-13585</a>)</p>
</section>
<section id="crypt">
<h3 class="translated">crypt<a class="headerlink" href="#crypt" title="Link to this heading">¶</a></h3>
<p class="translated">在 <code class="xref py py-mod docutils literal notranslate"><span class="pre">crypt</span></code> 模块中添加了盐和模块化加密格式（哈希方法）以及 <code class="xref py py-func docutils literal notranslate"><span class="pre">mksalt()</span></code> 函数。</p>
<p class="translated">(<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10924">bpo-10924</a>)</p>
</section>
<section id="curses">
<h3 class="translated">curses<a class="headerlink" href="#curses" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">如果 <a class="reference internal" href="../library/curses.html#module-curses" title="curses: An interface to the curses library, providing portable terminal handling. (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">curses</span></code></a> 模块是链接到 ncursesw 库，则当传入 Unicode 字符串或字符时将使用 Unicode 函数 (例如 <code class="xref c c-func docutils literal notranslate"><span class="pre">waddwstr()</span></code>)，否则使用字节函数 (例如 <code class="xref c c-func docutils literal notranslate"><span class="pre">waddstr()</span></code>)。</p></li>
<li><p class="translated">使用区域设置编码而不是 <code class="docutils literal notranslate"><span class="pre">utf-8</span></code> 来编码 Unicode 字符串。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/curses.html#curses.window" title="curses.window"><code class="xref py py-class docutils literal notranslate"><span class="pre">curses.window</span></code></a> 添加了新的 <a class="reference internal" href="../library/curses.html#curses.window.encoding" title="curses.window.encoding"><code class="xref py py-attr docutils literal notranslate"><span class="pre">curses.window.encoding</span></code></a> 属性。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/curses.html#curses.window" title="curses.window"><code class="xref py py-class docutils literal notranslate"><span class="pre">curses.window</span></code></a> 类有一个新的 <a class="reference internal" href="../library/curses.html#curses.window.get_wch" title="curses.window.get_wch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_wch()</span></code></a> 方法用来获取一个宽字符。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/curses.html#module-curses" title="curses: An interface to the curses library, providing portable terminal handling. (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">curses</span></code></a> 模块有一个新的 <a class="reference internal" href="../library/curses.html#curses.unget_wch" title="curses.unget_wch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unget_wch()</span></code></a> 函数用来推入一个宽字符以便下一个 <a class="reference internal" href="../library/curses.html#curses.window.get_wch" title="curses.window.get_wch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_wch()</span></code></a> 将返回它。</p></li>
</ul>
<p class="translated">（由 Iñigo Serna 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=6755">bpo-6755</a> 中贡献。）</p>
</section>
<section id="datetime">
<h3 class="translated">datetime<a class="headerlink" href="#datetime" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">在朴素型（naive-无时区）和感知型（aware-带时区）的 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a> 实例之间进行相等比较时，现在会直接返回 <a class="reference internal" href="../library/constants.html#False" title="False"><code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code></a>，而不再抛出 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> 异常（参见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=15006">bpo-15006</a>）。</p></li>
<li><p class="translated">新的 <a class="reference internal" href="../library/datetime.html#datetime.datetime.timestamp" title="datetime.datetime.timestamp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.datetime.timestamp()</span></code></a> 方法：返回与 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a> 实例对应的 POSIX 时间戳。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/datetime.html#datetime.datetime.strftime" title="datetime.datetime.strftime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.datetime.strftime()</span></code></a> 方法支持格式化早于 1000 年的年份。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/datetime.html#datetime.datetime.astimezone" title="datetime.datetime.astimezone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.datetime.astimezone()</span></code></a> 方法现在可以不带参数调用，以将 datetime 实例转换为系统时区。</p></li>
</ul>
</section>
<section id="decimal">
<span id="new-decimal"></span><h3 class="translated">decimal<a class="headerlink" href="#decimal" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt class="translated"><a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=7652">bpo-7652</a> - 集成了快速的本地十进制算术。</dt><dd><p class="translated">C模块和libmpdec由Stefan Krah编写。</p>
</dd>
</dl>
<p class="translated">新版的C语言版 decimal 模块集成了高速libmpdec库，用于任意精度的正确四舍五入十进制浮点运算。libmpdec符合IBM的通用十进制算术规范。</p>
<p class="translated">性能提升从数据库应用的10倍到数值密集型应用的100倍不等。这些数字是十进制浮点算术中标准精度预期提升的数值。由于精度是用户可配置的，确切数字可能会有所不同。例如，在整数大数算术中，差异可能会显著更高。</p>
<p class="translated">下表只用于简单展示。 基准测试详情参见 <a class="reference external" href="https://www.bytereef.org/mpdecimal/quickstart.html">https://www.bytereef.org/mpdecimal/quickstart.html</a>。</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p class="translated">decimal.py</p></th>
<th class="head"><p class="translated">_decimal</p></th>
<th class="head"><p class="translated">加速</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated">pi</p></td>
<td><p class="translated">42.02秒</p></td>
<td><p class="translated">0.345秒</p></td>
<td><p class="translated">120倍</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">telco</p></td>
<td><p class="translated">172.19秒</p></td>
<td><p class="translated">5.68秒</p></td>
<td><p class="translated">30倍</p></td>
</tr>
<tr class="row-even"><td><p class="translated">psycopg</p></td>
<td><p class="translated">3.57秒</p></td>
<td><p class="translated">0.29秒</p></td>
<td><p class="translated">12倍</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<section id="id1">
<h4 class="translated">相关特性<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/decimal.html#decimal.FloatOperation" title="decimal.FloatOperation"><code class="xref py py-exc docutils literal notranslate"><span class="pre">FloatOperation</span></code></a> 信号可选择启用针对混用 float 和 Decimal 时更严格的语义限制。</p></li>
<li><p class="translated">如果 Python 编译时不带线程，则 C 版本会自动禁用高资源开销的线程局部上下文机制。 在此情况下，变量 <a class="reference internal" href="../library/decimal.html#decimal.HAVE_THREADS" title="decimal.HAVE_THREADS"><code class="xref py py-const docutils literal notranslate"><span class="pre">HAVE_THREADS</span></code></a> 将被设为 <code class="docutils literal notranslate"><span class="pre">False</span></code>。</p></li>
</ul>
</section>
<section id="id2">
<h4 class="translated">API 的变化<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<ul>
<li><p class="translated">C模块上下文限制（如下表），具体取决于计算机体系结构：</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p class="translated">32位</p></th>
<th class="head"><p class="translated">64位</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="translated"><a class="reference internal" href="../library/decimal.html#decimal.MAX_PREC" title="decimal.MAX_PREC"><code class="xref py py-const docutils literal notranslate"><span class="pre">MAX_PREC</span></code></a></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">425000000</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">999999999999999999</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="translated"><a class="reference internal" href="../library/decimal.html#decimal.MAX_EMAX" title="decimal.MAX_EMAX"><code class="xref py py-const docutils literal notranslate"><span class="pre">MAX_EMAX</span></code></a></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">425000000</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">999999999999999999</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="translated"><a class="reference internal" href="../library/decimal.html#decimal.MIN_EMIN" title="decimal.MIN_EMIN"><code class="xref py py-const docutils literal notranslate"><span class="pre">MIN_EMIN</span></code></a></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">-425000000</span></code></p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">-999999999999999999</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p class="translated">在上下文模板 (<a class="reference internal" href="../library/decimal.html#decimal.DefaultContext" title="decimal.DefaultContext"><code class="xref py py-const docutils literal notranslate"><span class="pre">DefaultContext</span></code></a>, <a class="reference internal" href="../library/decimal.html#decimal.BasicContext" title="decimal.BasicContext"><code class="xref py py-const docutils literal notranslate"><span class="pre">BasicContext</span></code></a> 和 <a class="reference internal" href="../library/decimal.html#decimal.ExtendedContext" title="decimal.ExtendedContext"><code class="xref py py-const docutils literal notranslate"><span class="pre">ExtendedContext</span></code></a>) 中 <a class="reference internal" href="../library/decimal.html#decimal.Context.Emax" title="decimal.Context.Emax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Emax</span></code></a> 和 <a class="reference internal" href="../library/decimal.html#decimal.Context.Emin" title="decimal.Context.Emin"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Emin</span></code></a> 的数值被修改为 <code class="docutils literal notranslate"><span class="pre">999999</span></code>。</p></li>
<li><p class="translated">decimal.py中的 <a class="reference internal" href="../library/decimal.html#decimal.Decimal" title="decimal.Decimal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Decimal</span></code></a> 构造函数不遵守上下文限制，并精确转换具有任意指数或精度的值。由于C版本有内部限制，采用以下方案：如果可能，值将精确转换，否则会引发 <a class="reference internal" href="../library/decimal.html#decimal.InvalidOperation" title="decimal.InvalidOperation"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidOperation</span></code></a> 异常，结果为NaN。在后一种情况下，总是可以使用 <a class="reference internal" href="../library/decimal.html#decimal.Context.create_decimal" title="decimal.Context.create_decimal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_decimal()</span></code></a> 来获得一个四舍五入或不精确的值。</p></li>
<li><p class="translated">decimal.py中的幂函数总是正确四舍五入的。在C版本中，它是根据正确四舍五入的 <a class="reference internal" href="../library/decimal.html#decimal.Decimal.exp" title="decimal.Decimal.exp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exp()</span></code></a> 和 <a class="reference internal" href="../library/decimal.html#decimal.Decimal.ln" title="decimal.Decimal.ln"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ln()</span></code></a> 函数定义的，但最终结果只是“几乎总是正确四舍五入”。</p></li>
<li><p class="translated">在C版本中，包含信号的上下文字典是一个 <a class="reference internal" href="../library/collections.abc.html#collections.abc.MutableMapping" title="collections.abc.MutableMapping"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableMapping</span></code></a>。出于速度原因，<a class="reference internal" href="../library/decimal.html#decimal.Context.flags" title="decimal.Context.flags"><code class="xref py py-attr docutils literal notranslate"><span class="pre">flags</span></code></a> 和 <a class="reference internal" href="../library/decimal.html#decimal.Context.traps" title="decimal.Context.traps"><code class="xref py py-attr docutils literal notranslate"><span class="pre">traps</span></code></a> 始终引用与上下文初始化时相同的 <a class="reference internal" href="../library/collections.abc.html#collections.abc.MutableMapping" title="collections.abc.MutableMapping"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableMapping</span></code></a>。如果分配了新的信号字典，<a class="reference internal" href="../library/decimal.html#decimal.Context.flags" title="decimal.Context.flags"><code class="xref py py-attr docutils literal notranslate"><span class="pre">flags</span></code></a> 和 <a class="reference internal" href="../library/decimal.html#decimal.Context.traps" title="decimal.Context.traps"><code class="xref py py-attr docutils literal notranslate"><span class="pre">traps</span></code></a> 会使用新值进行更新，但不引用右侧的字典。</p></li>
<li><p class="translated">对 <a class="reference internal" href="../library/decimal.html#decimal.Context" title="decimal.Context"><code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code></a> 进行序列化会产生不同的输出，以便为 Python 和 C 版本提供一个通用的交换格式。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/decimal.html#decimal.Context" title="decimal.Context"><code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code></a> 构造函数中的参数顺序已更改，以匹配 <a class="reference internal" href="../library/functions.html#repr" title="repr"><code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code></a> 显示的顺序。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/decimal.html#decimal.Decimal.quantize" title="decimal.Decimal.quantize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">quantize()</span></code></a> 方法的 <code class="docutils literal notranslate"><span class="pre">watchexp</span></code> 形参已被弃用。</p></li>
</ul>
</section>
</section>
<section id="email">
<span id="new-email"></span><h3 class="translated">email<a class="headerlink" href="#email" title="Link to this heading">¶</a></h3>
<section id="policy-framework">
<h4 class="translated">策略框架<a class="headerlink" href="#policy-framework" title="Link to this heading">¶</a></h4>
<p class="translated">电子邮件包现在有一个 <a class="reference internal" href="../library/email.policy.html#module-email.policy" title="email.policy: Controlling the parsing and generating of messages"><code class="xref py py-mod docutils literal notranslate"><span class="pre">policy</span></code></a> 框架。<a class="reference internal" href="../library/email.policy.html#email.policy.Policy" title="email.policy.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a> 是一个具有多个方法和属性的对象，用于控制电子邮件包的行为。Python 3.3 的主要策略是 <a class="reference internal" href="../library/email.policy.html#email.policy.Compat32" title="email.policy.Compat32"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compat32</span></code></a> 策略，它提供了与 Python 3.2 中的电子邮件包的向后兼容性。可以在解析电子邮件消息时通过 <a class="reference internal" href="../library/email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">parser</span></code></a> 指定 <code class="docutils literal notranslate"><span class="pre">policy</span></code>，或在创建 <a class="reference internal" href="../library/email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a> 对象时指定，或在通过 <a class="reference internal" href="../library/email.generator.html#module-email.generator" title="email.generator: Generate flat text email messages from a message structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">generator</span></code></a> 序列化电子邮件时指定。除非被覆盖，否则传递给 <code class="docutils literal notranslate"><span class="pre">parser</span></code> 的策略将由该 <code class="docutils literal notranslate"><span class="pre">parser</span></code> 创建的所有 <code class="docutils literal notranslate"><span class="pre">Message</span></code> 对象和子对象继承。默认情况下，<code class="docutils literal notranslate"><span class="pre">generator</span></code> 将使用其序列化的 <code class="docutils literal notranslate"><span class="pre">Message</span></code> 对象的策略。默认策略是 <a class="reference internal" href="../library/email.policy.html#email.policy.compat32" title="email.policy.compat32"><code class="xref py py-data docutils literal notranslate"><span class="pre">compat32</span></code></a>。</p>
<p class="translated">所有 <code class="docutils literal notranslate"><span class="pre">policy</span></code> 对象实现的最小控制集是：</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p class="translated">max_line_length</p></td>
<td><p class="translated">当 <code class="docutils literal notranslate"><span class="pre">Message</span></code> 被序列化时，单个行的最大长度（不包括行分隔符字符）。默认为 78。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">linesep</p></td>
<td><p class="translated">当 <code class="docutils literal notranslate"><span class="pre">Message</span></code> 被序列化时，用于分隔单个行的字符。默认为 <code class="docutils literal notranslate"><span class="pre">\n</span></code>。</p></td>
</tr>
<tr class="row-odd"><td><p class="translated">cte_type</p></td>
<td><p class="translated"><code class="docutils literal notranslate"><span class="pre">7bit</span></code> 或 <code class="docutils literal notranslate"><span class="pre">8bit</span></code>。<code class="docutils literal notranslate"><span class="pre">8bit</span></code> 仅适用于 <code class="docutils literal notranslate"><span class="pre">Bytes</span></code> <code class="docutils literal notranslate"><span class="pre">generator</span></code>，意味着在协议允许的情况下（或原始输入中存在时）可以使用非 ASCII 字符。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">raise_on_defect</p></td>
<td><p class="translated">导致一个 <code class="docutils literal notranslate"><span class="pre">parser</span></code> 在遇到缺陷时引发错误而不是将它们添加到 <code class="docutils literal notranslate"><span class="pre">Message</span></code> 对象的 <code class="docutils literal notranslate"><span class="pre">defects</span></code> 列表。</p></td>
</tr>
</tbody>
</table>
<p class="translated">使用策略对象的 <a class="reference internal" href="../library/email.policy.html#email.policy.Policy.clone" title="email.policy.Policy.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clone()</span></code></a> 方法可以创建一个具有新设置的新策略实例。<code class="docutils literal notranslate"><span class="pre">clone</span></code> 方法接受上述任何控制作为关键字参数。在调用中未指定的任何控制将保留其默认值。因此，您可以创建一个使用 <code class="docutils literal notranslate"><span class="pre">\r\n</span></code> 行分隔符字符的策略，如下所示：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">mypolicy</span> <span class="o">=</span> <span class="n">compat32</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">linesep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="translated">策略可用于简化生成符合应用程序所需格式的消息的过程。您不必在所有调用“生成器”的地方都记住指定 <code class="docutils literal notranslate"><span class="pre">linesep='\r\n'</span></code>，而可以在设置“解析器”或“消息”使用的策略时一次性指定，无论您的程序使用哪一个来创建“消息”对象。另一方面，如果需要生成多种格式的消息，您仍然可以在相应的“生成器”调用中指定参数。或者，您可以为不同情况创建自定义策略实例，并在创建“生成器”时传递这些实例。</p>
</section>
<section id="provisional-policy-with-new-header-api">
<h4 class="translated">带有新头部API的暂行策略<a class="headerlink" href="#provisional-policy-with-new-header-api" title="Link to this heading">¶</a></h4>
<p class="translated">尽管策略框架本身很有价值，但引入它的主要动机是允许创建新策略，这些策略以保持向后兼容性的方式为电子邮件包实现新功能，适用于那些不使用新策略的用户。由于新策略引入了新的 API，我们在 Python 3.3 中将其作为 <a class="reference internal" href="../glossary.html#term-provisional-package"><span class="xref std std-term">暂行策略</span></a> 发布。如果核心开发人员认为有必要，可能会发生向后不兼容的更改（包括代码的移除）。</p>
<p class="translated">新策略是 <a class="reference internal" href="../library/email.policy.html#email.policy.EmailPolicy" title="email.policy.EmailPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmailPolicy</span></code></a> 的实例，并添加了以下附加控制：</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p class="translated">refold_source</p></td>
<td><p class="translated">控制是否由 <a class="reference internal" href="../library/email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">parser</span></code></a> 解析的头部由 <a class="reference internal" href="../library/email.generator.html#module-email.generator" title="email.generator: Generate flat text email messages from a message structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">generator</span></code></a> 重新折叠。它可以设置为 <code class="docutils literal notranslate"><span class="pre">none</span></code>、<code class="docutils literal notranslate"><span class="pre">long</span></code> 或 <code class="docutils literal notranslate"><span class="pre">all</span></code>。默认值为 <code class="docutils literal notranslate"><span class="pre">long</span></code>，意味着源头部中长度超过 <code class="docutils literal notranslate"><span class="pre">max_line_length</span></code> 的行将被重新折叠。<code class="docutils literal notranslate"><span class="pre">none</span></code> 表示没有行被重新折叠，<code class="docutils literal notranslate"><span class="pre">all</span></code> 表示所有行都被重新折叠。</p></td>
</tr>
<tr class="row-even"><td><p class="translated">header_factory</p></td>
<td><p class="translated">一个可调用对象，它接受一个``name``和``value``，并生成一个自定义的头部对象。</p></td>
</tr>
</tbody>
</table>
<p class="translated"><code class="docutils literal notranslate"><span class="pre">header_factory</span></code> 是新策略提供新功能的关键。当使用其中一个新策略时，从 <code class="docutils literal notranslate"><span class="pre">Message</span></code> 对象检索到的任何头部都是一个由 <code class="docutils literal notranslate"><span class="pre">header_factory</span></code> 产生的对象，并且每次在 <code class="docutils literal notranslate"><span class="pre">Message</span></code> 上设置头部时，它都会变成一个由 <code class="docutils literal notranslate"><span class="pre">header_factory</span></code> 产生的对象。所有这些头部对象都有一个等于头部名称的 <code class="docutils literal notranslate"><span class="pre">name</span></code> 属性。地址和日期头部有额外的属性，可以让你访问头部的解析数据。这意味着你现在可以做一些类似以下的事情：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="n">policy</span><span class="o">=</span><span class="n">SMTP</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Éric &lt;foo@example.com&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span>
<span class="go">&#39;Éric &lt;foo@example.com&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addresses</span>
<span class="go">(Address(display_name=&#39;Éric&#39;, username=&#39;foo&#39;, domain=&#39;example.com&#39;),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addresses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">username</span>
<span class="go">&#39;foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addresses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display_name</span>
<span class="go">&#39;Éric&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">datetime</span>
<span class="go">datetime.datetime(2012, 5, 25, 21, 39, 24, 465484, tzinfo=datetime.timezone(datetime.timedelta(-1, 72000), &#39;EDT&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="go">&#39;Fri, 25 May 2012 21:44:27 -0400&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">To: =?utf-8?q?=C3=89ric?= &lt;foo@example.com&gt;</span>
<span class="go">Date: Fri, 25 May 2012 21:44:27 -0400</span>
</pre></div>
</div>
<p class="translated">你会注意到，当消息被序列化时，unicode 显示名称会自动编码为 <code class="docutils literal notranslate"><span class="pre">utf-8</span></code>，但当直接访问头部时，你会得到 unicode 版本。这消除了处理 <a class="reference internal" href="../library/email.header.html#module-email.header" title="email.header: Representing non-ASCII headers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.header</span></code></a> 的 <a class="reference internal" href="../library/email.header.html#email.header.decode_header" title="email.header.decode_header"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decode_header()</span></code></a> 或 <a class="reference internal" href="../library/email.header.html#email.header.make_header" title="email.header.make_header"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_header()</span></code></a> 函数的任何需要。</p>
<p class="translated">你也可以从部分创建地址：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;cc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Group</span><span class="p">(</span><span class="s1">&#39;pals&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Address</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;example.com&#39;</span><span class="p">),</span>
<span class="gp">... </span>                          <span class="n">Address</span><span class="p">(</span><span class="s1">&#39;Sally&#39;</span><span class="p">,</span> <span class="s1">&#39;sally&#39;</span><span class="p">,</span> <span class="s1">&#39;example.com&#39;</span><span class="p">)]),</span>
<span class="gp">... </span>           <span class="n">Address</span><span class="p">(</span><span class="s1">&#39;Bonzo&#39;</span><span class="p">,</span> <span class="n">addr_spec</span><span class="o">=</span><span class="s1">&#39;bonz@laugh.com&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">To: =?utf-8?q?=C3=89ric?= &lt;foo@example.com&gt;</span>
<span class="go">Date: Fri, 25 May 2012 21:44:27 -0400</span>
<span class="go">cc: pals: Bob &lt;bob@example.com&gt;, Sally &lt;sally@example.com&gt;;, Bonzo &lt;bonz@laugh.com&gt;</span>
</pre></div>
</div>
<p class="translated">自动进行解码到 unicode：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">message_from_string</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span>
<span class="go">&#39;Éric &lt;foo@example.com&gt;&#39;</span>
</pre></div>
</div>
<p class="translated">当您解析消息时，可以使用头部对象的“addresses”和“groups”属性来访问组和单个地址:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span><span class="p">[</span><span class="s1">&#39;cc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addresses</span>
<span class="go">(Address(display_name=&#39;Bob&#39;, username=&#39;bob&#39;, domain=&#39;example.com&#39;), Address(display_name=&#39;Sally&#39;, username=&#39;sally&#39;, domain=&#39;example.com&#39;), Address(display_name=&#39;Bonzo&#39;, username=&#39;bonz&#39;, domain=&#39;laugh.com&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span><span class="p">[</span><span class="s1">&#39;cc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span>
<span class="go">(Group(display_name=&#39;pals&#39;, addresses=(Address(display_name=&#39;Bob&#39;, username=&#39;bob&#39;, domain=&#39;example.com&#39;), Address(display_name=&#39;Sally&#39;, username=&#39;sally&#39;, domain=&#39;example.com&#39;)), Group(display_name=None, addresses=(Address(display_name=&#39;Bonzo&#39;, username=&#39;bonz&#39;, domain=&#39;laugh.com&#39;),)))</span>
</pre></div>
</div>
<p class="translated">总结来说，如果您使用新的策略之一，头部操作将按预期工作：您的应用程序使用unicode字符串，而email包透明地将unicode编码和解码为RFC标准内容传输编码。</p>
</section>
<section id="other-api-changes">
<h4 class="translated">其他API更改<a class="headerlink" href="#other-api-changes" title="Link to this heading">¶</a></h4>
<p class="translated">新增 <a class="reference internal" href="../library/email.parser.html#email.parser.BytesHeaderParser" title="email.parser.BytesHeaderParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">BytesHeaderParser</span></code></a>，添加到 <a class="reference internal" href="../library/email.parser.html#module-email.parser" title="email.parser: Parse flat text email messages to produce a message object structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">parser</span></code></a> 模块中，以补充 <a class="reference internal" href="../library/email.parser.html#email.parser.HeaderParser" title="email.parser.HeaderParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeaderParser</span></code></a> 并完善Bytes API。</p>
<p class="translated">新实用函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/email.utils.html#email.utils.format_datetime" title="email.utils.format_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">format_datetime()</span></code></a>：给定一个 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>，生成一个格式化的字符串，用于电子邮件头部。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/email.utils.html#email.utils.parsedate_to_datetime" title="email.utils.parsedate_to_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">parsedate_to_datetime()</span></code></a>：给定一个来自电子邮件头部的日期字符串，将其转换为带时区的 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>，如果偏移量为“-0000”，则转换为不带时区的 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/email.utils.html#email.utils.localtime" title="email.utils.localtime"><code class="xref py py-func docutils literal notranslate"><span class="pre">localtime()</span></code></a>：无参数时，返回当前本地时间作为一个带时区的 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>，使用本地 <a class="reference internal" href="../library/datetime.html#datetime.timezone" title="datetime.timezone"><code class="xref py py-class docutils literal notranslate"><span class="pre">timezone</span></code></a>。给定一个带时区的 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>，将其转换为使用本地 <a class="reference internal" href="../library/datetime.html#datetime.timezone" title="datetime.timezone"><code class="xref py py-class docutils literal notranslate"><span class="pre">timezone</span></code></a> 的带时区的 <a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></a>。</p></li>
</ul>
</section>
</section>
<section id="ftplib">
<h3 class="translated">ftplib<a class="headerlink" href="#ftplib" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">现在 <a class="reference internal" href="../library/ftplib.html#ftplib.FTP" title="ftplib.FTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">ftplib.FTP</span></code></a> 接受一个 <code class="docutils literal notranslate"><span class="pre">source_address</span></code> 关键字参数用于在创建外发套接字时指定 <code class="docutils literal notranslate"><span class="pre">(host,</span> <span class="pre">port)</span></code> 作为绑定调用中的源地址。 （由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8594">bpo-8594</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ftplib.html#ftplib.FTP_TLS" title="ftplib.FTP_TLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">FTP_TLS</span></code></a> 类现在提供了一个新的 <a class="reference internal" href="../library/ftplib.html#ftplib.FTP_TLS.ccc" title="ftplib.FTP_TLS.ccc"><code class="xref py py-func docutils literal notranslate"><span class="pre">ccc()</span></code></a> 函数，用于将控制通道恢复为明文。这对于利用知道如何处理非安全 FTP 的 NAT 防火墙而无需打开固定端口非常有用。（由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12139">bpo-12139</a> 中贡献。）</p></li>
<li><p class="translated">添加了 <a class="reference internal" href="../library/ftplib.html#ftplib.FTP.mlsd" title="ftplib.FTP.mlsd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ftplib.FTP.mlsd()</span></code></a> 方法，该方法提供了一种可解析的目录列表格式，并弃用了 <a class="reference internal" href="../library/ftplib.html#ftplib.FTP.nlst" title="ftplib.FTP.nlst"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ftplib.FTP.nlst()</span></code></a> 和 <a class="reference internal" href="../library/ftplib.html#ftplib.FTP.dir" title="ftplib.FTP.dir"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ftplib.FTP.dir()</span></code></a> 方法。（由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11072">bpo-11072</a> 中贡献。）</p></li>
</ul>
</section>
<section id="functools">
<h3 class="translated">functools<a class="headerlink" href="#functools" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/functools.html#functools.lru_cache" title="functools.lru_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.lru_cache()</span></code></a> 装饰器现在接受一个 <code class="docutils literal notranslate"><span class="pre">typed</span></code> 关键字参数（默认为 <code class="docutils literal notranslate"><span class="pre">False</span></code>），以确保将比较相等的不同类型的值缓存在单独的缓存槽中。（由 Raymond Hettinger 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13227">bpo-13227</a> 中贡献。）</p>
</section>
<section id="gc">
<h3 class="translated">gc<a class="headerlink" href="#gc" title="Link to this heading">¶</a></h3>
<p class="translated">现在可以通过新的 <a class="reference internal" href="../library/gc.html#gc.callbacks" title="gc.callbacks"><code class="xref py py-data docutils literal notranslate"><span class="pre">callbacks</span></code></a> 列表注册垃圾收集器在收集前后调用的回调函数。</p>
</section>
<section id="hmac">
<h3 class="translated">hmac<a class="headerlink" href="#hmac" title="Link to this heading">¶</a></h3>
<p class="translated">添加了新的 <a class="reference internal" href="../library/hmac.html#hmac.compare_digest" title="hmac.compare_digest"><code class="xref py py-func docutils literal notranslate"><span class="pre">compare_digest()</span></code></a> 函数，以防止通过时间分析对摘要进行侧信道攻击。（由 Nick Coghlan 和 Christian Heimes 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=15061">bpo-15061</a> 中贡献。）</p>
</section>
<section id="http">
<h3 class="translated">http<a class="headerlink" href="#http" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/http.server.html#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.server.BaseHTTPRequestHandler</span></code></a> 现在缓冲头部信息，并在调用 <a class="reference internal" href="../library/http.server.html#http.server.BaseHTTPRequestHandler.end_headers" title="http.server.BaseHTTPRequestHandler.end_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">end_headers()</span></code></a> 时一次性写入所有头部信息。新的方法 <a class="reference internal" href="../library/http.server.html#http.server.BaseHTTPRequestHandler.flush_headers" title="http.server.BaseHTTPRequestHandler.flush_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flush_headers()</span></code></a> 可以用于直接管理累积头部信息的发送时间。（由 Andrew Schaaf 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=3709">bpo-3709</a> 中贡献。）</p>
<p class="translated"><a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-class docutils literal notranslate"><span class="pre">http.server</span></code></a> 现在生成有效的 <code class="docutils literal notranslate"><span class="pre">HTML</span> <span class="pre">4.01</span> <span class="pre">strict</span></code> 输出。（由 Ezio Melotti 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13295">bpo-13295</a> 中贡献。）</p>
<p class="translated"><a class="reference internal" href="../library/http.client.html#http.client.HTTPResponse" title="http.client.HTTPResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.client.HTTPResponse</span></code></a> 现在有一个 <a class="reference internal" href="../library/http.client.html#http.client.HTTPResponse.readinto" title="http.client.HTTPResponse.readinto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">readinto()</span></code></a> 方法，这意味着它可以作为 <a class="reference internal" href="../library/io.html#io.RawIOBase" title="io.RawIOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.RawIOBase</span></code></a> 类使用。（由 John Kuhn 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13464">bpo-13464</a> 中贡献。）</p>
</section>
<section id="html">
<h3 class="translated">html<a class="headerlink" href="#html" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">html.parser.HTMLParser</span></code></a> 能够解析不规范的标记而不会引发错误，因此构造器的 <em>strict</em> 参数和 <code class="xref py py-exc docutils literal notranslate"><span class="pre">HTMLParseError</span></code> 异常现已被弃用。 解析不规范标记的能力来自于一系列程序错误修正并且它们也在 Python 2.7/3.2 的最新错误修正发布版中可用。 （由 Ezio Melotti 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=15114">bpo-15114</a> 以及 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14538">bpo-14538</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13993">bpo-13993</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13960">bpo-13960</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13358">bpo-13358</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=1745761">bpo-1745761</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=755670">bpo-755670</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13357">bpo-13357</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12629">bpo-12629</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=1200313">bpo-1200313</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=670664">bpo-670664</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13273">bpo-13273</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12888">bpo-12888</a>, <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=7311">bpo-7311</a> 中贡献。）</p>
<p class="translated">新增了一个 <a class="reference internal" href="../library/html.entities.html#html.entities.html5" title="html.entities.html5"><code class="xref py py-data docutils literal notranslate"><span class="pre">html5</span></code></a> 字典，该字典将 HTML5 命名字符引用映射到等效的 Unicode 字符（例如 <code class="docutils literal notranslate"><span class="pre">html5['gt;']</span> <span class="pre">==</span> <span class="pre">'&gt;'</span></code>），已添加到 <a class="reference internal" href="../library/html.entities.html#module-html.entities" title="html.entities: Definitions of HTML general entities."><code class="xref py py-mod docutils literal notranslate"><span class="pre">html.entities</span></code></a> 模块中。该字典现在也被 <a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTMLParser</span></code></a> 使用。（由 Ezio Melotti 贡献，相关 issue：<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11113">bpo-11113</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=15156">bpo-15156</a>。）</p>
</section>
<section id="imaplib">
<h3 class="translated">imaplib<a class="headerlink" href="#imaplib" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/imaplib.html#imaplib.IMAP4_SSL" title="imaplib.IMAP4_SSL"><code class="xref py py-class docutils literal notranslate"><span class="pre">IMAP4_SSL</span></code></a> 构造函数现在接受一个 SSLContext 参数，用于控制安全通道的参数。</p>
<p class="translated">（由 Sijin Joseph 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8808">bpo-8808</a> 中贡献。）</p>
</section>
<section id="inspect">
<h3 class="translated">inspect<a class="headerlink" href="#inspect" title="Link to this heading">¶</a></h3>
<p class="translated">新增了一个 <a class="reference internal" href="../library/inspect.html#inspect.getclosurevars" title="inspect.getclosurevars"><code class="xref py py-func docutils literal notranslate"><span class="pre">getclosurevars()</span></code></a> 函数。此函数报告从函数体中引用的所有名称的当前绑定以及这些名称的解析位置，使得在测试依赖于有状态闭包的代码时，更容易验证正确的内部状态。</p>
<p class="translated">（由  Meador Inge 和 Nick Coghlan 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13062">bpo-13062</a> 中贡献。）</p>
<p class="translated">新增了一个 <a class="reference internal" href="../library/inspect.html#inspect.getgeneratorlocals" title="inspect.getgeneratorlocals"><code class="xref py py-func docutils literal notranslate"><span class="pre">getgeneratorlocals()</span></code></a> 函数。此函数报告生成器堆栈帧中局部变量的当前绑定，使得在测试生成器时，更容易验证正确的内部状态。</p>
<p class="translated">（由 Meador Inge 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=15153">bpo-15153</a> 中贡献。）</p>
</section>
<section id="io">
<h3 class="translated">io<a class="headerlink" href="#io" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/io.html#io.open" title="io.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> 函数新增了一个 <code class="docutils literal notranslate"><span class="pre">'x'</span></code> 模式，可用于独占地创建新文件，如果文件已存在，则引发 <a class="reference internal" href="../library/exceptions.html#FileExistsError" title="FileExistsError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">FileExistsError</span></code></a>。它基于 C11 中 fopen() 的 'x' 模式。</p>
<p class="translated">（由 David Townshend 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12760">bpo-12760</a> 中贡献。）</p>
<p class="translated"><a class="reference internal" href="../library/io.html#io.TextIOWrapper" title="io.TextIOWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextIOWrapper</span></code></a> 类的构造器新增了 <em>write_through</em> 可选参数。 如果 <em>write_through</em> 为 <code class="docutils literal notranslate"><span class="pre">True</span></code>，对 <code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code> 的调用会确保不被缓冲：在 <a class="reference internal" href="../library/io.html#io.TextIOWrapper" title="io.TextIOWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextIOWrapper</span></code></a> 对象上写入的任何数据会立即交给其下层的二进制缓冲区来处理。</p>
</section>
<section id="itertools">
<h3 class="translated">itertools<a class="headerlink" href="#itertools" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/itertools.html#itertools.accumulate" title="itertools.accumulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">accumulate()</span></code></a> 现在接受一个可选的 <code class="docutils literal notranslate"><span class="pre">func</span></code> 参数，用于提供用户定义的二元函数。</p>
</section>
<section id="logging">
<h3 class="translated">logging<a class="headerlink" href="#logging" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/logging.html#logging.basicConfig" title="logging.basicConfig"><code class="xref py py-func docutils literal notranslate"><span class="pre">basicConfig()</span></code></a> 函数现在支持一个可选的 <code class="docutils literal notranslate"><span class="pre">handlers</span></code> 参数，该参数接受一个可迭代的处理器列表，用于添加到根记录器。</p>
<p class="translated">向 <a class="reference internal" href="../library/logging.handlers.html#logging.handlers.SysLogHandler" title="logging.handlers.SysLogHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SysLogHandler</span></code></a> 添加了一个类级属性 <code class="xref py py-attr docutils literal notranslate"><span class="pre">append_nul</span></code> 以允许对向 syslog 记录添加 <code class="docutils literal notranslate"><span class="pre">NUL</span></code> (<code class="docutils literal notranslate"><span class="pre">\000</span></code>) 字节的行为进制控制，因为某些守护进程要求这样做而另一些则会直接传递给日志。</p>
</section>
<section id="math">
<h3 class="translated">math<a class="headerlink" href="#math" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/math.html#module-math" title="math: Mathematical functions (sin() etc.)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">math</span></code></a> 模块新增了一个函数 <a class="reference internal" href="../library/math.html#math.log2" title="math.log2"><code class="xref py py-func docutils literal notranslate"><span class="pre">log2()</span></code></a>，它返回 <em>x</em> 的以 2 为底的对数。</p>
<p class="translated">（由 Mark Dickinson 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11888">bpo-11888</a> 中编写。）</p>
</section>
<section id="mmap">
<h3 class="translated">mmap<a class="headerlink" href="#mmap" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../library/mmap.html#mmap.mmap.read" title="mmap.mmap.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> 方法能更好地兼容其他文件型对象：如果参数被省略或指定为 <code class="docutils literal notranslate"><span class="pre">None</span></code>，它将返回从当前文件位置到映射对象末尾的字节数据。 （由 Petri Lehtinen 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12021">bpo-12021</a> 中贡献。）</p>
</section>
<section id="multiprocessing">
<h3 class="translated">multiprocessing<a class="headerlink" href="#multiprocessing" title="Link to this heading">¶</a></h3>
<p class="translated">新增的 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.connection.wait" title="multiprocessing.connection.wait"><code class="xref py py-func docutils literal notranslate"><span class="pre">multiprocessing.connection.wait()</span></code></a> 函数允许附带超时限制轮询多个对象（如连接、套接字和管道）。 （由 Richard Oudkerk 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12328">bpo-12328</a> 中贡献。）</p>
<p class="translated">现在 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.connection.Connection" title="multiprocessing.connection.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">multiprocessing.connection.Connection</span></code></a> 对象可通过多进程连接进行传输。 （由 Richard Oudkerk 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=4892">bpo-4892</a> 中贡献。）</p>
<p class="translated">现在 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.Process" title="multiprocessing.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">multiprocessing.Process</span></code></a> 可接受 <code class="docutils literal notranslate"><span class="pre">daemon</span></code> 关键字参数来覆盖继承来自父进程的 <code class="docutils literal notranslate"><span class="pre">daemon</span></code> 旗标的默认行为 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=6064">bpo-6064</a>)。</p>
<p class="translated">新增的属性 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.Process.sentinel" title="multiprocessing.Process.sentinel"><code class="xref py py-data docutils literal notranslate"><span class="pre">multiprocessing.Process.sentinel</span></code></a> 允许程序使用适当的 OS 原语来同时等待多个 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.Process" title="multiprocessing.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">Process</span></code></a> 对象 (例如，在 posix 系统上是使用 <a class="reference internal" href="../library/select.html#module-select" title="select: Wait for I/O completion on multiple streams."><code class="xref py py-mod docutils literal notranslate"><span class="pre">select</span></code></a> )。</p>
<p class="translated">新增的方法 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.pool.Pool.starmap" title="multiprocessing.pool.Pool.starmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">multiprocessing.pool.Pool.starmap()</span></code></a> 和 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.pool.Pool.starmap_async" title="multiprocessing.pool.Pool.starmap_async"><code class="xref py py-meth docutils literal notranslate"><span class="pre">starmap_async()</span></code></a> 提供了针对现有 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.pool.Pool.map" title="multiprocessing.pool.Pool.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">multiprocessing.pool.Pool.map()</span></code></a> 和 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.pool.Pool.map_async" title="multiprocessing.pool.Pool.map_async"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map_async()</span></code></a> 函数的 <a class="reference internal" href="../library/itertools.html#itertools.starmap" title="itertools.starmap"><code class="xref py py-func docutils literal notranslate"><span class="pre">itertools.starmap()</span></code></a> 对应物。 （由 Hynek Schlawack 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12708">bpo-12708</a> 中贡献。）</p>
</section>
<section id="nntplib">
<h3 class="translated">nntplib<a class="headerlink" href="#nntplib" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <code class="xref py py-class docutils literal notranslate"><span class="pre">nntplib.NNTP</span></code> 类支持上下文管理协议以无条件地处理 <a class="reference internal" href="../library/socket.html#socket.error" title="socket.error"><code class="xref py py-exc docutils literal notranslate"><span class="pre">socket.error</span></code></a> 异常并在完成后关闭 NNTP 连接:</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">nntplib</span><span class="w"> </span><span class="kn">import</span> <span class="n">NNTP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">NNTP</span><span class="p">(</span><span class="s1">&#39;news.gmane.org&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">n</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">n</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;gmane.comp.python.committers&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">(&#39;211 1755 1 1755 gmane.comp.python.committers&#39;, 1755, 1, 1755, &#39;gmane.comp.python.committers&#39;)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p class="translated">（由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=9795">bpo-9795</a> 中贡献。）</p>
</section>
<section id="os">
<h3 class="translated">os<a class="headerlink" href="#os" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块新增了 <a class="reference internal" href="../library/os.html#os.pipe2" title="os.pipe2"><code class="xref py py-func docutils literal notranslate"><span class="pre">pipe2()</span></code></a> 函数以便能够创建会自动设置 <a class="reference internal" href="../library/os.html#os.O_CLOEXEC" title="os.O_CLOEXEC"><code class="xref py py-const docutils literal notranslate"><span class="pre">O_CLOEXEC</span></code></a> 或 <a class="reference internal" href="../library/os.html#os.O_NONBLOCK" title="os.O_NONBLOCK"><code class="xref py py-const docutils literal notranslate"><span class="pre">O_NONBLOCK</span></code></a> 旗标的管道。 这特别适用于避免多线程的程序出现竞争条件。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块新增了一个 <a class="reference internal" href="../library/os.html#os.sendfile" title="os.sendfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">sendfile()</span></code></a> 函数，提供了一种高效的“零拷贝”方式来将数据从一个文件（或套接字）描述符复制到另一个描述符。所谓“零拷贝”是指所有数据在两个描述符之间的复制完全由内核完成，无需将数据复制到用户空间缓冲区。<a class="reference internal" href="../library/os.html#os.sendfile" title="os.sendfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">sendfile()</span></code></a> 可用于高效地将磁盘上的文件数据复制到网络套接字，例如用于下载文件。</p>
<p class="translated">（由 Ross Lagerwall 和 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10882">bpo-10882</a> 中提交的补丁。）</p>
</li>
<li><p class="translated">为了避免诸如符号链接攻击和临时文件及目录的问题，操作文件描述符比操作文件名更可靠（也更快）。Python 3.3 增强了现有函数并引入了新函数来处理文件描述符（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=4761">bpo-4761</a>，<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10755">bpo-10755</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14626">bpo-14626</a>）。</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块新增了一个 <a class="reference internal" href="../library/os.html#os.fwalk" title="os.fwalk"><code class="xref py py-func docutils literal notranslate"><span class="pre">fwalk()</span></code></a> 函数，类似于 <a class="reference internal" href="../library/os.html#os.walk" title="os.walk"><code class="xref py py-func docutils literal notranslate"><span class="pre">walk()</span></code></a>，但它还会生成引用访问过的目录的文件描述符。这对于避免符号链接竞争条件特别有用。</p></li>
<li><p class="translated">下列函数新增了可选的 <em>dir_fd</em> (<a class="reference internal" href="../library/os.html#dir-fd"><span class="std std-ref">相对于目录描述符的路径</span></a>) 和/或 <em>follow_symlinks</em> (<a class="reference internal" href="../library/os.html#follow-symlinks"><span class="std std-ref">不跟随符号链接</span></a>): <a class="reference internal" href="../library/os.html#os.access" title="os.access"><code class="xref py py-func docutils literal notranslate"><span class="pre">access()</span></code></a>, <a class="reference internal" href="../library/os.html#os.chflags" title="os.chflags"><code class="xref py py-func docutils literal notranslate"><span class="pre">chflags()</span></code></a>, <a class="reference internal" href="../library/os.html#os.chmod" title="os.chmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">chmod()</span></code></a>, <a class="reference internal" href="../library/os.html#os.chown" title="os.chown"><code class="xref py py-func docutils literal notranslate"><span class="pre">chown()</span></code></a>, <a class="reference internal" href="../library/os.html#os.link" title="os.link"><code class="xref py py-func docutils literal notranslate"><span class="pre">link()</span></code></a>, <a class="reference internal" href="../library/os.html#os.lstat" title="os.lstat"><code class="xref py py-func docutils literal notranslate"><span class="pre">lstat()</span></code></a>, <a class="reference internal" href="../library/os.html#os.mkdir" title="os.mkdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">mkdir()</span></code></a>, <a class="reference internal" href="../library/os.html#os.mkfifo" title="os.mkfifo"><code class="xref py py-func docutils literal notranslate"><span class="pre">mkfifo()</span></code></a>, <a class="reference internal" href="../library/os.html#os.mknod" title="os.mknod"><code class="xref py py-func docutils literal notranslate"><span class="pre">mknod()</span></code></a>, <a class="reference internal" href="../library/os.html#os.open" title="os.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a>, <a class="reference internal" href="../library/os.html#os.readlink" title="os.readlink"><code class="xref py py-func docutils literal notranslate"><span class="pre">readlink()</span></code></a>, <a class="reference internal" href="../library/os.html#os.remove" title="os.remove"><code class="xref py py-func docutils literal notranslate"><span class="pre">remove()</span></code></a>, <a class="reference internal" href="../library/os.html#os.rename" title="os.rename"><code class="xref py py-func docutils literal notranslate"><span class="pre">rename()</span></code></a>, <a class="reference internal" href="../library/os.html#os.replace" title="os.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a>, <a class="reference internal" href="../library/os.html#os.rmdir" title="os.rmdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">rmdir()</span></code></a>, <a class="reference internal" href="../library/os.html#os.stat" title="os.stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">stat()</span></code></a>, <a class="reference internal" href="../library/os.html#os.symlink" title="os.symlink"><code class="xref py py-func docutils literal notranslate"><span class="pre">symlink()</span></code></a>, <a class="reference internal" href="../library/os.html#os.unlink" title="os.unlink"><code class="xref py py-func docutils literal notranslate"><span class="pre">unlink()</span></code></a>, <a class="reference internal" href="../library/os.html#os.utime" title="os.utime"><code class="xref py py-func docutils literal notranslate"><span class="pre">utime()</span></code></a>。 支持使用这些形参的平台可通过集合 <a class="reference internal" href="../library/os.html#os.supports_dir_fd" title="os.supports_dir_fd"><code class="xref py py-data docutils literal notranslate"><span class="pre">os.supports_dir_fd</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.supports_follow_symlinks" title="os.supports_follow_symlinks"><code class="xref py py-data docutils literal notranslate"><span class="pre">os.supports_follow_symlinks</span></code></a> 来检测。</p></li>
<li><p class="translated">以下函数现在支持使用文件描述符作为其路径参数：<a class="reference internal" href="../library/os.html#os.chdir" title="os.chdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">chdir()</span></code></a>，<a class="reference internal" href="../library/os.html#os.chmod" title="os.chmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">chmod()</span></code></a>，<a class="reference internal" href="../library/os.html#os.chown" title="os.chown"><code class="xref py py-func docutils literal notranslate"><span class="pre">chown()</span></code></a>，<a class="reference internal" href="../library/os.html#os.execve" title="os.execve"><code class="xref py py-func docutils literal notranslate"><span class="pre">execve()</span></code></a>，<a class="reference internal" href="../library/os.html#os.listdir" title="os.listdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">listdir()</span></code></a>，<a class="reference internal" href="../library/os.html#os.pathconf" title="os.pathconf"><code class="xref py py-func docutils literal notranslate"><span class="pre">pathconf()</span></code></a>，<a class="reference internal" href="../library/os.path.html#os.path.exists" title="os.path.exists"><code class="xref py py-func docutils literal notranslate"><span class="pre">exists()</span></code></a>，<a class="reference internal" href="../library/os.html#os.stat" title="os.stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">stat()</span></code></a>，<a class="reference internal" href="../library/os.html#os.statvfs" title="os.statvfs"><code class="xref py py-func docutils literal notranslate"><span class="pre">statvfs()</span></code></a>，<a class="reference internal" href="../library/os.html#os.utime" title="os.utime"><code class="xref py py-func docutils literal notranslate"><span class="pre">utime()</span></code></a>。平台对此的支持可以通过集合 <a class="reference internal" href="../library/os.html#os.supports_fd" title="os.supports_fd"><code class="xref py py-data docutils literal notranslate"><span class="pre">os.supports_fd</span></code></a> 检查。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.access" title="os.access"><code class="xref py py-func docutils literal notranslate"><span class="pre">access()</span></code></a> 接受一个 <code class="docutils literal notranslate"><span class="pre">effective_ids</span></code> 关键字参数，以在访问检查中使用有效 uid/gid 而不是真实 uid/gid。平台对此的支持可以通过集合 <a class="reference internal" href="../library/os.html#os.supports_effective_ids" title="os.supports_effective_ids"><code class="xref py py-data docutils literal notranslate"><span class="pre">supports_effective_ids</span></code></a> 检查。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块新增了两个函数：<a class="reference internal" href="../library/os.html#os.getpriority" title="os.getpriority"><code class="xref py py-func docutils literal notranslate"><span class="pre">getpriority()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.setpriority" title="os.setpriority"><code class="xref py py-func docutils literal notranslate"><span class="pre">setpriority()</span></code></a>。它们可以用来获取或设置进程的优先级/友好度，类似于 <a class="reference internal" href="../library/os.html#os.nice" title="os.nice"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.nice()</span></code></a>，但扩展到所有进程而不仅仅是当前进程。</p>
<p class="translated">（由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10784">bpo-10784</a> 中提交的补丁。）</p>
</li>
<li><p class="translated">新的 <a class="reference internal" href="../library/os.html#os.replace" title="os.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.replace()</span></code></a> 函数允许跨平台重命名文件，并覆盖目标文件。使用 <a class="reference internal" href="../library/os.html#os.rename" title="os.rename"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.rename()</span></code></a> 时，在 POSIX 下会覆盖现有目标文件，但在 Windows 下会引发错误。（由 Antoine Pitrou 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8828">bpo-8828</a> 中贡献。）</p></li>
<li><p class="translated">stat 系列函数（<a class="reference internal" href="../library/os.html#os.stat" title="os.stat"><code class="xref py py-func docutils literal notranslate"><span class="pre">stat()</span></code></a>，<a class="reference internal" href="../library/os.html#os.fstat" title="os.fstat"><code class="xref py py-func docutils literal notranslate"><span class="pre">fstat()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.lstat" title="os.lstat"><code class="xref py py-func docutils literal notranslate"><span class="pre">lstat()</span></code></a>）现在支持以纳秒精度读取文件的时间戳。相应地，<a class="reference internal" href="../library/os.html#os.utime" title="os.utime"><code class="xref py py-func docutils literal notranslate"><span class="pre">utime()</span></code></a> 现在可以以纳秒精度写入文件时间戳。（由 Larry Hastings 贡献，见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14127">bpo-14127</a>。）</p></li>
<li><p class="translated">新的 <a class="reference internal" href="../library/os.html#os.get_terminal_size" title="os.get_terminal_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.get_terminal_size()</span></code></a> 函数查询附加到文件描述符的终端大小。另请参见 <a class="reference internal" href="../library/shutil.html#shutil.get_terminal_size" title="shutil.get_terminal_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.get_terminal_size()</span></code></a>。（由 Zbigniew Jędrzejewski-Szmek 贡献，见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13609">bpo-13609</a>。）</p></li>
</ul>
<ul class="simple">
<li><p class="translated">支持 Linux 扩展属性的新函数（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12720">bpo-12720</a>）：<a class="reference internal" href="../library/os.html#os.getxattr" title="os.getxattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">getxattr()</span></code></a>，<a class="reference internal" href="../library/os.html#os.listxattr" title="os.listxattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">listxattr()</span></code></a>，<a class="reference internal" href="../library/os.html#os.removexattr" title="os.removexattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">removexattr()</span></code></a>，<a class="reference internal" href="../library/os.html#os.setxattr" title="os.setxattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">setxattr()</span></code></a>。</p></li>
<li><p class="translated">新的调度器接口。这些函数控制操作系统如何为进程分配 CPU 时间。新函数包括：<a class="reference internal" href="../library/os.html#os.sched_get_priority_max" title="os.sched_get_priority_max"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_get_priority_max()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_get_priority_min" title="os.sched_get_priority_min"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_get_priority_min()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_getaffinity" title="os.sched_getaffinity"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_getaffinity()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_getparam" title="os.sched_getparam"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_getparam()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_getscheduler" title="os.sched_getscheduler"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_getscheduler()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_rr_get_interval" title="os.sched_rr_get_interval"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_rr_get_interval()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_setaffinity" title="os.sched_setaffinity"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_setaffinity()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_setparam" title="os.sched_setparam"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_setparam()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_setscheduler" title="os.sched_setscheduler"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_setscheduler()</span></code></a>，<a class="reference internal" href="../library/os.html#os.sched_yield" title="os.sched_yield"><code class="xref py py-func docutils literal notranslate"><span class="pre">sched_yield()</span></code></a>，</p></li>
<li><p class="translated">控制文件系统的新函数：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.posix_fadvise" title="os.posix_fadvise"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_fadvise()</span></code></a>：宣布以特定模式访问数据的意图，从而允许内核进行优化。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.posix_fallocate" title="os.posix_fallocate"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_fallocate()</span></code></a>：确保为文件分配足够的磁盘空间。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.sync" title="os.sync"><code class="xref py py-func docutils literal notranslate"><span class="pre">sync()</span></code></a>：强制将所有内容写入磁盘。</p></li>
</ul>
</li>
<li><p class="translated">其他新的 POSIX 函数：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.lockf" title="os.lockf"><code class="xref py py-func docutils literal notranslate"><span class="pre">lockf()</span></code></a>：对打开的文件描述符应用、测试或移除 POSIX 锁。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.pread" title="os.pread"><code class="xref py py-func docutils literal notranslate"><span class="pre">pread()</span></code></a>：从文件描述符的偏移量处读取，文件偏移量保持不变。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.pwrite" title="os.pwrite"><code class="xref py py-func docutils literal notranslate"><span class="pre">pwrite()</span></code></a>：从偏移量处写入文件描述符，文件偏移量保持不变。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.readv" title="os.readv"><code class="xref py py-func docutils literal notranslate"><span class="pre">readv()</span></code></a>：从文件描述符读取到多个可写缓冲区。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.truncate" title="os.truncate"><code class="xref py py-func docutils literal notranslate"><span class="pre">truncate()</span></code></a>：截断与 <em>path</em> 对应的文件，使其大小最多为 <em>length</em> 字节。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.waitid" title="os.waitid"><code class="xref py py-func docutils literal notranslate"><span class="pre">waitid()</span></code></a>: 等待一个或多个子进程的完成。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.writev" title="os.writev"><code class="xref py py-func docutils literal notranslate"><span class="pre">writev()</span></code></a>: 将*buffers*的内容写入文件描述符，其中*buffers*是任意序列的缓冲区。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.getgrouplist" title="os.getgrouplist"><code class="xref py py-func docutils literal notranslate"><span class="pre">getgrouplist()</span></code></a> (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=9344">bpo-9344</a>): 返回指定用户所属的组ID列表。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.times" title="os.times"><code class="xref py py-func docutils literal notranslate"><span class="pre">times()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.uname" title="os.uname"><code class="xref py py-func docutils literal notranslate"><span class="pre">uname()</span></code></a>: 返回类型从元组更改为具有命名属性的类元组对象。</p></li>
<li><p class="translated">一些平台现在支持 <a class="reference internal" href="../library/os.html#os.lseek" title="os.lseek"><code class="xref py py-func docutils literal notranslate"><span class="pre">lseek()</span></code></a> 函数的额外常量，例如 <code class="docutils literal notranslate"><span class="pre">os.SEEK_HOLE</span></code> 和 <code class="docutils literal notranslate"><span class="pre">os.SEEK_DATA</span></code>。</p></li>
<li><p class="translated">新增常量 <a class="reference internal" href="../library/os.html#os.RTLD_LAZY" title="os.RTLD_LAZY"><code class="xref py py-const docutils literal notranslate"><span class="pre">RTLD_LAZY</span></code></a>, <a class="reference internal" href="../library/os.html#os.RTLD_NOW" title="os.RTLD_NOW"><code class="xref py py-const docutils literal notranslate"><span class="pre">RTLD_NOW</span></code></a>, <a class="reference internal" href="../library/os.html#os.RTLD_GLOBAL" title="os.RTLD_GLOBAL"><code class="xref py py-const docutils literal notranslate"><span class="pre">RTLD_GLOBAL</span></code></a>, <a class="reference internal" href="../library/os.html#os.RTLD_LOCAL" title="os.RTLD_LOCAL"><code class="xref py py-const docutils literal notranslate"><span class="pre">RTLD_LOCAL</span></code></a>, <a class="reference internal" href="../library/os.html#os.RTLD_NODELETE" title="os.RTLD_NODELETE"><code class="xref py py-const docutils literal notranslate"><span class="pre">RTLD_NODELETE</span></code></a>, <a class="reference internal" href="../library/os.html#os.RTLD_NOLOAD" title="os.RTLD_NOLOAD"><code class="xref py py-const docutils literal notranslate"><span class="pre">RTLD_NOLOAD</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.RTLD_DEEPBIND" title="os.RTLD_DEEPBIND"><code class="xref py py-const docutils literal notranslate"><span class="pre">RTLD_DEEPBIND</span></code></a> 将在支持它们的平台上可用。 这些常量将被用于 <a class="reference internal" href="../library/sys.html#sys.setdlopenflags" title="sys.setdlopenflags"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.setdlopenflags()</span></code></a> 函数，并取代在 <a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">DLFCN</span></code> 中定义的类似常量。 （由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13226">bpo-13226</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/os.html#os.symlink" title="os.symlink"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.symlink()</span></code></a> 现在接受（并忽略）非Windows平台上的 <code class="docutils literal notranslate"><span class="pre">target_is_directory</span></code> 关键字参数，以简化跨平台支持。</p></li>
</ul>
</section>
<section id="pdb">
<h3 class="translated">pdb<a class="headerlink" href="#pdb" title="Link to this heading">¶</a></h3>
<p class="translated">Tab 补全现在不仅适用于命令名称，也适用于它们的参数。 例如，对于 <code class="docutils literal notranslate"><span class="pre">break</span></code> 命令，函数和文件名将被补全。</p>
<p class="translated">（由 Georg Brandl 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14210">bpo-14210</a> 中贡献）</p>
</section>
<section id="pickle">
<h3 class="translated">pickle<a class="headerlink" href="#pickle" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../library/pickle.html#pickle.Pickler" title="pickle.Pickler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pickle.Pickler</span></code></a> 对象具有一个可选的 <a class="reference internal" href="../library/pickle.html#pickle.Pickler.dispatch_table" title="pickle.Pickler.dispatch_table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dispatch_table</span></code></a> 属性以允许针对每个 pickler 设置缩减函数。</p>
<p class="translated">（由 Richard Oudkerk 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14166">bpo-14166</a> 中贡献。）</p>
</section>
<section id="pydoc">
<h3 class="translated">pydoc<a class="headerlink" href="#pydoc" title="Link to this heading">¶</a></h3>
<p class="translated">Tk GUI 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">serve()</span></code> 函数已从 <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pydoc</span></code></a> 模块中移除: <code class="docutils literal notranslate"><span class="pre">pydoc</span> <span class="pre">-g</span></code> 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">serve()</span></code> 在 Python 3.2 中已被弃用。</p>
</section>
<section id="re">
<h3 class="translated">re<a class="headerlink" href="#re" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 正则表达式已支持 <code class="docutils literal notranslate"><span class="pre">\u</span></code> 和 <code class="docutils literal notranslate"><span class="pre">\U</span></code> 转义符。</p>
<p class="translated">（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=3665">bpo-3665</a> 中贡献。）</p>
</section>
<section id="sched">
<h3 class="translated">sched<a class="headerlink" href="#sched" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/sched.html#sched.scheduler.run" title="sched.scheduler.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> 现在接受一个 <em>blocking</em> 参数，当设置为 false 时，该方法执行即将到期的计划事件（如果有）并立即返回。这在您希望使用 <a class="reference internal" href="../library/sched.html#sched.scheduler" title="sched.scheduler"><code class="xref py py-class docutils literal notranslate"><span class="pre">scheduler</span></code></a> 在非阻塞应用程序中时非常有用。（由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13449">bpo-13449</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/sched.html#sched.scheduler" title="sched.scheduler"><code class="xref py py-class docutils literal notranslate"><span class="pre">scheduler</span></code></a> 类现在可以安全地在多线程环境中使用。（由 Josiah Carlson 和 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8684">bpo-8684</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/sched.html#sched.scheduler" title="sched.scheduler"><code class="xref py py-class docutils literal notranslate"><span class="pre">scheduler</span></code></a> 类构造函数的 <em>timefunc</em> 和 <em>delayfunct</em> 参数现在是可选的，默认分别为 <a class="reference internal" href="../library/time.html#time.time" title="time.time"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.time()</span></code></a> 和 <a class="reference internal" href="../library/time.html#time.sleep" title="time.sleep"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.sleep()</span></code></a>。（由 Chris Clark 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13245">bpo-13245</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/sched.html#sched.scheduler.enter" title="sched.scheduler.enter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enter()</span></code></a> 和 <a class="reference internal" href="../library/sched.html#sched.scheduler.enterabs" title="sched.scheduler.enterabs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enterabs()</span></code></a> 的 <em>argument</em> 参数现在是可选的。 (由 Chris Clark 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13245">bpo-13245</a> 中贡献)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/sched.html#sched.scheduler.enter" title="sched.scheduler.enter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enter()</span></code></a> 和 <a class="reference internal" href="../library/sched.html#sched.scheduler.enterabs" title="sched.scheduler.enterabs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enterabs()</span></code></a> 现在接受一个 <em>kwargs</em> 参数。 (由 Chris Clark 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13245">bpo-13245</a> 中贡献)</p></li>
</ul>
</section>
<section id="select">
<h3 class="translated">select<a class="headerlink" href="#select" title="Link to this heading">¶</a></h3>
<p class="translated">Solaris 及其衍生平台新增了一个类 <a class="reference internal" href="../library/select.html#select.devpoll" title="select.devpoll"><code class="xref py py-class docutils literal notranslate"><span class="pre">select.devpoll</span></code></a>，用于通过 <code class="file docutils literal notranslate"><span class="pre">/dev/poll</span></code> 实现高性能异步套接字。 (由 Jesús Cea Avión 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=6397">bpo-6397</a> 中贡献)</p>
</section>
<section id="shlex">
<h3 class="translated">shlex<a class="headerlink" href="#shlex" title="Link to this heading">¶</a></h3>
<p class="translated">之前未文档化的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">pipes</span></code> 模块中的辅助函数 <code class="docutils literal notranslate"><span class="pre">quote</span></code> 已移至 <a class="reference internal" href="../library/shlex.html#module-shlex" title="shlex: Simple lexical analysis for Unix shell-like languages."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shlex</span></code></a> 模块并进行文档化。 <a class="reference internal" href="../library/shlex.html#shlex.quote" title="shlex.quote"><code class="xref py py-func docutils literal notranslate"><span class="pre">quote()</span></code></a> 正确地转义字符串中所有可能在 shell 中具有特殊意义的字符。</p>
</section>
<section id="shutil">
<h3 class="translated">shutil<a class="headerlink" href="#shutil" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">新的函数：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/shutil.html#shutil.disk_usage" title="shutil.disk_usage"><code class="xref py py-func docutils literal notranslate"><span class="pre">disk_usage()</span></code></a>：提供总、已用和可用磁盘空间统计信息。 (由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12442">bpo-12442</a> 中贡献)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/shutil.html#shutil.chown" title="shutil.chown"><code class="xref py py-func docutils literal notranslate"><span class="pre">chown()</span></code></a>：允许更改给定路径的用户和/或组，同时可以指定用户/组名称，而不仅限于其数字 ID。 (由 Sandro Tosi 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12191">bpo-12191</a> 中贡献)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/shutil.html#shutil.get_terminal_size" title="shutil.get_terminal_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.get_terminal_size()</span></code></a>：返回解释器所连接的终端窗口的大小。 (由 Zbigniew Jędrzejewski-Szmek 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13609">bpo-13609</a> 中贡献)</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/shutil.html#shutil.copy2" title="shutil.copy2"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy2()</span></code></a> 和 <a class="reference internal" href="../library/shutil.html#shutil.copystat" title="shutil.copystat"><code class="xref py py-func docutils literal notranslate"><span class="pre">copystat()</span></code></a> 现在在支持的平台中可以保留纳秒精度的文件时间戳。它们还保留 Linux 上的文件“扩展属性”。 (由 Larry Hastings 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14127">bpo-14127</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=15238">bpo-15238</a> 中贡献)</p></li>
<li><p class="translated">多个函数现在接受一个可选的 <code class="docutils literal notranslate"><span class="pre">symlinks</span></code> 参数：当该参数为真时，不解析符号链接，操作直接作用于符号链接本身（或在相关情况下创建一个）。 (由 Hynek Schlawack 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12715">bpo-12715</a> 中贡献)</p></li>
<li><p class="translated">当将文件复制到不同的文件系统时，<a class="reference internal" href="../library/shutil.html#shutil.move" title="shutil.move"><code class="xref py py-func docutils literal notranslate"><span class="pre">move()</span></code></a> 现在处理符号链接的方式与 POSIX 的 <code class="docutils literal notranslate"><span class="pre">mv</span></code> 命令相同，即重新创建符号链接而不是复制目标文件内容。(由 Jonathan Niehof 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=9993">bpo-9993</a> 中贡献。) <a class="reference internal" href="../library/shutil.html#shutil.move" title="shutil.move"><code class="xref py py-func docutils literal notranslate"><span class="pre">move()</span></code></a> 现在还返回 <code class="docutils literal notranslate"><span class="pre">dst</span></code> 参数作为其结果。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/shutil.html#shutil.rmtree" title="shutil.rmtree"><code class="xref py py-func docutils literal notranslate"><span class="pre">rmtree()</span></code></a> 现在对符号链接攻击具有抵抗力，适用于支持 <a class="reference internal" href="../library/os.html#os.open" title="os.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.open()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.unlink" title="os.unlink"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.unlink()</span></code></a> 中新 <code class="docutils literal notranslate"><span class="pre">dir_fd</span></code> 参数的平台。（由 Martin von Löwis 和 Hynek Schlawack 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=4489">bpo-4489</a> 中贡献。）</p></li>
</ul>
</section>
<section id="signal">
<h3 class="translated">signal<a class="headerlink" href="#signal" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/signal.html#module-signal" title="signal: Set handlers for asynchronous events."><code class="xref py py-mod docutils literal notranslate"><span class="pre">signal</span></code></a> 模块新增的函数:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/signal.html#signal.pthread_sigmask" title="signal.pthread_sigmask"><code class="xref py py-func docutils literal notranslate"><span class="pre">pthread_sigmask()</span></code></a>: 获取和/或改变调用方线程的信号掩码（由 Jean-Paul Calderone 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8407">bpo-8407</a> 中贡献）；</p></li>
<li><p class="translated"><a class="reference internal" href="../library/signal.html#signal.pthread_kill" title="signal.pthread_kill"><code class="xref py py-func docutils literal notranslate"><span class="pre">pthread_kill()</span></code></a>: 向指定线程发送信号；</p></li>
<li><p class="translated"><a class="reference internal" href="../library/signal.html#signal.sigpending" title="signal.sigpending"><code class="xref py py-func docutils literal notranslate"><span class="pre">sigpending()</span></code></a>: 检查挂起的函数；</p></li>
<li><p class="translated"><a class="reference internal" href="../library/signal.html#signal.sigwait" title="signal.sigwait"><code class="xref py py-func docutils literal notranslate"><span class="pre">sigwait()</span></code></a>: 等待一个信号;</p></li>
<li><p class="translated"><a class="reference internal" href="../library/signal.html#signal.sigwaitinfo" title="signal.sigwaitinfo"><code class="xref py py-func docutils literal notranslate"><span class="pre">sigwaitinfo()</span></code></a>: 等待信号，返回相关的详细信息；</p></li>
<li><p class="translated"><a class="reference internal" href="../library/signal.html#signal.sigtimedwait" title="signal.sigtimedwait"><code class="xref py py-func docutils literal notranslate"><span class="pre">sigtimedwait()</span></code></a>：类似于 <a class="reference internal" href="../library/signal.html#signal.sigwaitinfo" title="signal.sigwaitinfo"><code class="xref py py-func docutils literal notranslate"><span class="pre">sigwaitinfo()</span></code></a>，但带有超时。</p></li>
</ul>
</li>
<li><p class="translated">信号处理程序将信号号码作为一个字节而不是空字节写入唤醒文件描述符。因此，可以等待多个信号并知道哪些信号被触发。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/signal.html#signal.signal" title="signal.signal"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal.signal()</span></code></a> 和 <a class="reference internal" href="../library/signal.html#signal.siginterrupt" title="signal.siginterrupt"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal.siginterrupt()</span></code></a> 引发 OSError，而不是 RuntimeError：OSError 具有 errno 属性。</p></li>
</ul>
</section>
<section id="smtpd">
<h3 class="translated">smtpd<a class="headerlink" href="#smtpd" title="Link to this heading">¶</a></h3>
<p class="translated"><code class="xref py py-mod docutils literal notranslate"><span class="pre">smtpd</span></code> 模块现在支持 <span class="target" id="index-98"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5321.html"><strong>RFC 5321</strong></a> (扩展 SMTP) 和 <span class="target" id="index-99"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc1870.html"><strong>RFC 1870</strong></a> (大小扩展) 。根据标准，这些扩展仅在客户端使用 <code class="docutils literal notranslate"><span class="pre">EHLO</span></code> 命令发起会话时启用。</p>
<p class="translated">（初始 <code class="docutils literal notranslate"><span class="pre">ELHO</span></code> 支持由 Alberto Trevino 提供。大小扩展由 Juhana Jauhiainen 提供。Michele Orrù 和 Dan Boswell 对补丁做出了大量额外贡献。<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8739">bpo-8739</a>）</p>
</section>
<section id="smtplib">
<h3 class="translated">smtplib<a class="headerlink" href="#smtplib" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/smtplib.html#smtplib.SMTP" title="smtplib.SMTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMTP</span></code></a>、<a class="reference internal" href="../library/smtplib.html#smtplib.SMTP_SSL" title="smtplib.SMTP_SSL"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMTP_SSL</span></code></a> 和 <a class="reference internal" href="../library/smtplib.html#smtplib.LMTP" title="smtplib.LMTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">LMTP</span></code></a> 类现在接受 <code class="docutils literal notranslate"><span class="pre">source_address</span></code> 关键字参数，用于指定在创建传出套接字时绑定调用中使用的 <code class="docutils literal notranslate"><span class="pre">(host,</span> <span class="pre">port)</span></code> 源地址。（由 Paulo Scardine 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11281">bpo-11281</a> 中贡献。）</p>
<p class="translated"><a class="reference internal" href="../library/smtplib.html#smtplib.SMTP" title="smtplib.SMTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMTP</span></code></a> 现在支持上下文管理协议，允许 <code class="docutils literal notranslate"><span class="pre">SMTP</span></code> 实例在 <code class="docutils literal notranslate"><span class="pre">with</span></code> 语句中使用。（由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11289">bpo-11289</a> 中贡献。）</p>
<p class="translated"><a class="reference internal" href="../library/smtplib.html#smtplib.SMTP_SSL" title="smtplib.SMTP_SSL"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMTP_SSL</span></code></a> 构造函数和 <a class="reference internal" href="../library/smtplib.html#smtplib.SMTP.starttls" title="smtplib.SMTP.starttls"><code class="xref py py-meth docutils literal notranslate"><span class="pre">starttls()</span></code></a> 方法现在接受一个 SSLContext 参数，用于控制安全通道的参数。（由 Kasun Herath 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8809">bpo-8809</a> 中贡献。）</p>
</section>
<section id="socket">
<h3 class="translated">socket<a class="headerlink" href="#socket" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/socket.html#socket.socket" title="socket.socket"><code class="xref py py-class docutils literal notranslate"><span class="pre">socket</span></code></a> 类现在公开了额外的方法，用于在底层平台支持时处理辅助数据：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/socket.html#socket.socket.sendmsg" title="socket.socket.sendmsg"><code class="xref py py-func docutils literal notranslate"><span class="pre">sendmsg()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/socket.html#socket.socket.recvmsg" title="socket.socket.recvmsg"><code class="xref py py-func docutils literal notranslate"><span class="pre">recvmsg()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../library/socket.html#socket.socket.recvmsg_into" title="socket.socket.recvmsg_into"><code class="xref py py-func docutils literal notranslate"><span class="pre">recvmsg_into()</span></code></a></p></li>
</ul>
<p class="translated">（由 David Watson 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=6560">bpo-6560</a> 中贡献，基于 Heiko Wundram 的早期补丁。）</p>
</li>
<li><p class="translated"><a class="reference internal" href="../library/socket.html#socket.socket" title="socket.socket"><code class="xref py py-class docutils literal notranslate"><span class="pre">socket</span></code></a> 类现在支持 Linux 上的 PF_CAN 协议族（<a class="reference external" href="https://en.wikipedia.org/wiki/Socketcan">https://en.wikipedia.org/wiki/Socketcan</a>）。（<a class="reference external" href="https://lwn.net/Articles/253425">https://lwn.net/Articles/253425</a>）</p>
<p class="translated">（由 Matthias Fuchs 贡献，Tiago Gonçalves 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10141">bpo-10141</a> 中更新。）</p>
</li>
<li><p class="translated"><a class="reference internal" href="../library/socket.html#socket.socket" title="socket.socket"><code class="xref py py-class docutils literal notranslate"><span class="pre">socket</span></code></a> 类现在支持 PF_RDS 协议族（<a class="reference external" href="https://en.wikipedia.org/wiki/Reliable_Datagram_Sockets">https://en.wikipedia.org/wiki/Reliable_Datagram_Sockets</a> 和 <a class="reference external" href="https://web.archive.org/web/20130115155505/https://oss.oracle.com/projects/rds/">https://oss.oracle.com/projects/rds</a>）。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/socket.html#socket.socket" title="socket.socket"><code class="xref py py-class docutils literal notranslate"><span class="pre">socket</span></code></a> 类现在支持 OS X 上的 <code class="docutils literal notranslate"><span class="pre">PF_SYSTEM</span></code> 协议族。（由 Michael Goderbauer 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13777">bpo-13777</a> 中贡献。）</p></li>
<li><p class="translated">新函数 <a class="reference internal" href="../library/socket.html#socket.sethostname" title="socket.sethostname"><code class="xref py py-func docutils literal notranslate"><span class="pre">sethostname()</span></code></a> 允许在 Unix 系统上设置主机名，如果调用进程具有足够权限。（由 Ross Lagerwall 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10866">bpo-10866</a> 中贡献。）</p></li>
</ul>
</section>
<section id="socketserver">
<h3 class="translated">socketserver<a class="headerlink" href="#socketserver" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/socketserver.html#socketserver.BaseServer" title="socketserver.BaseServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseServer</span></code></a> 现在有一个可重写的方法 <a class="reference internal" href="../library/socketserver.html#socketserver.BaseServer.service_actions" title="socketserver.BaseServer.service_actions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">service_actions()</span></code></a>，该方法由 <a class="reference internal" href="../library/socketserver.html#socketserver.BaseServer.serve_forever" title="socketserver.BaseServer.serve_forever"><code class="xref py py-meth docutils literal notranslate"><span class="pre">serve_forever()</span></code></a> 方法在服务循环中调用。<a class="reference internal" href="../library/socketserver.html#socketserver.ForkingMixIn" title="socketserver.ForkingMixIn"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForkingMixIn</span></code></a> 现在使用此方法来清理僵尸子进程。（由 Justin Warkentin 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11109">bpo-11109</a> 中贡献。）</p>
</section>
<section id="sqlite3">
<h3 class="translated">sqlite3<a class="headerlink" href="#sqlite3" title="Link to this heading">¶</a></h3>
<p class="translated">新增的 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Connection</span></code></a> 方法 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.set_trace_callback" title="sqlite3.Connection.set_trace_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_trace_callback()</span></code></a> 可被用于捕获由 sqlite 处理的所有 sql 命令的追踪信息。 （由 Torsten Landschoff 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11688">bpo-11688</a> 中贡献。）</p>
</section>
<section id="ssl">
<h3 class="translated">ssl<a class="headerlink" href="#ssl" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#module-ssl" title="ssl: TLS/SSL wrapper for socket objects"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ssl</span></code></a> 新增了两个随机生成函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#ssl.RAND_bytes" title="ssl.RAND_bytes"><code class="xref py py-func docutils literal notranslate"><span class="pre">RAND_bytes()</span></code></a>: 生成高加密强度的伪随机字节数据。</p></li>
<li><p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">RAND_pseudo_bytes()</span></code>: 生成伪随机字节数据。</p></li>
</ul>
<p class="translated">（由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12049">bpo-12049</a> 中贡献。）</p>
</li>
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#module-ssl" title="ssl: TLS/SSL wrapper for socket objects"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ssl</span></code></a> 模块现在公开了一个更细粒度的异常层次结构，以便更容易检查各种错误类型。（由 Antoine Pitrou 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11183">bpo-11183</a> 中贡献。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_cert_chain" title="ssl.SSLContext.load_cert_chain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_cert_chain()</span></code></a> 现在接受一个 <em>password</em> 参数，用于如果私钥被加密时使用。（由 Adam Simpkins 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12803">bpo-12803</a> 中贡献。)</p></li>
<li><p class="translated">现在支持通过 <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_dh_params" title="ssl.SSLContext.load_dh_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_dh_params()</span></code></a> 和 <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_ecdh_curve" title="ssl.SSLContext.set_ecdh_curve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_ecdh_curve()</span></code></a> 方法实现常规和基于椭圆曲线的 Diffie-Hellman 密钥交换。（由 Antoine Pitrou 贡献于 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13626">bpo-13626</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13627">bpo-13627</a>。）</p></li>
<li><p class="translated">SSL 套接字新增了 <a class="reference internal" href="../library/ssl.html#ssl.SSLSocket.get_channel_binding" title="ssl.SSLSocket.get_channel_binding"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_channel_binding()</span></code></a> 方法，允许实现某些认证机制，例如 SCRAM-SHA-1-PLUS。（由 Jacek Konieczny 贡献于 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12551">bpo-12551</a>。）</p></li>
<li><p class="translated">您可以通过新的 <a class="reference internal" href="../library/ssl.html#ssl.SSLSocket.compression" title="ssl.SSLSocket.compression"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compression()</span></code></a> 方法查询 SSL 套接字使用的 SSL 压缩算法。新的属性 <a class="reference internal" href="../library/ssl.html#ssl.OP_NO_COMPRESSION" title="ssl.OP_NO_COMPRESSION"><code class="xref py py-const docutils literal notranslate"><span class="pre">OP_NO_COMPRESSION</span></code></a> 可用于禁用压缩。（由 Antoine Pitrou 贡献于 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13634">bpo-13634</a>。）</p></li>
<li><p class="translated">已添加对使用 <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_npn_protocols" title="ssl.SSLContext.set_npn_protocols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ssl.SSLContext.set_npn_protocols()</span></code></a> 方法的 Next Protocol Negotiation 扩展的支持。（由 Colin Marc 贡献于 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14204">bpo-14204</a>。）</p></li>
<li><p class="translated">由于 <a class="reference internal" href="../library/ssl.html#ssl.SSLError.library" title="ssl.SSLError.library"><code class="xref py py-attr docutils literal notranslate"><span class="pre">library</span></code></a> 和 <a class="reference internal" href="../library/ssl.html#ssl.SSLError.reason" title="ssl.SSLError.reason"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reason</span></code></a> 属性，现在可以更轻松地检查 SSL 错误。（由 Antoine Pitrou 贡献于 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14837">bpo-14837</a>。）</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ssl.html#ssl.get_server_certificate" title="ssl.get_server_certificate"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_server_certificate()</span></code></a> 函数现在支持 IPv6。（由 Charles-François Natali 贡献于 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11811">bpo-11811</a>。）</p></li>
<li><p class="translated">新的属性 <a class="reference internal" href="../library/ssl.html#ssl.OP_CIPHER_SERVER_PREFERENCE" title="ssl.OP_CIPHER_SERVER_PREFERENCE"><code class="xref py py-const docutils literal notranslate"><span class="pre">OP_CIPHER_SERVER_PREFERENCE</span></code></a> 允许将 SSLv3 服务器套接字设置为使用服务器的密码排序偏好，而不是客户端的（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13635">bpo-13635</a>）。</p></li>
</ul>
</section>
<section id="stat">
<h3 class="translated">stat<a class="headerlink" href="#stat" title="Link to this heading">¶</a></h3>
<p class="translated">未文档化的 tarfile.filemode 函数已移至 <a class="reference internal" href="../library/stat.html#stat.filemode" title="stat.filemode"><code class="xref py py-func docutils literal notranslate"><span class="pre">stat.filemode()</span></code></a>。它可用于将文件的模式转换为形式为 '-rwxrwxrwx' 的字符串。</p>
<p class="translated">（由 Giampaolo Rodolà 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14807">bpo-14807</a> 中贡献。）</p>
</section>
<section id="struct">
<h3 class="translated">struct<a class="headerlink" href="#struct" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/struct.html#module-struct" title="struct: Interpret bytes as packed binary data."><code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code></a> 模块现在通过新的代码 <code class="docutils literal notranslate"><span class="pre">n</span></code> 和 <code class="docutils literal notranslate"><span class="pre">N</span></code> 分别支持 <code class="xref c c-type docutils literal notranslate"><span class="pre">ssize_t</span></code> 和 <code class="xref c c-type docutils literal notranslate"><span class="pre">size_t</span></code>。（由 Antoine Pitrou 贡献于 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=3163">bpo-3163</a>。）</p>
</section>
<section id="subprocess">
<h3 class="translated">subprocess<a class="headerlink" href="#subprocess" title="Link to this heading">¶</a></h3>
<p class="translated">在 POSIX 平台上，命令字符串现在可以是字节对象。（由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8513">bpo-8513</a> 中贡献。）</p>
<p class="translated">一个新的常量 <a class="reference internal" href="../library/subprocess.html#subprocess.DEVNULL" title="subprocess.DEVNULL"><code class="xref py py-const docutils literal notranslate"><span class="pre">DEVNULL</span></code></a> 允许以平台独立的方式抑制输出。（由 Ross Lagerwall 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=5870">bpo-5870</a> 中贡献。）</p>
</section>
<section id="sys">
<h3 class="translated">sys<a class="headerlink" href="#sys" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a> 模块新增了一个 <a class="reference internal" href="../library/sys.html#sys.thread_info" title="sys.thread_info"><code class="xref py py-data docutils literal notranslate"><span class="pre">thread_info</span></code></a> <a class="reference internal" href="../glossary.html#term-named-tuple"><span class="xref std std-term">具名元组</span></a>，包含有关线程实现的信息（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11223">bpo-11223</a>）。</p>
</section>
<section id="tarfile">
<h3 class="translated">tarfile<a class="headerlink" href="#tarfile" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a> 现在通过 <a class="reference internal" href="../library/lzma.html#module-lzma" title="lzma: A Python wrapper for the liblzma compression library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">lzma</span></code></a> 模块支持 <code class="docutils literal notranslate"><span class="pre">lzma</span></code> 编码。（由 Lars Gustäbel 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=5689">bpo-5689</a> 中贡献。）</p>
</section>
<section id="tempfile">
<h3 class="translated">tempfile<a class="headerlink" href="#tempfile" title="Link to this heading">¶</a></h3>
<p class="translated">现在 <a class="reference internal" href="../library/tempfile.html#tempfile.SpooledTemporaryFile" title="tempfile.SpooledTemporaryFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">tempfile.SpooledTemporaryFile</span></code></a> 的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">truncate()</span></code> 方法接受 <code class="docutils literal notranslate"><span class="pre">size</span></code> 形参。 （由 Ryan Kelly 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=9957">bpo-9957</a> 中贡献。）.)</p>
</section>
<section id="textwrap">
<h3 class="translated">textwrap<a class="headerlink" href="#textwrap" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/textwrap.html#module-textwrap" title="textwrap: Text wrapping and filling"><code class="xref py py-mod docutils literal notranslate"><span class="pre">textwrap</span></code></a> 模块新增了一个 <a class="reference internal" href="../library/textwrap.html#textwrap.indent" title="textwrap.indent"><code class="xref py py-func docutils literal notranslate"><span class="pre">indent()</span></code></a> 函数，可以方便地为文本块中的选定行添加一个公共前缀（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13857">bpo-13857</a>）。</p>
</section>
<section id="threading">
<h3 class="translated">threading<a class="headerlink" href="#threading" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/threading.html#threading.Condition" title="threading.Condition"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Condition</span></code></a>、<a class="reference internal" href="../library/threading.html#threading.Semaphore" title="threading.Semaphore"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Semaphore</span></code></a>、<a class="reference internal" href="../library/threading.html#threading.BoundedSemaphore" title="threading.BoundedSemaphore"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.BoundedSemaphore</span></code></a>、<a class="reference internal" href="../library/threading.html#threading.Event" title="threading.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Event</span></code></a> 和 <a class="reference internal" href="../library/threading.html#threading.Timer" title="threading.Timer"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Timer</span></code></a>，这些原本是返回类实例的工厂函数，现在都变成了类，并且可以被子类化。（由 Éric Araujo 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10968">bpo-10968</a> 中贡献。）</p>
<p class="translated"><a class="reference internal" href="../library/threading.html#threading.Thread" title="threading.Thread"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Thread</span></code></a> 构造函数现在接受一个 <code class="docutils literal notranslate"><span class="pre">daemon</span></code> 关键字参数，以覆盖从父线程继承 <code class="docutils literal notranslate"><span class="pre">daemon</span></code> 标志值的默认行为（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=6064">bpo-6064</a>）。</p>
<p class="translated">原本私有的函数 <code class="docutils literal notranslate"><span class="pre">_thread.get_ident</span></code> 现在作为公共函数 <a class="reference internal" href="../library/threading.html#threading.get_ident" title="threading.get_ident"><code class="xref py py-func docutils literal notranslate"><span class="pre">threading.get_ident()</span></code></a> 提供。这消除了标准库中直接访问 <code class="docutils literal notranslate"><span class="pre">_thread</span></code> 模块的几种情况。使用 <code class="docutils literal notranslate"><span class="pre">_thread.get_ident</span></code> 的第三方代码也应改为使用新的公共接口。</p>
</section>
<section id="time">
<h3 class="translated">time<a class="headerlink" href="#time" title="Link to this heading">¶</a></h3>
<p class="translated"><span class="target" id="index-100"></span><a class="pep reference external" href="https://peps.python.org/pep-0418/"><strong>PEP 418</strong></a> 向 <a class="reference internal" href="../library/time.html#module-time" title="time: Time access and conversions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">time</span></code></a> 模块添加了新函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/time.html#time.get_clock_info" title="time.get_clock_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_clock_info()</span></code></a>：获取时钟信息。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/time.html#time.monotonic" title="time.monotonic"><code class="xref py py-func docutils literal notranslate"><span class="pre">monotonic()</span></code></a>：单调时钟（不会倒退），不受系统时钟更新影响。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/time.html#time.perf_counter" title="time.perf_counter"><code class="xref py py-func docutils literal notranslate"><span class="pre">perf_counter()</span></code></a>：具有最高可用分辨率的性能计数器，用于测量短时间间隔。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/time.html#time.process_time" title="time.process_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">process_time()</span></code></a>: 当前进程的系统CPU时间和用户CPU时间之和。</p></li>
</ul>
<p class="translated">其他新函数：</p>
<ul class="simple">
<li><p class="translated"><a class="reference internal" href="../library/time.html#time.clock_getres" title="time.clock_getres"><code class="xref py py-func docutils literal notranslate"><span class="pre">clock_getres()</span></code></a>，<a class="reference internal" href="../library/time.html#time.clock_gettime" title="time.clock_gettime"><code class="xref py py-func docutils literal notranslate"><span class="pre">clock_gettime()</span></code></a> 和 <a class="reference internal" href="../library/time.html#time.clock_settime" title="time.clock_settime"><code class="xref py py-func docutils literal notranslate"><span class="pre">clock_settime()</span></code></a> 函数，配合 <code class="samp docutils literal notranslate"><span class="pre">CLOCK_</span><em><span class="pre">xxx</span></em></code> 常量。（由Victor Stinner贡献，见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10278">bpo-10278</a>。）</p></li>
</ul>
<p class="translated">为了提高跨平台一致性，<a class="reference internal" href="../library/time.html#time.sleep" title="time.sleep"><code class="xref py py-func docutils literal notranslate"><span class="pre">sleep()</span></code></a> 现在在传入负数睡眠值时会引发 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。之前在posix上是错误，但在Windows上会导致无限睡眠。</p>
</section>
<section id="types">
<h3 class="translated">types<a class="headerlink" href="#types" title="Link to this heading">¶</a></h3>
<p class="translated">添加新的 <a class="reference internal" href="../library/types.html#types.MappingProxyType" title="types.MappingProxyType"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.MappingProxyType</span></code></a> 类：映射的只读代理。（见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14386">bpo-14386</a>）</p>
<p class="translated">新函数 <a class="reference internal" href="../library/types.html#types.new_class" title="types.new_class"><code class="xref py py-func docutils literal notranslate"><span class="pre">types.new_class()</span></code></a> 和 <a class="reference internal" href="../library/types.html#types.prepare_class" title="types.prepare_class"><code class="xref py py-func docutils literal notranslate"><span class="pre">types.prepare_class()</span></code></a> 提供了对 <span class="target" id="index-101"></span><a class="pep reference external" href="https://peps.python.org/pep-3115/"><strong>PEP 3115</strong></a> 兼容的动态类型创建的支持。（见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14588">bpo-14588</a>）</p>
</section>
<section id="unittest">
<h3 class="translated">unittest<a class="headerlink" href="#unittest" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertRaises" title="unittest.TestCase.assertRaises"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertRaises()</span></code></a>，<a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertRaisesRegex" title="unittest.TestCase.assertRaisesRegex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertRaisesRegex()</span></code></a>，<a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertWarns" title="unittest.TestCase.assertWarns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertWarns()</span></code></a> 和 <a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertWarnsRegex" title="unittest.TestCase.assertWarnsRegex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertWarnsRegex()</span></code></a> 现在接受一个关键字参数 <em>msg</em>，当用作上下文管理器时。（由Ezio Melotti和Winston Ewert贡献，见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10775">bpo-10775</a>。）</p>
<p class="translated"><a class="reference internal" href="../library/unittest.html#unittest.TestCase.run" title="unittest.TestCase.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestCase.run()</span></code></a> 现在返回 <a class="reference internal" href="../library/unittest.html#unittest.TestResult" title="unittest.TestResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestResult</span></code></a> 对象。</p>
</section>
<section id="urllib">
<h3 class="translated">urllib<a class="headerlink" href="#urllib" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> 类现在接受一个 <em>method</em> 参数，由 <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.get_method" title="urllib.request.Request.get_method"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_method()</span></code></a> 用于确定应使用哪种HTTP方法。例如，这将发送一个 <code class="docutils literal notranslate"><span class="pre">'HEAD'</span></code> 请求：</p>
<div class="translated highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urlopen</span><span class="p">(</span><span class="n">Request</span><span class="p">(</span><span class="s1">&#39;https://www.python.org&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;HEAD&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p class="translated">（见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=1673007">bpo-1673007</a>）</p>
</section>
<section id="webbrowser">
<h3 class="translated">webbrowser<a class="headerlink" href="#webbrowser" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/webbrowser.html#module-webbrowser" title="webbrowser: Easy-to-use controller for web browsers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">webbrowser</span></code></a> 模块支持更多的“浏览器”：Google Chrome（根据版本和操作系统命名为 <strong class="program">chrome</strong>，<strong class="program">chromium</strong>，<strong class="program">chrome-browser</strong> 或 <strong class="program">chromium-browser</strong>），以及通用的启动器 <strong class="program">xdg-open</strong> (来自FreeDesktop.org项目) 和 <strong class="program">gvfs-open`（GNOME 3的默认URI处理程序）。（前者由Arnaud Calmettes贡献，见 :issue:`13620</strong>，后者由Matthias Klose贡献，见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14493">bpo-14493</a>。）</p>
</section>
<section id="xml-etree-elementtree">
<h3 class="translated">xml.etree.ElementTree<a class="headerlink" href="#xml-etree-elementtree" title="Link to this heading">¶</a></h3>
<p class="untranslated">The <a class="reference internal" href="../library/xml.etree.elementtree.html#module-xml.etree.ElementTree" title="xml.etree.ElementTree: Implementation of the ElementTree API."><code class="xref py py-mod docutils literal notranslate"><span class="pre">xml.etree.ElementTree</span></code></a> module now imports its C accelerator by
default; there is no longer a need to explicitly import
<code class="xref py py-mod docutils literal notranslate"><span class="pre">xml.etree.cElementTree</span></code> (this module stays for backwards compatibility,
but is now deprecated).  In addition,  the <code class="docutils literal notranslate"><span class="pre">iter</span></code> family of methods of
<a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.Element" title="xml.etree.ElementTree.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> has been optimized (rewritten in C).
The module's documentation has also been greatly improved with added examples
and a more detailed reference.</p>
</section>
<section id="zlib">
<h3 class="translated">zlib<a class="headerlink" href="#zlib" title="Link to this heading">¶</a></h3>
<p class="translated">新属性 <a class="reference internal" href="../library/zlib.html#zlib.Decompress.eof" title="zlib.Decompress.eof"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zlib.Decompress.eof</span></code></a> 使得可以区分正确形成的压缩流和不完整或截断的压缩流。（由 Nadeem Vawda 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12646">bpo-12646</a> 中贡献。）</p>
<p class="translated">新属性 <a class="reference internal" href="../library/zlib.html#zlib.ZLIB_RUNTIME_VERSION" title="zlib.ZLIB_RUNTIME_VERSION"><code class="xref py py-const docutils literal notranslate"><span class="pre">zlib.ZLIB_RUNTIME_VERSION</span></code></a> 报告在运行时加载的底层 <code class="docutils literal notranslate"><span class="pre">zlib</span></code> 库的版本字符串。（由 Torsten Landschoff 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12306">bpo-12306</a> 中贡献。）</p>
</section>
</section>
<section id="optimizations">
<h2 class="translated">性能优化<a class="headerlink" href="#optimizations" title="Link to this heading">¶</a></h2>
<p class="translated">已增加的主要性能改善:</p>
<ul>
<li><p class="translated">得益于 <span class="target" id="index-102"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a>，Unicode 字符串的某些操作已得到优化：</p>
<ul class="simple">
<li><p class="translated">内存占用根据文本内容减少到原来的 1/2 到 1/4。</p></li>
<li><p class="translated">将 ASCII 字符串编码为 UTF-8 不再需要对字符进行编码，UTF-8 的表示法与 ASCII 的表示法是共享的</p></li>
<li><p class="translated">UTF-8 编码器已优化。</p></li>
<li><p class="translated">重复单个 ASCII 字母和获取 ASCII 字符串的子字符串的速度提高了 4 倍。</p></li>
</ul>
</li>
<li><p class="translated">UTF-8 编码现在快 2 到 4 倍。  UTF-16 编码的速度现在提高了 10 倍。</p>
<p class="translated">（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14624">bpo-14624</a>、 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14738">bpo-14738</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=15026">bpo-15026</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="build-and-c-api-changes">
<h2 class="translated">构建和 C API 的改变<a class="headerlink" href="#build-and-c-api-changes" title="Link to this heading">¶</a></h2>
<p class="translated">针对 Python 构建过程和 C API 的改变包括:</p>
<ul class="simple">
<li><p class="translated">新的 <span class="target" id="index-103"></span><a class="pep reference external" href="https://peps.python.org/pep-3118/"><strong>PEP 3118</strong></a> 相关功能：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../c-api/memoryview.html#c.PyMemoryView_FromMemory" title="PyMemoryView_FromMemory"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMemoryView_FromMemory()</span></code></a></p></li>
</ul>
</li>
<li><p class="translated"><span class="target" id="index-104"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a> 添加了新的 Unicode 类型，宏和函数：</p>
<ul>
<li><p class="translated">高阶 API：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_CopyCharacters" title="PyUnicode_CopyCharacters"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_CopyCharacters()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FindChar" title="PyUnicode_FindChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FindChar()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_GetLength" title="PyUnicode_GetLength"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GetLength()</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_GET_LENGTH" title="PyUnicode_GET_LENGTH"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_GET_LENGTH</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_New" title="PyUnicode_New"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_New()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Substring" title="PyUnicode_Substring"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Substring()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_ReadChar" title="PyUnicode_ReadChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_ReadChar()</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_WriteChar" title="PyUnicode_WriteChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_WriteChar()</span></code></a></p></li>
</ul>
</li>
<li><p class="translated">低阶 API:</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.Py_UCS1" title="Py_UCS1"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UCS1</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.Py_UCS2" title="Py_UCS2"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UCS2</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.Py_UCS4" title="Py_UCS4"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UCS4</span></code></a> 类型</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyASCIIObject" title="PyASCIIObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyASCIIObject</span></code></a> 和 <a class="reference internal" href="../c-api/unicode.html#c.PyCompactUnicodeObject" title="PyCompactUnicodeObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyCompactUnicodeObject</span></code></a> 结构</p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_READY" title="PyUnicode_READY"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_READY</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FromKindAndData" title="PyUnicode_FromKindAndData"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FromKindAndData()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsUCS4" title="PyUnicode_AsUCS4"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUCS4()</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsUCS4Copy" title="PyUnicode_AsUCS4Copy"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUCS4Copy()</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_DATA" title="PyUnicode_DATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_DATA</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_1BYTE_DATA" title="PyUnicode_1BYTE_DATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_1BYTE_DATA</span></code></a>,
<a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_2BYTE_DATA" title="PyUnicode_2BYTE_DATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_2BYTE_DATA</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_4BYTE_DATA" title="PyUnicode_4BYTE_DATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_4BYTE_DATA</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_KIND" title="PyUnicode_KIND"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_KIND</span></code></a> 使用 <code class="xref c c-enum docutils literal notranslate"><span class="pre">PyUnicode_Kind</span></code> 枚举: <code class="xref c c-data docutils literal notranslate"><span class="pre">PyUnicode_WCHAR_KIND</span></code>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_1BYTE_KIND" title="PyUnicode_1BYTE_KIND"><code class="xref c c-data docutils literal notranslate"><span class="pre">PyUnicode_1BYTE_KIND</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_2BYTE_KIND" title="PyUnicode_2BYTE_KIND"><code class="xref c c-data docutils literal notranslate"><span class="pre">PyUnicode_2BYTE_KIND</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_4BYTE_KIND" title="PyUnicode_4BYTE_KIND"><code class="xref c c-data docutils literal notranslate"><span class="pre">PyUnicode_4BYTE_KIND</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_READ" title="PyUnicode_READ"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_READ</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_READ_CHAR" title="PyUnicode_READ_CHAR"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_READ_CHAR</span></code></a>, <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_WRITE" title="PyUnicode_WRITE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_WRITE</span></code></a></p></li>
<li><p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_MAX_CHAR_VALUE" title="PyUnicode_MAX_CHAR_VALUE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_MAX_CHAR_VALUE</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../c-api/arg.html#c.PyArg_ParseTuple" title="PyArg_ParseTuple"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyArg_ParseTuple</span></code></a> 现在接受 <code class="docutils literal notranslate"><span class="pre">c</span></code> 格式的 <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12380">bpo-12380</a>)。</p></li>
</ul>
</section>
<section id="deprecated">
<h2 class="translated">弃用<a class="headerlink" href="#deprecated" title="Link to this heading">¶</a></h2>
<section id="unsupported-operating-systems">
<h3 class="translated">不支持的操作系统<a class="headerlink" href="#unsupported-operating-systems" title="Link to this heading">¶</a></h3>
<p class="translated">由于缺少维护人员，不再支持 OS/2 和 VMS 系统 。</p>
<p class="translated">由于维护负担，将 <code class="docutils literal notranslate"><span class="pre">COMSPEC</span></code> 设置为 <code class="docutils literal notranslate"><span class="pre">command.com</span></code> 的 Windows平台（含Windows 2000）不再受支持。</p>
<p class="translated">OSF支持在3.2中被弃用，现在已经被完全删除。</p>
</section>
<section id="deprecated-python-modules-functions-and-methods">
<h3 class="translated">已弃用的 Python 模块、函数和方法<a class="headerlink" href="#deprecated-python-modules-functions-and-methods" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">向 <code class="docutils literal notranslate"><span class="pre">object.__format__()</span></code> 传递非空字符串的做法已被弃用，在 Python 3.4 中会产生一个 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=9856">bpo-9856</a>)。</p></li>
<li><p class="translated">由于 <span class="target" id="index-105"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a>，<code class="docutils literal notranslate"><span class="pre">unicode_internal</span></code> 编解码器已被弃用。 请使用 UTF-8、UTF-16 (<code class="docutils literal notranslate"><span class="pre">utf-16-le</span></code> 或 <code class="docutils literal notranslate"><span class="pre">utf-16-be</span></code>) 或 UTF-32 (<code class="docutils literal notranslate"><span class="pre">utf-32-le</span></code> 或 <code class="docutils literal notranslate"><span class="pre">utf-32-be</span></code>)</p></li>
<li><p class="translated"><a class="reference internal" href="../library/ftplib.html#ftplib.FTP.nlst" title="ftplib.FTP.nlst"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ftplib.FTP.nlst()</span></code></a> 和 <a class="reference internal" href="../library/ftplib.html#ftplib.FTP.dir" title="ftplib.FTP.dir"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ftplib.FTP.dir()</span></code></a>：使用 <a class="reference internal" href="../library/ftplib.html#ftplib.FTP.mlsd" title="ftplib.FTP.mlsd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ftplib.FTP.mlsd()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">platform.popen()</span></code>: 使用 <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> 模块。 特别查看 <a class="reference internal" href="../library/subprocess.html#subprocess-replacements"><span class="std std-ref">使用 subprocess 模块替换旧函数</span></a> 小节 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11377">bpo-11377</a>)。</p></li>
<li><p class="translated"><a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13374">bpo-13374</a>：在 <a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块中，Windows 字节 API 已不推荐使用。使用 Unicode 文件名，而不是字节文件名，以便不再依赖 ANSI 代码页并支持任何文件名。</p></li>
<li><p class="translated"><a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13988">bpo-13988</a>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">xml.etree.cElementTree</span></code> 模块已被弃用。 将会在可能的情况下自动使用加速器。</p></li>
<li><p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.clock()</span></code> 的行为依赖于具体平台：请根据你的需求改用新的 <a class="reference internal" href="../library/time.html#time.perf_counter" title="time.perf_counter"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.perf_counter()</span></code></a> 或 <a class="reference internal" href="../library/time.html#time.process_time" title="time.process_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.process_time()</span></code></a> 函数，以获得具有良好定义的行为。</p></li>
<li><p class="translated"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.stat_float_times()</span></code> 函数已被弃用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/abc.html#module-abc" title="abc: Abstract base classes according to :pep:`3119`."><code class="xref py py-mod docutils literal notranslate"><span class="pre">abc</span></code></a> 模块：</p>
<ul>
<li><p class="translated"><a class="reference internal" href="../library/abc.html#abc.abstractproperty" title="abc.abstractproperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.abstractproperty</span></code></a> 已被弃用，改为 <a class="reference internal" href="../library/functions.html#property" title="property"><code class="xref py py-class docutils literal notranslate"><span class="pre">property</span></code></a> 配合 <a class="reference internal" href="../library/abc.html#abc.abstractmethod" title="abc.abstractmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">abc.abstractmethod()</span></code></a> 使用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/abc.html#abc.abstractclassmethod" title="abc.abstractclassmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.abstractclassmethod</span></code></a> 已被弃用，改为 <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code></a> 配合 <a class="reference internal" href="../library/abc.html#abc.abstractmethod" title="abc.abstractmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">abc.abstractmethod()</span></code></a> 使用。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/abc.html#abc.abstractstaticmethod" title="abc.abstractstaticmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.abstractstaticmethod</span></code></a> 已被弃用，改为 <a class="reference internal" href="../library/functions.html#staticmethod" title="staticmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">staticmethod</span></code></a> 配合 <a class="reference internal" href="../library/abc.html#abc.abstractmethod" title="abc.abstractmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">abc.abstractmethod()</span></code></a> 使用。</p></li>
</ul>
</li>
<li><p class="translated"><a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> 包：</p>
<ul>
<li><p class="translated">现在 <a class="reference internal" href="../library/importlib.html#importlib.abc.SourceLoader.path_mtime" title="importlib.abc.SourceLoader.path_mtime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.abc.SourceLoader.path_mtime()</span></code></a> 已被弃用而应改用 <a class="reference internal" href="../library/importlib.html#importlib.abc.SourceLoader.path_stats" title="importlib.abc.SourceLoader.path_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.abc.SourceLoader.path_stats()</span></code></a> ，因为字节码文件现在会同时储存编译出该字节码文件的源文件的修改时间和大小。</p></li>
</ul>
</li>
</ul>
</section>
<section id="deprecated-functions-and-types-of-the-c-api">
<h3 class="translated">已弃用的 C API 函数和类型<a class="headerlink" href="#deprecated-functions-and-types-of-the-c-api" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UNICODE</span></code></a> 已经在 <span class="target" id="index-106"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a> 弃用，并将于 Python 4 中移除。所有使用此类型的函数都已弃用：</p>
<p class="translated">使用 <a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UNICODE</span></code></a> 和 <span class="c-expr sig sig-inline c"><a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><span class="n">Py_UNICODE</span></a><span class="p">*</span></span> 类型的 Unicode 函数和方法：</p>
<ul class="simple">
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_FromUnicode</span></code>：使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FromWideChar" title="PyUnicode_FromWideChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FromWideChar()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FromKindAndData" title="PyUnicode_FromKindAndData"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FromKindAndData()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_AS_UNICODE</span></code>、 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUnicode()</span></code>、 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUnicodeAndSize()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsWideCharString" title="PyUnicode_AsWideCharString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsWideCharString()</span></code></a>。</p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_AS_DATA</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_DATA" title="PyUnicode_DATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_DATA</span></code></a> 结合 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_READ" title="PyUnicode_READ"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_READ</span></code></a> 和 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_WRITE" title="PyUnicode_WRITE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_WRITE</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_GET_SIZE</span></code>、 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GetSize()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_GET_LENGTH" title="PyUnicode_GET_LENGTH"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_GET_LENGTH</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_GetLength" title="PyUnicode_GetLength"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GetLength()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_GET_DATA_SIZE</span></code>: 使用 <code class="docutils literal notranslate"><span class="pre">PyUnicode_GET_LENGTH(str)</span> <span class="pre">*</span> <span class="pre">PyUnicode_KIND(str)</span></code> (仅适用于已准备好的字符串)</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUnicodeCopy()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsUCS4Copy" title="PyUnicode_AsUCS4Copy"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUCS4Copy()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsWideCharString" title="PyUnicode_AsWideCharString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsWideCharString()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GetMax()</span></code></p></li>
</ul>
<p class="translated">操作 Py_UNICODE* 字符串的函数和宏：</p>
<ul class="simple">
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strlen()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_GetLength" title="PyUnicode_GetLength"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GetLength()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_GET_LENGTH" title="PyUnicode_GET_LENGTH"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_GET_LENGTH</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strcat()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_CopyCharacters" title="PyUnicode_CopyCharacters"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_CopyCharacters()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FromFormat" title="PyUnicode_FromFormat"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FromFormat()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strcpy()</span></code>, <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strncpy()</span></code>, <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_COPY()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_CopyCharacters" title="PyUnicode_CopyCharacters"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_CopyCharacters()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Substring" title="PyUnicode_Substring"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Substring()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strcmp()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Compare" title="PyUnicode_Compare"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Compare()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strncmp()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Tailmatch" title="PyUnicode_Tailmatch"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Tailmatch()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strchr()</span></code>, <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_strrchr()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FindChar" title="PyUnicode_FindChar"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FindChar()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_FILL()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Fill" title="PyUnicode_Fill"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Fill()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_MATCH</span></code></p></li>
</ul>
<p class="translated">编码器:</p>
<ul class="simple">
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Encode()</span></code>: 使用 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsEncodedObject()</span></code></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF7()</span></code></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF8()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsUTF8" title="PyUnicode_AsUTF8"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUTF8()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsUTF8String" title="PyUnicode_AsUTF8String"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUTF8String()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF32()</span></code></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF16()</span></code></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUnicodeEscape()</span></code> 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsUnicodeEscapeString" title="PyUnicode_AsUnicodeEscapeString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUnicodeEscapeString()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeRawUnicodeEscape()</span></code> 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsRawUnicodeEscapeString" title="PyUnicode_AsRawUnicodeEscapeString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsRawUnicodeEscapeString()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeLatin1()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsLatin1String" title="PyUnicode_AsLatin1String"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsLatin1String()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeASCII()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsASCIIString" title="PyUnicode_AsASCIIString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsASCIIString()</span></code></a></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeCharmap()</span></code></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_TranslateCharmap()</span></code></p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeMBCS()</span></code>: 使用 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_AsMBCSString" title="PyUnicode_AsMBCSString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsMBCSString()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_EncodeCodePage" title="PyUnicode_EncodeCodePage"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeCodePage()</span></code></a> (用 <code class="docutils literal notranslate"><span class="pre">CP_ACP</span></code> code_page)</p></li>
<li><p class="translated"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeDecimal()</span></code>、 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_TransformDecimalToASCII()</span></code></p></li>
</ul>
</section>
<section id="deprecated-features">
<h3 class="translated">弃用的特性<a class="headerlink" href="#deprecated-features" title="Link to this heading">¶</a></h3>
<p class="translated"><a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal notranslate"><span class="pre">array</span></code></a> 模块的 <code class="docutils literal notranslate"><span class="pre">'u'</span></code> 格式代码现已弃用，将在 Python 4 中与 (<a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UNICODE</span></code></a>) API 的其他部分一起删除。</p>
</section>
</section>
<section id="porting-to-python-3-3">
<h2 class="translated">移植到 Python 3.3<a class="headerlink" href="#porting-to-python-3-3" title="Link to this heading">¶</a></h2>
<p class="translated">本节列出了先前描述的更改以及可能需要更改代码的其他错误修正.</p>
<section id="porting-python-code">
<span id="portingpythoncode"></span><h3 class="translated">移植 Python 代码<a class="headerlink" href="#porting-python-code" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p class="translated">默认启用哈希随机化。 将 <span class="target" id="index-107"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONHASHSEED"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHASHSEED</span></code></a> 环境变量设为 <code class="docutils literal notranslate"><span class="pre">0</span></code> 可禁用哈希随机化。 另请参阅 <a class="reference internal" href="../reference/datamodel.html#object.__hash__" title="object.__hash__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">object.__hash__()</span></code></a> 方法。</p></li>
<li><p class="translated"><a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12326">bpo-12326</a>: 在 Linux 上，sys.platform 不再包含主要版本。现在它始终是 &quot;linux&quot;，而不是 &quot;linux2&quot; 或 &quot;linux3&quot;，这取决于用于构建 Python 的 Linux 版本。请用 sys.platform.startswith('linux') 替换 sys.platform == 'linux2'，如果不需要支持较旧的 Python 版本，则可直接替换成 sys.platform == 'linux'。</p></li>
<li><p class="translated"><a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13847">bpo-13847</a>、 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14180">bpo-14180</a>: <a class="reference internal" href="../library/time.html#module-time" title="time: Time access and conversions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">time</span></code></a> 和 <a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a>: 现在如果时间戳超出范围将会引发 <a class="reference internal" href="../library/exceptions.html#OverflowError" title="OverflowError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OverflowError</span></code></a> 而不是 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。 现在如果 C 函数 <code class="xref c c-func docutils literal notranslate"><span class="pre">gmtime()</span></code> 或 <code class="xref c c-func docutils literal notranslate"><span class="pre">localtime()</span></code> 失败将会引发 <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a>。</p></li>
<li><p class="translated">import 使用的默认查找器现在利用特定目录内容的缓存。如果您创建了一个 Python 源文件或无源字节码文件，请确保调用 <a class="reference internal" href="../library/importlib.html#importlib.invalidate_caches" title="importlib.invalidate_caches"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.invalidate_caches()</span></code></a> 以清除缓存，以便查找器能够注意到新文件。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/exceptions.html#ImportError" title="ImportError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ImportError</span></code></a> 现在使用尝试导入的模块的完整名称。检查 ImportError 消息的 doctest 需要更新为使用模块的完整名称，而不仅仅是名称的尾部。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/functions.html#import__" title="__import__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__import__()</span></code></a> 函数的 <em>index</em> 参数现在默认值为 0，而不是 -1，并且不再支持负值。在实现 <span class="target" id="index-108"></span><a class="pep reference external" href="https://peps.python.org/pep-0328/"><strong>PEP 328</strong></a> 时，默认值仍为 -1 是一个疏忽。如果你需要继续执行相对导入后再进行绝对导入，可以使用索引为 1 的相对导入，然后再使用索引为 0 的另一个导入。不过，建议使用 <a class="reference internal" href="../library/importlib.html#importlib.import_module" title="importlib.import_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.import_module()</span></code></a> 而不是直接调用 <a class="reference internal" href="../library/functions.html#import__" title="__import__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__import__()</span></code></a>。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/functions.html#import__" title="__import__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__import__()</span></code></a> 不再允许对顶层模块使用除 0 以外的索引值。例如，<code class="docutils literal notranslate"><span class="pre">__import__('sys',</span> <span class="pre">level=1)</span></code> 现在是一个错误。</p></li>
<li><p class="translated">因为 <a class="reference internal" href="../library/sys.html#sys.meta_path" title="sys.meta_path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.meta_path</span></code></a> 和 <a class="reference internal" href="../library/sys.html#sys.path_hooks" title="sys.path_hooks"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_hooks</span></code></a> 上现在默认具有查找器，你很可能会希望使用 <a class="reference internal" href="../library/stdtypes.html#list.insert" title="list.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list.insert()</span></code></a> 而不是 <a class="reference internal" href="../library/stdtypes.html#list.append" title="list.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list.append()</span></code></a> 来向列表添加元素。</p></li>
<li><p class="translated">由于 <code class="docutils literal notranslate"><span class="pre">None</span></code> 现在会被插入到 <a class="reference internal" href="../library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_importer_cache</span></code></a> 中，如果你正在清除路径字典中没有查找器的条目，你需要移除与 <code class="docutils literal notranslate"><span class="pre">None</span></code> <strong>和</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">imp.NullImporter</span></code> 配对的键，以保持向后兼容。这在旧版本的 Python 中会导致额外的开销，因为它们会重新将 <code class="docutils literal notranslate"><span class="pre">None</span></code> 插入到 <a class="reference internal" href="../library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_importer_cache</span></code></a> 中，表示使用隐式查找器，但从语义上讲，这不应改变任何内容。</p></li>
<li><p class="translated"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.Finder</span></code> 不再指定必须实现的 <code class="docutils literal notranslate"><span class="pre">find_module()</span></code> 抽象方法。如果你依赖于子类实现该方法，请确保首先检查该方法的存在。不过，在处理 <a class="reference internal" href="../glossary.html#term-path-entry-finder"><span class="xref std std-term">路径条目查找器</span></a> 时，你可能首先需要检查 <code class="docutils literal notranslate"><span class="pre">find_loader()</span></code>。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/pkgutil.html#module-pkgutil" title="pkgutil: Utilities for the import system."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pkgutil</span></code></a> 已内部转换为使用 <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a>。这消除了许多边缘情况，在这些情况下，旧的 <span class="target" id="index-109"></span><a class="pep reference external" href="https://peps.python.org/pep-0302/"><strong>PEP 302</strong></a> 导入模拟行为未能与真实导入系统的行为匹配。导入模拟本身仍然存在，但现在已被弃用。<a class="reference internal" href="../library/pkgutil.html#pkgutil.iter_importers" title="pkgutil.iter_importers"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkgutil.iter_importers()</span></code></a> 和 <a class="reference internal" href="../library/pkgutil.html#pkgutil.walk_packages" title="pkgutil.walk_packages"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkgutil.walk_packages()</span></code></a> 函数特别处理标准导入钩子，因此它们仍然受支持，尽管它们不提供非标准的 <code class="docutils literal notranslate"><span class="pre">iter_modules()</span></code> 方法。</p></li>
<li><p class="translated">在 <a class="reference internal" href="../library/email.header.html#email.header.decode_header" title="email.header.decode_header"><code class="xref py py-func docutils literal notranslate"><span class="pre">email.header.decode_header()</span></code></a> 所做的解析中，一个长期存在的 RFC 兼容性错误 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=1079">bpo-1079</a>) 已被修复。使用标准习惯用法将编码的头部转换为 unicode（<code class="docutils literal notranslate"><span class="pre">str(make_header(decode_header(h)))</span></code>）的代码将看不到任何变化，但查看 decode_header 返回的各个元组的代码将看到，现在 <code class="docutils literal notranslate"><span class="pre">ASCII</span></code> 部分前后的空白符被包含在 <code class="docutils literal notranslate"><span class="pre">ASCII</span></code> 部分中。使用 <code class="docutils literal notranslate"><span class="pre">make_header</span></code> 构建头部的代码也应继续工作而无需更改，因为 <code class="docutils literal notranslate"><span class="pre">make_header</span></code> 在输入字符串中未显式包含空白字符时，仍会继续在 <code class="docutils literal notranslate"><span class="pre">ASCII</span></code> 和非 <code class="docutils literal notranslate"><span class="pre">ASCII</span></code> 部分之间添加空白符。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/email.utils.html#email.utils.formataddr" title="email.utils.formataddr"><code class="xref py py-func docutils literal notranslate"><span class="pre">email.utils.formataddr()</span></code></a> 现在在传递非 <code class="docutils literal notranslate"><span class="pre">ASCII</span></code> 显示名称时执行正确的内容传输编码。任何依赖于以前错误行为（在格式化的输出字符串中保留非 <code class="docutils literal notranslate"><span class="pre">ASCII</span></code> unicode）的代码都需要更改 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=1690608">bpo-1690608</a>)。</p></li>
<li><p class="translated"><a class="reference internal" href="../library/poplib.html#poplib.POP3.quit" title="poplib.POP3.quit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">poplib.POP3.quit()</span></code></a> 现在可能会像所有其他 <code class="docutils literal notranslate"><span class="pre">poplib</span></code> 方法一样引发协议错误。假设 <code class="docutils literal notranslate"><span class="pre">quit</span></code> 不引发 <a class="reference internal" href="../library/poplib.html#poplib.error_proto" title="poplib.error_proto"><code class="xref py py-exc docutils literal notranslate"><span class="pre">poplib.error_proto</span></code></a> 错误的代码，如果特定应用程序在 <code class="docutils literal notranslate"><span class="pre">quit</span></code> 时遇到错误，可能需要更改 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11291">bpo-11291</a>)。</p></li>
<li><p class="translated">自 Python 2.4 起被弃用的 <a class="reference internal" href="../library/email.parser.html#email.parser.Parser" title="email.parser.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">email.parser.Parser</span></code></a> 的 <code class="docutils literal notranslate"><span class="pre">strict</span></code> 参数已被最终移除。</p></li>
<li><p class="translated">已被弃用的方法 <code class="docutils literal notranslate"><span class="pre">unittest.TestCase.assertSameElements</span></code> 已被移除。</p></li>
<li><p class="translated">已被弃用的变量 <code class="docutils literal notranslate"><span class="pre">time.accept2dyear</span></code> 已被移除。</p></li>
<li><p class="translated">已被弃用的 <code class="docutils literal notranslate"><span class="pre">Context._clamp</span></code> 属性已从 <a class="reference internal" href="../library/decimal.html#module-decimal" title="decimal: Implementation of the General Decimal Arithmetic Specification."><code class="xref py py-mod docutils literal notranslate"><span class="pre">decimal</span></code></a> 模块中移除。 在此之前它已被公有属性 <a class="reference internal" href="../library/decimal.html#decimal.Context.clamp" title="decimal.Context.clamp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">clamp</span></code></a> 取代。 （参见 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=8540">bpo-8540</a>。）</p></li>
<li><p class="translated">未记录的内部辅助类 <code class="docutils literal notranslate"><span class="pre">SSLFakeFile</span></code> 已从 <a class="reference internal" href="../library/smtplib.html#module-smtplib" title="smtplib: SMTP protocol client (requires sockets)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">smtplib</span></code></a> 中移除，因为其功能早已直接由 <a class="reference internal" href="../library/socket.html#socket.socket.makefile" title="socket.socket.makefile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">socket.socket.makefile()</span></code></a> 提供。</p></li>
<li><p class="translated">在 Windows 上向 <a class="reference internal" href="../library/time.html#time.sleep" title="time.sleep"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.sleep()</span></code></a> 传递负值现在会引发错误，而不是永远休眠。在 POSIX 上它一直会引发错误。</p></li>
<li><p class="translated"><code class="docutils literal notranslate"><span class="pre">ast.__version__</span></code> 常量已被移除。如果需要根据 AST 版本做出决策，请使用 <a class="reference internal" href="../library/sys.html#sys.version_info" title="sys.version_info"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.version_info</span></code></a> 来进行决策。</p></li>
<li><p class="translated">过去那些通过继承私有类来绕过 <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a> 模块使用工厂函数限制的代码，现在需要调整为继承新公开的类。</p></li>
<li><p class="translated">threading 模块中未记录的调试机制已被移除，简化了代码。这对生产代码应无影响，但在此提及以防有应用程序调试框架与其交互 (<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=13550">bpo-13550</a>)。</p></li>
</ul>
</section>
<section id="porting-c-code">
<h3 class="translated">移植 C 代码<a class="headerlink" href="#porting-c-code" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">在改用缓冲区 API 的过程中未写入文档的 <a class="reference internal" href="../c-api/buffer.html#c.Py_buffer" title="Py_buffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_buffer</span></code></a> 结构体成员 <code class="xref c c-member docutils literal notranslate"><span class="pre">smalltable</span></code> 已被移除而 <code class="xref c c-type docutils literal notranslate"><span class="pre">PyMemoryViewObject</span></code> 的布局已发生变化。</p>
<p class="translated">所有依赖于 <code class="docutils literal notranslate"><span class="pre">memoryobject.h</span></code> 或 <code class="docutils literal notranslate"><span class="pre">object.h</span></code> 中相关部分的扩展必须重新构建。</p>
</li>
<li><p class="translated">由于 <a class="reference internal" href="#pep-393"><span class="std std-ref">PEP 393</span></a>，<a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UNICODE</span></code></a> 类型及所有使用此类型的功能已被弃用（但至少在未来五年内仍将可用）。如果您曾使用低级 Unicode API 来构造和访问 Unicode 对象，并希望受益于 <span class="target" id="index-110"></span><a class="pep reference external" href="https://peps.python.org/pep-0393/"><strong>PEP 393</strong></a> 提供的内存占用减少，您必须将代码转换为新的 <a class="reference internal" href="../c-api/unicode.html"><span class="doc">Unicode API</span></a>。</p>
<p class="translated">然而，如果您仅使用过高级函数如 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Concat" title="PyUnicode_Concat"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Concat()</span></code></a>、<a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_Join" title="PyUnicode_Join"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_Join()</span></code></a> 或 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FromFormat" title="PyUnicode_FromFormat"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FromFormat()</span></code></a>，您的代码将自动利用新的 Unicode 表示形式。</p>
</li>
<li><p class="translated"><a class="reference internal" href="../c-api/import.html#c.PyImport_GetMagicNumber" title="PyImport_GetMagicNumber"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_GetMagicNumber()</span></code></a> 在失败时现在返回 <code class="docutils literal notranslate"><span class="pre">-1</span></code>。</p></li>
<li><p class="translated">由于 <em>level</em> 参数的负值对 <a class="reference internal" href="../library/functions.html#import__" title="__import__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__import__()</span></code></a> 已不再有效，同样的情况现在也适用于 <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleLevel" title="PyImport_ImportModuleLevel"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleLevel()</span></code></a>。这也意味着 <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleEx" title="PyImport_ImportModuleEx"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleEx()</span></code></a> 使用的 <em>level</em> 值现在是 <code class="docutils literal notranslate"><span class="pre">0</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">-1</span></code>。</p></li>
</ul>
</section>
<section id="building-c-extensions">
<h3 class="translated">构建 C 扩展<a class="headerlink" href="#building-c-extensions" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">C 扩展的可能文件名范围已经缩小。非常少用的拼写已被抑制：在 POSIX 下，名为 <code class="docutils literal notranslate"><span class="pre">xxxmodule.so</span></code>、<code class="docutils literal notranslate"><span class="pre">xxxmodule.abi3.so</span></code> 和 <code class="docutils literal notranslate"><span class="pre">xxxmodule.cpython-*.so</span></code> 的文件不再被识别为实现了 <code class="docutils literal notranslate"><span class="pre">xxx</span></code> 模块。如果你之前生成了这样的文件，你必须切换到其他拼写（即，从文件名中移除 <code class="docutils literal notranslate"><span class="pre">module</span></code> 字符串）。</p>
<p class="translated">（在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=14040">bpo-14040</a> 中实现。）</p>
</li>
</ul>
</section>
<section id="command-line-switch-changes">
<h3 class="translated">命令行开关的变化<a class="headerlink" href="#command-line-switch-changes" title="Link to this heading">¶</a></h3>
<ul>
<li><p class="translated">删除了 -Q命令行旗标和相关工具。 检查 sys.flags.division_warning 的代码需要更新。</p>
<p class="translated">（由 Éric Araujo 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=10998">bpo-10998</a> 中贡献。）</p>
</li>
<li><p class="translated">当 <strong class="program">python</strong> 附带 <a class="reference internal" href="../using/cmdline.html#cmdoption-S"><code class="xref std std-option docutils literal notranslate"><span class="pre">-S</span></code></a> 启动时，<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">site</span></code> 将不再向模块搜索路径添加 site 专属路径。 在之前版本中则会这样做。</p>
<p class="translated">（由 Carl Meyer 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=11591">bpo-11591</a> 中贡献并由 Éric Araujo 进行修改。）</p>
</li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.3 有什么新变化</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">摘要 -- 发布重点</a></li>
<li><a class="reference internal" href="#pep-405-virtual-environments">PEP 405: 虚拟环境</a></li>
<li><a class="reference internal" href="#pep-420-implicit-namespace-packages">PEP 420: 隐式命名空间包</a></li>
<li><a class="reference internal" href="#pep-3118-new-memoryview-implementation-and-buffer-protocol-documentation">PEP 3118: 新的内存视图实现和缓冲协议文档</a><ul>
<li><a class="reference internal" href="#features">相关特性</a></li>
<li><a class="reference internal" href="#api-changes">API 的变化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-393-flexible-string-representation">PEP 393: 灵活的字符串表示</a><ul>
<li><a class="reference internal" href="#functionality">功能</a></li>
<li><a class="reference internal" href="#performance-and-resource-usage">性能和资源使用情况</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-397-python-launcher-for-windows">PEP 397: 适用于Windows的Python启动器</a></li>
<li><a class="reference internal" href="#pep-3151-reworking-the-os-and-io-exception-hierarchy">PEP 3151: 重写 OS 和 IO 异常的层次结构</a></li>
<li><a class="reference internal" href="#pep-380-syntax-for-delegating-to-a-subgenerator">PEP 380: 委托给子生成器的语法</a></li>
<li><a class="reference internal" href="#pep-409-suppressing-exception-context">PEP 409: 清除异常上下文</a></li>
<li><a class="reference internal" href="#pep-414-explicit-unicode-literals">PEP 414: 显式的Unicode文本</a></li>
<li><a class="reference internal" href="#pep-3155-qualified-name-for-classes-and-functions">PEP 3155: 类和函数的限定名称</a></li>
<li><a class="reference internal" href="#pep-412-key-sharing-dictionary">PEP 412: Key-Sharing Dictionary</a></li>
<li><a class="reference internal" href="#pep-362-function-signature-object">PEP 362: 函数签名对象</a></li>
<li><a class="reference internal" href="#pep-421-adding-sys-implementation">PEP 421: 添加 sys.implementation</a><ul>
<li><a class="reference internal" href="#simplenamespace">SimpleNamespace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-importlib-as-the-implementation-of-import">使用 importlib 作为导入的实现</a><ul>
<li><a class="reference internal" href="#new-apis">新的API</a></li>
<li><a class="reference internal" href="#visible-changes">可见的改变</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他语言特性修改</a></li>
<li><a class="reference internal" href="#a-finer-grained-import-lock">更细粒度的导入锁</a></li>
<li><a class="reference internal" href="#builtin-functions-and-types">内置函数和类型</a></li>
<li><a class="reference internal" href="#new-modules">新增模块</a><ul>
<li><a class="reference internal" href="#faulthandler">faulthandler</a></li>
<li><a class="reference internal" href="#ipaddress">ipaddress</a></li>
<li><a class="reference internal" href="#lzma">lzma</a></li>
</ul>
</li>
<li><a class="reference internal" href="#improved-modules">改进的模块</a><ul>
<li><a class="reference internal" href="#abc">abc</a></li>
<li><a class="reference internal" href="#array">array</a></li>
<li><a class="reference internal" href="#base64">base64</a></li>
<li><a class="reference internal" href="#binascii">binascii</a></li>
<li><a class="reference internal" href="#bz2">bz2</a></li>
<li><a class="reference internal" href="#codecs">编码器</a></li>
<li><a class="reference internal" href="#collections">collections</a></li>
<li><a class="reference internal" href="#contextlib">contextlib</a></li>
<li><a class="reference internal" href="#crypt">crypt</a></li>
<li><a class="reference internal" href="#curses">curses</a></li>
<li><a class="reference internal" href="#datetime">datetime</a></li>
<li><a class="reference internal" href="#decimal">decimal</a><ul>
<li><a class="reference internal" href="#id1">相关特性</a></li>
<li><a class="reference internal" href="#id2">API 的变化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#email">email</a><ul>
<li><a class="reference internal" href="#policy-framework">策略框架</a></li>
<li><a class="reference internal" href="#provisional-policy-with-new-header-api">带有新头部API的暂行策略</a></li>
<li><a class="reference internal" href="#other-api-changes">其他API更改</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ftplib">ftplib</a></li>
<li><a class="reference internal" href="#functools">functools</a></li>
<li><a class="reference internal" href="#gc">gc</a></li>
<li><a class="reference internal" href="#hmac">hmac</a></li>
<li><a class="reference internal" href="#http">http</a></li>
<li><a class="reference internal" href="#html">html</a></li>
<li><a class="reference internal" href="#imaplib">imaplib</a></li>
<li><a class="reference internal" href="#inspect">inspect</a></li>
<li><a class="reference internal" href="#io">io</a></li>
<li><a class="reference internal" href="#itertools">itertools</a></li>
<li><a class="reference internal" href="#logging">logging</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#mmap">mmap</a></li>
<li><a class="reference internal" href="#multiprocessing">multiprocessing</a></li>
<li><a class="reference internal" href="#nntplib">nntplib</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#pdb">pdb</a></li>
<li><a class="reference internal" href="#pickle">pickle</a></li>
<li><a class="reference internal" href="#pydoc">pydoc</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#sched">sched</a></li>
<li><a class="reference internal" href="#select">select</a></li>
<li><a class="reference internal" href="#shlex">shlex</a></li>
<li><a class="reference internal" href="#shutil">shutil</a></li>
<li><a class="reference internal" href="#signal">signal</a></li>
<li><a class="reference internal" href="#smtpd">smtpd</a></li>
<li><a class="reference internal" href="#smtplib">smtplib</a></li>
<li><a class="reference internal" href="#socket">socket</a></li>
<li><a class="reference internal" href="#socketserver">socketserver</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#ssl">ssl</a></li>
<li><a class="reference internal" href="#stat">stat</a></li>
<li><a class="reference internal" href="#struct">struct</a></li>
<li><a class="reference internal" href="#subprocess">subprocess</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#tarfile">tarfile</a></li>
<li><a class="reference internal" href="#tempfile">tempfile</a></li>
<li><a class="reference internal" href="#textwrap">textwrap</a></li>
<li><a class="reference internal" href="#threading">threading</a></li>
<li><a class="reference internal" href="#time">time</a></li>
<li><a class="reference internal" href="#types">types</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#urllib">urllib</a></li>
<li><a class="reference internal" href="#webbrowser">webbrowser</a></li>
<li><a class="reference internal" href="#xml-etree-elementtree">xml.etree.ElementTree</a></li>
<li><a class="reference internal" href="#zlib">zlib</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">性能优化</a></li>
<li><a class="reference internal" href="#build-and-c-api-changes">构建和 C API 的改变</a></li>
<li><a class="reference internal" href="#deprecated">弃用</a><ul>
<li><a class="reference internal" href="#unsupported-operating-systems">不支持的操作系统</a></li>
<li><a class="reference internal" href="#deprecated-python-modules-functions-and-methods">已弃用的 Python 模块、函数和方法</a></li>
<li><a class="reference internal" href="#deprecated-functions-and-types-of-the-c-api">已弃用的 C API 函数和类型</a></li>
<li><a class="reference internal" href="#deprecated-features">弃用的特性</a></li>
</ul>
</li>
<li><a class="reference internal" href="#porting-to-python-3-3">移植到 Python 3.3</a><ul>
<li><a class="reference internal" href="#porting-python-code">移植 Python 代码</a></li>
<li><a class="reference internal" href="#porting-c-code">移植 C 代码</a></li>
<li><a class="reference internal" href="#building-c-extensions">构建 C 扩展</a></li>
<li><a class="reference internal" href="#command-line-switch-changes">命令行开关的变化</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="3.4.html"
                          title="上一章">Python 3.4 有什么新变化</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="3.2.html"
                          title="下一章">Python 3.2 有什么新变化</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告代码错误</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.3.rst?plain=1"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="折叠边栏">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="3.2.html" title="Python 3.2 有什么新变化"
             >下一页</a> |</li>
        <li class="right" >
          <a href="3.4.html" title="Python 3.4 有什么新变化"
             >上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python的新变化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.3 有什么新变化</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box">
          <input type="submit" value="转到">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    主题
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>自动</option>
        <option value="light">明亮</option>
        <option value="dark">黑暗</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">版权</a> 2001 Python Software Foundation.
    <br>
    本页面采用 Python 软件基金会许可证第 2 版授权。
    <br>
    文档中的示例、代码片段及其他代码内容额外采用零条款 BSD 许可证授权。
    <br>
    
      更多信息请参阅《<a href="/license.html"> 历史与许可 </a>》。<br>
    
    
    <br>

    Python 软件基金会是一家非营利性公司。
<a href="https://www.python.org/psf/donations/">请进行捐赠。</a>
<br>
    <br>
      最后更新于11月 25, 2025 (07:24 UTC) 。
    
      <a href="/bugs.html">发现了错误</a>？
    
    <br>

    使用<a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3 创建。
    </div>

  </body>
</html>